{"version":3,"sources":["../node_modules/react/index.js","../node_modules/prop-types/index.js","../node_modules/history/node_modules/warning/browser.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/typeof.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits.js","../node_modules/warning/warning.js","../node_modules/invariant/browser.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../../src/errors.ts","../../src/constants.ts","../../src/logger.ts","../../src/firebaseApp.ts","../../src/firebaseNamespace.ts","../../src/firebaseNamespaceCore.ts","../../src/platformLoggerService.ts","../../index.ts","../../src/registerCoreComponents.ts","../node_modules/react-transition-group/index.js","../node_modules/react-dom/index.js","../../src/component.ts","../../src/provider.ts","../../src/component_container.ts","../node_modules/react-router/es/matchPath.js","../../src/assert.ts","../../src/crypt.ts","../../src/deepCopy.ts","../../src/deferred.ts","../../src/environment.ts","../../src/json.ts","../../src/jwt.ts","../../src/sha1.ts","../../src/subscribe.ts","../../src/validation.ts","../../src/obj.ts","../../src/query.ts","../../src/utf8.ts","../node_modules/object-assign/index.js","../node_modules/webpack/buildin/global.js","../node_modules/react-transition-group/Transition.js","../node_modules/react-lifecycles-compat/react-lifecycles-compat.es.js","../node_modules/react-transition-group/utils/PropTypes.js","../node_modules/react-transition-group/TransitionGroup.js","../node_modules/re-base/index.js","../node_modules/path-to-regexp/index.js","../node_modules/react/cjs/react.production.min.js","../node_modules/react-dom/cjs/react-dom.production.min.js","../node_modules/scheduler/index.js","../node_modules/scheduler/cjs/scheduler.production.min.js","../node_modules/react-transition-group/CSSTransition.js","../node_modules/prop-types/factoryWithThrowingShims.js","../node_modules/prop-types/lib/ReactPropTypesSecret.js","../node_modules/dom-helpers/class/addClass.js","../node_modules/@babel/runtime/helpers/interopRequireDefault.js","../node_modules/dom-helpers/class/hasClass.js","../node_modules/dom-helpers/class/removeClass.js","../node_modules/react-transition-group/ReplaceTransition.js","../node_modules/react-transition-group/utils/ChildMapping.js","../node_modules/re-base/dist/bundle.js","../node_modules/@firebase/app/node_modules/tslib/tslib.es6.js","../node_modules/@firebase/util/node_modules/tslib/tslib.es6.js","../node_modules/@firebase/component/node_modules/tslib/tslib.es6.js","../../src/core/storage/DOMStorageWrapper.ts","../../src/core/storage/MemoryStorage.ts","../../src/core/storage/storage.ts","../../src/core/util/util.ts","../../src/core/util/Path.ts","../../src/core/RepoInfo.ts","../../src/realtime/Constants.ts","../../src/core/util/libs/parser.ts","../../src/core/snap/indexes/KeyIndex.ts","../../src/core/snap/snap.ts","../../src/core/util/validation.ts","../../src/api/onDisconnect.ts","../../src/api/TransactionResult.ts","../../src/core/util/NextPushId.ts","../../src/core/snap/Node.ts","../../src/core/snap/indexes/Index.ts","../../src/core/snap/LeafNode.ts","../../src/core/snap/indexes/PriorityIndex.ts","../../src/core/snap/IndexMap.ts","../../src/core/snap/ChildrenNode.ts","../../src/core/util/SortedMap.ts","../../src/core/snap/childSet.ts","../../src/core/snap/comparators.ts","../../src/core/snap/nodeFromJSON.ts","../../src/core/snap/indexes/ValueIndex.ts","../../src/api/Query.ts","../../src/core/operation/Operation.ts","../../src/core/snap/indexes/PathIndex.ts","../../src/api/DataSnapshot.ts","../../src/core/view/Event.ts","../../src/core/view/EventRegistration.ts","../../src/core/SparseSnapshotTree.ts","../../src/core/util/ServerValues.ts","../../src/core/util/ImmutableTree.ts","../../src/core/SyncPoint.ts","../../src/core/operation/AckUserWrite.ts","../../src/core/operation/ListenComplete.ts","../../src/core/operation/Overwrite.ts","../../src/core/operation/Merge.ts","../../src/core/view/CacheNode.ts","../../src/core/view/ViewCache.ts","../../src/core/view/Change.ts","../../src/core/view/filter/IndexedFilter.ts","../../src/core/view/ChildChangeAccumulator.ts","../../src/core/view/CompleteChildSource.ts","../../src/core/view/ViewProcessor.ts","../../src/core/view/EventGenerator.ts","../../src/core/view/View.ts","../../src/core/CompoundWrite.ts","../../src/core/WriteTree.ts","../../src/core/SyncTree.ts","../../src/core/SnapshotHolder.ts","../../src/core/AuthTokenProvider.ts","../../src/core/stats/StatsCollection.ts","../../src/core/stats/StatsManager.ts","../../src/core/stats/StatsListener.ts","../../src/core/stats/StatsReporter.ts","../../src/core/view/EventQueue.ts","../../src/core/util/EventEmitter.ts","../../src/core/util/VisibilityMonitor.ts","../../src/core/util/OnlineMonitor.ts","../../src/realtime/polling/PacketReceiver.ts","../../src/realtime/BrowserPollConnection.ts","../../src/core/version.ts","../../src/realtime/WebSocketConnection.ts","../../src/realtime/TransportManager.ts","../../src/realtime/Connection.ts","../../src/core/ServerActions.ts","../../src/core/PersistentConnection.ts","../../src/core/ReadonlyRestClient.ts","../../src/core/Repo.ts","../../src/core/view/filter/RangedFilter.ts","../../src/core/view/filter/LimitedFilter.ts","../../src/core/view/QueryParams.ts","../../src/api/Reference.ts","../../src/core/util/Tree.ts","../../src/core/Repo_transaction.ts","../../src/core/RepoManager.ts","../../src/api/Database.ts","../../src/api/internal.ts","../../src/api/test_access.ts","../node_modules/process/browser.js","../node_modules/@firebase/database/node_modules/tslib/tslib.es6.js","../node_modules/isarray/index.js","../node_modules/@firebase/storage/node_modules/tslib/tslib.es6.js","../../src/implementation/error.ts","../../src/implementation/string.ts","../../src/implementation/taskenums.ts","../../src/implementation/xhrio.ts","../../src/implementation/type.ts","../../src/implementation/xhrio_network.ts","../../src/implementation/xhriopool.ts","../../src/implementation/fs.ts","../../src/implementation/blob.ts","../../src/implementation/location.ts","../../src/implementation/constants.ts","../../src/implementation/json.ts","../../src/implementation/path.ts","../../src/implementation/url.ts","../../src/implementation/metadata.ts","../../src/implementation/list.ts","../../src/implementation/requestinfo.ts","../../src/implementation/requests.ts","../../src/implementation/observer.ts","../../src/tasksnapshot.ts","../../src/implementation/args.ts","../../src/implementation/async.ts","../../src/task.ts","../../src/reference.ts","../../src/implementation/failrequest.ts","../../src/implementation/requestmap.ts","../../src/implementation/authwrapper.ts","../../src/implementation/request.ts","../../src/implementation/backoff.ts","../../src/service.ts","../node_modules/resolve-pathname/index.js","../node_modules/value-equal/index.js","../node_modules/history/es/PathUtils.js","../node_modules/history/es/LocationUtils.js","../node_modules/history/es/createTransitionManager.js","../node_modules/history/es/DOMUtils.js","../node_modules/history/es/createBrowserHistory.js","../node_modules/react-router/es/Router.js","../node_modules/history/es/createHashHistory.js","../node_modules/history/es/createMemoryHistory.js","../node_modules/react-router-dom/es/Router.js","../node_modules/react-router-dom/es/BrowserRouter.js","../node_modules/react-router/es/Switch.js","../node_modules/react-router-dom/es/Switch.js","../node_modules/react-router/es/Route.js","../node_modules/react-router-dom/es/Route.js"],"names":["module","exports","require","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","_getPrototypeOf","o","setPrototypeOf","getPrototypeOf","__proto__","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","toString","call","e","_typeof","obj","Symbol","iterator","constructor","_possibleConstructorReturn","self","ReferenceError","_createSuper","Derived","result","Super","NewTarget","this","arguments","apply","_setPrototypeOf","p","_inherits","subClass","superClass","create","value","warning","condition","format","a","b","c","d","f","error","undefined","Error","args","argIndex","replace","name","framesToPop","_defineProperty","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","_objectSpread2","source","forEach","getOwnPropertyDescriptors","defineProperties","ErrorFactory","_a","appName","Logger","options","config","firebase_","isDeleted_","name_","automaticDataCollectionEnabled_","automaticDataCollectionEnabled","options_","deepCopy","container","ComponentContainer","_addComponent","Component","INTERNAL","components","values","component","checkDestroyed_","val","delete","Promise","resolve","then","removeApp","all","getProviders","map","provider","_getService","instanceIdentifier","getProvider","getImmediate","identifier","_removeServiceInstance","clearInstance","addComponent","logger","debug","_addOrOverwriteComponent","addOrOverwriteComponent","ERROR_FACTORY","FirebaseAppImpl","console","log","firebase","createFirebaseNamespace","namespace","firebaseAppImpl","apps","Map","__esModule","initializeApp","rawConfig","String","contains","app","registerVersion","libraryKeyOrName","version","variant","library","PLATFORM_LOG_STRING","libraryMismatch","match","versionMismatch","warn","join","registerComponent","SDK_VERSION","useAsService","componentName","has","type","set","serviceNamespace","appArg","serviceProps","deepExtend","serviceFxn","bind","multipleInstances","get","createFirebaseNamespaceCore","extendNamespace","createSubscribe","getPlatformInfoString","getComponent","isVersionServiceProvider","service","logString","isBrowser","firebaseNamespace","isNode","PlatformLoggerService","_CSSTransition","_interopRequireDefault","_ReplaceTransition","_TransitionGroup","_Transition","default","Transition","TransitionGroup","ReplaceTransition","CSSTransition","checkDCE","__REACT_DEVTOOLS_GLOBAL_HOOK__","process","err","instanceFactory","instantiationMode","setInstantiationMode","mode","setMultipleInstances","setServiceProps","instances","instancesDeferred","normalizedIdentifier","normalizeInstanceIdentifier","deferred","Deferred","getOrInitializeService","promise","optional","setComponent","isComponentEager","entries","instanceDeferred","services","Array","from","isComponentSet","normalizeIdentifierForFactory","providers","Provider","patternCache","cacheCount","compilePath","pattern","cacheKey","end","strict","sensitive","cache","compiledPattern","re","pathToRegexp","matchPath","pathname","parent","path","_options","_options$exact","exact","_options$strict","_options$sensitive","_compilePath","exec","url","slice","isExact","params","reduce","memo","index","CONSTANTS","NODE_CLIENT","NODE_ADMIN","assert","assertion","message","assertionError","stringToByteArray","str","out","charCodeAt","base64","byteToCharMap_","charToByteMap_","byteToCharMapWebSafe_","charToByteMapWebSafe_","ENCODED_VALS_BASE","HAS_NATIVE_SUPPORT","atob","encodeByteArray","input","webSafe","isArray","init_","byteToCharMap","output","byte1","haveByte2","byte2","haveByte3","byte3","outByte1","outByte2","outByte3","outByte4","encodeString","btoa","decodeString","bytes","pos","c1","fromCharCode","c2","u","c3","byteArrayToString","decodeStringToByteArray","charToByteMap","charAt","byte4","ENCODED_VALS","ENCODED_VALS_WEBSAFE","base64Decode","getTime","prop","hasOwnProperty","reject","wrapCallback","callback","catch","getUA","navigator","code","FirebaseError","captureStackTrace","serviceName","errors","customData","data","fullCode","template","replaceTemplate","fullMessage","PATTERN","_","jsonEval","JSON","parse","decode","token","header","claims","signature","parts","split","chain_","buf_","W_","pad_","inbuf_","total_","blockSize","reset","compress_","buf","offset","W","t","k","update","lengthMinusBlock","n","inbuf","digest","totalBits","j","executor","onNoObservers","observers","unsubscribes","observerCount","task","finalized","next","forEachObserver","observer","close","complete","subscribe","nextOrObserver","methods","method","implementsAnyMethods","noop","unsub","unsubscribeOne","finalError","fn","sendOne","errorPrefix","fnName","argumentNumber","argName","onError","utf8Bytes","proxy","ObserverProxy","window","test","global","now","Math","floor","validSince","validUntil","contextObj","res","querystringParams","arrayVal","encodeURIComponent","querystring","high","stringify","minCount","maxCount","argCount","argError","context","propIsEnumerable","propertyIsEnumerable","toObject","assign","test1","getOwnPropertyNames","test2","test3","letter","shouldUseNative","to","s","g","Function","EXITING","ENTERED","ENTERING","EXITED","UNMOUNTED","PropTypes","newObj","desc","_interopRequireWildcard","_react","_reactDom","_reactLifecyclesCompat","_React$Component","_this","initialStatus","parentGroup","transitionGroup","appear","isMounting","enter","appearStatus","in","unmountOnExit","mountOnEnter","state","status","nextCallback","_proto","getChildContext","getDerivedStateFromProps","_ref","prevState","componentDidMount","updateStatus","componentDidUpdate","prevProps","nextStatus","componentWillUnmount","cancelNextCallback","getTimeouts","exit","timeout","mounting","node","findDOMNode","performEnter","performExit","setState","_this2","appearing","timeouts","onEnter","safeSetState","onEntering","onTransitionEnd","onEntered","_this3","onExit","onExiting","onExited","cancel","nextState","setNextCallback","_this4","active","event","handler","addEndListener","setTimeout","render","_this$props","children","childProps","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","child","Children","only","cloneElement","contextTypes","childContextTypes","propTypes","defaultProps","_default","polyfill","componentWillMount","componentWillReceiveProps","nextProps","componentWillUpdate","__reactInternalSnapshotFlag","__reactInternalSnapshot","getSnapshotBeforeUpdate","isReactComponent","foundWillMountName","foundWillReceivePropsName","foundWillUpdateName","UNSAFE_componentWillMount","UNSAFE_componentWillReceiveProps","UNSAFE_componentWillUpdate","displayName","newApiName","maybeSnapshot","snapshot","__suppressDeprecationWarning","transitionTimeout","transitionType","timeoutPropName","enabledPropName","classNamesShape","timeoutsShape","_propTypes","oneOfType","number","shape","isRequired","string","enterDone","enterActive","exitDone","exitActive","_ChildMapping","_extends","_assertThisInitialized","handleExited","firstRender","appeared","mounted","prevChildMapping","getInitialChildMapping","getNextChildMapping","currentChildMapping","getChildMapping","childFactory","createElement","LogLevel","defaultLogLevel","INFO","defaultLogHandler","logType","logLevel","toISOString","DEBUG","VERBOSE","info","WARN","ERROR","_logLevel","_logHandler","isarray","compile","tokensToFunction","tokensToRegExp","PATH_REGEXP","RegExp","tokens","defaultDelimiter","delimiter","m","escaped","prefix","capture","group","modifier","asterisk","partial","repeat","escapeGroup","escapeString","substr","encodeURIComponentPretty","encodeURI","toUpperCase","matches","opts","encode","pretty","segment","attachKeys","flags","route","endsWithDelimiter","groups","regexpToRegexp","arrayToRegexp","stringToRegexp","for","q","r","v","w","x","y","z","A","B","C","aa","h","l","D","E","isMounted","enqueueForceUpdate","enqueueReplaceState","enqueueSetState","F","G","refs","updater","H","I","forceUpdate","J","isPureReactComponent","K","current","currentDispatcher","L","M","ref","__self","__source","N","$$typeof","_owner","O","P","Q","R","pop","keyPrefix","func","count","S","V","T","U","done","escape","ca","da","ba","X","toArray","createRef","PureComponent","createContext","_calculateChangedBits","_currentValue","_currentValue2","_threadCount","Consumer","_context","forwardRef","lazy","_ctor","_status","_result","compare","Fragment","StrictMode","Suspense","createFactory","isValidElement","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentOwner","unstable_ConcurrentMode","unstable_Profiler","Y","Z","ea","fa","ha","ia","ja","ka","ma","na","oa","pa","extractEvents","eventTypes","qa","phasedRegistrationNames","ra","registrationName","sa","ta","dependencies","ua","va","wa","xa","currentTarget","la","ya","concat","za","Aa","Ba","_dispatchListeners","_dispatchInstances","isPropagationStopped","isPersistent","release","Ca","injectEventPluginOrder","injectEventPluginsByName","Da","stateNode","disabled","Ea","Fa","random","Ga","Ha","Ia","parentNode","tag","Ja","Ka","La","Ma","return","Na","dispatchConfig","Oa","_targetInst","Pa","Qa","Ra","Sa","document","Ta","toLowerCase","Ua","animationend","animationiteration","animationstart","transitionend","Va","Wa","Xa","style","animation","transition","Ya","Za","$a","ab","bb","cb","eb","fb","gb","textContent","hb","ib","nativeEvent","Interface","isDefaultPrevented","defaultPrevented","returnValue","kb","eventPool","lb","destructor","jb","getPooled","preventDefault","stopPropagation","cancelBubble","persist","eventPhase","bubbles","cancelable","timeStamp","isTrusted","extend","mb","nb","ob","pb","qb","documentMode","rb","sb","tb","ub","beforeInput","bubbled","captured","compositionEnd","compositionStart","compositionUpdate","vb","wb","keyCode","xb","detail","yb","Bb","locale","which","zb","ctrlKey","altKey","metaKey","char","Ab","Cb","Db","Eb","Hb","Ib","Jb","Kb","Lb","Mb","Nb","Ob","Pb","color","date","datetime","email","month","password","range","search","tel","text","time","week","Qb","nodeName","Rb","srcElement","correspondingUseElement","nodeType","Sb","setAttribute","Tb","Vb","_valueTracker","getValue","setValue","stopTracking","Ub","Wb","checked","Xb","Yb","Zb","$b","ac","bc","cc","dc","ec","fc","gc","hc","ic","jc","kc","lc","mc","nc","_debugOwner","_debugSource","fileName","lineNumber","oc","pc","qc","rc","acceptsBooleans","attributeName","attributeNamespace","mustUseProperty","propertyName","vc","xc","yc","tc","isNaN","uc","sc","removeAttribute","setAttributeNS","zc","Ac","defaultChecked","defaultValue","_wrapperState","initialChecked","Bc","initialValue","controlled","Cc","Dc","Ec","Fc","ownerDocument","activeElement","tabIndex","Gc","change","Hc","Jc","Kc","Lc","Mc","Nc","Oc","Pc","detachEvent","Qc","Rc","attachEvent","Sc","Tc","Uc","Vc","_isInputEventSupported","Wc","view","Xc","Alt","Control","Meta","Shift","Yc","getModifierState","Zc","$c","ad","bd","cd","dd","screenX","screenY","clientX","clientY","pageX","pageY","shiftKey","button","buttons","relatedTarget","fromElement","toElement","movementX","movementY","ed","pointerId","width","height","pressure","tangentialPressure","tiltX","tiltY","twist","pointerType","isPrimary","fd","mouseEnter","mouseLeave","pointerEnter","pointerLeave","gd","defaultView","parentWindow","alternate","hd","id","jd","kd","effectTag","ld","nd","sibling","md","od","animationName","elapsedTime","pseudoElement","pd","clipboardData","qd","rd","charCode","sd","Esc","Spacebar","Left","Up","Right","Down","Del","Win","Menu","Apps","Scroll","MozPrintableKey","td","8","9","12","13","16","17","18","19","20","27","32","33","34","35","36","37","38","39","40","45","46","112","113","114","115","116","117","118","119","120","121","122","123","144","145","224","ud","location","vd","dataTransfer","wd","touches","targetTouches","changedTouches","xd","yd","deltaX","wheelDeltaX","deltaY","wheelDeltaY","wheelDelta","deltaZ","deltaMode","zd","Ad","Bd","Cd","isInteractive","Dd","isInteractiveTopLevelEventType","Ed","Fd","Gd","targetInst","ancestors","containerInfo","topLevelType","Hd","Id","Jd","addEventListener","Kd","Ld","Md","Nd","Od","Pd","body","Qd","firstChild","Rd","nextSibling","Td","HTMLIFrameElement","contentDocument","Ud","contentEditable","Vd","Wd","select","Xd","Yd","Zd","$d","ae","start","selectionStart","selectionEnd","anchorNode","getSelection","anchorOffset","focusNode","focusOffset","be","onSelect","ee","de","fe","selected","defaultSelected","ge","dangerouslySetInnerHTML","he","ie","je","SimpleEventPlugin","EnterLeaveEventPlugin","ChangeEventPlugin","SelectEventPlugin","BeforeInputEventPlugin","ke","le","me","ne","oe","MSApp","execUnsafeLocalFunction","namespaceURI","innerHTML","removeChild","appendChild","pe","lastChild","nodeValue","qe","animationIterationCount","borderImageOutset","borderImageSlice","borderImageWidth","boxFlex","boxFlexGroup","boxOrdinalGroup","columnCount","columns","flex","flexGrow","flexPositive","flexShrink","flexNegative","flexOrder","gridArea","gridRow","gridRowEnd","gridRowSpan","gridRowStart","gridColumn","gridColumnEnd","gridColumnSpan","gridColumnStart","fontWeight","lineClamp","lineHeight","opacity","order","orphans","tabSize","widows","zIndex","zoom","fillOpacity","floodOpacity","stopOpacity","strokeDasharray","strokeDashoffset","strokeMiterlimit","strokeOpacity","strokeWidth","se","trim","te","setProperty","substring","ue","menuitem","area","base","br","col","embed","hr","img","keygen","link","meta","param","track","wbr","ve","we","is","xe","blur","focus","ye","ze","Ae","Be","autoFocus","Ce","__html","De","Ee","clearTimeout","Fe","Ge","Set","He","Ie","Je","Ke","Le","__reactInternalMemoizedUnmaskedChildContext","__reactInternalMemoizedMaskedChildContext","Me","Ne","Oe","Pe","Qe","__reactInternalMemoizedMergedChildContext","Re","Se","Te","Ue","We","elementType","pendingProps","firstContextDependency","memoizedState","updateQueue","memoizedProps","lastEffect","firstEffect","nextEffect","childExpirationTime","expirationTime","Xe","Ze","$e","af","bf","cf","df","pendingChildren","implementation","ef","didError","earliestPendingTime","latestPendingTime","ff","gf","latestPingedTime","earliestSuspendedTime","latestSuspendedTime","hf","nextExpirationTimeToWorkOn","jf","kf","baseState","firstUpdate","lastUpdate","firstCapturedUpdate","lastCapturedUpdate","firstCapturedEffect","lastCapturedEffect","lf","mf","payload","nf","of","pf","qf","rf","sf","tf","uf","vf","stack","wf","xf","yf","zf","Af","Bf","Cf","Df","observedBits","Ef","Ff","Gf","Hf","If","documentElement","tagName","Jf","Kf","Lf","Nf","Of","Pf","Uf","_reactInternalFiber","Qf","Rf","Sf","Tf","Vf","shouldComponentUpdate","Wf","contextType","readContext","Xf","Yf","Zf","$f","_stringRef","ag","bg","cg","dg","eg","fg","gg","hg","ig","jg","kg","lg","mg","ng","og","pg","qg","rg","sg","tg","ug","vg","getDerivedStateFromError","wg","pendingContext","xg","timedOutAt","fallback","yg","Mf","Ye","element","hydrate","hidden","unstable_observedBits","zg","Ag","Fg","Gg","Hg","Ig","Jg","Kg","destroy","Lg","Mg","Ng","insertBefore","_reactRootContainer","onclick","Og","wasMultiple","multiple","display","Pg","Qg","Rg","componentDidCatch","Sg","add","componentStack","Tg","onClick","Ug","Vg","Wg","Xg","Yg","Zg","$g","ah","dh","eh","createElementNS","createTextNode","fh","gh","pendingCommitExpirationTime","hh","maxDuration","ih","finishedWork","jh","kh","lh","mh","nh","oh","ph","qh","rh","sh","th","uh","vh","wh","xh","yh","zh","unstable_now","Ah","Bh","Ch","Dh","Eh","unstable_cancelCallback","unstable_scheduleCallback","Fh","timeoutHandle","Gh","Hh","Ih","nextScheduledRoot","Jh","Kh","Lh","unstable_shouldYield","_onComplete","Mh","firstBatch","_expirationTime","_defer","rangeCount","db","focusedElem","selectionRange","Th","__reactInternalSnapshotBeforeUpdate","Sd","compareDocumentPosition","min","createRange","setStart","removeAllRanges","addRange","setEnd","left","scrollLeft","top","scrollTop","Fb","Gb","wc","ci","Cg","Dg","di","Ic","Eg","ce","Nh","Oh","Ph","Qh","Rh","Sh","Uh","Vh","_root","_callbacks","_next","_hasChildren","_didComplete","_children","Wh","_didCommit","_onCommit","Xh","_internalRoot","Yh","$h","legacy_renderSubtreeIntoContainer","hasAttribute","Zh","ai","querySelectorAll","form","commit","unmount","createBatch","bi","createPortal","unstable_renderSubtreeIntoContainer","unmountComponentAtNode","unstable_createPortal","unstable_batchedUpdates","unstable_interactiveUpdates","flushSync","unstable_flushControlled","Events","unstable_createRoot","findFiberByHostInstance","isDisabled","supportsFiber","inject","onCommitFiberRoot","onCommitFiberUnmount","Ve","findHostInstanceByFiber","bundleType","rendererPackageName","ei","fi","previous","priorityLevel","requestAnimationFrame","cancelAnimationFrame","performance","_schedMock","MessageChannel","port2","port1","onmessage","postMessage","unstable_ImmediatePriority","unstable_UserBlockingPriority","unstable_NormalPriority","unstable_IdlePriority","unstable_LowPriority","unstable_runWithPriority","unstable_wrapCallback","unstable_getCurrentPriorityLevel","_addClass","_removeClass","addClass","classes","removeClass","_len","_key","className","getClassNames","removeClasses","activeClassName","reflowAndAddClass","doneClassName","classNames","_this$getClassNames7","ReactPropTypesSecret","emptyFunction","shim","propName","propFullName","secret","getShim","ReactPropTypes","array","bool","symbol","any","arrayOf","instanceOf","objectOf","oneOf","checkPropTypes","classList","_hasClass","baseVal","replaceClassName","origClass","classToRemove","remove","_args","handleEnter","_len2","_key2","handleLifecycle","handleEntering","_len3","_key3","handleEntered","_len4","_key4","handleExit","_len5","_key5","handleExiting","_len6","_key6","_len7","_key7","idx","originalArgs","_child$props","inProp","_React$Children$toArr","first","second","mergeChildMappings","getProp","nextChildMapping","hasPrev","hasNext","prevChild","isLeaving","mapFn","mapper","prev","getValueForKey","nextKeysPending","pendingKeys","prevKey","childMapping","nextKey","pendingNextKey","factory","__WEBPACK_EXTERNAL_MODULE_6__","modules","installedModules","__webpack_require__","moduleId","loaded","_validators","_app2","_push3","_fetch3","_post3","_sync3","_bind3","_update3","_reset3","_removeBinding3","_remove3","_fsSync3","_fsRemoveBinding3","_fsBind3","_fsGet3","_fsRemoveDoc3","_fsAddToCollection3","_fsRemoveFromCollection3","_fsUpdateDoc3","_fsReset3","createClass","_validateDatabase","listeners","syncs","WeakMap","rebase","initializedApp","timestamp","database","ServerValue","TIMESTAMP","listenTo","endpoint","bindToState","syncState","fetch","post","removeBinding","binding","firestore","FieldValue","serverTimestamp","bindDoc","bindCollection","syncDoc","doc","listenToDoc","listenToCollection","addToCollection","updateDoc","removeDoc","removeFromCollection","init","_fsCreateRef","_fsSetUnmountHandler","_setData","_handleError","_createNestedObject","_setUnmountHandler","_addFirestoreListener","_addListener","_fsUpdateSyncState","_updateSyncState","_firebaseRefsMixin","_addSync","_hasOwnNestedProperty","_getSegmentCount","_getNestedObject","_isNestedPath","_isObject","_isValid","_toArray","_fsPrepareData","_prepareData","_throwError","_setState","_returnRef","_addFirestoreQuery","_addQueries","_createHash","arr","childSnapshot","lastKey","root","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","asArray","newState","queries","needArgs","limitToFirst","limitToLast","orderByChild","startAt","endAt","equalTo","query","onFailure","handleError","keepKeys","acc","curr","item","isCollection","exists","withRefs","withIds","collection","empty","invoker","hash","msg","sync","existingSyncs","boundOnFailure","on","reactSetState","called","onSnapshot","_newState2","_newState3","currentState","_newState4","_newState5","pathOrRef","_ref2","listener","off","currentSyncs","findIndex","splice","unsubscribe","_validateCollectionPath","_validateDocumentPath","_validateEndpoint","optionValidators","_utils","notObject","makeError","validQueries","actual","errorMsg","defaultError","once","_sync","updateFirebase","stateKey","syncsToCall","syncedKeys","nested","syncedKey","datum","find","_fsSync","batch","extendStatics","__extends","__","__assign","__rest","__decorate","decorators","decorate","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","generator","fulfilled","step","rejected","__generator","label","sent","trys","ops","verb","op","__exportStar","__values","__read","ar","__spread","__spreadArrays","il","jl","__await","__asyncGenerator","asyncIterator","resume","fulfill","settle","shift","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__importStar","mod","__importDefault","domStorage_","prefix_","removeItem","prefixedName_","setItem","storedVal","getItem","cache_","isInMemoryStorage","createStoragefor","domStorageName","domStorage","DOMStorageWrapper","MemoryStorage","PersistentStorage","SessionStorage","logClient","LUIDGenerator","sha1","Sha1","sha1Bytes","buildLogMessage_","var_args","firstLog_","enableLogging","logger_","persistent","logWrapper","fatal","isInvalidJSONNumber","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","MIN_NAME","MAX_NAME","nameCompare","aAsInt","tryParseInt","bAsInt","stringCompare","requireKey","ObjectToUniqueKey","sort","splitStringBySize","segsize","len","dataSegs","each","doubleToIEEE754String","ln","bits","Infinity","abs","pow","LN2","round","reverse","hexByteString","hexByte","parseInt","INTEGER_REGEXP_","intVal","exceptionGuard","setTimeoutNonBlocking","pathOrString","pieceNum","pieces_","copyTo","pieceNum_","Path","getFront","getLength","popFront","getBack","pathString","toUrlEncodedString","begin","pieces","childPathObj","childPieces","isEmpty","relativePath","outerPath","innerPath","outer","inner","comparePaths","right","leftKeys","rightKeys","cmp","equals","other","errorPrefix_","parts_","byteLength_","max","stringLength","checkValid_","last","ValidationPath","MAX_PATH_LENGTH_BYTES","MAX_PATH_DEPTH","toErrorString","host","secure","webSocketOnly","persistenceKey","includeNamespaceInQueryParams","domain","internalHost","needsQueryParam","isCustomHost","isCacheableHost","isDemoHost","updateHost","newHost","connectionURL","connURL","pairs","toURLString","__EMPTY_NODE","MAX_NODE","parseRepoInfo","dataURL","parsedUrl","parseDatabaseURL","protocol","scheme","repoInfo","RepoInfo","subdomain","port","colonInd","slashInd","questionMarkInd","pathStringDecoded","piece","decodeURIComponent","decodePath","queryParams","queryString","results","kv","decodeQuery","INVALID_KEY_REGEX_","INVALID_PATH_REGEX_","isValidKey","isValidPathString","isValidPriority","priority","validateFirebaseDataArg","validateFirebaseData","errorPrefixFxn","path_","validateFirebaseMergeDataArg","mergePaths","curPath","prevPath","validateFirebaseMergePaths","validatePriority","validateEventType","eventType","validateKey","validatePathString","validateRootPathString","validateWritablePath","validateUrl","isValidRootPathString","validateBoolean","repo_","onComplete","validateArgCount","validateCallback","onDisconnectCancel","onDisconnectSet","setWithPriority","onDisconnectSetWithPriority","objectToMerge","newObjectToMerge","onDisconnectUpdate","committed","toJSON","nextPushId","PUSH_CHARS","lastPushTime","lastRandChars","duplicateTime","timeStampChars","Wrap","NamedNode","getCompare","indexedValueChanged","oldNode","newNode","oldWrapped","newWrapped","minPost","MIN","isDefinedOn","maxPost","makePost","indexValue","Index","KEY_INDEX","KeyIndex","__childrenNodeConstructor","nodeFromJSON","priorityHashText","validatePriorityNode","priorityNode","isLeafNode","getPriority","value_","priorityNode_","LeafNode","EMPTY_NODE","lazyHash_","updatePriority","newPriorityNode","getImmediateChild","childName","getChild","hasChild","getPredecessorChildName","childNode","updateImmediateChild","newChildNode","updateChild","front","numChildren","forEachChild","action","exportFormat","toHash","compareTo","compareToLeafNode_","otherLeaf","otherLeafType","thisLeafType","otherIndex","VALUE_TYPE_ORDER","thisIndex","withIndex","isIndexed","_defaultIndexMap","PRIORITY_INDEX","aPriority","bPriority","indexCmp","startKey","comparator","isReverse_","resultGenerator_","nodeStack_","getNext","peek","LLRBNode","RED","SortedMap","copy","inorderTraversal","reverseTraversal","min_","minKey","maxKey","insert","fixUp_","removeMin_","isRed_","moveRedLeft_","smallest","rotateRight_","moveRedRight_","rotateLeft_","colorFlip_","nl","nr","checkMaxDepth_","blackDepth","check_","BLACK","comparator_","root_","getPredecessorKey","rightParent","getIterator","resultGenerator","SortedMapIterator","getIteratorFrom","getReverseIteratorFrom","getReverseIterator","LLRBEmptyNode","LOG_2","num","current_","mask","bits_","nextBitIsOne","buildChildSet","childList","keyFn","mapSortFn","base12","buildPennant","chunkSize","low","childTree","buildBalancedTree","namedNode","middle","attachPennant","pennant","isOne","buildFrom12Array","Base12Num","fallbackObject","indexes_","indexSet_","IndexMap","indexKey","sortedMap","safeGet","hasIndex","indexDefinition","addIndex","existingChildren","newIndex","sawIndexedValue","iter","indexName","newIndexSet","newIndexes","addToIndexes","indexedChildren","existingSnap","newChildren","removeFromIndexes","NAME_ONLY_COMPARATOR","NAME_COMPARATOR","children_","indexMap_","ChildrenNode","Default","newPriority","newIndexMap","newImmediateChild","numKeys","allIntegerKeys","childHash","resolveIndex_","predecessor","getFirstChildName","getFirstChild","getLastChildName","getLastChild","wrappedNode","startPost","endPost","otherChildrenNode","thisIter","otherIter","thisCurrent","otherCurrent","MAX","setPriorityMaxNode","json","childData","childSet","sortedChildSet","setNodeFromJSON","__referenceConstructor","OperationType","VALUE_INDEX","valueNode","indexPath_","extractChild","snap","aChild","bChild","node_","ref_","index_","exportVal","childPathString","childPath","childRef","DataSnapshot","childrenNode","hasChildren","getKey","getRef","eventRegistration","prevName","getPath","getParent","getEventType","getEventRunner","callback_","cancelCallback_","context_","respondsTo","createEvent","getQueryParams","getIndex","DataEvent","snapshotNode","eventData","ctx","createCancelEvent","CancelEvent","ValueEventRegistration","hasAnyCallback","callbacks_","eventToCheck","ChildEventRegistration","otherKeys","thisKeys","otherCount","otherKey","thisKey","every","repo","queryParams_","orderByCalled_","validateQueryEndpoints_","startNode","endNode","hasStart","getIndexStartValue","hasEnd","getIndexEndValue","tooManyArgsError","wrongArgTypeError","getIndexStartName","getIndexEndName","PathIndex","validateLimit_","hasLimit","hasAnchoredLimit","validateNoPreviousOrderByCall_","Query","cancelCallbackOrContext","ret","getCancelAndContextArgs_","onValueEvent","callbacks","onChildEvent","cancelCallback","addEventCallbackForQuery","validateContextObject","valueCallback","removeEventCallbackForQuery","userCallback","failureCallbackOrContext","firstCall","onceCallback","limit","parsedPath","newParams","orderBy","orderByKey","orderByPriority","orderByValue","queryObject","getQueryObject","queryIdentifier","isEqual","sameRepo","samePath","sameQueryIdentifier","cancelOrContext","size","childKey","remember","clear","SparseSnapshotTree","forget","tree","forEachTree","prefixPath","resolveDeferredValue","existing","serverValues","resolveScalarDeferredValue","resolveComplexDeferredValue","unused","delta","existingVal","resolveDeferredValueSnapshot","rawPri","leafNode","emptyChildrenSingleton","fromUser","fromServer","queryId","tagged","User","OperationSource","Server","forServerTaggedQuery","affectedTree","revert","ACK_USER_WRITE","operationForChild","subtree","AckUserWrite","Empty","fromObject","ImmutableTree","childSnap","findRootMostMatchingPathAndValue","predicate","childExistingPathAndValue","findRootMostValueAndPath","toSet","newChild","setTree","newTree","fold","fold_","pathSoFar","accum","findOnPath","findOnPath_","pathToFollow","nextChild","foreachOnPath","foreachOnPath_","currentRelativePath","foreach","foreach_","foreachChild","LISTEN_COMPLETE","ListenComplete","OVERWRITE","Overwrite","MERGE","Merge","fullyInitialized_","filtered_","isFullyInitialized","isFiltered","isCompleteForPath","isCompleteForChild","getNode","eventCache_","serverCache_","updateEventSnap","eventSnap","filtered","ViewCache","CacheNode","updateServerSnap","serverSnap","getEventCache","getCompleteEventSnap","getServerCache","getCompleteServerSnap","oldSnap","valueChange","Change","VALUE","childAddedChange","CHILD_ADDED","childRemovedChange","CHILD_REMOVED","childChangedChange","newSnapshot","oldSnapshot","CHILD_CHANGED","childMovedChange","CHILD_MOVED","affectedPath","optChangeAccumulator","oldChild","trackChildChange","updateFullNode","newSnap","filtersNodes","getIndexedFilter","changeMap","oldChange","oldType","getChanges","NO_COMPLETE_CHILD_SOURCE","getCompleteChild","getChildAfterChild","writes_","viewCache_","optCompleteServerCache_","serverNode","calcCompleteChild","completeServerData","nodes","calcIndexedSlice","viewCache","changes","filter_","assertIndexed","applyOperation","oldViewCache","operation","writesCache","completeCache","newViewCache","filterServerNode","accumulator","ChildChangeAccumulator","overwrite","applyUserOverwrite_","applyServerOverwrite_","merge","applyUserMerge_","applyServerMerge_","ackUserWrite","revertUserWrite_","ackUserWrite_","listenComplete_","ViewProcessor","maybeAddValueEvent_","ProcessorResult","isLeafOrEmpty","oldCompleteSnap","generateEventCacheAfterServerEvent_","changePath","oldEventSnap","shadowingWrite","newEventCache","serverCache","completeChildren","completeEventChildren","calcCompleteEventChildren","completeNode","calcCompleteEventCache","oldEventNode","updatedPriority","calcEventCacheAfterServerOverwrite","childChangePath","newEventChild","eventChildUpdate","changedSnap","newServerCache","oldServerSnap","serverFilter","newServerNode","WriteTreeCompleteChildSource","newEventSnap","cacheHasChild_","changedChildren","curViewCache","writePath","applyMerge_","viewMergeTree","serverChild","childMergeTree","isUnknownDeepMerge","ackPath","mergePath","serverCachePath","oldServerNode","completeServerCache","oldEventCache","serverChildren","query_","generateEventsForChanges","eventCache","eventRegistrations","events","moves","generateEventsForType_","registrations","filteredChanges","compareChanges_","materializedChange","materializeSingleChange_","registration","aWrapped","bWrapped","initialViewCache","eventRegistrations_","indexFilter","IndexedFilter","getNodeFilter","processor_","initialServerCache","initialEventCache","eventGenerator_","EventGenerator","getQuery","getCompleteServerCache","loadsAllData","addEventRegistration","removeEventRegistration","cancelError","cancelEvents","maybeEvent","remaining","generateEventsForChanges_","getInitialEvents","initialChanges","views","optCompleteServerCache","serverCacheComplete","eventCacheComplete","View","removed","hadCompleteView","hasCompleteView","viewQueryId","SyncPoint","getQueryViews","viewForQuery","getCompleteView","viewExistsForQuery","writeTree_","addWrite","CompoundWrite","rootmost","rootMostPath","addWrites","updates","newWrite","removeWrite","hasCompleteWrite","getCompleteNode","getCompleteChildren","childCompoundWrite","shadowingNode","applySubtreeWrite","writeTree","visibleWrites_","allWrites_","lastWriteId_","childWrites","WriteTreeRef","addOverwrite","writeId","visible","addMerge","getWrite","record","writeToRemove","removedWriteWasVisible","removedWriteOverlapsWithOtherWrites","currentWrite","recordContainsPath_","resetTree_","getCompleteWriteData","treePath","writeIdsToExclude","includeHiddenWrites","mergeAtPath","WriteTree","layerTree_","write","layeredCache","subMerge","completeServerChildren","topLevelSet","existingEventSnap","existingServerSnap","childMerge","toIterate","writeRecord","DefaultFilter_","writes","treeRoot","compoundWrite","deepNode","treePath_","existingServerCache","listenProvider_","syncPointTree_","pendingWriteTree_","tagToQueryMap","queryToTagMap","applyUserOverwrite","newData","applyOperationToSyncPoints_","applyUserMerge","changeTree","applyServerOverwrite","applyServerMerge","applyListenComplete","applyTaggedQueryOverwrite","queryKey","queryKeyForTag_","SyncTree","parseQueryKey_","queryPath","applyTaggedOperation_","applyTaggedQueryMerge","applyTaggedListenComplete","foundAncestorDefaultView","pathToSyncPoint","sp","syncPoint","childSyncPoint","viewAlreadyExists","makeQueryKey_","getNextQueryTag_","setupListener_","maybeSyncPoint","removedAndEvents","removingDefault","covered","parentSyncPoint","newViews","collectDistinctViewsForSubTree_","newQuery","createListenerForView_","startListening","queryForListening_","tagForQuery_","hashFn","stopListening","queryToRemove","tagToRemove","removeTags_","maybeChildSyncPoint","childMap","childViews","removedQuery","removedQueryKey","removedQueryTag","isDefault","queriesToStop","childQueries","queryToStop","reason","errorForServerCode","splitIndex","nextQueryTag_","applyOperationHelper_","syncPointTree","applyOperationDescendantsHelper_","childOperation","childServerCache","childWritesCache","rootNode_","updateSnapshot","newSnapshotNode","app_","authProvider_","auth_","auth","getToken","forceRefresh","addTokenChangeListener","addAuthTokenListener","removeTokenChangeListener","removeAuthTokenListener","notifyForInvalidToken","errorMessage","counters_","incrementCounter","amount","getCollection","hashString","collections_","StatsCollection","getOrCreateReporter","creatorFunction","reporters_","collection_","last_","newStats","stat","server_","statsToReport_","statsListener_","StatsListener","reportStats_","includeStat","stats","reportedStats","haveStatsToReport","reportStats","eventLists_","recursionDepth_","queueEvents","eventDataList","currList","eventPath","EventList","raiseEventsAtPath","raiseQueuedEventsMatchingPredicate_","raiseEventsForChangedPath","changedPath","sentAll","eventList","raise","events_","eventFn","allowedEvents_","listeners_","trigger","validateEventType_","getInitialEvent","et","visibilityChange","visible_","getInstance","VisibilityMonitor","EventEmitter","online_","isMobileCordova","OnlineMonitor","currentlyOnline","onMessage_","pendingResponses","currentResponseNum","closeAfterResponse","onClose","closeAfter","responseNum","handleResponse","requestNum","toProcess","connId","transportSessionId","lastSessionId","bytesSent","bytesReceived","everConnected_","log_","stats_","StatsManager","urlFn","open","onMessage","onDisconnect","curSegmentNum","onDisconnect_","myPacketOrderer","PacketReceiver","isClosed_","connectTimeoutTimer_","onClosed_","isNodeSdk","readyState","executeWhenDOMReady","scriptTagHolder","FirebaseIFrameScriptHolder","command","arg1","arg2","incrementIncomingBytes_","sendNewPolls","pN","urlParams","uniqueCallbackIdentifier","href","connectURL","addTag","startLongPoll","addDisconnectPingFrame","forceAllow","BrowserPollConnection","forceAllow_","forceDisallow","forceDisallow_","isAvailable","Windows","UI","markConnectionHealthy","shutdown_","myDisconnFrame","send","dataStr","base64data","base64Encode","MAX_URL_DATA_SIZE","enqueueSegment","pw","src","commandCB","onMessageCB","outstandingRequests","pendingSegs","currentSerial","myIFrame","createIFrame_","script","iframeContents","iframe","contentWindow","alive","myID","myPW","newRequest_","theURL","curDataString","theSeg","seg","ts","addLongPollTag_","segnum","totalsegs","serial","doNewRequest","keepaliveTimeout","loadCB","doNodeLongPoll","async","onload","onreadystatechange","rstate","onerror","WebSocketImpl","MozWebSocket","WebSocket","keepaliveTimer","frames","totalFrames","WebSocketConnection","connectionURL_","device","ENV_CONSTANTS","headers","platform","env","origin","mySock","onopen","onclose","handleIncomingFrame","isOldAndroid","userAgent","oldAndroidMatch","parseFloat","previouslyFailed","appendFrame_","fullMess","jsonMess","handleNewFrameCount_","frameCount","extractFrameCount_","mess","resetKeepAlive","remainingData","sendString_","clearInterval","setInterval","responsesRequiredToBeHealthy","healthyTimeout","initTransports_","isWebSocketsAvailable","isSkipPollConnection","transports_","transports","TransportManager","ALL_TRANSPORTS","transport","initialTransport","upgradeTransport","repoInfo_","onReady_","onKill_","connectionCount","pendingDataMessages","state_","transportManager_","start_","conn","conn_","nextTransportId_","primaryResponsesRequired_","onMessageReceived","connReceiver_","onConnectionLost","disconnReceiver_","tx_","rx_","secondaryConn_","isHealthy_","healthyTimeout_ms","healthyTimeout_","everConnected","onConnectionLost_","onSecondaryConnectionLost_","onPrimaryMessageReceived_","onSecondaryMessageReceived_","sendRequest","dataMsg","sendData_","tryCleanupConnection","onSecondaryControl_","controlData","cmd","upgradeIfSecondaryHealthy_","secondaryResponsesRequired_","parsedData","layer","proceedWithUpgrade_","onControl_","onDataMessage_","onPrimaryResponse_","onHandshake_","onConnectionShutdown_","onReset_","sendPingOnPrimaryIfNecessary_","handshake","sessionId","onConnectionEstablished_","tryStartUpgrade_","startUpgrade_","closeConnections_","put","refreshAuthToken","onDisconnectPut","onDisconnectMerge","onDataUpdate_","onConnectStatus_","onServerInfoUpdate_","authTokenProvider_","authOverride_","PersistentConnection","nextPersistentConnectionId_","interruptReasons_","listens","outstandingPuts_","outstandingPutCount_","onDisconnectRequestQueue_","connected_","reconnectDelay_","maxReconnectDelay_","securityDebugCallback_","establishConnectionTimer_","requestCBHash_","requestNumber_","realtime_","authToken_","forceTokenRefresh_","invalidAuthTokenCount_","firstConnection_","lastConnectionAttemptTime_","lastConnectionEstablishedTime_","scheduleConnect_","onVisible_","onOnline_","onResponse","curReqNum","listen","currentHashFn","listenSpec","sendListen_","req","warnOnListenWarnings_","removeListen_","warnings","indexSpec","indexPath","tryAuth","reduceReconnectDelayIfAdminCredential_","credential","isAdmin","authMethod","isValidFormat","requestData","cred","onAuthRevoked_","unlisten","sendUnlisten_","queryObj","sendOnDisconnect_","request","response","putInternal","sendPut_","queued","errorReason","reqNum","onDataPush_","onListenRevoked_","onSecurityDebugPacket_","handleTimestamp_","sendConnectStats_","restoreState_","establishConnection_","online","onRealtimeDisconnect_","cancelSentTransactions_","shouldReconnect_","timeSinceLastConnectAttempt","reconnectDelay","nextConnectionId_","accessToken","Connection","interrupt","serverTimeOffset","normalizedPathString","statusCode","explanation","clientName","isReactNative","ServerActions","listens_","getListenId_","listenId","ReadonlyRestClient","thisListen","queryStringParameters","toRestQueryStringParameters","restRequest_","authTokenData","authToken","xhr","XMLHttpRequest","responseText","forceRestClient","authProvider","dataUpdateCount","eventQueue_","EventQueue","nextWriteId_","interceptServerDataCallback_","persistentConnection_","authTokenProvider","AuthTokenProvider","authOverride","statsReporter_","StatsReporter","transactions_init_","infoData_","SnapshotHolder","infoSyncTree_","infoEvents","updateInfo_","serverSyncTree_","serverTime","generateServerValues","isMerge","taggedChildren","taggedSnap","rerunTransactions_","interceptServerData_","connectStatus","runOnDisconnectEvents_","getNextWriteId_","newVal","newNodeUnresolved","success","clearEvents","callOnCompleteCallback","abortTransactions_","childrenToMerge","changedKey","changedValue","resolvedOnDisconnectTree","syncTree","resolvedTree","resolveDeferredValueTree","showDelta","longestName","previousValue","currentValue","paddedStat","statsIncrementCounter","metric","__database","Database","indexedFilter_","startPost_","RangedFilter","getStartPost_","endPost_","getEndPost_","getStartPost","getEndPost","startName","endName","rangedFilter_","limit_","getLimit","reverse_","isViewFromLeft","fullLimitUpdateChild_","foundStartPost","changeAccumulator","newChildNamedNode","windowBoundary","inRange","oldChildSnap","compareNext","limitSet_","startSet_","startNameSet_","endSet_","endNameSet_","viewFrom_","indexStartValue_","indexStartName_","indexEndValue_","indexEndName_","QueryParams","WIRE_PROTOCOL_CONSTANTS_","VIEW_FROM_LEFT","copy_","newLimit","VIEW_FROM_RIGHT","WIRE_PROTOCOL_CONSTANTS","INDEX_START_VALUE","INDEX_START_NAME","INDEX_END_VALUE","INDEX_END_NAME","LIMIT","viewFrom","VIEW_FROM","INDEX","LimitedFilter","REST_CONSTANTS","REST_QUERY_CONSTANTS_","qs","ORDER_BY","START_AT","END_AT","LIMIT_TO_FIRST","LIMIT_TO_LAST","DEFAULT","Repo","Reference","parentPath","getRoot","databaseProp","transaction","transactionUpdate","applyLocally","promiseComplete","TransactionResult","startTransaction","setPriority","thennablePushRef","pushRef","OnDisconnect","TransactionStatus","childCount","parent_","TreeNode","subTree","pathObj","Tree","updateParents_","forEachDescendant","includeSelf","childrenFirst","forEachAncestor","forEachImmediateDescendantWithValue","updateChild_","childEmpty","childExists","MAX_TRANSACTION_RETRIES_","transactionQueueTree_","watchRef","retryCount","unwatcher","abortReason","currentWriteId","currentInputSnapshot","currentOutputSnapshotRaw","currentOutputSnapshotResolved","getLatestState_","RUN","queueNode","nodeQueue","priorityForNode","sendReadyTransactions_","excludeSets","pruneCompletedTransactionsBelowNode_","queue","buildTransactionQueue_","sendTransactionQueue_","setsToIgnore","txn","latestState","snapToSend","latestHash","SENT","dataToSend","pathToSend","COMPLETED","SENT_NEEDS_ABORT","NEEDS_ABORT","rootMostTransactionNode","getAncestorTransactionNode_","rerunTransactionQueue_","abortTransaction","currentNode","newDataNode","oldWriteId","newNodeResolved","lastInput","transactionNode","transactionQueue","aggregateTransactionQueuesForNode_","abortTransactionsOnNode_","lastSent","_staticInstance","repos_","useRestClient_","RepoManager","dbUrl","databaseFromApp","dbEmulatorHost","createRepo","deleteRepo","appRepos","DatabaseInternals","checkDeleted_","refFromURL","apiName","parsedURL","goOffline","goOnline","_increment","DataConnection","simpleListen","echo","onEcho","RealTimeConnection","ConnectionTarget","newHash","oldPut","opt_onComplete","opt_hash","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","draining","queueIndex","cleanUpNextTick","drainQueue","run","marker","runClearTimeout","Item","nextTick","title","browser","argv","versions","addListener","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","cwd","chdir","dir","umask","code_","prependCode","message_","serverResponse_","codeProp","codeEquals","serverResponseProp","setServerResponseProp","serverResponse","Code","unknown","FirebaseStorageError","cannotSliceBlob","noDownloadURL","invalidArgument","appDeleted","invalidFormat","internalError","StringFormat","RAW","BASE64","BASE64URL","DATA_URL","formatValidator","stringFormat","contentType","dataFromString","stringData","StringData","utf8Bytes_","base64Bytes_","dataUrl","DataURLParts","rest","decoded","errorsExports.invalidFormat","percentEncodedBytes_","dataURLBytes_","errorsExports.unknown","Uint8Array","hasMinus","hasUnder","hasPlus","hasSlash","ErrorCode","TaskEvent","STATE_CHANGED","InternalTaskState","TaskState","RUNNING","PAUSED","SUCCESS","CANCELED","taskStateFromInternalTaskState","isDef","isJustDef","isFunction","isObject","isNonNullObject","isString","isInteger","isNumber","isNativeBlob","isNativeBlobDefined","Blob","sent_","xhr_","errorCode_","NO_ERROR","sendPromise_","ABORT","NETWORK_ERROR","errorsExports.internalError","type.isDef","setRequestHeader","getErrorCode","getStatus","getResponseText","abort","getResponseHeader","addUploadProgressListener","upload","removeUploadProgressListener","removeEventListener","createXhrIo","NetworkXhrIo","getBlobBuilder","BlobBuilder","WebKitBlobBuilder","getBlob","append","type.isNativeBlobDefined","elideCopy","blobType","type.isNativeBlob","data_","ArrayBuffer","byteLength","size_","type_","startByte","endByte","sliced","blob","webkitSlice","mozSlice","fs.sliceBlob","FbsBlob","buffer","blobby","fs.getBlob","uint8Arrays","type.isString","uploadData","bucket","fullServerUrl","bucketOnlyServerUrl","makeFromBucketSpec","bucketString","bucketLocation","Location","makeFromUrl","gsRegex","hostRegex","regex","indices","postModify","loc","captures","bucketValue","pathValue","errorsExports.invalidUrl","jsonObjectOrNull","canonicalChildPath","lastComponent","lastIndexOf","makeUrl","urlPart","makeQueryString","queryPart","noXform_","server","local","xform","mappings_","getMappings","mappings","Mapping","nameMapping","_metadata","fullPath","path.lastComponent","xformPath","sizeMapping","fromResource","authWrapper","resource","mapping","makeStorageReference","addRef","fromResourceString","resourceString","json.jsonObjectOrNull","toResourceString","metadataValidator","type.isObject","type.isNonNullObject","fromBackendResponse","listResult","prefixes","items","nextPageToken","pathWithoutTrailingSlash","reference","listOptionsValidator","type.isInteger","errorHandler","progressCallback","successCodes","additionalRetryCodes","handlerCheck","cndn","metadataHandler","MetadataUtils.fromResourceString","listHandler","ListResultUtils.fromResponseString","downloadUrlHandler","UrlUtils.makeUrl","UrlUtils.makeQueryString","alt","MetadataUtils.downloadUrlFromResourceString","sharedErrorHandler","newErr","objectErrorHandler","shared","getMetadata","maxOperationRetryTime","requestInfo","RequestInfo","list","pageToken","maxResults","isRoot","getDownloadUrl","updateMetadata","MetadataUtils.toResourceString","deleteObject","_xhr","_text","metadataForUpload_","metadataClone","determineContentType_","total","checkResumeHeader_","allowed","continueResumableUpload","status_","ResumableUploadStatus","bytesLeft","bytesToUpload","maxUploadRetryTime","uploadStatus","newCurrent","type.isFunction","bytesTransferred","totalBytes","validate","specs","passed","minArgs","maxArgs","argMin","argMax","real","countPart","plural","errorsExports.invalidArgumentCount","validator","errorsExports.invalidArgument","type.isJustDef","stringSpec","stringValidator","chainedValidator","v1","v2","ArgSpec","uploadDataSpec","metadataSpec","MetadataUtils.metadataValidator","listOptionSpec","ListOptionsUtils.listOptionsValidator","nonNegativeNumberSpec","type.isNumber","looseObjectSpec","nullFunctionSpec","argsToForward","transferred_","needToFetchStatus_","needToFetchMetadata_","observers_","error_","uploadUrl_","request_","chunkMultiplier_","resolve_","reject_","authWrapper_","location_","blob_","metadata_","resumable_","shouldDoResumable_","errorHandler_","completeTransitions_","transition_","metadataErrorHandler_","promise_","makeProgressCallback_","sizeBefore","updateProgress_","createResumable_","fetchStatus_","fetchMetadata_","continueUpload_","oneShotUpload_","resolveToken_","getAuthToken","metadataForUpload","fbsRequests.createResumableUpload","createRequest","makeRequest","getPromise","sizeString","fbsRequests.getResumableUploadStatus","statusRequest","fbsRequests.ResumableUploadStatus","fbsRequests.continueResumableUpload","uploadRequest","newStatus","increaseMultiplier_","fbsRequests.getMetadata","metadataRequest","boundary","genBoundary","preBlobPart","postBlobPart","fbsRequests.multipartUpload","multipartRequest","transferred","old","notifyObservers_","wasPaused","externalState","UploadTaskSnapshot","completed","typeValidator","nextOrObserverMessage","nextValidator","observerValidator","nextOrObserverValidator","typeUtils.isJustDef","makeBinder","Observer","addObserver_","removeObserver_","binderNextOrObserverValidator","binderSpecs","typeOnly","onFulfilled","onRejected","notifyObserver_","finishPromise_","triggered","fbsAsync","valid","pause","newRef","metadata.getMappings","newPath","path.child","path.parent","throwIfRoot_","UploadTask","putString","requests.deleteObject","listAll","listAllHelper","opt","nextPage","requests.list","requests.getMetadata","requests.updateMetadata","getDownloadURL","requests.getDownloadUrl","errorsExports.noDownloadURL","errorsExports.invalidRootOperation","_appDelete","addRequest","maker","requestMaker","pool","bucket_","deleted_","AuthWrapper","extractBucket_","storageRefMaker_","requestMaker_","pool_","service_","maxOperationRetryTime_","maxUploadRetryTime_","requestMap_","RequestMap","errorsExports.appDeleted","FailRequest","deleteApp","setMaxUploadRetryTime","setMaxOperationRetryTime","errorCallback","pendingXhr_","backoffId_","canceled_","appDelete_","url_","method_","headers_","body_","successCodes_","additionalRetryCodes_","errorCallback_","progressCallback_","timeout_","backoffDone","requestWentThrough","wasSuccessCode","canceled","RequestEndStatus","waitSeconds","timeoutId","hitTimeout","cancelState","triggeredCallback","triggerCallback","callWithDelay","millis","waitMillis","mustStop","stopped","stop","wasTimeout","backoff.start","backoffCallback","progressListener","hitServer","isRetryStatusCode_","successCode","wasCanceled","progressEvent","lengthComputable","appDelete","backoff.stop","isFiveHundredCode","isExtraRetryCode","isRequestSpecificRetryCode","addAuthHeader_","addVersionHeader_","NetworkRequest","RequestExports.makeRequest","authWrapperBucket","internals_","ServiceInternals","args.validate","args.stringSpec","args.nonNegativeNumberSpec","Service","XhrIoPool","namespaceExports","Storage","registerStorage","isAbsolute","spliceOne","resolvePathname","toParts","fromParts","isToAbs","isFromAbs","mustEndAbs","hasTrailingSlash","up","part","unshift","valueEqual","addLeadingSlash","hasBasename","stripBasename","stripTrailingSlash","createPath","createLocation","currentLocation","hashIndex","searchIndex","parsePath","decodeURI","URIError","createTransitionManager","prompt","setPrompt","nextPrompt","confirmTransitionTo","getUserConfirmation","appendListener","isActive","notifyListeners","canUseDOM","getConfirmation","confirm","supportsHistory","history","supportsPopStateOnHashChange","isExtraneousPopstateEvent","getHistoryState","createBrowserHistory","invariant","globalHistory","canUseHistory","needsHashChangeListener","_props$forceRefresh","_props$getUserConfirm","_props$keyLength","keyLength","basename","getDOMLocation","historyState","_window$location","createKey","transitionManager","handlePopState","handlePop","handleHashChange","forceNextPop","ok","revertPop","fromLocation","toLocation","toIndex","allKeys","fromIndex","go","initialLocation","createHref","pushState","prevIndex","nextKeys","replaceState","goBack","goForward","listenerCount","checkDOMListeners","isBlocked","block","unblock","Router","_temp","computeMatch","router","_props","React","BrowserRouter","createHistory","Switch","_element$props","pathProp","computedMatch","isEmptyChildren","Route","nextContext","_context$router","staticContext"],"mappings":"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","file":"static/js/2.813dadc6.chunk.js","sourcesContent":["'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react.production.min.js');\n} else {\n  module.exports = require('./cjs/react.development.js');\n}\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var REACT_ELEMENT_TYPE = (typeof Symbol === 'function' &&\n    Symbol.for &&\n    Symbol.for('react.element')) ||\n    0xeac7;\n\n  var isValidElement = function(object) {\n    return typeof object === 'object' &&\n      object !== null &&\n      object.$$typeof === REACT_ELEMENT_TYPE;\n  };\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(isValidElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","/**\n * Copyright 2014-2015, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n'use strict';\n\n/**\n * Similar to invariant but only logs a warning if the condition is not met.\n * This can be used to log issues in development environments in critical\n * paths. Removing the logging code for production environments will keep the\n * same logic and follow the same code paths.\n */\n\nvar warning = function() {};\n\nif (process.env.NODE_ENV !== 'production') {\n  warning = function(condition, format, args) {\n    var len = arguments.length;\n    args = new Array(len > 2 ? len - 2 : 0);\n    for (var key = 2; key < len; key++) {\n      args[key - 2] = arguments[key];\n    }\n    if (format === undefined) {\n      throw new Error(\n        '`warning(condition, format, ...args)` requires a warning ' +\n        'message argument'\n      );\n    }\n\n    if (format.length < 10 || (/^[s\\W]*$/).test(format)) {\n      throw new Error(\n        'The warning format should be able to uniquely identify this ' +\n        'warning. Please, use a more descriptive format than: ' + format\n      );\n    }\n\n    if (!condition) {\n      var argIndex = 0;\n      var message = 'Warning: ' +\n        format.replace(/%s/g, function() {\n          return args[argIndex++];\n        });\n      if (typeof console !== 'undefined') {\n        console.error(message);\n      }\n      try {\n        // This error was thrown as a convenience so that you can use this stack\n        // to find the callsite that caused this warning to fire.\n        throw new Error(message);\n      } catch(x) {}\n    }\n  };\n}\n\nmodule.exports = warning;\n","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","import _typeof from \"../../helpers/esm/typeof\";\nimport assertThisInitialized from \"./assertThisInitialized\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","import getPrototypeOf from \"./getPrototypeOf\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct\";\nimport possibleConstructorReturn from \"./possibleConstructorReturn\";\nexport default function _createSuper(Derived) {\n  return function () {\n    var Super = getPrototypeOf(Derived),\n        result;\n\n    if (isNativeReflectConstruct()) {\n      var NewTarget = getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return possibleConstructorReturn(this, result);\n  };\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n/**\n * Similar to invariant but only logs a warning if the condition is not met.\n * This can be used to log issues in development environments in critical\n * paths. Removing the logging code for production environments will keep the\n * same logic and follow the same code paths.\n */\n\nvar __DEV__ = process.env.NODE_ENV !== 'production';\n\nvar warning = function() {};\n\nif (__DEV__) {\n  var printWarning = function printWarning(format, args) {\n    var len = arguments.length;\n    args = new Array(len > 2 ? len - 2 : 0);\n    for (var key = 2; key < len; key++) {\n      args[key - 2] = arguments[key];\n    }\n    var argIndex = 0;\n    var message = 'Warning: ' +\n      format.replace(/%s/g, function() {\n        return args[argIndex++];\n      });\n    if (typeof console !== 'undefined') {\n      console.error(message);\n    }\n    try {\n      // --- Welcome to debugging React ---\n      // This error was thrown as a convenience so that you can use this stack\n      // to find the callsite that caused this warning to fire.\n      throw new Error(message);\n    } catch (x) {}\n  }\n\n  warning = function(condition, format, args) {\n    var len = arguments.length;\n    args = new Array(len > 2 ? len - 2 : 0);\n    for (var key = 2; key < len; key++) {\n      args[key - 2] = arguments[key];\n    }\n    if (format === undefined) {\n      throw new Error(\n          '`warning(condition, format, ...args)` requires a warning ' +\n          'message argument'\n      );\n    }\n    if (!condition) {\n      printWarning.apply(null, [format].concat(args));\n    }\n  };\n}\n\nmodule.exports = warning;\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\n\nvar invariant = function(condition, format, a, b, c, d, e, f) {\n  if (process.env.NODE_ENV !== 'production') {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n\n  if (!condition) {\n    var error;\n    if (format === undefined) {\n      error = new Error(\n        'Minified exception occurred; use the non-minified dev environment ' +\n        'for the full error message and additional helpful warnings.'\n      );\n    } else {\n      var args = [a, b, c, d, e, f];\n      var argIndex = 0;\n      error = new Error(\n        format.replace(/%s/g, function() { return args[argIndex++]; })\n      );\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1; // we don't care about invariant's own frame\n    throw error;\n  }\n};\n\nmodule.exports = invariant;\n","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"./defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @fileoverview Standardized Firebase Error.\n *\n * Usage:\n *\n *   // Typescript string literals for type-safe codes\n *   type Err =\n *     'unknown' |\n *     'object-not-found'\n *     ;\n *\n *   // Closure enum for type-safe error codes\n *   // at-enum {string}\n *   var Err = {\n *     UNKNOWN: 'unknown',\n *     OBJECT_NOT_FOUND: 'object-not-found',\n *   }\n *\n *   let errors: Map<Err, string> = {\n *     'generic-error': \"Unknown error\",\n *     'file-not-found': \"Could not find file: {$file}\",\n *   };\n *\n *   // Type-safe function - must pass a valid error code as param.\n *   let error = new ErrorFactory<Err>('service', 'Service', errors);\n *\n *   ...\n *   throw error.create(Err.GENERIC);\n *   ...\n *   throw error.create(Err.FILE_NOT_FOUND, {'file': fileName});\n *   ...\n *   // Service: Could not file file: foo.txt (service/file-not-found).\n *\n *   catch (e) {\n *     assert(e.message === \"Could not find file: foo.txt.\");\n *     if (e.code === 'service/file-not-found') {\n *       console.log(\"Could not read file: \" + e['file']);\n *     }\n *   }\n */\n\nexport type ErrorMap<ErrorCode extends string> = {\n  readonly [K in ErrorCode]: string;\n};\n\nconst ERROR_NAME = 'FirebaseError';\n\nexport interface StringLike {\n  toString(): string;\n}\n\nexport interface ErrorData {\n  [key: string]: StringLike | undefined;\n}\n\nexport interface FirebaseError extends Error, ErrorData {\n  // Unique code for error - format is service/error-code-string.\n  readonly code: string;\n\n  // Developer-friendly error message.\n  readonly message: string;\n\n  // Always 'FirebaseError'.\n  readonly name: typeof ERROR_NAME;\n\n  // Where available - stack backtrace in a string.\n  readonly stack?: string;\n}\n\n// Based on code from:\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types\nexport class FirebaseError extends Error {\n  readonly name = ERROR_NAME;\n\n  constructor(readonly code: string, message: string) {\n    super(message);\n\n    // Fix For ES5\n    // https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\n    Object.setPrototypeOf(this, FirebaseError.prototype);\n\n    // Maintains proper stack trace for where our error was thrown.\n    // Only available on V8.\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ErrorFactory.prototype.create);\n    }\n  }\n}\n\nexport class ErrorFactory<\n  ErrorCode extends string,\n  ErrorParams extends { readonly [K in ErrorCode]?: ErrorData } = {}\n> {\n  constructor(\n    private readonly service: string,\n    private readonly serviceName: string,\n    private readonly errors: ErrorMap<ErrorCode>\n  ) {}\n\n  create<K extends ErrorCode>(\n    code: K,\n    ...data: K extends keyof ErrorParams ? [ErrorParams[K]] : []\n  ): FirebaseError {\n    const customData = (data[0] as ErrorData) || {};\n    const fullCode = `${this.service}/${code}`;\n    const template = this.errors[code];\n\n    const message = template ? replaceTemplate(template, customData) : 'Error';\n    // Service Name: Error message (service/code).\n    const fullMessage = `${this.serviceName}: ${message} (${fullCode}).`;\n\n    const error = new FirebaseError(fullCode, fullMessage);\n\n    // Keys with an underscore at the end of their name are not included in\n    // error.data for some reason.\n    // TODO: Replace with Object.entries when lib is updated to es2017.\n    for (const key of Object.keys(customData)) {\n      if (key.slice(-1) !== '_') {\n        if (key in error) {\n          console.warn(\n            `Overwriting FirebaseError base field \"${key}\" can cause unexpected behavior.`\n          );\n        }\n        error[key] = customData[key];\n      }\n    }\n\n    return error;\n  }\n}\n\nfunction replaceTemplate(template: string, data: ErrorData): string {\n  return template.replace(PATTERN, (_, key) => {\n    const value = data[key];\n    return value != null ? value.toString() : `<${key}?>`;\n  });\n}\n\nconst PATTERN = /\\{\\$([^}]+)}/g;\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Firebase constants.  Some of these (@defines) can be overridden at compile-time.\n */\n\nexport const CONSTANTS = {\n  /**\n   * @define {boolean} Whether this is the client Node.js SDK.\n   */\n  NODE_CLIENT: false,\n  /**\n   * @define {boolean} Whether this is the Admin Node.js SDK.\n   */\n  NODE_ADMIN: false,\n\n  /**\n   * Firebase SDK Version\n   */\n  SDK_VERSION: '${JSCORE_VERSION}'\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * A container for all of the Logger instances\n */\nexport const instances: Logger[] = [];\n\n/**\n * The JS SDK supports 5 log levels and also allows a user the ability to\n * silence the logs altogether.\n *\n * The order is a follows:\n * DEBUG < VERBOSE < INFO < WARN < ERROR\n *\n * All of the log types above the current log level will be captured (i.e. if\n * you set the log level to `INFO`, errors will still be logged, but `DEBUG` and\n * `VERBOSE` logs will not)\n */\nexport enum LogLevel {\n  DEBUG,\n  VERBOSE,\n  INFO,\n  WARN,\n  ERROR,\n  SILENT\n}\n\n/**\n * The default log level\n */\nconst defaultLogLevel: LogLevel = LogLevel.INFO;\n\n/**\n * We allow users the ability to pass their own log handler. We will pass the\n * type of log, the current log level, and any other arguments passed (i.e. the\n * messages that the user wants to log) to this function.\n */\nexport type LogHandler = (\n  loggerInstance: Logger,\n  logType: LogLevel,\n  ...args: unknown[]\n) => void;\n\n/**\n * The default log handler will forward DEBUG, VERBOSE, INFO, WARN, and ERROR\n * messages on to their corresponding console counterparts (if the log method\n * is supported by the current log level)\n */\nconst defaultLogHandler: LogHandler = (instance, logType, ...args): void => {\n  if (logType < instance.logLevel) {\n    return;\n  }\n  const now = new Date().toISOString();\n  switch (logType) {\n    /**\n     * By default, `console.debug` is not displayed in the developer console (in\n     * chrome). To avoid forcing users to have to opt-in to these logs twice\n     * (i.e. once for firebase, and once in the console), we are sending `DEBUG`\n     * logs to the `console.log` function.\n     */\n    case LogLevel.DEBUG:\n      console.log(`[${now}]  ${instance.name}:`, ...args);\n      break;\n    case LogLevel.VERBOSE:\n      console.log(`[${now}]  ${instance.name}:`, ...args);\n      break;\n    case LogLevel.INFO:\n      console.info(`[${now}]  ${instance.name}:`, ...args);\n      break;\n    case LogLevel.WARN:\n      console.warn(`[${now}]  ${instance.name}:`, ...args);\n      break;\n    case LogLevel.ERROR:\n      console.error(`[${now}]  ${instance.name}:`, ...args);\n      break;\n    default:\n      throw new Error(\n        `Attempted to log a message with an invalid logType (value: ${logType})`\n      );\n  }\n};\n\nexport class Logger {\n  /**\n   * Gives you an instance of a Logger to capture messages according to\n   * Firebase's logging scheme.\n   *\n   * @param name The name that the logs will be associated with\n   */\n  constructor(public name: string) {\n    /**\n     * Capture the current instance for later use\n     */\n    instances.push(this);\n  }\n\n  /**\n   * The log level of the given Logger instance.\n   */\n  private _logLevel = defaultLogLevel;\n  get logLevel(): LogLevel {\n    return this._logLevel;\n  }\n  set logLevel(val: LogLevel) {\n    if (!(val in LogLevel)) {\n      throw new TypeError('Invalid value assigned to `logLevel`');\n    }\n    this._logLevel = val;\n  }\n\n  /**\n   * The log handler for the Logger instance.\n   */\n  private _logHandler: LogHandler = defaultLogHandler;\n  get logHandler(): LogHandler {\n    return this._logHandler;\n  }\n  set logHandler(val: LogHandler) {\n    if (typeof val !== 'function') {\n      throw new TypeError('Value assigned to `logHandler` must be a function');\n    }\n    this._logHandler = val;\n  }\n\n  /**\n   * The functions below are all based on the `console` interface\n   */\n\n  debug(...args: unknown[]): void {\n    this._logHandler(this, LogLevel.DEBUG, ...args);\n  }\n  log(...args: unknown[]): void {\n    this._logHandler(this, LogLevel.VERBOSE, ...args);\n  }\n  info(...args: unknown[]): void {\n    this._logHandler(this, LogLevel.INFO, ...args);\n  }\n  warn(...args: unknown[]): void {\n    this._logHandler(this, LogLevel.WARN, ...args);\n  }\n  error(...args: unknown[]): void {\n    this._logHandler(this, LogLevel.ERROR, ...args);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FirebaseApp,\n  FirebaseOptions,\n  FirebaseAppConfig\n} from '@firebase/app-types';\nimport {\n  _FirebaseApp,\n  _FirebaseNamespace,\n  FirebaseService\n} from '@firebase/app-types/private';\nimport { deepCopy } from '@firebase/util';\nimport {\n  ComponentContainer,\n  Component,\n  ComponentType,\n  Name\n} from '@firebase/component';\nimport { AppError, ERROR_FACTORY } from './errors';\nimport { DEFAULT_ENTRY_NAME } from './constants';\nimport { logger } from './logger';\n\n/**\n * Global context object for a collection of services using\n * a shared authentication state.\n */\nexport class FirebaseAppImpl implements FirebaseApp {\n  private readonly options_: FirebaseOptions;\n  private readonly name_: string;\n  private isDeleted_ = false;\n  private automaticDataCollectionEnabled_: boolean;\n  private container: ComponentContainer;\n\n  constructor(\n    options: FirebaseOptions,\n    config: FirebaseAppConfig,\n    private readonly firebase_: _FirebaseNamespace\n  ) {\n    this.name_ = config.name!;\n    this.automaticDataCollectionEnabled_ =\n      config.automaticDataCollectionEnabled || false;\n    this.options_ = deepCopy<FirebaseOptions>(options);\n    this.container = new ComponentContainer(config.name!);\n\n    // add itself to container\n    this._addComponent(new Component('app', () => this, ComponentType.PUBLIC));\n    // populate ComponentContainer with existing components\n    for (const component of this.firebase_.INTERNAL.components.values()) {\n      this._addComponent(component);\n    }\n  }\n\n  get automaticDataCollectionEnabled(): boolean {\n    this.checkDestroyed_();\n    return this.automaticDataCollectionEnabled_;\n  }\n\n  set automaticDataCollectionEnabled(val) {\n    this.checkDestroyed_();\n    this.automaticDataCollectionEnabled_ = val;\n  }\n\n  get name(): string {\n    this.checkDestroyed_();\n    return this.name_;\n  }\n\n  get options(): FirebaseOptions {\n    this.checkDestroyed_();\n    return this.options_;\n  }\n\n  delete(): Promise<void> {\n    return new Promise(resolve => {\n      this.checkDestroyed_();\n      resolve();\n    })\n      .then(() => {\n        this.firebase_.INTERNAL.removeApp(this.name_);\n\n        return Promise.all(\n          this.container.getProviders().map(provider => provider.delete())\n        );\n      })\n      .then((): void => {\n        this.isDeleted_ = true;\n      });\n  }\n\n  /**\n   * Return a service instance associated with this app (creating it\n   * on demand), identified by the passed instanceIdentifier.\n   *\n   * NOTE: Currently storage and functions are the only ones that are leveraging this\n   * functionality. They invoke it by calling:\n   *\n   * ```javascript\n   * firebase.app().storage('STORAGE BUCKET ID')\n   * ```\n   *\n   * The service name is passed to this already\n   * @internal\n   */\n  _getService(\n    name: string,\n    instanceIdentifier: string = DEFAULT_ENTRY_NAME\n  ): FirebaseService {\n    this.checkDestroyed_();\n\n    // getImmediate will always succeed because _getService is only called for registered components.\n    return (this.container.getProvider(name as Name).getImmediate({\n      identifier: instanceIdentifier\n    }) as unknown) as FirebaseService;\n  }\n  /**\n   * Remove a service instance from the cache, so we will create a new instance for this service\n   * when people try to get this service again.\n   *\n   * NOTE: currently only firestore is using this functionality to support firestore shutdown.\n   *\n   * @param name The service name\n   * @param instanceIdentifier instance identifier in case multiple instances are allowed\n   * @internal\n   */\n  _removeServiceInstance(\n    name: string,\n    instanceIdentifier: string = DEFAULT_ENTRY_NAME\n  ): void {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    this.container.getProvider(name as any).clearInstance(instanceIdentifier);\n  }\n\n  /**\n   * @param component the component being added to this app's container\n   */\n  _addComponent(component: Component): void {\n    try {\n      this.container.addComponent(component);\n    } catch (e) {\n      logger.debug(\n        `Component ${component.name} failed to register with FirebaseApp ${this.name}`,\n        e\n      );\n    }\n  }\n\n  _addOrOverwriteComponent(component: Component): void {\n    this.container.addOrOverwriteComponent(component);\n  }\n\n  /**\n   * This function will throw an Error if the App has already been deleted -\n   * use before performing API actions on the App.\n   */\n  private checkDestroyed_(): void {\n    if (this.isDeleted_) {\n      throw ERROR_FACTORY.create(AppError.APP_DELETED, { appName: this.name_ });\n    }\n  }\n}\n\n// Prevent dead-code elimination of these methods w/o invalid property\n// copying.\n(FirebaseAppImpl.prototype.name && FirebaseAppImpl.prototype.options) ||\n  FirebaseAppImpl.prototype.delete ||\n  console.log('dc');\n","/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FirebaseNamespace } from '@firebase/app-types';\nimport { _FirebaseApp, _FirebaseNamespace } from '@firebase/app-types/private';\nimport { createSubscribe, deepExtend, ErrorFactory } from '@firebase/util';\nimport { FirebaseAppImpl } from './firebaseApp';\nimport { createFirebaseNamespaceCore } from './firebaseNamespaceCore';\n\n/**\n * Return a firebase namespace object.\n *\n * In production, this will be called exactly once and the result\n * assigned to the 'firebase' global.  It may be called multiple times\n * in unit tests.\n */\nexport function createFirebaseNamespace(): FirebaseNamespace {\n  const namespace = createFirebaseNamespaceCore(FirebaseAppImpl);\n  (namespace as _FirebaseNamespace).INTERNAL = {\n    ...(namespace as _FirebaseNamespace).INTERNAL,\n    createFirebaseNamespace,\n    extendNamespace,\n    createSubscribe,\n    ErrorFactory,\n    deepExtend\n  };\n\n  /**\n   * Patch the top-level firebase namespace with additional properties.\n   *\n   * firebase.INTERNAL.extendNamespace()\n   */\n  function extendNamespace(props: { [prop: string]: unknown }): void {\n    deepExtend(namespace, props);\n  }\n\n  return namespace;\n}\n\nexport const firebase = createFirebaseNamespace();\n","/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  FirebaseApp,\n  FirebaseOptions,\n  FirebaseNamespace,\n  FirebaseAppConfig\n} from '@firebase/app-types';\nimport {\n  _FirebaseApp,\n  _FirebaseNamespace,\n  FirebaseService,\n  FirebaseServiceNamespace\n} from '@firebase/app-types/private';\nimport { deepExtend, contains } from '@firebase/util';\nimport { FirebaseAppImpl } from './firebaseApp';\nimport { ERROR_FACTORY, AppError } from './errors';\nimport { FirebaseAppLiteImpl } from './lite/firebaseAppLite';\nimport { DEFAULT_ENTRY_NAME, PLATFORM_LOG_STRING } from './constants';\nimport { version } from '../../firebase/package.json';\nimport { logger } from './logger';\nimport { Component, ComponentType, Name } from '@firebase/component';\n\n/**\n * Because auth can't share code with other components, we attach the utility functions\n * in an internal namespace to share code.\n * This function return a firebase namespace object without\n * any utility functions, so it can be shared between the regular firebaseNamespace and\n * the lite version.\n */\nexport function createFirebaseNamespaceCore(\n  firebaseAppImpl: typeof FirebaseAppImpl | typeof FirebaseAppLiteImpl\n): FirebaseNamespace {\n  const apps: { [name: string]: FirebaseApp } = {};\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const components = new Map<string, Component<any>>();\n\n  // A namespace is a plain JavaScript Object.\n  const namespace: FirebaseNamespace = {\n    // Hack to prevent Babel from modifying the object returned\n    // as the firebase namespace.\n    // @ts-ignore\n    __esModule: true,\n    initializeApp,\n    // @ts-ignore\n    app,\n    registerVersion,\n    // @ts-ignore\n    apps: null,\n    SDK_VERSION: version,\n    INTERNAL: {\n      registerComponent,\n      removeApp,\n      components,\n      useAsService\n    }\n  };\n\n  // Inject a circular default export to allow Babel users who were previously\n  // using:\n  //\n  //   import firebase from 'firebase';\n  //   which becomes: var firebase = require('firebase').default;\n  //\n  // instead of\n  //\n  //   import * as firebase from 'firebase';\n  //   which becomes: var firebase = require('firebase');\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  (namespace as any)['default'] = namespace;\n\n  // firebase.apps is a read-only getter.\n  Object.defineProperty(namespace, 'apps', {\n    get: getApps\n  });\n\n  /**\n   * Called by App.delete() - but before any services associated with the App\n   * are deleted.\n   */\n  function removeApp(name: string): void {\n    delete apps[name];\n  }\n\n  /**\n   * Get the App object for a given name (or DEFAULT).\n   */\n  function app(name?: string): FirebaseApp {\n    name = name || DEFAULT_ENTRY_NAME;\n    if (!contains(apps, name)) {\n      throw ERROR_FACTORY.create(AppError.NO_APP, { appName: name });\n    }\n    return apps[name];\n  }\n\n  // @ts-ignore\n  app['App'] = firebaseAppImpl;\n  /**\n   * Create a new App instance (name must be unique).\n   */\n  function initializeApp(\n    options: FirebaseOptions,\n    config?: FirebaseAppConfig\n  ): FirebaseApp;\n  function initializeApp(options: FirebaseOptions, name?: string): FirebaseApp;\n  function initializeApp(\n    options: FirebaseOptions,\n    rawConfig = {}\n  ): FirebaseApp {\n    if (typeof rawConfig !== 'object' || rawConfig === null) {\n      const name = rawConfig;\n      rawConfig = { name };\n    }\n\n    const config = rawConfig as FirebaseAppConfig;\n\n    if (config.name === undefined) {\n      config.name = DEFAULT_ENTRY_NAME;\n    }\n\n    const { name } = config;\n\n    if (typeof name !== 'string' || !name) {\n      throw ERROR_FACTORY.create(AppError.BAD_APP_NAME, {\n        appName: String(name)\n      });\n    }\n\n    if (contains(apps, name)) {\n      throw ERROR_FACTORY.create(AppError.DUPLICATE_APP, { appName: name });\n    }\n\n    const app = new firebaseAppImpl(\n      options,\n      config,\n      namespace as _FirebaseNamespace\n    );\n\n    apps[name] = app;\n\n    return app;\n  }\n\n  /*\n   * Return an array of all the non-deleted FirebaseApps.\n   */\n  function getApps(): FirebaseApp[] {\n    // Make a copy so caller cannot mutate the apps list.\n    return Object.keys(apps).map(name => apps[name]);\n  }\n\n  function registerComponent(\n    component: Component\n  ): FirebaseServiceNamespace<FirebaseService> | null {\n    const componentName = component.name;\n    if (components.has(componentName)) {\n      logger.debug(\n        `There were multiple attempts to register component ${componentName}.`\n      );\n\n      return component.type === ComponentType.PUBLIC\n        ? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          (namespace as any)[componentName]\n        : null;\n    }\n\n    components.set(componentName, component);\n\n    // create service namespace for public components\n    if (component.type === ComponentType.PUBLIC) {\n      // The Service namespace is an accessor function ...\n      const serviceNamespace = (\n        appArg: FirebaseApp = app()\n      ): FirebaseService => {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        if (typeof (appArg as any)[componentName] !== 'function') {\n          // Invalid argument.\n          // This happens in the following case: firebase.storage('gs:/')\n          throw ERROR_FACTORY.create(AppError.INVALID_APP_ARGUMENT, {\n            appName: componentName\n          });\n        }\n\n        // Forward service instance lookup to the FirebaseApp.\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        return (appArg as any)[componentName]();\n      };\n\n      // ... and a container for service-level properties.\n      if (component.serviceProps !== undefined) {\n        deepExtend(serviceNamespace, component.serviceProps);\n      }\n\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (namespace as any)[componentName] = serviceNamespace;\n\n      // Patch the FirebaseAppImpl prototype\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (firebaseAppImpl.prototype as any)[componentName] =\n        // TODO: The eslint disable can be removed and the 'ignoreRestArgs'\n        // option added to the no-explicit-any rule when ESlint releases it.\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        function(...args: any) {\n          const serviceFxn = this._getService.bind(this, componentName);\n          return serviceFxn.apply(\n            this,\n            component.multipleInstances ? args : []\n          );\n        };\n    }\n\n    // add the component to existing app instances\n    for (const appName of Object.keys(apps)) {\n      (apps[appName] as _FirebaseApp)._addComponent(component);\n    }\n\n    return component.type === ComponentType.PUBLIC\n      ? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (namespace as any)[componentName]\n      : null;\n  }\n\n  function registerVersion(\n    libraryKeyOrName: string,\n    version: string,\n    variant?: string\n  ): void {\n    // TODO: We can use this check to whitelist strings when/if we set up\n    // a good whitelist system.\n    let library = PLATFORM_LOG_STRING[libraryKeyOrName] ?? libraryKeyOrName;\n    if (variant) {\n      library += `-${variant}`;\n    }\n    const libraryMismatch = library.match(/\\s|\\//);\n    const versionMismatch = version.match(/\\s|\\//);\n    if (libraryMismatch || versionMismatch) {\n      const warning = [\n        `Unable to register library \"${library}\" with version \"${version}\":`\n      ];\n      if (libraryMismatch) {\n        warning.push(\n          `library name \"${library}\" contains illegal characters (whitespace or \"/\")`\n        );\n      }\n      if (libraryMismatch && versionMismatch) {\n        warning.push('and');\n      }\n      if (versionMismatch) {\n        warning.push(\n          `version name \"${version}\" contains illegal characters (whitespace or \"/\")`\n        );\n      }\n      logger.warn(warning.join(' '));\n      return;\n    }\n    registerComponent(\n      new Component(\n        `${library}-version` as Name,\n        () => ({ library, version }),\n        ComponentType.VERSION\n      )\n    );\n  }\n\n  // Map the requested service to a registered service name\n  // (used to map auth to serverAuth service when needed).\n  function useAsService(app: FirebaseApp, name: string): string | null {\n    if (name === 'serverAuth') {\n      return null;\n    }\n\n    const useService = name;\n\n    return useService;\n  }\n\n  return namespace;\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ComponentContainer,\n  ComponentType,\n  Provider,\n  Name\n} from '@firebase/component';\n\nexport class PlatformLoggerService {\n  constructor(private readonly container: ComponentContainer) {}\n  // In initial implementation, this will be called by installations on\n  // auth token refresh, and installations will send this string.\n  getPlatformInfoString(): string {\n    const providers = this.container.getProviders();\n    // Loop through providers and get library/version pairs from any that are\n    // version components.\n    return providers\n      .map(provider => {\n        if (isVersionServiceProvider(provider)) {\n          const service = provider.getImmediate();\n          return `${service.library}/${service.version}`;\n        } else {\n          return null;\n        }\n      })\n      .filter(logString => logString)\n      .join(' ');\n  }\n}\n/**\n *\n * @param provider check if this provider provides a VersionService\n *\n * NOTE: Using Provider<'app-version'> is a hack to indicate that the provider\n * provides VersionService. The provider is not necessarily a 'app-version'\n * provider.\n */\nfunction isVersionServiceProvider(\n  provider: Provider<Name>\n): provider is Provider<'app-version'> {\n  const component = provider.getComponent();\n  return component?.type === ComponentType.VERSION;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport firebase from '@firebase/app';\nimport { _FirebaseNamespace } from '@firebase/app-types/private';\nimport { StringFormat } from './src/implementation/string';\nimport { TaskEvent, TaskState } from './src/implementation/taskenums';\n\nimport { XhrIoPool } from './src/implementation/xhriopool';\nimport { Reference } from './src/reference';\nimport { Service } from './src/service';\nimport * as types from '@firebase/storage-types';\nimport {\n  Component,\n  ComponentType,\n  ComponentContainer\n} from '@firebase/component';\n\nimport { name, version } from './package.json';\n\n/**\n * Type constant for Firebase Storage.\n */\nconst STORAGE_TYPE = 'storage';\n\nfunction factory(\n  container: ComponentContainer,\n  url?: string\n): types.FirebaseStorage {\n  // Dependencies\n  const app = container.getProvider('app').getImmediate();\n  const authProvider = container.getProvider('auth-internal');\n\n  return (new Service(\n    app,\n    authProvider,\n    new XhrIoPool(),\n    url\n  ) as unknown) as types.FirebaseStorage;\n}\n\nexport function registerStorage(instance: _FirebaseNamespace): void {\n  const namespaceExports = {\n    // no-inline\n    TaskState,\n    TaskEvent,\n    StringFormat,\n    Storage: Service,\n    Reference\n  };\n  instance.INTERNAL.registerComponent(\n    new Component(STORAGE_TYPE, factory, ComponentType.PUBLIC)\n      .setServiceProps(namespaceExports)\n      .setMultipleInstances(true)\n  );\n\n  instance.registerVersion(name, version);\n}\n\nregisterStorage(firebase as _FirebaseNamespace);\n\n/**\n * Define extension behavior for `registerStorage`\n */\ndeclare module '@firebase/app-types' {\n  interface FirebaseNamespace {\n    storage?: {\n      (app?: FirebaseApp): types.FirebaseStorage;\n      Storage: typeof types.FirebaseStorage;\n\n      StringFormat: {\n        BASE64: types.StringFormat;\n        BASE64URL: types.StringFormat;\n        DATA_URL: types.StringFormat;\n        RAW: types.StringFormat;\n      };\n      TaskEvent: {\n        STATE_CHANGED: types.TaskEvent;\n      };\n      TaskState: {\n        CANCELED: types.TaskState;\n        ERROR: types.TaskState;\n        PAUSED: types.TaskState;\n        RUNNING: types.TaskState;\n        SUCCESS: types.TaskState;\n      };\n    };\n  }\n  interface FirebaseApp {\n    storage?(storageBucket?: string): types.FirebaseStorage;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FirebaseNamespace } from '@firebase/app-types';\nimport { _FirebaseNamespace } from '@firebase/app-types/private';\nimport { Component, ComponentType } from '@firebase/component';\nimport { PlatformLoggerService } from './platformLoggerService';\nimport { name, version } from '../package.json';\n\nexport function registerCoreComponents(\n  firebase: FirebaseNamespace,\n  variant?: string\n): void {\n  (firebase as _FirebaseNamespace).INTERNAL.registerComponent(\n    new Component(\n      'platform-logger',\n      container => new PlatformLoggerService(container),\n      ComponentType.PRIVATE\n    )\n  );\n  // Register `app` package.\n  firebase.registerVersion(name, version, variant);\n  // Register platform SDK identifier (no version).\n  firebase.registerVersion('fire-js', '');\n}\n","\"use strict\";\n\nvar _CSSTransition = _interopRequireDefault(require(\"./CSSTransition\"));\n\nvar _ReplaceTransition = _interopRequireDefault(require(\"./ReplaceTransition\"));\n\nvar _TransitionGroup = _interopRequireDefault(require(\"./TransitionGroup\"));\n\nvar _Transition = _interopRequireDefault(require(\"./Transition\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = {\n  Transition: _Transition.default,\n  TransitionGroup: _TransitionGroup.default,\n  ReplaceTransition: _ReplaceTransition.default,\n  CSSTransition: _CSSTransition.default\n};","'use strict';\n\nfunction checkDCE() {\n  /* global __REACT_DEVTOOLS_GLOBAL_HOOK__ */\n  if (\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__ === 'undefined' ||\n    typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE !== 'function'\n  ) {\n    return;\n  }\n  if (process.env.NODE_ENV !== 'production') {\n    // This branch is unreachable because this function is only called\n    // in production, but the condition is true only in development.\n    // Therefore if the branch is still here, dead code elimination wasn't\n    // properly applied.\n    // Don't change the message. React DevTools relies on it. Also make sure\n    // this message doesn't occur elsewhere in this function, or it will cause\n    // a false positive.\n    throw new Error('^_^');\n  }\n  try {\n    // Verify that the code above has been dead code eliminated (DCE'd).\n    __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE);\n  } catch (err) {\n    // DevTools shouldn't crash React, no matter what.\n    // We should still report in case we break this code.\n    console.error(err);\n  }\n}\n\nif (process.env.NODE_ENV === 'production') {\n  // DCE check should happen before ReactDOM bundle executes so that\n  // DevTools can report bad minification during injection.\n  checkDCE();\n  module.exports = require('./cjs/react-dom.production.min.js');\n} else {\n  module.exports = require('./cjs/react-dom.development.js');\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  InstantiationMode,\n  InstanceFactory,\n  ComponentType,\n  Dictionary,\n  Name\n} from './types';\n\n/**\n * Component for service name T, e.g. `auth`, `auth-internal`\n */\nexport class Component<T extends Name = Name> {\n  multipleInstances = false;\n  /**\n   * Properties to be added to the service namespace\n   */\n  serviceProps: Dictionary = {};\n\n  instantiationMode = InstantiationMode.LAZY;\n\n  /**\n   *\n   * @param name The public service name, e.g. app, auth, firestore, database\n   * @param instanceFactory Service factory responsible for creating the public interface\n   * @param type whehter the service provided by the component is public or private\n   */\n  constructor(\n    readonly name: T,\n    readonly instanceFactory: InstanceFactory<T>,\n    readonly type: ComponentType\n  ) {}\n\n  setInstantiationMode(mode: InstantiationMode): this {\n    this.instantiationMode = mode;\n    return this;\n  }\n\n  setMultipleInstances(multipleInstances: boolean): this {\n    this.multipleInstances = multipleInstances;\n    return this;\n  }\n\n  setServiceProps(props: Dictionary): this {\n    this.serviceProps = props;\n    return this;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Deferred } from '@firebase/util';\nimport { ComponentContainer } from './component_container';\nimport { DEFAULT_ENTRY_NAME } from './constants';\nimport { InstantiationMode, Name, NameServiceMapping } from './types';\nimport { Component } from './component';\n\n/**\n * Provider for instance for service name T, e.g. 'auth', 'auth-internal'\n * NameServiceMapping[T] is an alias for the type of the instance\n */\nexport class Provider<T extends Name> {\n  private component: Component<T> | null = null;\n  private readonly instances: Map<string, NameServiceMapping[T]> = new Map();\n  private readonly instancesDeferred: Map<\n    string,\n    Deferred<NameServiceMapping[T]>\n  > = new Map();\n\n  constructor(\n    private readonly name: T,\n    private readonly container: ComponentContainer\n  ) {}\n\n  /**\n   * @param identifier A provider can provide mulitple instances of a service\n   * if this.component.multipleInstances is true.\n   */\n  get(identifier: string = DEFAULT_ENTRY_NAME): Promise<NameServiceMapping[T]> {\n    // if multipleInstances is not supported, use the default name\n    const normalizedIdentifier = this.normalizeInstanceIdentifier(identifier);\n\n    if (!this.instancesDeferred.has(normalizedIdentifier)) {\n      const deferred = new Deferred<NameServiceMapping[T]>();\n      this.instancesDeferred.set(normalizedIdentifier, deferred);\n      // If the service instance is available, resolve the promise with it immediately\n      try {\n        const instance = this.getOrInitializeService(normalizedIdentifier);\n        if (instance) {\n          deferred.resolve(instance);\n        }\n      } catch (e) {\n        // when the instance factory throws an exception during get(), it should not cause\n        // a fatal error. We just return the unresolved promise in this case.\n      }\n    }\n\n    return this.instancesDeferred.get(normalizedIdentifier)!.promise;\n  }\n\n  /**\n   *\n   * @param options.identifier A provider can provide mulitple instances of a service\n   * if this.component.multipleInstances is true.\n   * @param options.optional If optional is false or not provided, the method throws an error when\n   * the service is not immediately available.\n   * If optional is true, the method returns null if the service is not immediately available.\n   */\n  getImmediate(options: {\n    identifier?: string;\n    optional: true;\n  }): NameServiceMapping[T] | null;\n  getImmediate(options?: {\n    identifier?: string;\n    optional?: false;\n  }): NameServiceMapping[T];\n  getImmediate(options?: {\n    identifier?: string;\n    optional?: boolean;\n  }): NameServiceMapping[T] | null {\n    const { identifier, optional } = {\n      identifier: DEFAULT_ENTRY_NAME,\n      optional: false,\n      ...options\n    };\n    // if multipleInstances is not supported, use the default name\n    const normalizedIdentifier = this.normalizeInstanceIdentifier(identifier);\n    try {\n      const instance = this.getOrInitializeService(normalizedIdentifier);\n\n      if (!instance) {\n        if (optional) {\n          return null;\n        }\n        throw Error(`Service ${this.name} is not available`);\n      }\n      return instance;\n    } catch (e) {\n      if (optional) {\n        return null;\n      } else {\n        throw e;\n      }\n    }\n  }\n\n  getComponent(): Component<T> | null {\n    return this.component;\n  }\n\n  setComponent(component: Component<T>): void {\n    if (component.name !== this.name) {\n      throw Error(\n        `Mismatching Component ${component.name} for Provider ${this.name}.`\n      );\n    }\n\n    if (this.component) {\n      throw Error(`Component for ${this.name} has already been provided`);\n    }\n\n    this.component = component;\n    // if the service is eager, initialize the default instance\n    if (isComponentEager(component)) {\n      try {\n        this.getOrInitializeService(DEFAULT_ENTRY_NAME);\n      } catch (e) {\n        // when the instance factory for an eager Component throws an exception during the eager\n        // initialization, it should not cause a fatal error.\n        // TODO: Investigate if we need to make it configurable, because some component may want to cause\n        // a fatal error in this case?\n      }\n    }\n\n    // Create service instances for the pending promises and resolve them\n    // NOTE: if this.multipleInstances is false, only the default instance will be created\n    // and all promises with resolve with it regardless of the identifier.\n    for (const [\n      instanceIdentifier,\n      instanceDeferred\n    ] of this.instancesDeferred.entries()) {\n      const normalizedIdentifier = this.normalizeInstanceIdentifier(\n        instanceIdentifier\n      );\n\n      try {\n        // `getOrInitializeService()` should always return a valid instance since a component is guaranteed. use ! to make typescript happy.\n        const instance = this.getOrInitializeService(normalizedIdentifier)!;\n        instanceDeferred.resolve(instance);\n      } catch (e) {\n        // when the instance factory throws an exception, it should not cause\n        // a fatal error. We just leave the promise unresolved.\n      }\n    }\n  }\n\n  clearInstance(identifier: string = DEFAULT_ENTRY_NAME): void {\n    this.instancesDeferred.delete(identifier);\n    this.instances.delete(identifier);\n  }\n\n  // app.delete() will call this method on every provider to delete the services\n  // TODO: should we mark the provider as deleted?\n  async delete(): Promise<void> {\n    const services = Array.from(this.instances.values());\n\n    await Promise.all(\n      services\n        .filter(service => 'INTERNAL' in service)\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        .map(service => (service as any).INTERNAL!.delete())\n    );\n  }\n\n  isComponentSet(): boolean {\n    return this.component != null;\n  }\n\n  private getOrInitializeService(\n    identifier: string\n  ): NameServiceMapping[T] | null {\n    let instance = this.instances.get(identifier);\n    if (!instance && this.component) {\n      instance = this.component.instanceFactory(\n        this.container,\n        normalizeIdentifierForFactory(identifier)\n      ) as NameServiceMapping[T];\n      this.instances.set(identifier, instance);\n    }\n\n    return instance || null;\n  }\n\n  private normalizeInstanceIdentifier(identifier: string): string {\n    if (this.component) {\n      return this.component.multipleInstances ? identifier : DEFAULT_ENTRY_NAME;\n    } else {\n      return identifier; // assume multiple instances are supported before the component is provided.\n    }\n  }\n}\n\n// undefined should be passed to the service factory for the default instance\nfunction normalizeIdentifierForFactory(identifier: string): string | undefined {\n  return identifier === DEFAULT_ENTRY_NAME ? undefined : identifier;\n}\n\nfunction isComponentEager(component: Component<Name>): boolean {\n  return component.instantiationMode === InstantiationMode.EAGER;\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Provider } from './provider';\nimport { Component } from './component';\nimport { Name } from './types';\n\n/**\n * ComponentContainer that provides Providers for service name T, e.g. `auth`, `auth-internal`\n */\nexport class ComponentContainer {\n  private readonly providers = new Map<string, Provider<Name>>();\n\n  constructor(private readonly name: string) {}\n\n  /**\n   *\n   * @param component Component being added\n   * @param overwrite When a component with the same name has already been registered,\n   * if overwrite is true: overwrite the existing component with the new component and create a new\n   * provider with the new component. It can be useful in tests where you want to use different mocks\n   * for different tests.\n   * if overwrite is false: throw an exception\n   */\n  addComponent<T extends Name>(component: Component<T>): void {\n    const provider = this.getProvider(component.name);\n    if (provider.isComponentSet()) {\n      throw new Error(\n        `Component ${component.name} has already been registered with ${this.name}`\n      );\n    }\n\n    provider.setComponent(component);\n  }\n\n  addOrOverwriteComponent<T extends Name>(component: Component<T>): void {\n    const provider = this.getProvider(component.name);\n    if (provider.isComponentSet()) {\n      // delete the existing provider from the container, so we can register the new component\n      this.providers.delete(component.name);\n    }\n\n    this.addComponent(component);\n  }\n\n  /**\n   * getProvider provides a type safe interface where it can only be called with a field name\n   * present in NameServiceMapping interface.\n   *\n   * Firebase SDKs providing services should extend NameServiceMapping interface to register\n   * themselves.\n   */\n  getProvider<T extends Name>(name: T): Provider<T> {\n    if (this.providers.has(name)) {\n      return this.providers.get(name) as Provider<T>;\n    }\n\n    // create a Provider for a service that hasn't registered with Firebase\n    const provider = new Provider<T>(name, this);\n    this.providers.set(name, provider);\n\n    return provider as Provider<T>;\n  }\n\n  getProviders(): Array<Provider<Name>> {\n    return Array.from(this.providers.values());\n  }\n}\n","import pathToRegexp from \"path-to-regexp\";\n\nvar patternCache = {};\nvar cacheLimit = 10000;\nvar cacheCount = 0;\n\nvar compilePath = function compilePath(pattern, options) {\n  var cacheKey = \"\" + options.end + options.strict + options.sensitive;\n  var cache = patternCache[cacheKey] || (patternCache[cacheKey] = {});\n\n  if (cache[pattern]) return cache[pattern];\n\n  var keys = [];\n  var re = pathToRegexp(pattern, keys, options);\n  var compiledPattern = { re: re, keys: keys };\n\n  if (cacheCount < cacheLimit) {\n    cache[pattern] = compiledPattern;\n    cacheCount++;\n  }\n\n  return compiledPattern;\n};\n\n/**\n * Public API for matching a URL pathname to a path pattern.\n */\nvar matchPath = function matchPath(pathname) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var parent = arguments[2];\n\n  if (typeof options === \"string\") options = { path: options };\n\n  var _options = options,\n      path = _options.path,\n      _options$exact = _options.exact,\n      exact = _options$exact === undefined ? false : _options$exact,\n      _options$strict = _options.strict,\n      strict = _options$strict === undefined ? false : _options$strict,\n      _options$sensitive = _options.sensitive,\n      sensitive = _options$sensitive === undefined ? false : _options$sensitive;\n\n\n  if (path == null) return parent;\n\n  var _compilePath = compilePath(path, { end: exact, strict: strict, sensitive: sensitive }),\n      re = _compilePath.re,\n      keys = _compilePath.keys;\n\n  var match = re.exec(pathname);\n\n  if (!match) return null;\n\n  var url = match[0],\n      values = match.slice(1);\n\n  var isExact = pathname === url;\n\n  if (exact && !isExact) return null;\n\n  return {\n    path: path, // the path pattern used to match\n    url: path === \"/\" && url === \"\" ? \"/\" : url, // the matched portion of the URL\n    isExact: isExact, // whether or not we matched exactly\n    params: keys.reduce(function (memo, key, index) {\n      memo[key.name] = values[index];\n      return memo;\n    }, {})\n  };\n};\n\nexport default matchPath;","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CONSTANTS } from './constants';\n\n/**\n * Throws an error if the provided assertion is falsy\n */\nexport const assert = function(assertion: unknown, message: string): void {\n  if (!assertion) {\n    throw assertionError(message);\n  }\n};\n\n/**\n * Returns an Error object suitable for throwing.\n */\nexport const assertionError = function(message: string): Error {\n  return new Error(\n    'Firebase Database (' +\n      CONSTANTS.SDK_VERSION +\n      ') INTERNAL ASSERT FAILED: ' +\n      message\n  );\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst stringToByteArray = function(str: string): number[] {\n  // TODO(user): Use native implementations if/when available\n  const out: number[] = [];\n  let p = 0;\n  for (let i = 0; i < str.length; i++) {\n    let c = str.charCodeAt(i);\n    if (c < 128) {\n      out[p++] = c;\n    } else if (c < 2048) {\n      out[p++] = (c >> 6) | 192;\n      out[p++] = (c & 63) | 128;\n    } else if (\n      (c & 0xfc00) === 0xd800 &&\n      i + 1 < str.length &&\n      (str.charCodeAt(i + 1) & 0xfc00) === 0xdc00\n    ) {\n      // Surrogate Pair\n      c = 0x10000 + ((c & 0x03ff) << 10) + (str.charCodeAt(++i) & 0x03ff);\n      out[p++] = (c >> 18) | 240;\n      out[p++] = ((c >> 12) & 63) | 128;\n      out[p++] = ((c >> 6) & 63) | 128;\n      out[p++] = (c & 63) | 128;\n    } else {\n      out[p++] = (c >> 12) | 224;\n      out[p++] = ((c >> 6) & 63) | 128;\n      out[p++] = (c & 63) | 128;\n    }\n  }\n  return out;\n};\n\n/**\n * Turns an array of numbers into the string given by the concatenation of the\n * characters to which the numbers correspond.\n * @param bytes Array of numbers representing characters.\n * @return Stringification of the array.\n */\nconst byteArrayToString = function(bytes: number[]): string {\n  // TODO(user): Use native implementations if/when available\n  const out: string[] = [];\n  let pos = 0,\n    c = 0;\n  while (pos < bytes.length) {\n    const c1 = bytes[pos++];\n    if (c1 < 128) {\n      out[c++] = String.fromCharCode(c1);\n    } else if (c1 > 191 && c1 < 224) {\n      const c2 = bytes[pos++];\n      out[c++] = String.fromCharCode(((c1 & 31) << 6) | (c2 & 63));\n    } else if (c1 > 239 && c1 < 365) {\n      // Surrogate Pair\n      const c2 = bytes[pos++];\n      const c3 = bytes[pos++];\n      const c4 = bytes[pos++];\n      const u =\n        (((c1 & 7) << 18) | ((c2 & 63) << 12) | ((c3 & 63) << 6) | (c4 & 63)) -\n        0x10000;\n      out[c++] = String.fromCharCode(0xd800 + (u >> 10));\n      out[c++] = String.fromCharCode(0xdc00 + (u & 1023));\n    } else {\n      const c2 = bytes[pos++];\n      const c3 = bytes[pos++];\n      out[c++] = String.fromCharCode(\n        ((c1 & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63)\n      );\n    }\n  }\n  return out.join('');\n};\n\ninterface Base64 {\n  byteToCharMap_: { [key: number]: string } | null;\n  charToByteMap_: { [key: string]: number } | null;\n  byteToCharMapWebSafe_: { [key: number]: string } | null;\n  charToByteMapWebSafe_: { [key: string]: number } | null;\n  ENCODED_VALS_BASE: string;\n  readonly ENCODED_VALS: string;\n  readonly ENCODED_VALS_WEBSAFE: string;\n  HAS_NATIVE_SUPPORT: boolean;\n  encodeByteArray(input: number[] | Uint8Array, webSafe?: boolean): string;\n  encodeString(input: string, webSafe?: boolean): string;\n  decodeString(input: string, webSafe: boolean): string;\n  decodeStringToByteArray(input: string, webSafe: boolean): number[];\n  init_(): void;\n}\n\n// We define it as an object literal instead of a class because a class compiled down to es5 can't\n// be treeshaked. https://github.com/rollup/rollup/issues/1691\n// Static lookup maps, lazily populated by init_()\nexport const base64: Base64 = {\n  /**\n   * Maps bytes to characters.\n   */\n  byteToCharMap_: null,\n\n  /**\n   * Maps characters to bytes.\n   */\n  charToByteMap_: null,\n\n  /**\n   * Maps bytes to websafe characters.\n   * @private\n   */\n  byteToCharMapWebSafe_: null,\n\n  /**\n   * Maps websafe characters to bytes.\n   * @private\n   */\n  charToByteMapWebSafe_: null,\n\n  /**\n   * Our default alphabet, shared between\n   * ENCODED_VALS and ENCODED_VALS_WEBSAFE\n   */\n  ENCODED_VALS_BASE:\n    'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz' + '0123456789',\n\n  /**\n   * Our default alphabet. Value 64 (=) is special; it means \"nothing.\"\n   */\n  get ENCODED_VALS() {\n    return this.ENCODED_VALS_BASE + '+/=';\n  },\n\n  /**\n   * Our websafe alphabet.\n   */\n  get ENCODED_VALS_WEBSAFE() {\n    return this.ENCODED_VALS_BASE + '-_.';\n  },\n\n  /**\n   * Whether this browser supports the atob and btoa functions. This extension\n   * started at Mozilla but is now implemented by many browsers. We use the\n   * ASSUME_* variables to avoid pulling in the full useragent detection library\n   * but still allowing the standard per-browser compilations.\n   *\n   */\n  HAS_NATIVE_SUPPORT: typeof atob === 'function',\n\n  /**\n   * Base64-encode an array of bytes.\n   *\n   * @param input An array of bytes (numbers with\n   *     value in [0, 255]) to encode.\n   * @param webSafe Boolean indicating we should use the\n   *     alternative alphabet.\n   * @return The base64 encoded string.\n   */\n  encodeByteArray(input: number[] | Uint8Array, webSafe?: boolean): string {\n    if (!Array.isArray(input)) {\n      throw Error('encodeByteArray takes an array as a parameter');\n    }\n\n    this.init_();\n\n    const byteToCharMap = webSafe\n      ? this.byteToCharMapWebSafe_!\n      : this.byteToCharMap_!;\n\n    const output = [];\n\n    for (let i = 0; i < input.length; i += 3) {\n      const byte1 = input[i];\n      const haveByte2 = i + 1 < input.length;\n      const byte2 = haveByte2 ? input[i + 1] : 0;\n      const haveByte3 = i + 2 < input.length;\n      const byte3 = haveByte3 ? input[i + 2] : 0;\n\n      const outByte1 = byte1 >> 2;\n      const outByte2 = ((byte1 & 0x03) << 4) | (byte2 >> 4);\n      let outByte3 = ((byte2 & 0x0f) << 2) | (byte3 >> 6);\n      let outByte4 = byte3 & 0x3f;\n\n      if (!haveByte3) {\n        outByte4 = 64;\n\n        if (!haveByte2) {\n          outByte3 = 64;\n        }\n      }\n\n      output.push(\n        byteToCharMap[outByte1],\n        byteToCharMap[outByte2],\n        byteToCharMap[outByte3],\n        byteToCharMap[outByte4]\n      );\n    }\n\n    return output.join('');\n  },\n\n  /**\n   * Base64-encode a string.\n   *\n   * @param input A string to encode.\n   * @param webSafe If true, we should use the\n   *     alternative alphabet.\n   * @return The base64 encoded string.\n   */\n  encodeString(input: string, webSafe?: boolean): string {\n    // Shortcut for Mozilla browsers that implement\n    // a native base64 encoder in the form of \"btoa/atob\"\n    if (this.HAS_NATIVE_SUPPORT && !webSafe) {\n      return btoa(input);\n    }\n    return this.encodeByteArray(stringToByteArray(input), webSafe);\n  },\n\n  /**\n   * Base64-decode a string.\n   *\n   * @param input to decode.\n   * @param webSafe True if we should use the\n   *     alternative alphabet.\n   * @return string representing the decoded value.\n   */\n  decodeString(input: string, webSafe: boolean): string {\n    // Shortcut for Mozilla browsers that implement\n    // a native base64 encoder in the form of \"btoa/atob\"\n    if (this.HAS_NATIVE_SUPPORT && !webSafe) {\n      return atob(input);\n    }\n    return byteArrayToString(this.decodeStringToByteArray(input, webSafe));\n  },\n\n  /**\n   * Base64-decode a string.\n   *\n   * In base-64 decoding, groups of four characters are converted into three\n   * bytes.  If the encoder did not apply padding, the input length may not\n   * be a multiple of 4.\n   *\n   * In this case, the last group will have fewer than 4 characters, and\n   * padding will be inferred.  If the group has one or two characters, it decodes\n   * to one byte.  If the group has three characters, it decodes to two bytes.\n   *\n   * @param input Input to decode.\n   * @param webSafe True if we should use the web-safe alphabet.\n   * @return bytes representing the decoded value.\n   */\n  decodeStringToByteArray(input: string, webSafe: boolean): number[] {\n    this.init_();\n\n    const charToByteMap = webSafe\n      ? this.charToByteMapWebSafe_!\n      : this.charToByteMap_!;\n\n    const output: number[] = [];\n\n    for (let i = 0; i < input.length; ) {\n      const byte1 = charToByteMap[input.charAt(i++)];\n\n      const haveByte2 = i < input.length;\n      const byte2 = haveByte2 ? charToByteMap[input.charAt(i)] : 0;\n      ++i;\n\n      const haveByte3 = i < input.length;\n      const byte3 = haveByte3 ? charToByteMap[input.charAt(i)] : 64;\n      ++i;\n\n      const haveByte4 = i < input.length;\n      const byte4 = haveByte4 ? charToByteMap[input.charAt(i)] : 64;\n      ++i;\n\n      if (byte1 == null || byte2 == null || byte3 == null || byte4 == null) {\n        throw Error();\n      }\n\n      const outByte1 = (byte1 << 2) | (byte2 >> 4);\n      output.push(outByte1);\n\n      if (byte3 !== 64) {\n        const outByte2 = ((byte2 << 4) & 0xf0) | (byte3 >> 2);\n        output.push(outByte2);\n\n        if (byte4 !== 64) {\n          const outByte3 = ((byte3 << 6) & 0xc0) | byte4;\n          output.push(outByte3);\n        }\n      }\n    }\n\n    return output;\n  },\n\n  /**\n   * Lazy static initialization function. Called before\n   * accessing any of the static map variables.\n   * @private\n   */\n  init_() {\n    if (!this.byteToCharMap_) {\n      this.byteToCharMap_ = {};\n      this.charToByteMap_ = {};\n      this.byteToCharMapWebSafe_ = {};\n      this.charToByteMapWebSafe_ = {};\n\n      // We want quick mappings back and forth, so we precompute two maps.\n      for (let i = 0; i < this.ENCODED_VALS.length; i++) {\n        this.byteToCharMap_[i] = this.ENCODED_VALS.charAt(i);\n        this.charToByteMap_[this.byteToCharMap_[i]] = i;\n        this.byteToCharMapWebSafe_[i] = this.ENCODED_VALS_WEBSAFE.charAt(i);\n        this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]] = i;\n\n        // Be forgiving when decoding and correctly decode both encodings.\n        if (i >= this.ENCODED_VALS_BASE.length) {\n          this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)] = i;\n          this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)] = i;\n        }\n      }\n    }\n  }\n};\n\n/**\n * URL-safe base64 encoding\n */\nexport const base64Encode = function(str: string): string {\n  const utf8Bytes = stringToByteArray(str);\n  return base64.encodeByteArray(utf8Bytes, true);\n};\n\n/**\n * URL-safe base64 decoding\n *\n * NOTE: DO NOT use the global atob() function - it does NOT support the\n * base64Url variant encoding.\n *\n * @param str To be decoded\n * @return Decoded result, if possible\n */\nexport const base64Decode = function(str: string): string | null {\n  try {\n    return base64.decodeString(str, true);\n  } catch (e) {\n    console.error('base64Decode failed: ', e);\n  }\n  return null;\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Do a deep-copy of basic JavaScript Objects or Arrays.\n */\nexport function deepCopy<T>(value: T): T {\n  return deepExtend(undefined, value) as T;\n}\n\n/**\n * Copy properties from source to target (recursively allows extension\n * of Objects and Arrays).  Scalar values in the target are over-written.\n * If target is undefined, an object of the appropriate type will be created\n * (and returned).\n *\n * We recursively copy all child properties of plain Objects in the source- so\n * that namespace- like dictionaries are merged.\n *\n * Note that the target can be a function, in which case the properties in\n * the source Object are copied onto it as static properties of the Function.\n */\nexport function deepExtend(target: unknown, source: unknown): unknown {\n  if (!(source instanceof Object)) {\n    return source;\n  }\n\n  switch (source.constructor) {\n    case Date:\n      // Treat Dates like scalars; if the target date object had any child\n      // properties - they will be lost!\n      const dateValue = source as Date;\n      return new Date(dateValue.getTime());\n\n    case Object:\n      if (target === undefined) {\n        target = {};\n      }\n      break;\n    case Array:\n      // Always copy the array source and overwrite the target.\n      target = [];\n      break;\n\n    default:\n      // Not a plain Object - treat it as a scalar.\n      return source;\n  }\n\n  for (const prop in source) {\n    if (!source.hasOwnProperty(prop)) {\n      continue;\n    }\n    (target as { [key: string]: unknown })[prop] = deepExtend(\n      (target as { [key: string]: unknown })[prop],\n      (source as { [key: string]: unknown })[prop]\n    );\n  }\n\n  return target;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class Deferred<R> {\n  promise: Promise<R>;\n  reject: (value?: unknown) => void = () => {};\n  resolve: (value?: unknown) => void = () => {};\n  constructor() {\n    this.promise = new Promise((resolve, reject) => {\n      this.resolve = resolve as (value?: unknown) => void;\n      this.reject = reject as (value?: unknown) => void;\n    });\n  }\n\n  /**\n   * Our API internals are not promiseified and cannot because our callback APIs have subtle expectations around\n   * invoking promises inline, which Promises are forbidden to do. This method accepts an optional node-style callback\n   * and returns a node-style callback which will resolve or reject the Deferred's promise.\n   */\n  wrapCallback(\n    callback?: (error?: unknown, value?: unknown) => void\n  ): (error: unknown, value?: unknown) => void {\n    return (error, value?) => {\n      if (error) {\n        this.reject(error);\n      } else {\n        this.resolve(value);\n      }\n      if (typeof callback === 'function') {\n        // Attaching noop handler just in case developer wasn't expecting\n        // promises\n        this.promise.catch(() => {});\n\n        // Some of our callbacks don't expect a value and our own tests\n        // assert that the parameter length is 1\n        if (callback.length === 1) {\n          callback(error);\n        } else {\n          callback(error, value);\n        }\n      }\n    };\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CONSTANTS } from './constants';\n\n/**\n * Returns navigator.userAgent string or '' if it's not defined.\n * @return user agent string\n */\nexport function getUA(): string {\n  if (\n    typeof navigator !== 'undefined' &&\n    typeof navigator['userAgent'] === 'string'\n  ) {\n    return navigator['userAgent'];\n  } else {\n    return '';\n  }\n}\n\n/**\n * Detect Cordova / PhoneGap / Ionic frameworks on a mobile device.\n *\n * Deliberately does not rely on checking `file://` URLs (as this fails PhoneGap\n * in the Ripple emulator) nor Cordova `onDeviceReady`, which would normally\n * wait for a callback.\n */\nexport function isMobileCordova(): boolean {\n  return (\n    typeof window !== 'undefined' &&\n    // @ts-ignore Setting up an broadly applicable index signature for Window\n    // just to deal with this case would probably be a bad idea.\n    !!(window['cordova'] || window['phonegap'] || window['PhoneGap']) &&\n    /ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())\n  );\n}\n\n/**\n * Detect Node.js.\n *\n * @return true if Node.js environment is detected.\n */\n// Node detection logic from: https://github.com/iliakan/detect-node/\nexport function isNode(): boolean {\n  try {\n    return (\n      Object.prototype.toString.call(global.process) === '[object process]'\n    );\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Detect Browser Environment\n */\nexport function isBrowser(): boolean {\n  return typeof self === 'object' && self.self === self;\n}\n\n/**\n * Detect React Native.\n *\n * @return true if ReactNative environment is detected.\n */\nexport function isReactNative(): boolean {\n  return (\n    typeof navigator === 'object' && navigator['product'] === 'ReactNative'\n  );\n}\n\n/**\n * Detect whether the current SDK build is the Node version.\n *\n * @return true if it's the Node SDK build.\n */\nexport function isNodeSdk(): boolean {\n  return CONSTANTS.NODE_CLIENT === true || CONSTANTS.NODE_ADMIN === true;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Evaluates a JSON string into a javascript object.\n *\n * @param {string} str A string containing JSON.\n * @return {*} The javascript object representing the specified JSON.\n */\nexport function jsonEval(str: string): unknown {\n  return JSON.parse(str);\n}\n\n/**\n * Returns JSON representing a javascript object.\n * @param {*} data Javascript object to be stringified.\n * @return {string} The JSON contents of the object.\n */\nexport function stringify(data: unknown): string {\n  return JSON.stringify(data);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { base64Decode } from './crypt';\nimport { jsonEval } from './json';\n\ninterface Claims {\n  [key: string]: {};\n}\n\ninterface DecodedToken {\n  header: object;\n  claims: Claims;\n  data: object;\n  signature: string;\n}\n\n/**\n * Decodes a Firebase auth. token into constituent parts.\n *\n * Notes:\n * - May return with invalid / incomplete claims if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n */\nexport const decode = function(token: string): DecodedToken {\n  let header = {},\n    claims: Claims = {},\n    data = {},\n    signature = '';\n\n  try {\n    const parts = token.split('.');\n    header = jsonEval(base64Decode(parts[0]) || '') as object;\n    claims = jsonEval(base64Decode(parts[1]) || '') as Claims;\n    signature = parts[2];\n    data = claims['d'] || {};\n    delete claims['d'];\n  } catch (e) {}\n\n  return {\n    header,\n    claims,\n    data,\n    signature\n  };\n};\n\ninterface DecodedToken {\n  header: object;\n  claims: Claims;\n  data: object;\n  signature: string;\n}\n\n/**\n * Decodes a Firebase auth. token and checks the validity of its time-based claims. Will return true if the\n * token is within the time window authorized by the 'nbf' (not-before) and 'iat' (issued-at) claims.\n *\n * Notes:\n * - May return a false negative if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n */\nexport const isValidTimestamp = function(token: string): boolean {\n  const claims: Claims = decode(token).claims;\n  const now: number = Math.floor(new Date().getTime() / 1000);\n  let validSince: number = 0,\n    validUntil: number = 0;\n\n  if (typeof claims === 'object') {\n    if (claims.hasOwnProperty('nbf')) {\n      validSince = claims['nbf'] as number;\n    } else if (claims.hasOwnProperty('iat')) {\n      validSince = claims['iat'] as number;\n    }\n\n    if (claims.hasOwnProperty('exp')) {\n      validUntil = claims['exp'] as number;\n    } else {\n      // token will expire after 24h by default\n      validUntil = validSince + 86400;\n    }\n  }\n\n  return (\n    !!now &&\n    !!validSince &&\n    !!validUntil &&\n    now >= validSince &&\n    now <= validUntil\n  );\n};\n\n/**\n * Decodes a Firebase auth. token and returns its issued at time if valid, null otherwise.\n *\n * Notes:\n * - May return null if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n */\nexport const issuedAtTime = function(token: string): number | null {\n  const claims: Claims = decode(token).claims;\n  if (typeof claims === 'object' && claims.hasOwnProperty('iat')) {\n    return claims['iat'] as number;\n  }\n  return null;\n};\n\n/**\n * Decodes a Firebase auth. token and checks the validity of its format. Expects a valid issued-at time.\n *\n * Notes:\n * - May return a false negative if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n */\nexport const isValidFormat = function(token: string): boolean {\n  const decoded = decode(token),\n    claims = decoded.claims;\n\n  return !!claims && typeof claims === 'object' && claims.hasOwnProperty('iat');\n};\n\n/**\n * Attempts to peer into an auth token and determine if it's an admin auth token by looking at the claims portion.\n *\n * Notes:\n * - May return a false negative if there's no native base64 decoding support.\n * - Doesn't check if the token is actually valid.\n */\nexport const isAdmin = function(token: string): boolean {\n  const claims: Claims = decode(token).claims;\n  return typeof claims === 'object' && claims['admin'] === true;\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview SHA-1 cryptographic hash.\n * Variable names follow the notation in FIPS PUB 180-3:\n * http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf.\n *\n * Usage:\n *   var sha1 = new sha1();\n *   sha1.update(bytes);\n *   var hash = sha1.digest();\n *\n * Performance:\n *   Chrome 23:   ~400 Mbit/s\n *   Firefox 16:  ~250 Mbit/s\n *\n */\n\n/**\n * SHA-1 cryptographic hash constructor.\n *\n * The properties declared here are discussed in the above algorithm document.\n * @constructor\n * @final\n * @struct\n */\nexport class Sha1 {\n  /**\n   * Holds the previous values of accumulated variables a-e in the compress_\n   * function.\n   * @private\n   */\n  private chain_: number[] = [];\n\n  /**\n   * A buffer holding the partially computed hash result.\n   * @private\n   */\n  private buf_: number[] = [];\n\n  /**\n   * An array of 80 bytes, each a part of the message to be hashed.  Referred to\n   * as the message schedule in the docs.\n   * @private\n   */\n  private W_: number[] = [];\n\n  /**\n   * Contains data needed to pad messages less than 64 bytes.\n   * @private\n   */\n  private pad_: number[] = [];\n\n  /**\n   * @private {number}\n   */\n  private inbuf_: number = 0;\n\n  /**\n   * @private {number}\n   */\n  private total_: number = 0;\n\n  blockSize: number;\n\n  constructor() {\n    this.blockSize = 512 / 8;\n\n    this.pad_[0] = 128;\n    for (let i = 1; i < this.blockSize; ++i) {\n      this.pad_[i] = 0;\n    }\n\n    this.reset();\n  }\n\n  reset(): void {\n    this.chain_[0] = 0x67452301;\n    this.chain_[1] = 0xefcdab89;\n    this.chain_[2] = 0x98badcfe;\n    this.chain_[3] = 0x10325476;\n    this.chain_[4] = 0xc3d2e1f0;\n\n    this.inbuf_ = 0;\n    this.total_ = 0;\n  }\n\n  /**\n   * Internal compress helper function.\n   * @param buf Block to compress.\n   * @param offset Offset of the block in the buffer.\n   * @private\n   */\n  compress_(buf: number[] | Uint8Array | string, offset?: number): void {\n    if (!offset) {\n      offset = 0;\n    }\n\n    const W = this.W_;\n\n    // get 16 big endian words\n    if (typeof buf === 'string') {\n      for (let i = 0; i < 16; i++) {\n        // TODO(user): [bug 8140122] Recent versions of Safari for Mac OS and iOS\n        // have a bug that turns the post-increment ++ operator into pre-increment\n        // during JIT compilation.  We have code that depends heavily on SHA-1 for\n        // correctness and which is affected by this bug, so I've removed all uses\n        // of post-increment ++ in which the result value is used.  We can revert\n        // this change once the Safari bug\n        // (https://bugs.webkit.org/show_bug.cgi?id=109036) has been fixed and\n        // most clients have been updated.\n        W[i] =\n          (buf.charCodeAt(offset) << 24) |\n          (buf.charCodeAt(offset + 1) << 16) |\n          (buf.charCodeAt(offset + 2) << 8) |\n          buf.charCodeAt(offset + 3);\n        offset += 4;\n      }\n    } else {\n      for (let i = 0; i < 16; i++) {\n        W[i] =\n          (buf[offset] << 24) |\n          (buf[offset + 1] << 16) |\n          (buf[offset + 2] << 8) |\n          buf[offset + 3];\n        offset += 4;\n      }\n    }\n\n    // expand to 80 words\n    for (let i = 16; i < 80; i++) {\n      const t = W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16];\n      W[i] = ((t << 1) | (t >>> 31)) & 0xffffffff;\n    }\n\n    let a = this.chain_[0];\n    let b = this.chain_[1];\n    let c = this.chain_[2];\n    let d = this.chain_[3];\n    let e = this.chain_[4];\n    let f, k;\n\n    // TODO(user): Try to unroll this loop to speed up the computation.\n    for (let i = 0; i < 80; i++) {\n      if (i < 40) {\n        if (i < 20) {\n          f = d ^ (b & (c ^ d));\n          k = 0x5a827999;\n        } else {\n          f = b ^ c ^ d;\n          k = 0x6ed9eba1;\n        }\n      } else {\n        if (i < 60) {\n          f = (b & c) | (d & (b | c));\n          k = 0x8f1bbcdc;\n        } else {\n          f = b ^ c ^ d;\n          k = 0xca62c1d6;\n        }\n      }\n\n      const t = (((a << 5) | (a >>> 27)) + f + e + k + W[i]) & 0xffffffff;\n      e = d;\n      d = c;\n      c = ((b << 30) | (b >>> 2)) & 0xffffffff;\n      b = a;\n      a = t;\n    }\n\n    this.chain_[0] = (this.chain_[0] + a) & 0xffffffff;\n    this.chain_[1] = (this.chain_[1] + b) & 0xffffffff;\n    this.chain_[2] = (this.chain_[2] + c) & 0xffffffff;\n    this.chain_[3] = (this.chain_[3] + d) & 0xffffffff;\n    this.chain_[4] = (this.chain_[4] + e) & 0xffffffff;\n  }\n\n  update(bytes?: number[] | Uint8Array | string, length?: number): void {\n    // TODO(johnlenz): tighten the function signature and remove this check\n    if (bytes == null) {\n      return;\n    }\n\n    if (length === undefined) {\n      length = bytes.length;\n    }\n\n    const lengthMinusBlock = length - this.blockSize;\n    let n = 0;\n    // Using local instead of member variables gives ~5% speedup on Firefox 16.\n    const buf = this.buf_;\n    let inbuf = this.inbuf_;\n\n    // The outer while loop should execute at most twice.\n    while (n < length) {\n      // When we have no data in the block to top up, we can directly process the\n      // input buffer (assuming it contains sufficient data). This gives ~25%\n      // speedup on Chrome 23 and ~15% speedup on Firefox 16, but requires that\n      // the data is provided in large chunks (or in multiples of 64 bytes).\n      if (inbuf === 0) {\n        while (n <= lengthMinusBlock) {\n          this.compress_(bytes, n);\n          n += this.blockSize;\n        }\n      }\n\n      if (typeof bytes === 'string') {\n        while (n < length) {\n          buf[inbuf] = bytes.charCodeAt(n);\n          ++inbuf;\n          ++n;\n          if (inbuf === this.blockSize) {\n            this.compress_(buf);\n            inbuf = 0;\n            // Jump to the outer loop so we use the full-block optimization.\n            break;\n          }\n        }\n      } else {\n        while (n < length) {\n          buf[inbuf] = bytes[n];\n          ++inbuf;\n          ++n;\n          if (inbuf === this.blockSize) {\n            this.compress_(buf);\n            inbuf = 0;\n            // Jump to the outer loop so we use the full-block optimization.\n            break;\n          }\n        }\n      }\n    }\n\n    this.inbuf_ = inbuf;\n    this.total_ += length;\n  }\n\n  /** @override */\n  digest(): number[] {\n    const digest: number[] = [];\n    let totalBits = this.total_ * 8;\n\n    // Add pad 0x80 0x00*.\n    if (this.inbuf_ < 56) {\n      this.update(this.pad_, 56 - this.inbuf_);\n    } else {\n      this.update(this.pad_, this.blockSize - (this.inbuf_ - 56));\n    }\n\n    // Add # bits.\n    for (let i = this.blockSize - 1; i >= 56; i--) {\n      this.buf_[i] = totalBits & 255;\n      totalBits /= 256; // Don't use bit-shifting here!\n    }\n\n    this.compress_(this.buf_);\n\n    let n = 0;\n    for (let i = 0; i < 5; i++) {\n      for (let j = 24; j >= 0; j -= 8) {\n        digest[n] = (this.chain_[i] >> j) & 255;\n        ++n;\n      }\n    }\n    return digest;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nexport type NextFn<T> = (value: T) => void;\nexport type ErrorFn = (error: Error) => void;\nexport type CompleteFn = () => void;\n\nexport interface Observer<T> {\n  // Called once for each value in a stream of values.\n  next: NextFn<T>;\n\n  // A stream terminates by a single call to EITHER error() or complete().\n  error: ErrorFn;\n\n  // No events will be sent to next() once complete() is called.\n  complete: CompleteFn;\n}\n\nexport type PartialObserver<T> = Partial<Observer<T>>;\n\n// TODO: Support also Unsubscribe.unsubscribe?\nexport type Unsubscribe = () => void;\n\n/**\n * The Subscribe interface has two forms - passing the inline function\n * callbacks, or a object interface with callback properties.\n */\nexport interface Subscribe<T> {\n  (next?: NextFn<T>, error?: ErrorFn, complete?: CompleteFn): Unsubscribe;\n  (observer: PartialObserver<T>): Unsubscribe;\n}\n\nexport interface Observable<T> {\n  // Subscribe method\n  subscribe: Subscribe<T>;\n}\n\nexport type Executor<T> = (observer: Observer<T>) => void;\n\n/**\n * Helper to make a Subscribe function (just like Promise helps make a\n * Thenable).\n *\n * @param executor Function which can make calls to a single Observer\n *     as a proxy.\n * @param onNoObservers Callback when count of Observers goes to zero.\n */\nexport function createSubscribe<T>(\n  executor: Executor<T>,\n  onNoObservers?: Executor<T>\n): Subscribe<T> {\n  const proxy = new ObserverProxy<T>(executor, onNoObservers);\n  return proxy.subscribe.bind(proxy);\n}\n\n/**\n * Implement fan-out for any number of Observers attached via a subscribe\n * function.\n */\nclass ObserverProxy<T> implements Observer<T> {\n  private observers: Array<Observer<T>> | undefined = [];\n  private unsubscribes: Unsubscribe[] = [];\n  private onNoObservers: Executor<T> | undefined;\n  private observerCount = 0;\n  // Micro-task scheduling by calling task.then().\n  private task = Promise.resolve();\n  private finalized = false;\n  private finalError?: Error;\n\n  /**\n   * @param executor Function which can make calls to a single Observer\n   *     as a proxy.\n   * @param onNoObservers Callback when count of Observers goes to zero.\n   */\n  constructor(executor: Executor<T>, onNoObservers?: Executor<T>) {\n    this.onNoObservers = onNoObservers;\n    // Call the executor asynchronously so subscribers that are called\n    // synchronously after the creation of the subscribe function\n    // can still receive the very first value generated in the executor.\n    this.task\n      .then(() => {\n        executor(this);\n      })\n      .catch(e => {\n        this.error(e);\n      });\n  }\n\n  next(value: T): void {\n    this.forEachObserver((observer: Observer<T>) => {\n      observer.next(value);\n    });\n  }\n\n  error(error: Error): void {\n    this.forEachObserver((observer: Observer<T>) => {\n      observer.error(error);\n    });\n    this.close(error);\n  }\n\n  complete(): void {\n    this.forEachObserver((observer: Observer<T>) => {\n      observer.complete();\n    });\n    this.close();\n  }\n\n  /**\n   * Subscribe function that can be used to add an Observer to the fan-out list.\n   *\n   * - We require that no event is sent to a subscriber sychronously to their\n   *   call to subscribe().\n   */\n  subscribe(\n    nextOrObserver?: PartialObserver<T> | Function,\n    error?: ErrorFn,\n    complete?: CompleteFn\n  ): Unsubscribe {\n    let observer: Observer<T>;\n\n    if (\n      nextOrObserver === undefined &&\n      error === undefined &&\n      complete === undefined\n    ) {\n      throw new Error('Missing Observer.');\n    }\n\n    // Assemble an Observer object when passed as callback functions.\n    if (\n      implementsAnyMethods(nextOrObserver as { [key: string]: unknown }, [\n        'next',\n        'error',\n        'complete'\n      ])\n    ) {\n      observer = nextOrObserver as Observer<T>;\n    } else {\n      observer = {\n        next: nextOrObserver as NextFn<T>,\n        error,\n        complete\n      } as Observer<T>;\n    }\n\n    if (observer.next === undefined) {\n      observer.next = noop as NextFn<T>;\n    }\n    if (observer.error === undefined) {\n      observer.error = noop as ErrorFn;\n    }\n    if (observer.complete === undefined) {\n      observer.complete = noop as CompleteFn;\n    }\n\n    const unsub = this.unsubscribeOne.bind(this, this.observers!.length);\n\n    // Attempt to subscribe to a terminated Observable - we\n    // just respond to the Observer with the final error or complete\n    // event.\n    if (this.finalized) {\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      this.task.then(() => {\n        try {\n          if (this.finalError) {\n            observer.error(this.finalError);\n          } else {\n            observer.complete();\n          }\n        } catch (e) {\n          // nothing\n        }\n        return;\n      });\n    }\n\n    this.observers!.push(observer as Observer<T>);\n\n    return unsub;\n  }\n\n  // Unsubscribe is synchronous - we guarantee that no events are sent to\n  // any unsubscribed Observer.\n  private unsubscribeOne(i: number): void {\n    if (this.observers === undefined || this.observers[i] === undefined) {\n      return;\n    }\n\n    delete this.observers[i];\n\n    this.observerCount -= 1;\n    if (this.observerCount === 0 && this.onNoObservers !== undefined) {\n      this.onNoObservers(this);\n    }\n  }\n\n  private forEachObserver(fn: (observer: Observer<T>) => void): void {\n    if (this.finalized) {\n      // Already closed by previous event....just eat the additional values.\n      return;\n    }\n\n    // Since sendOne calls asynchronously - there is no chance that\n    // this.observers will become undefined.\n    for (let i = 0; i < this.observers!.length; i++) {\n      this.sendOne(i, fn);\n    }\n  }\n\n  // Call the Observer via one of it's callback function. We are careful to\n  // confirm that the observe has not been unsubscribed since this asynchronous\n  // function had been queued.\n  private sendOne(i: number, fn: (observer: Observer<T>) => void): void {\n    // Execute the callback asynchronously\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    this.task.then(() => {\n      if (this.observers !== undefined && this.observers[i] !== undefined) {\n        try {\n          fn(this.observers[i]);\n        } catch (e) {\n          // Ignore exceptions raised in Observers or missing methods of an\n          // Observer.\n          // Log error to console. b/31404806\n          if (typeof console !== 'undefined' && console.error) {\n            console.error(e);\n          }\n        }\n      }\n    });\n  }\n\n  private close(err?: Error): void {\n    if (this.finalized) {\n      return;\n    }\n    this.finalized = true;\n    if (err !== undefined) {\n      this.finalError = err;\n    }\n    // Proxy is no longer needed - garbage collect references\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    this.task.then(() => {\n      this.observers = undefined;\n      this.onNoObservers = undefined;\n    });\n  }\n}\n\n/** Turn synchronous function into one called asynchronously. */\nexport function async(fn: Function, onError?: ErrorFn): Function {\n  return (...args: unknown[]) => {\n    Promise.resolve(true)\n      .then(() => {\n        fn(...args);\n      })\n      .catch((error: Error) => {\n        if (onError) {\n          onError(error);\n        }\n      });\n  };\n}\n\n/**\n * Return true if the object passed in implements any of the named methods.\n */\nfunction implementsAnyMethods(\n  obj: { [key: string]: unknown },\n  methods: string[]\n): boolean {\n  if (typeof obj !== 'object' || obj === null) {\n    return false;\n  }\n\n  for (const method of methods) {\n    if (method in obj && typeof obj[method] === 'function') {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction noop(): void {\n  // do nothing\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Check to make sure the appropriate number of arguments are provided for a public function.\n * Throws an error if it fails.\n *\n * @param fnName The function name\n * @param minCount The minimum number of arguments to allow for the function call\n * @param maxCount The maximum number of argument to allow for the function call\n * @param argCount The actual number of arguments provided.\n */\nexport const validateArgCount = function(\n  fnName: string,\n  minCount: number,\n  maxCount: number,\n  argCount: number\n): void {\n  let argError;\n  if (argCount < minCount) {\n    argError = 'at least ' + minCount;\n  } else if (argCount > maxCount) {\n    argError = maxCount === 0 ? 'none' : 'no more than ' + maxCount;\n  }\n  if (argError) {\n    const error =\n      fnName +\n      ' failed: Was called with ' +\n      argCount +\n      (argCount === 1 ? ' argument.' : ' arguments.') +\n      ' Expects ' +\n      argError +\n      '.';\n    throw new Error(error);\n  }\n};\n\n/**\n * Generates a string to prefix an error message about failed argument validation\n *\n * @param fnName The function name\n * @param argumentNumber The index of the argument\n * @param optional Whether or not the argument is optional\n * @return The prefix to add to the error thrown for validation.\n */\nexport function errorPrefix(\n  fnName: string,\n  argumentNumber: number,\n  optional: boolean\n): string {\n  let argName = '';\n  switch (argumentNumber) {\n    case 1:\n      argName = optional ? 'first' : 'First';\n      break;\n    case 2:\n      argName = optional ? 'second' : 'Second';\n      break;\n    case 3:\n      argName = optional ? 'third' : 'Third';\n      break;\n    case 4:\n      argName = optional ? 'fourth' : 'Fourth';\n      break;\n    default:\n      throw new Error(\n        'errorPrefix called with argumentNumber > 4.  Need to update it?'\n      );\n  }\n\n  let error = fnName + ' failed: ';\n\n  error += argName + ' argument ';\n  return error;\n}\n\n/**\n * @param fnName\n * @param argumentNumber\n * @param namespace\n * @param optional\n */\nexport function validateNamespace(\n  fnName: string,\n  argumentNumber: number,\n  namespace: string,\n  optional: boolean\n): void {\n  if (optional && !namespace) {\n    return;\n  }\n  if (typeof namespace !== 'string') {\n    //TODO: I should do more validation here. We only allow certain chars in namespaces.\n    throw new Error(\n      errorPrefix(fnName, argumentNumber, optional) +\n        'must be a valid firebase namespace.'\n    );\n  }\n}\n\nexport function validateCallback(\n  fnName: string,\n  argumentNumber: number,\n  callback: Function,\n  optional: boolean\n): void {\n  if (optional && !callback) {\n    return;\n  }\n  if (typeof callback !== 'function') {\n    throw new Error(\n      errorPrefix(fnName, argumentNumber, optional) +\n        'must be a valid function.'\n    );\n  }\n}\n\nexport function validateContextObject(\n  fnName: string,\n  argumentNumber: number,\n  context: unknown,\n  optional: boolean\n): void {\n  if (optional && !context) {\n    return;\n  }\n  if (typeof context !== 'object' || context === null) {\n    throw new Error(\n      errorPrefix(fnName, argumentNumber, optional) +\n        'must be a valid context object.'\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport function contains<T extends object>(obj: T, key: keyof T): boolean {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}\n\nexport function safeGet<T extends object, K extends keyof T>(\n  obj: T,\n  key: K\n): T[K] | undefined {\n  if (Object.prototype.hasOwnProperty.call(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\n\nexport function isEmpty(obj: object): obj is {} {\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function map<K extends string, V, U>(\n  obj: { [key in K]: V },\n  fn: (value: V, key: K, obj: { [key in K]: V }) => U,\n  contextObj?: unknown\n): { [key in K]: U } {\n  const res: Partial<{ [key in K]: U }> = {};\n  for (const key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      res[key] = fn.call(contextObj, obj[key], key, obj);\n    }\n  }\n  return res as { [key in K]: U };\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns a querystring-formatted string (e.g. &arg=val&arg2=val2) from a\n * params object (e.g. {arg: 'val', arg2: 'val2'})\n * Note: You must prepend it with ? when adding it to a URL.\n */\nexport function querystring(querystringParams: {\n  [key: string]: string;\n}): string {\n  const params = [];\n  for (const [key, value] of Object.entries(querystringParams)) {\n    if (Array.isArray(value)) {\n      value.forEach(arrayVal => {\n        params.push(\n          encodeURIComponent(key) + '=' + encodeURIComponent(arrayVal)\n        );\n      });\n    } else {\n      params.push(encodeURIComponent(key) + '=' + encodeURIComponent(value));\n    }\n  }\n  return params.length ? '&' + params.join('&') : '';\n}\n\n/**\n * Decodes a querystring (e.g. ?arg=val&arg2=val2) into a params object\n * (e.g. {arg: 'val', arg2: 'val2'})\n */\nexport function querystringDecode(querystring: string): object {\n  const obj: { [key: string]: unknown } = {};\n  const tokens = querystring.replace(/^\\?/, '').split('&');\n\n  tokens.forEach(token => {\n    if (token) {\n      const key = token.split('=');\n      obj[key[0]] = key[1];\n    }\n  });\n  return obj;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from './assert';\n\n// Code originally came from goog.crypt.stringToUtf8ByteArray, but for some reason they\n// automatically replaced '\\r\\n' with '\\n', and they didn't handle surrogate pairs,\n// so it's been modified.\n\n// Note that not all Unicode characters appear as single characters in JavaScript strings.\n// fromCharCode returns the UTF-16 encoding of a character - so some Unicode characters\n// use 2 characters in Javascript.  All 4-byte UTF-8 characters begin with a first\n// character in the range 0xD800 - 0xDBFF (the first character of a so-called surrogate\n// pair).\n// See http://www.ecma-international.org/ecma-262/5.1/#sec-15.1.3\n\n/**\n * @param {string} str\n * @return {Array}\n */\nexport const stringToByteArray = function(str: string): number[] {\n  const out: number[] = [];\n  let p = 0;\n  for (let i = 0; i < str.length; i++) {\n    let c = str.charCodeAt(i);\n\n    // Is this the lead surrogate in a surrogate pair?\n    if (c >= 0xd800 && c <= 0xdbff) {\n      const high = c - 0xd800; // the high 10 bits.\n      i++;\n      assert(i < str.length, 'Surrogate pair missing trail surrogate.');\n      const low = str.charCodeAt(i) - 0xdc00; // the low 10 bits.\n      c = 0x10000 + (high << 10) + low;\n    }\n\n    if (c < 128) {\n      out[p++] = c;\n    } else if (c < 2048) {\n      out[p++] = (c >> 6) | 192;\n      out[p++] = (c & 63) | 128;\n    } else if (c < 65536) {\n      out[p++] = (c >> 12) | 224;\n      out[p++] = ((c >> 6) & 63) | 128;\n      out[p++] = (c & 63) | 128;\n    } else {\n      out[p++] = (c >> 18) | 240;\n      out[p++] = ((c >> 12) & 63) | 128;\n      out[p++] = ((c >> 6) & 63) | 128;\n      out[p++] = (c & 63) | 128;\n    }\n  }\n  return out;\n};\n\n/**\n * Calculate length without actually converting; useful for doing cheaper validation.\n * @param {string} str\n * @return {number}\n */\nexport const stringLength = function(str: string): number {\n  let p = 0;\n  for (let i = 0; i < str.length; i++) {\n    const c = str.charCodeAt(i);\n    if (c < 128) {\n      p++;\n    } else if (c < 2048) {\n      p += 2;\n    } else if (c >= 0xd800 && c <= 0xdbff) {\n      // Lead surrogate of a surrogate pair.  The pair together will take 4 bytes to represent.\n      p += 4;\n      i++; // skip trail surrogate.\n    } else {\n      p += 3;\n    }\n  }\n  return p;\n};\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","\"use strict\";\n\nexports.__esModule = true;\nexports.default = exports.EXITING = exports.ENTERED = exports.ENTERING = exports.EXITED = exports.UNMOUNTED = void 0;\n\nvar PropTypes = _interopRequireWildcard(require(\"prop-types\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactDom = _interopRequireDefault(require(\"react-dom\"));\n\nvar _reactLifecyclesCompat = require(\"react-lifecycles-compat\");\n\nvar _PropTypes = require(\"./utils/PropTypes\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nvar UNMOUNTED = 'unmounted';\nexports.UNMOUNTED = UNMOUNTED;\nvar EXITED = 'exited';\nexports.EXITED = EXITED;\nvar ENTERING = 'entering';\nexports.ENTERING = ENTERING;\nvar ENTERED = 'entered';\nexports.ENTERED = ENTERED;\nvar EXITING = 'exiting';\n/**\n * The Transition component lets you describe a transition from one component\n * state to another _over time_ with a simple declarative API. Most commonly\n * it's used to animate the mounting and unmounting of a component, but can also\n * be used to describe in-place transition states as well.\n *\n * By default the `Transition` component does not alter the behavior of the\n * component it renders, it only tracks \"enter\" and \"exit\" states for the components.\n * It's up to you to give meaning and effect to those states. For example we can\n * add styles to a component when it enters or exits:\n *\n * ```jsx\n * import Transition from 'react-transition-group/Transition';\n *\n * const duration = 300;\n *\n * const defaultStyle = {\n *   transition: `opacity ${duration}ms ease-in-out`,\n *   opacity: 0,\n * }\n *\n * const transitionStyles = {\n *   entering: { opacity: 0 },\n *   entered:  { opacity: 1 },\n * };\n *\n * const Fade = ({ in: inProp }) => (\n *   <Transition in={inProp} timeout={duration}>\n *     {(state) => (\n *       <div style={{\n *         ...defaultStyle,\n *         ...transitionStyles[state]\n *       }}>\n *         I'm a fade Transition!\n *       </div>\n *     )}\n *   </Transition>\n * );\n * ```\n *\n * As noted the `Transition` component doesn't _do_ anything by itself to its child component.\n * What it does do is track transition states over time so you can update the\n * component (such as by adding styles or classes) when it changes states.\n *\n * There are 4 main states a Transition can be in:\n *  - `'entering'`\n *  - `'entered'`\n *  - `'exiting'`\n *  - `'exited'`\n *\n * Transition state is toggled via the `in` prop. When `true` the component begins the\n * \"Enter\" stage. During this stage, the component will shift from its current transition state,\n * to `'entering'` for the duration of the transition and then to the `'entered'` stage once\n * it's complete. Let's take the following example:\n *\n * ```jsx\n * state = { in: false };\n *\n * toggleEnterState = () => {\n *   this.setState({ in: true });\n * }\n *\n * render() {\n *   return (\n *     <div>\n *       <Transition in={this.state.in} timeout={500} />\n *       <button onClick={this.toggleEnterState}>Click to Enter</button>\n *     </div>\n *   );\n * }\n * ```\n *\n * When the button is clicked the component will shift to the `'entering'` state and\n * stay there for 500ms (the value of `timeout`) before it finally switches to `'entered'`.\n *\n * When `in` is `false` the same thing happens except the state moves from `'exiting'` to `'exited'`.\n *\n * ## Timing\n *\n * Timing is often the trickiest part of animation, mistakes can result in slight delays\n * that are hard to pin down. A common example is when you want to add an exit transition,\n * you should set the desired final styles when the state is `'exiting'`. That's when the\n * transition to those styles will start and, if you matched the `timeout` prop with the\n * CSS Transition duration, it will end exactly when the state changes to `'exited'`.\n *\n * > **Note**: For simpler transitions the `Transition` component might be enough, but\n * > take into account that it's platform-agnostic, while the `CSSTransition` component\n * > [forces reflows](https://github.com/reactjs/react-transition-group/blob/5007303e729a74be66a21c3e2205e4916821524b/src/CSSTransition.js#L208-L215)\n * > in order to make more complex transitions more predictable. For example, even though\n * > classes `example-enter` and `example-enter-active` are applied immediately one after\n * > another, you can still transition from one to the other because of the forced reflow\n * > (read [this issue](https://github.com/reactjs/react-transition-group/issues/159#issuecomment-322761171)\n * > for more info). Take this into account when choosing between `Transition` and\n * > `CSSTransition`.\n */\n\nexports.EXITING = EXITING;\n\nvar Transition =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(Transition, _React$Component);\n\n  function Transition(props, context) {\n    var _this;\n\n    _this = _React$Component.call(this, props, context) || this;\n    var parentGroup = context.transitionGroup; // In the context of a TransitionGroup all enters are really appears\n\n    var appear = parentGroup && !parentGroup.isMounting ? props.enter : props.appear;\n    var initialStatus;\n    _this.appearStatus = null;\n\n    if (props.in) {\n      if (appear) {\n        initialStatus = EXITED;\n        _this.appearStatus = ENTERING;\n      } else {\n        initialStatus = ENTERED;\n      }\n    } else {\n      if (props.unmountOnExit || props.mountOnEnter) {\n        initialStatus = UNMOUNTED;\n      } else {\n        initialStatus = EXITED;\n      }\n    }\n\n    _this.state = {\n      status: initialStatus\n    };\n    _this.nextCallback = null;\n    return _this;\n  }\n\n  var _proto = Transition.prototype;\n\n  _proto.getChildContext = function getChildContext() {\n    return {\n      transitionGroup: null // allows for nested Transitions\n\n    };\n  };\n\n  Transition.getDerivedStateFromProps = function getDerivedStateFromProps(_ref, prevState) {\n    var nextIn = _ref.in;\n\n    if (nextIn && prevState.status === UNMOUNTED) {\n      return {\n        status: EXITED\n      };\n    }\n\n    return null;\n  }; // getSnapshotBeforeUpdate(prevProps) {\n  //   let nextStatus = null\n  //   if (prevProps !== this.props) {\n  //     const { status } = this.state\n  //     if (this.props.in) {\n  //       if (status !== ENTERING && status !== ENTERED) {\n  //         nextStatus = ENTERING\n  //       }\n  //     } else {\n  //       if (status === ENTERING || status === ENTERED) {\n  //         nextStatus = EXITING\n  //       }\n  //     }\n  //   }\n  //   return { nextStatus }\n  // }\n\n\n  _proto.componentDidMount = function componentDidMount() {\n    this.updateStatus(true, this.appearStatus);\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {\n    var nextStatus = null;\n\n    if (prevProps !== this.props) {\n      var status = this.state.status;\n\n      if (this.props.in) {\n        if (status !== ENTERING && status !== ENTERED) {\n          nextStatus = ENTERING;\n        }\n      } else {\n        if (status === ENTERING || status === ENTERED) {\n          nextStatus = EXITING;\n        }\n      }\n    }\n\n    this.updateStatus(false, nextStatus);\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    this.cancelNextCallback();\n  };\n\n  _proto.getTimeouts = function getTimeouts() {\n    var timeout = this.props.timeout;\n    var exit, enter, appear;\n    exit = enter = appear = timeout;\n\n    if (timeout != null && typeof timeout !== 'number') {\n      exit = timeout.exit;\n      enter = timeout.enter;\n      appear = timeout.appear;\n    }\n\n    return {\n      exit: exit,\n      enter: enter,\n      appear: appear\n    };\n  };\n\n  _proto.updateStatus = function updateStatus(mounting, nextStatus) {\n    if (mounting === void 0) {\n      mounting = false;\n    }\n\n    if (nextStatus !== null) {\n      // nextStatus will always be ENTERING or EXITING.\n      this.cancelNextCallback();\n\n      var node = _reactDom.default.findDOMNode(this);\n\n      if (nextStatus === ENTERING) {\n        this.performEnter(node, mounting);\n      } else {\n        this.performExit(node);\n      }\n    } else if (this.props.unmountOnExit && this.state.status === EXITED) {\n      this.setState({\n        status: UNMOUNTED\n      });\n    }\n  };\n\n  _proto.performEnter = function performEnter(node, mounting) {\n    var _this2 = this;\n\n    var enter = this.props.enter;\n    var appearing = this.context.transitionGroup ? this.context.transitionGroup.isMounting : mounting;\n    var timeouts = this.getTimeouts(); // no enter animation skip right to ENTERED\n    // if we are mounting and running this it means appear _must_ be set\n\n    if (!mounting && !enter) {\n      this.safeSetState({\n        status: ENTERED\n      }, function () {\n        _this2.props.onEntered(node);\n      });\n      return;\n    }\n\n    this.props.onEnter(node, appearing);\n    this.safeSetState({\n      status: ENTERING\n    }, function () {\n      _this2.props.onEntering(node, appearing); // FIXME: appear timeout?\n\n\n      _this2.onTransitionEnd(node, timeouts.enter, function () {\n        _this2.safeSetState({\n          status: ENTERED\n        }, function () {\n          _this2.props.onEntered(node, appearing);\n        });\n      });\n    });\n  };\n\n  _proto.performExit = function performExit(node) {\n    var _this3 = this;\n\n    var exit = this.props.exit;\n    var timeouts = this.getTimeouts(); // no exit animation skip right to EXITED\n\n    if (!exit) {\n      this.safeSetState({\n        status: EXITED\n      }, function () {\n        _this3.props.onExited(node);\n      });\n      return;\n    }\n\n    this.props.onExit(node);\n    this.safeSetState({\n      status: EXITING\n    }, function () {\n      _this3.props.onExiting(node);\n\n      _this3.onTransitionEnd(node, timeouts.exit, function () {\n        _this3.safeSetState({\n          status: EXITED\n        }, function () {\n          _this3.props.onExited(node);\n        });\n      });\n    });\n  };\n\n  _proto.cancelNextCallback = function cancelNextCallback() {\n    if (this.nextCallback !== null) {\n      this.nextCallback.cancel();\n      this.nextCallback = null;\n    }\n  };\n\n  _proto.safeSetState = function safeSetState(nextState, callback) {\n    // This shouldn't be necessary, but there are weird race conditions with\n    // setState callbacks and unmounting in testing, so always make sure that\n    // we can cancel any pending setState callbacks after we unmount.\n    callback = this.setNextCallback(callback);\n    this.setState(nextState, callback);\n  };\n\n  _proto.setNextCallback = function setNextCallback(callback) {\n    var _this4 = this;\n\n    var active = true;\n\n    this.nextCallback = function (event) {\n      if (active) {\n        active = false;\n        _this4.nextCallback = null;\n        callback(event);\n      }\n    };\n\n    this.nextCallback.cancel = function () {\n      active = false;\n    };\n\n    return this.nextCallback;\n  };\n\n  _proto.onTransitionEnd = function onTransitionEnd(node, timeout, handler) {\n    this.setNextCallback(handler);\n\n    if (node) {\n      if (this.props.addEndListener) {\n        this.props.addEndListener(node, this.nextCallback);\n      }\n\n      if (timeout != null) {\n        setTimeout(this.nextCallback, timeout);\n      }\n    } else {\n      setTimeout(this.nextCallback, 0);\n    }\n  };\n\n  _proto.render = function render() {\n    var status = this.state.status;\n\n    if (status === UNMOUNTED) {\n      return null;\n    }\n\n    var _this$props = this.props,\n        children = _this$props.children,\n        childProps = _objectWithoutPropertiesLoose(_this$props, [\"children\"]); // filter props for Transtition\n\n\n    delete childProps.in;\n    delete childProps.mountOnEnter;\n    delete childProps.unmountOnExit;\n    delete childProps.appear;\n    delete childProps.enter;\n    delete childProps.exit;\n    delete childProps.timeout;\n    delete childProps.addEndListener;\n    delete childProps.onEnter;\n    delete childProps.onEntering;\n    delete childProps.onEntered;\n    delete childProps.onExit;\n    delete childProps.onExiting;\n    delete childProps.onExited;\n\n    if (typeof children === 'function') {\n      return children(status, childProps);\n    }\n\n    var child = _react.default.Children.only(children);\n\n    return _react.default.cloneElement(child, childProps);\n  };\n\n  return Transition;\n}(_react.default.Component);\n\nTransition.contextTypes = {\n  transitionGroup: PropTypes.object\n};\nTransition.childContextTypes = {\n  transitionGroup: function transitionGroup() {}\n};\nTransition.propTypes = process.env.NODE_ENV !== \"production\" ? {\n  /**\n   * A `function` child can be used instead of a React element.\n   * This function is called with the current transition status\n   * ('entering', 'entered', 'exiting', 'exited', 'unmounted'), which can be used\n   * to apply context specific props to a component.\n   *\n   * ```jsx\n   * <Transition timeout={150}>\n   *   {(status) => (\n   *     <MyComponent className={`fade fade-${status}`} />\n   *   )}\n   * </Transition>\n   * ```\n   */\n  children: PropTypes.oneOfType([PropTypes.func.isRequired, PropTypes.element.isRequired]).isRequired,\n\n  /**\n   * Show the component; triggers the enter or exit states\n   */\n  in: PropTypes.bool,\n\n  /**\n   * By default the child component is mounted immediately along with\n   * the parent `Transition` component. If you want to \"lazy mount\" the component on the\n   * first `in={true}` you can set `mountOnEnter`. After the first enter transition the component will stay\n   * mounted, even on \"exited\", unless you also specify `unmountOnExit`.\n   */\n  mountOnEnter: PropTypes.bool,\n\n  /**\n   * By default the child component stays mounted after it reaches the `'exited'` state.\n   * Set `unmountOnExit` if you'd prefer to unmount the component after it finishes exiting.\n   */\n  unmountOnExit: PropTypes.bool,\n\n  /**\n   * Normally a component is not transitioned if it is shown when the `<Transition>` component mounts.\n   * If you want to transition on the first mount set `appear` to `true`, and the\n   * component will transition in as soon as the `<Transition>` mounts.\n   *\n   * > Note: there are no specific \"appear\" states. `appear` only adds an additional `enter` transition.\n   */\n  appear: PropTypes.bool,\n\n  /**\n   * Enable or disable enter transitions.\n   */\n  enter: PropTypes.bool,\n\n  /**\n   * Enable or disable exit transitions.\n   */\n  exit: PropTypes.bool,\n\n  /**\n   * The duration of the transition, in milliseconds.\n   * Required unless `addEndListener` is provided\n   *\n   * You may specify a single timeout for all transitions like: `timeout={500}`,\n   * or individually like:\n   *\n   * ```jsx\n   * timeout={{\n   *  enter: 300,\n   *  exit: 500,\n   * }}\n   * ```\n   *\n   * @type {number | { enter?: number, exit?: number }}\n   */\n  timeout: function timeout(props) {\n    var pt = process.env.NODE_ENV !== \"production\" ? _PropTypes.timeoutsShape : {};;\n    if (!props.addEndListener) pt = pt.isRequired;\n\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    return pt.apply(void 0, [props].concat(args));\n  },\n\n  /**\n   * Add a custom transition end trigger. Called with the transitioning\n   * DOM node and a `done` callback. Allows for more fine grained transition end\n   * logic. **Note:** Timeouts are still used as a fallback if provided.\n   *\n   * ```jsx\n   * addEndListener={(node, done) => {\n   *   // use the css transitionend event to mark the finish of a transition\n   *   node.addEventListener('transitionend', done, false);\n   * }}\n   * ```\n   */\n  addEndListener: PropTypes.func,\n\n  /**\n   * Callback fired before the \"entering\" status is applied. An extra parameter\n   * `isAppearing` is supplied to indicate if the enter stage is occurring on the initial mount\n   *\n   * @type Function(node: HtmlElement, isAppearing: bool) -> void\n   */\n  onEnter: PropTypes.func,\n\n  /**\n   * Callback fired after the \"entering\" status is applied. An extra parameter\n   * `isAppearing` is supplied to indicate if the enter stage is occurring on the initial mount\n   *\n   * @type Function(node: HtmlElement, isAppearing: bool)\n   */\n  onEntering: PropTypes.func,\n\n  /**\n   * Callback fired after the \"entered\" status is applied. An extra parameter\n   * `isAppearing` is supplied to indicate if the enter stage is occurring on the initial mount\n   *\n   * @type Function(node: HtmlElement, isAppearing: bool) -> void\n   */\n  onEntered: PropTypes.func,\n\n  /**\n   * Callback fired before the \"exiting\" status is applied.\n   *\n   * @type Function(node: HtmlElement) -> void\n   */\n  onExit: PropTypes.func,\n\n  /**\n   * Callback fired after the \"exiting\" status is applied.\n   *\n   * @type Function(node: HtmlElement) -> void\n   */\n  onExiting: PropTypes.func,\n\n  /**\n   * Callback fired after the \"exited\" status is applied.\n   *\n   * @type Function(node: HtmlElement) -> void\n   */\n  onExited: PropTypes.func // Name the function so it is clearer in the documentation\n\n} : {};\n\nfunction noop() {}\n\nTransition.defaultProps = {\n  in: false,\n  mountOnEnter: false,\n  unmountOnExit: false,\n  appear: false,\n  enter: true,\n  exit: true,\n  onEnter: noop,\n  onEntering: noop,\n  onEntered: noop,\n  onExit: noop,\n  onExiting: noop,\n  onExited: noop\n};\nTransition.UNMOUNTED = 0;\nTransition.EXITED = 1;\nTransition.ENTERING = 2;\nTransition.ENTERED = 3;\nTransition.EXITING = 4;\n\nvar _default = (0, _reactLifecyclesCompat.polyfill)(Transition);\n\nexports.default = _default;","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nfunction componentWillMount() {\n  // Call this.constructor.gDSFP to support sub-classes.\n  var state = this.constructor.getDerivedStateFromProps(this.props, this.state);\n  if (state !== null && state !== undefined) {\n    this.setState(state);\n  }\n}\n\nfunction componentWillReceiveProps(nextProps) {\n  // Call this.constructor.gDSFP to support sub-classes.\n  // Use the setState() updater to ensure state isn't stale in certain edge cases.\n  function updater(prevState) {\n    var state = this.constructor.getDerivedStateFromProps(nextProps, prevState);\n    return state !== null && state !== undefined ? state : null;\n  }\n  // Binding \"this\" is important for shallow renderer support.\n  this.setState(updater.bind(this));\n}\n\nfunction componentWillUpdate(nextProps, nextState) {\n  try {\n    var prevProps = this.props;\n    var prevState = this.state;\n    this.props = nextProps;\n    this.state = nextState;\n    this.__reactInternalSnapshotFlag = true;\n    this.__reactInternalSnapshot = this.getSnapshotBeforeUpdate(\n      prevProps,\n      prevState\n    );\n  } finally {\n    this.props = prevProps;\n    this.state = prevState;\n  }\n}\n\n// React may warn about cWM/cWRP/cWU methods being deprecated.\n// Add a flag to suppress these warnings for this special case.\ncomponentWillMount.__suppressDeprecationWarning = true;\ncomponentWillReceiveProps.__suppressDeprecationWarning = true;\ncomponentWillUpdate.__suppressDeprecationWarning = true;\n\nfunction polyfill(Component) {\n  var prototype = Component.prototype;\n\n  if (!prototype || !prototype.isReactComponent) {\n    throw new Error('Can only polyfill class components');\n  }\n\n  if (\n    typeof Component.getDerivedStateFromProps !== 'function' &&\n    typeof prototype.getSnapshotBeforeUpdate !== 'function'\n  ) {\n    return Component;\n  }\n\n  // If new component APIs are defined, \"unsafe\" lifecycles won't be called.\n  // Error if any of these lifecycles are present,\n  // Because they would work differently between older and newer (16.3+) versions of React.\n  var foundWillMountName = null;\n  var foundWillReceivePropsName = null;\n  var foundWillUpdateName = null;\n  if (typeof prototype.componentWillMount === 'function') {\n    foundWillMountName = 'componentWillMount';\n  } else if (typeof prototype.UNSAFE_componentWillMount === 'function') {\n    foundWillMountName = 'UNSAFE_componentWillMount';\n  }\n  if (typeof prototype.componentWillReceiveProps === 'function') {\n    foundWillReceivePropsName = 'componentWillReceiveProps';\n  } else if (typeof prototype.UNSAFE_componentWillReceiveProps === 'function') {\n    foundWillReceivePropsName = 'UNSAFE_componentWillReceiveProps';\n  }\n  if (typeof prototype.componentWillUpdate === 'function') {\n    foundWillUpdateName = 'componentWillUpdate';\n  } else if (typeof prototype.UNSAFE_componentWillUpdate === 'function') {\n    foundWillUpdateName = 'UNSAFE_componentWillUpdate';\n  }\n  if (\n    foundWillMountName !== null ||\n    foundWillReceivePropsName !== null ||\n    foundWillUpdateName !== null\n  ) {\n    var componentName = Component.displayName || Component.name;\n    var newApiName =\n      typeof Component.getDerivedStateFromProps === 'function'\n        ? 'getDerivedStateFromProps()'\n        : 'getSnapshotBeforeUpdate()';\n\n    throw Error(\n      'Unsafe legacy lifecycles will not be called for components using new component APIs.\\n\\n' +\n        componentName +\n        ' uses ' +\n        newApiName +\n        ' but also contains the following legacy lifecycles:' +\n        (foundWillMountName !== null ? '\\n  ' + foundWillMountName : '') +\n        (foundWillReceivePropsName !== null\n          ? '\\n  ' + foundWillReceivePropsName\n          : '') +\n        (foundWillUpdateName !== null ? '\\n  ' + foundWillUpdateName : '') +\n        '\\n\\nThe above lifecycles should be removed. Learn more about this warning here:\\n' +\n        'https://fb.me/react-async-component-lifecycle-hooks'\n    );\n  }\n\n  // React <= 16.2 does not support static getDerivedStateFromProps.\n  // As a workaround, use cWM and cWRP to invoke the new static lifecycle.\n  // Newer versions of React will ignore these lifecycles if gDSFP exists.\n  if (typeof Component.getDerivedStateFromProps === 'function') {\n    prototype.componentWillMount = componentWillMount;\n    prototype.componentWillReceiveProps = componentWillReceiveProps;\n  }\n\n  // React <= 16.2 does not support getSnapshotBeforeUpdate.\n  // As a workaround, use cWU to invoke the new lifecycle.\n  // Newer versions of React will ignore that lifecycle if gSBU exists.\n  if (typeof prototype.getSnapshotBeforeUpdate === 'function') {\n    if (typeof prototype.componentDidUpdate !== 'function') {\n      throw new Error(\n        'Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype'\n      );\n    }\n\n    prototype.componentWillUpdate = componentWillUpdate;\n\n    var componentDidUpdate = prototype.componentDidUpdate;\n\n    prototype.componentDidUpdate = function componentDidUpdatePolyfill(\n      prevProps,\n      prevState,\n      maybeSnapshot\n    ) {\n      // 16.3+ will not execute our will-update method;\n      // It will pass a snapshot value to did-update though.\n      // Older versions will require our polyfilled will-update value.\n      // We need to handle both cases, but can't just check for the presence of \"maybeSnapshot\",\n      // Because for <= 15.x versions this might be a \"prevContext\" object.\n      // We also can't just check \"__reactInternalSnapshot\",\n      // Because get-snapshot might return a falsy value.\n      // So check for the explicit __reactInternalSnapshotFlag flag to determine behavior.\n      var snapshot = this.__reactInternalSnapshotFlag\n        ? this.__reactInternalSnapshot\n        : maybeSnapshot;\n\n      componentDidUpdate.call(this, prevProps, prevState, snapshot);\n    };\n  }\n\n  return Component;\n}\n\nexport { polyfill };\n","\"use strict\";\n\nexports.__esModule = true;\nexports.transitionTimeout = transitionTimeout;\nexports.classNamesShape = exports.timeoutsShape = void 0;\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction transitionTimeout(transitionType) {\n  var timeoutPropName = 'transition' + transitionType + 'Timeout';\n  var enabledPropName = 'transition' + transitionType;\n  return function (props) {\n    // If the transition is enabled\n    if (props[enabledPropName]) {\n      // If no timeout duration is provided\n      if (props[timeoutPropName] == null) {\n        return new Error(timeoutPropName + ' wasn\\'t supplied to CSSTransitionGroup: ' + 'this can cause unreliable animations and won\\'t be supported in ' + 'a future version of React. See ' + 'https://fb.me/react-animation-transition-group-timeout for more ' + 'information.'); // If the duration isn't a number\n      } else if (typeof props[timeoutPropName] !== 'number') {\n        return new Error(timeoutPropName + ' must be a number (in milliseconds)');\n      }\n    }\n\n    return null;\n  };\n}\n\nvar timeoutsShape = _propTypes.default.oneOfType([_propTypes.default.number, _propTypes.default.shape({\n  enter: _propTypes.default.number,\n  exit: _propTypes.default.number\n}).isRequired]);\n\nexports.timeoutsShape = timeoutsShape;\n\nvar classNamesShape = _propTypes.default.oneOfType([_propTypes.default.string, _propTypes.default.shape({\n  enter: _propTypes.default.string,\n  exit: _propTypes.default.string,\n  active: _propTypes.default.string\n}), _propTypes.default.shape({\n  enter: _propTypes.default.string,\n  enterDone: _propTypes.default.string,\n  enterActive: _propTypes.default.string,\n  exit: _propTypes.default.string,\n  exitDone: _propTypes.default.string,\n  exitActive: _propTypes.default.string\n})]);\n\nexports.classNamesShape = classNamesShape;","\"use strict\";\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactLifecyclesCompat = require(\"react-lifecycles-compat\");\n\nvar _ChildMapping = require(\"./utils/ChildMapping\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nvar values = Object.values || function (obj) {\n  return Object.keys(obj).map(function (k) {\n    return obj[k];\n  });\n};\n\nvar propTypes = process.env.NODE_ENV !== \"production\" ? {\n  /**\n   * `<TransitionGroup>` renders a `<div>` by default. You can change this\n   * behavior by providing a `component` prop.\n   * If you use React v16+ and would like to avoid a wrapping `<div>` element\n   * you can pass in `component={null}`. This is useful if the wrapping div\n   * borks your css styles.\n   */\n  component: _propTypes.default.any,\n\n  /**\n   * A set of `<Transition>` components, that are toggled `in` and out as they\n   * leave. the `<TransitionGroup>` will inject specific transition props, so\n   * remember to spread them through if you are wrapping the `<Transition>` as\n   * with our `<Fade>` example.\n   */\n  children: _propTypes.default.node,\n\n  /**\n   * A convenience prop that enables or disables appear animations\n   * for all children. Note that specifying this will override any defaults set\n   * on individual children Transitions.\n   */\n  appear: _propTypes.default.bool,\n\n  /**\n   * A convenience prop that enables or disables enter animations\n   * for all children. Note that specifying this will override any defaults set\n   * on individual children Transitions.\n   */\n  enter: _propTypes.default.bool,\n\n  /**\n   * A convenience prop that enables or disables exit animations\n   * for all children. Note that specifying this will override any defaults set\n   * on individual children Transitions.\n   */\n  exit: _propTypes.default.bool,\n\n  /**\n   * You may need to apply reactive updates to a child as it is exiting.\n   * This is generally done by using `cloneElement` however in the case of an exiting\n   * child the element has already been removed and not accessible to the consumer.\n   *\n   * If you do need to update a child as it leaves you can provide a `childFactory`\n   * to wrap every child, even the ones that are leaving.\n   *\n   * @type Function(child: ReactElement) -> ReactElement\n   */\n  childFactory: _propTypes.default.func\n} : {};;\nvar defaultProps = {\n  component: 'div',\n  childFactory: function childFactory(child) {\n    return child;\n  }\n  /**\n   * The `<TransitionGroup>` component manages a set of transition components\n   * (`<Transition>` and `<CSSTransition>`) in a list. Like with the transition\n   * components, `<TransitionGroup>` is a state machine for managing the mounting\n   * and unmounting of components over time.\n   *\n   * Consider the example below. As items are removed or added to the TodoList the\n   * `in` prop is toggled automatically by the `<TransitionGroup>`.\n   *\n   * Note that `<TransitionGroup>`  does not define any animation behavior!\n   * Exactly _how_ a list item animates is up to the individual transition\n   * component. This means you can mix and match animations across different list\n   * items.\n   */\n\n};\n\nvar TransitionGroup =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(TransitionGroup, _React$Component);\n\n  function TransitionGroup(props, context) {\n    var _this;\n\n    _this = _React$Component.call(this, props, context) || this;\n\n    var handleExited = _this.handleExited.bind(_assertThisInitialized(_assertThisInitialized(_this))); // Initial children should all be entering, dependent on appear\n\n\n    _this.state = {\n      handleExited: handleExited,\n      firstRender: true\n    };\n    return _this;\n  }\n\n  var _proto = TransitionGroup.prototype;\n\n  _proto.getChildContext = function getChildContext() {\n    return {\n      transitionGroup: {\n        isMounting: !this.appeared\n      }\n    };\n  };\n\n  _proto.componentDidMount = function componentDidMount() {\n    this.appeared = true;\n    this.mounted = true;\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    this.mounted = false;\n  };\n\n  TransitionGroup.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, _ref) {\n    var prevChildMapping = _ref.children,\n        handleExited = _ref.handleExited,\n        firstRender = _ref.firstRender;\n    return {\n      children: firstRender ? (0, _ChildMapping.getInitialChildMapping)(nextProps, handleExited) : (0, _ChildMapping.getNextChildMapping)(nextProps, prevChildMapping, handleExited),\n      firstRender: false\n    };\n  };\n\n  _proto.handleExited = function handleExited(child, node) {\n    var currentChildMapping = (0, _ChildMapping.getChildMapping)(this.props.children);\n    if (child.key in currentChildMapping) return;\n\n    if (child.props.onExited) {\n      child.props.onExited(node);\n    }\n\n    if (this.mounted) {\n      this.setState(function (state) {\n        var children = _extends({}, state.children);\n\n        delete children[child.key];\n        return {\n          children: children\n        };\n      });\n    }\n  };\n\n  _proto.render = function render() {\n    var _this$props = this.props,\n        Component = _this$props.component,\n        childFactory = _this$props.childFactory,\n        props = _objectWithoutPropertiesLoose(_this$props, [\"component\", \"childFactory\"]);\n\n    var children = values(this.state.children).map(childFactory);\n    delete props.appear;\n    delete props.enter;\n    delete props.exit;\n\n    if (Component === null) {\n      return children;\n    }\n\n    return _react.default.createElement(Component, props, children);\n  };\n\n  return TransitionGroup;\n}(_react.default.Component);\n\nTransitionGroup.childContextTypes = {\n  transitionGroup: _propTypes.default.object.isRequired\n};\nTransitionGroup.propTypes = process.env.NODE_ENV !== \"production\" ? propTypes : {};\nTransitionGroup.defaultProps = defaultProps;\n\nvar _default = (0, _reactLifecyclesCompat.polyfill)(TransitionGroup);\n\nexports.default = _default;\nmodule.exports = exports[\"default\"];","module.exports = require('./dist/bundle.js');\n\n","var isarray = require('isarray')\n\n/**\n * Expose `pathToRegexp`.\n */\nmodule.exports = pathToRegexp\nmodule.exports.parse = parse\nmodule.exports.compile = compile\nmodule.exports.tokensToFunction = tokensToFunction\nmodule.exports.tokensToRegExp = tokensToRegExp\n\n/**\n * The main path matching regexp utility.\n *\n * @type {RegExp}\n */\nvar PATH_REGEXP = new RegExp([\n  // Match escaped characters that would otherwise appear in future matches.\n  // This allows the user to escape special characters that won't transform.\n  '(\\\\\\\\.)',\n  // Match Express-style parameters and un-named parameters with a prefix\n  // and optional suffixes. Matches appear as:\n  //\n  // \"/:test(\\\\d+)?\" => [\"/\", \"test\", \"\\d+\", undefined, \"?\", undefined]\n  // \"/route(\\\\d+)\"  => [undefined, undefined, undefined, \"\\d+\", undefined, undefined]\n  // \"/*\"            => [\"/\", undefined, undefined, undefined, undefined, \"*\"]\n  '([\\\\/.])?(?:(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))([+*?])?|(\\\\*))'\n].join('|'), 'g')\n\n/**\n * Parse a string for the raw tokens.\n *\n * @param  {string}  str\n * @param  {Object=} options\n * @return {!Array}\n */\nfunction parse (str, options) {\n  var tokens = []\n  var key = 0\n  var index = 0\n  var path = ''\n  var defaultDelimiter = options && options.delimiter || '/'\n  var res\n\n  while ((res = PATH_REGEXP.exec(str)) != null) {\n    var m = res[0]\n    var escaped = res[1]\n    var offset = res.index\n    path += str.slice(index, offset)\n    index = offset + m.length\n\n    // Ignore already escaped sequences.\n    if (escaped) {\n      path += escaped[1]\n      continue\n    }\n\n    var next = str[index]\n    var prefix = res[2]\n    var name = res[3]\n    var capture = res[4]\n    var group = res[5]\n    var modifier = res[6]\n    var asterisk = res[7]\n\n    // Push the current path onto the tokens.\n    if (path) {\n      tokens.push(path)\n      path = ''\n    }\n\n    var partial = prefix != null && next != null && next !== prefix\n    var repeat = modifier === '+' || modifier === '*'\n    var optional = modifier === '?' || modifier === '*'\n    var delimiter = res[2] || defaultDelimiter\n    var pattern = capture || group\n\n    tokens.push({\n      name: name || key++,\n      prefix: prefix || '',\n      delimiter: delimiter,\n      optional: optional,\n      repeat: repeat,\n      partial: partial,\n      asterisk: !!asterisk,\n      pattern: pattern ? escapeGroup(pattern) : (asterisk ? '.*' : '[^' + escapeString(delimiter) + ']+?')\n    })\n  }\n\n  // Match any characters still remaining.\n  if (index < str.length) {\n    path += str.substr(index)\n  }\n\n  // If the path exists, push it onto the end.\n  if (path) {\n    tokens.push(path)\n  }\n\n  return tokens\n}\n\n/**\n * Compile a string to a template function for the path.\n *\n * @param  {string}             str\n * @param  {Object=}            options\n * @return {!function(Object=, Object=)}\n */\nfunction compile (str, options) {\n  return tokensToFunction(parse(str, options))\n}\n\n/**\n * Prettier encoding of URI path segments.\n *\n * @param  {string}\n * @return {string}\n */\nfunction encodeURIComponentPretty (str) {\n  return encodeURI(str).replace(/[\\/?#]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase()\n  })\n}\n\n/**\n * Encode the asterisk parameter. Similar to `pretty`, but allows slashes.\n *\n * @param  {string}\n * @return {string}\n */\nfunction encodeAsterisk (str) {\n  return encodeURI(str).replace(/[?#]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase()\n  })\n}\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nfunction tokensToFunction (tokens) {\n  // Compile all the tokens into regexps.\n  var matches = new Array(tokens.length)\n\n  // Compile all the patterns before compilation.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'object') {\n      matches[i] = new RegExp('^(?:' + tokens[i].pattern + ')$')\n    }\n  }\n\n  return function (obj, opts) {\n    var path = ''\n    var data = obj || {}\n    var options = opts || {}\n    var encode = options.pretty ? encodeURIComponentPretty : encodeURIComponent\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i]\n\n      if (typeof token === 'string') {\n        path += token\n\n        continue\n      }\n\n      var value = data[token.name]\n      var segment\n\n      if (value == null) {\n        if (token.optional) {\n          // Prepend partial segment prefixes.\n          if (token.partial) {\n            path += token.prefix\n          }\n\n          continue\n        } else {\n          throw new TypeError('Expected \"' + token.name + '\" to be defined')\n        }\n      }\n\n      if (isarray(value)) {\n        if (!token.repeat) {\n          throw new TypeError('Expected \"' + token.name + '\" to not repeat, but received `' + JSON.stringify(value) + '`')\n        }\n\n        if (value.length === 0) {\n          if (token.optional) {\n            continue\n          } else {\n            throw new TypeError('Expected \"' + token.name + '\" to not be empty')\n          }\n        }\n\n        for (var j = 0; j < value.length; j++) {\n          segment = encode(value[j])\n\n          if (!matches[i].test(segment)) {\n            throw new TypeError('Expected all \"' + token.name + '\" to match \"' + token.pattern + '\", but received `' + JSON.stringify(segment) + '`')\n          }\n\n          path += (j === 0 ? token.prefix : token.delimiter) + segment\n        }\n\n        continue\n      }\n\n      segment = token.asterisk ? encodeAsterisk(value) : encode(value)\n\n      if (!matches[i].test(segment)) {\n        throw new TypeError('Expected \"' + token.name + '\" to match \"' + token.pattern + '\", but received \"' + segment + '\"')\n      }\n\n      path += token.prefix + segment\n    }\n\n    return path\n  }\n}\n\n/**\n * Escape a regular expression string.\n *\n * @param  {string} str\n * @return {string}\n */\nfunction escapeString (str) {\n  return str.replace(/([.+*?=^!:${}()[\\]|\\/\\\\])/g, '\\\\$1')\n}\n\n/**\n * Escape the capturing group by escaping special characters and meaning.\n *\n * @param  {string} group\n * @return {string}\n */\nfunction escapeGroup (group) {\n  return group.replace(/([=!:$\\/()])/g, '\\\\$1')\n}\n\n/**\n * Attach the keys as a property of the regexp.\n *\n * @param  {!RegExp} re\n * @param  {Array}   keys\n * @return {!RegExp}\n */\nfunction attachKeys (re, keys) {\n  re.keys = keys\n  return re\n}\n\n/**\n * Get the flags for a regexp from the options.\n *\n * @param  {Object} options\n * @return {string}\n */\nfunction flags (options) {\n  return options.sensitive ? '' : 'i'\n}\n\n/**\n * Pull out keys from a regexp.\n *\n * @param  {!RegExp} path\n * @param  {!Array}  keys\n * @return {!RegExp}\n */\nfunction regexpToRegexp (path, keys) {\n  // Use a negative lookahead to match only capturing groups.\n  var groups = path.source.match(/\\((?!\\?)/g)\n\n  if (groups) {\n    for (var i = 0; i < groups.length; i++) {\n      keys.push({\n        name: i,\n        prefix: null,\n        delimiter: null,\n        optional: false,\n        repeat: false,\n        partial: false,\n        asterisk: false,\n        pattern: null\n      })\n    }\n  }\n\n  return attachKeys(path, keys)\n}\n\n/**\n * Transform an array into a regexp.\n *\n * @param  {!Array}  path\n * @param  {Array}   keys\n * @param  {!Object} options\n * @return {!RegExp}\n */\nfunction arrayToRegexp (path, keys, options) {\n  var parts = []\n\n  for (var i = 0; i < path.length; i++) {\n    parts.push(pathToRegexp(path[i], keys, options).source)\n  }\n\n  var regexp = new RegExp('(?:' + parts.join('|') + ')', flags(options))\n\n  return attachKeys(regexp, keys)\n}\n\n/**\n * Create a path regexp from string input.\n *\n * @param  {string}  path\n * @param  {!Array}  keys\n * @param  {!Object} options\n * @return {!RegExp}\n */\nfunction stringToRegexp (path, keys, options) {\n  return tokensToRegExp(parse(path, options), keys, options)\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n *\n * @param  {!Array}          tokens\n * @param  {(Array|Object)=} keys\n * @param  {Object=}         options\n * @return {!RegExp}\n */\nfunction tokensToRegExp (tokens, keys, options) {\n  if (!isarray(keys)) {\n    options = /** @type {!Object} */ (keys || options)\n    keys = []\n  }\n\n  options = options || {}\n\n  var strict = options.strict\n  var end = options.end !== false\n  var route = ''\n\n  // Iterate over the tokens and create our regexp string.\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n\n    if (typeof token === 'string') {\n      route += escapeString(token)\n    } else {\n      var prefix = escapeString(token.prefix)\n      var capture = '(?:' + token.pattern + ')'\n\n      keys.push(token)\n\n      if (token.repeat) {\n        capture += '(?:' + prefix + capture + ')*'\n      }\n\n      if (token.optional) {\n        if (!token.partial) {\n          capture = '(?:' + prefix + '(' + capture + '))?'\n        } else {\n          capture = prefix + '(' + capture + ')?'\n        }\n      } else {\n        capture = prefix + '(' + capture + ')'\n      }\n\n      route += capture\n    }\n  }\n\n  var delimiter = escapeString(options.delimiter || '/')\n  var endsWithDelimiter = route.slice(-delimiter.length) === delimiter\n\n  // In non-strict mode we allow a slash at the end of match. If the path to\n  // match already ends with a slash, we remove it for consistency. The slash\n  // is valid at the end of a path match, not in the middle. This is important\n  // in non-ending mode, where \"/test/\" shouldn't match \"/test//route\".\n  if (!strict) {\n    route = (endsWithDelimiter ? route.slice(0, -delimiter.length) : route) + '(?:' + delimiter + '(?=$))?'\n  }\n\n  if (end) {\n    route += '$'\n  } else {\n    // In non-ending mode, we need the capturing groups to match as much as\n    // possible by using a positive lookahead to the end or next path segment.\n    route += strict && endsWithDelimiter ? '' : '(?=' + delimiter + '|$)'\n  }\n\n  return attachKeys(new RegExp('^' + route, flags(options)), keys)\n}\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n *\n * @param  {(string|RegExp|Array)} path\n * @param  {(Array|Object)=}       keys\n * @param  {Object=}               options\n * @return {!RegExp}\n */\nfunction pathToRegexp (path, keys, options) {\n  if (!isarray(keys)) {\n    options = /** @type {!Object} */ (keys || options)\n    keys = []\n  }\n\n  options = options || {}\n\n  if (path instanceof RegExp) {\n    return regexpToRegexp(path, /** @type {!Array} */ (keys))\n  }\n\n  if (isarray(path)) {\n    return arrayToRegexp(/** @type {!Array} */ (path), /** @type {!Array} */ (keys), options)\n  }\n\n  return stringToRegexp(/** @type {string} */ (path), /** @type {!Array} */ (keys), options)\n}\n","/** @license React v16.6.1\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';var k=require(\"object-assign\"),n=\"function\"===typeof Symbol&&Symbol.for,p=n?Symbol.for(\"react.element\"):60103,q=n?Symbol.for(\"react.portal\"):60106,r=n?Symbol.for(\"react.fragment\"):60107,t=n?Symbol.for(\"react.strict_mode\"):60108,u=n?Symbol.for(\"react.profiler\"):60114,v=n?Symbol.for(\"react.provider\"):60109,w=n?Symbol.for(\"react.context\"):60110,x=n?Symbol.for(\"react.concurrent_mode\"):60111,y=n?Symbol.for(\"react.forward_ref\"):60112,z=n?Symbol.for(\"react.suspense\"):60113,A=n?Symbol.for(\"react.memo\"):\n60115,B=n?Symbol.for(\"react.lazy\"):60116,C=\"function\"===typeof Symbol&&Symbol.iterator;function aa(a,b,e,c,d,g,h,f){if(!a){a=void 0;if(void 0===b)a=Error(\"Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.\");else{var l=[e,c,d,g,h,f],m=0;a=Error(b.replace(/%s/g,function(){return l[m++]}));a.name=\"Invariant Violation\"}a.framesToPop=1;throw a;}}\nfunction D(a){for(var b=arguments.length-1,e=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,c=0;c<b;c++)e+=\"&args[]=\"+encodeURIComponent(arguments[c+1]);aa(!1,\"Minified React error #\"+a+\"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. \",e)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F={};\nfunction G(a,b,e){this.props=a;this.context=b;this.refs=F;this.updater=e||E}G.prototype.isReactComponent={};G.prototype.setState=function(a,b){\"object\"!==typeof a&&\"function\"!==typeof a&&null!=a?D(\"85\"):void 0;this.updater.enqueueSetState(this,a,b,\"setState\")};G.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,\"forceUpdate\")};function H(){}H.prototype=G.prototype;function I(a,b,e){this.props=a;this.context=b;this.refs=F;this.updater=e||E}var J=I.prototype=new H;\nJ.constructor=I;k(J,G.prototype);J.isPureReactComponent=!0;var K={current:null,currentDispatcher:null},L=Object.prototype.hasOwnProperty,M={key:!0,ref:!0,__self:!0,__source:!0};\nfunction N(a,b,e){var c=void 0,d={},g=null,h=null;if(null!=b)for(c in void 0!==b.ref&&(h=b.ref),void 0!==b.key&&(g=\"\"+b.key),b)L.call(b,c)&&!M.hasOwnProperty(c)&&(d[c]=b[c]);var f=arguments.length-2;if(1===f)d.children=e;else if(1<f){for(var l=Array(f),m=0;m<f;m++)l[m]=arguments[m+2];d.children=l}if(a&&a.defaultProps)for(c in f=a.defaultProps,f)void 0===d[c]&&(d[c]=f[c]);return{$$typeof:p,type:a,key:g,ref:h,props:d,_owner:K.current}}\nfunction ba(a,b){return{$$typeof:p,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function O(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===p}function escape(a){var b={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+(\"\"+a).replace(/[=:]/g,function(a){return b[a]})}var P=/\\/+/g,Q=[];function R(a,b,e,c){if(Q.length){var d=Q.pop();d.result=a;d.keyPrefix=b;d.func=e;d.context=c;d.count=0;return d}return{result:a,keyPrefix:b,func:e,context:c,count:0}}\nfunction S(a){a.result=null;a.keyPrefix=null;a.func=null;a.context=null;a.count=0;10>Q.length&&Q.push(a)}\nfunction T(a,b,e,c){var d=typeof a;if(\"undefined\"===d||\"boolean\"===d)a=null;var g=!1;if(null===a)g=!0;else switch(d){case \"string\":case \"number\":g=!0;break;case \"object\":switch(a.$$typeof){case p:case q:g=!0}}if(g)return e(c,a,\"\"===b?\".\"+U(a,0):b),1;g=0;b=\"\"===b?\".\":b+\":\";if(Array.isArray(a))for(var h=0;h<a.length;h++){d=a[h];var f=b+U(d,h);g+=T(d,f,e,c)}else if(null===a||\"object\"!==typeof a?f=null:(f=C&&a[C]||a[\"@@iterator\"],f=\"function\"===typeof f?f:null),\"function\"===typeof f)for(a=f.call(a),h=\n0;!(d=a.next()).done;)d=d.value,f=b+U(d,h++),g+=T(d,f,e,c);else\"object\"===d&&(e=\"\"+a,D(\"31\",\"[object Object]\"===e?\"object with keys {\"+Object.keys(a).join(\", \")+\"}\":e,\"\"));return g}function V(a,b,e){return null==a?0:T(a,\"\",b,e)}function U(a,b){return\"object\"===typeof a&&null!==a&&null!=a.key?escape(a.key):b.toString(36)}function ca(a,b){a.func.call(a.context,b,a.count++)}\nfunction da(a,b,e){var c=a.result,d=a.keyPrefix;a=a.func.call(a.context,b,a.count++);Array.isArray(a)?W(a,c,e,function(a){return a}):null!=a&&(O(a)&&(a=ba(a,d+(!a.key||b&&b.key===a.key?\"\":(\"\"+a.key).replace(P,\"$&/\")+\"/\")+e)),c.push(a))}function W(a,b,e,c,d){var g=\"\";null!=e&&(g=(\"\"+e).replace(P,\"$&/\")+\"/\");b=R(b,g,c,d);V(a,da,b);S(b)}\nvar X={Children:{map:function(a,b,e){if(null==a)return a;var c=[];W(a,c,null,b,e);return c},forEach:function(a,b,e){if(null==a)return a;b=R(null,null,b,e);V(a,ca,b);S(b)},count:function(a){return V(a,function(){return null},null)},toArray:function(a){var b=[];W(a,b,null,function(a){return a});return b},only:function(a){O(a)?void 0:D(\"143\");return a}},createRef:function(){return{current:null}},Component:G,PureComponent:I,createContext:function(a,b){void 0===b&&(b=null);a={$$typeof:w,_calculateChangedBits:b,\n_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:v,_context:a};return a.Consumer=a},forwardRef:function(a){return{$$typeof:y,render:a}},lazy:function(a){return{$$typeof:B,_ctor:a,_status:-1,_result:null}},memo:function(a,b){return{$$typeof:A,type:a,compare:void 0===b?null:b}},Fragment:r,StrictMode:t,Suspense:z,createElement:N,cloneElement:function(a,b,e){null===a||void 0===a?D(\"267\",a):void 0;var c=void 0,d=k({},a.props),g=a.key,h=a.ref,f=a._owner;\nif(null!=b){void 0!==b.ref&&(h=b.ref,f=K.current);void 0!==b.key&&(g=\"\"+b.key);var l=void 0;a.type&&a.type.defaultProps&&(l=a.type.defaultProps);for(c in b)L.call(b,c)&&!M.hasOwnProperty(c)&&(d[c]=void 0===b[c]&&void 0!==l?l[c]:b[c])}c=arguments.length-2;if(1===c)d.children=e;else if(1<c){l=Array(c);for(var m=0;m<c;m++)l[m]=arguments[m+2];d.children=l}return{$$typeof:p,type:a.type,key:g,ref:h,props:d,_owner:f}},createFactory:function(a){var b=N.bind(null,a);b.type=a;return b},isValidElement:O,version:\"16.6.3\",\n__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:K,assign:k}};X.unstable_ConcurrentMode=x;X.unstable_Profiler=u;var Y={default:X},Z=Y&&X||Y;module.exports=Z.default||Z;\n","/** @license React v16.6.1\n * react-dom.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n/*\n Modernizr 3.0.0pre (Custom Build) | MIT\n*/\n'use strict';var aa=require(\"react\"),n=require(\"object-assign\"),ba=require(\"scheduler\");function ca(a,b,c,d,e,f,g,h){if(!a){a=void 0;if(void 0===b)a=Error(\"Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.\");else{var k=[c,d,e,f,g,h],l=0;a=Error(b.replace(/%s/g,function(){return k[l++]}));a.name=\"Invariant Violation\"}a.framesToPop=1;throw a;}}\nfunction t(a){for(var b=arguments.length-1,c=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+a,d=0;d<b;d++)c+=\"&args[]=\"+encodeURIComponent(arguments[d+1]);ca(!1,\"Minified React error #\"+a+\"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. \",c)}aa?void 0:t(\"227\");function da(a,b,c,d,e,f,g,h,k){var l=Array.prototype.slice.call(arguments,3);try{b.apply(c,l)}catch(m){this.onError(m)}}\nvar ea=!1,fa=null,ha=!1,ia=null,ja={onError:function(a){ea=!0;fa=a}};function ka(a,b,c,d,e,f,g,h,k){ea=!1;fa=null;da.apply(ja,arguments)}function la(a,b,c,d,e,f,g,h,k){ka.apply(this,arguments);if(ea){if(ea){var l=fa;ea=!1;fa=null}else t(\"198\"),l=void 0;ha||(ha=!0,ia=l)}}var ma=null,na={};\nfunction oa(){if(ma)for(var a in na){var b=na[a],c=ma.indexOf(a);-1<c?void 0:t(\"96\",a);if(!pa[c]){b.extractEvents?void 0:t(\"97\",a);pa[c]=b;c=b.eventTypes;for(var d in c){var e=void 0;var f=c[d],g=b,h=d;qa.hasOwnProperty(h)?t(\"99\",h):void 0;qa[h]=f;var k=f.phasedRegistrationNames;if(k){for(e in k)k.hasOwnProperty(e)&&ra(k[e],g,h);e=!0}else f.registrationName?(ra(f.registrationName,g,h),e=!0):e=!1;e?void 0:t(\"98\",d,a)}}}}\nfunction ra(a,b,c){sa[a]?t(\"100\",a):void 0;sa[a]=b;ta[a]=b.eventTypes[c].dependencies}var pa=[],qa={},sa={},ta={},ua=null,va=null,wa=null;function xa(a,b,c){var d=a.type||\"unknown-event\";a.currentTarget=wa(c);la(d,b,void 0,a);a.currentTarget=null}function ya(a,b){null==b?t(\"30\"):void 0;if(null==a)return b;if(Array.isArray(a)){if(Array.isArray(b))return a.push.apply(a,b),a;a.push(b);return a}return Array.isArray(b)?[a].concat(b):[a,b]}\nfunction za(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)}var Aa=null;function Ba(a){if(a){var b=a._dispatchListeners,c=a._dispatchInstances;if(Array.isArray(b))for(var d=0;d<b.length&&!a.isPropagationStopped();d++)xa(a,b[d],c[d]);else b&&xa(a,b,c);a._dispatchListeners=null;a._dispatchInstances=null;a.isPersistent()||a.constructor.release(a)}}\nvar Ca={injectEventPluginOrder:function(a){ma?t(\"101\"):void 0;ma=Array.prototype.slice.call(a);oa()},injectEventPluginsByName:function(a){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];na.hasOwnProperty(c)&&na[c]===d||(na[c]?t(\"102\",c):void 0,na[c]=d,b=!0)}b&&oa()}};\nfunction Da(a,b){var c=a.stateNode;if(!c)return null;var d=ua(c);if(!d)return null;c=d[b];a:switch(b){case \"onClick\":case \"onClickCapture\":case \"onDoubleClick\":case \"onDoubleClickCapture\":case \"onMouseDown\":case \"onMouseDownCapture\":case \"onMouseMove\":case \"onMouseMoveCapture\":case \"onMouseUp\":case \"onMouseUpCapture\":(d=!d.disabled)||(a=a.type,d=!(\"button\"===a||\"input\"===a||\"select\"===a||\"textarea\"===a));a=!d;break a;default:a=!1}if(a)return null;c&&\"function\"!==typeof c?t(\"231\",b,typeof c):void 0;\nreturn c}function Ea(a){null!==a&&(Aa=ya(Aa,a));a=Aa;Aa=null;if(a&&(za(a,Ba),Aa?t(\"95\"):void 0,ha))throw a=ia,ha=!1,ia=null,a;}var Fa=Math.random().toString(36).slice(2),Ga=\"__reactInternalInstance$\"+Fa,Ha=\"__reactEventHandlers$\"+Fa;function Ia(a){if(a[Ga])return a[Ga];for(;!a[Ga];)if(a.parentNode)a=a.parentNode;else return null;a=a[Ga];return 5===a.tag||6===a.tag?a:null}function Ja(a){a=a[Ga];return!a||5!==a.tag&&6!==a.tag?null:a}\nfunction Ka(a){if(5===a.tag||6===a.tag)return a.stateNode;t(\"33\")}function La(a){return a[Ha]||null}function Ma(a){do a=a.return;while(a&&5!==a.tag);return a?a:null}function Na(a,b,c){if(b=Da(a,c.dispatchConfig.phasedRegistrationNames[b]))c._dispatchListeners=ya(c._dispatchListeners,b),c._dispatchInstances=ya(c._dispatchInstances,a)}\nfunction Oa(a){if(a&&a.dispatchConfig.phasedRegistrationNames){for(var b=a._targetInst,c=[];b;)c.push(b),b=Ma(b);for(b=c.length;0<b--;)Na(c[b],\"captured\",a);for(b=0;b<c.length;b++)Na(c[b],\"bubbled\",a)}}function Pa(a,b,c){a&&c&&c.dispatchConfig.registrationName&&(b=Da(a,c.dispatchConfig.registrationName))&&(c._dispatchListeners=ya(c._dispatchListeners,b),c._dispatchInstances=ya(c._dispatchInstances,a))}function Qa(a){a&&a.dispatchConfig.registrationName&&Pa(a._targetInst,null,a)}\nfunction Ra(a){za(a,Oa)}var Sa=!(\"undefined\"===typeof window||!window.document||!window.document.createElement);function Ta(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c[\"Webkit\"+a]=\"webkit\"+b;c[\"Moz\"+a]=\"moz\"+b;return c}var Ua={animationend:Ta(\"Animation\",\"AnimationEnd\"),animationiteration:Ta(\"Animation\",\"AnimationIteration\"),animationstart:Ta(\"Animation\",\"AnimationStart\"),transitionend:Ta(\"Transition\",\"TransitionEnd\")},Va={},Wa={};\nSa&&(Wa=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete Ua.animationend.animation,delete Ua.animationiteration.animation,delete Ua.animationstart.animation),\"TransitionEvent\"in window||delete Ua.transitionend.transition);function Xa(a){if(Va[a])return Va[a];if(!Ua[a])return a;var b=Ua[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Wa)return Va[a]=b[c];return a}\nvar Ya=Xa(\"animationend\"),Za=Xa(\"animationiteration\"),$a=Xa(\"animationstart\"),ab=Xa(\"transitionend\"),bb=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),cb=null,eb=null,fb=null;\nfunction gb(){if(fb)return fb;var a,b=eb,c=b.length,d,e=\"value\"in cb?cb.value:cb.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return fb=e.slice(a,1<d?1-d:void 0)}function hb(){return!0}function ib(){return!1}\nfunction A(a,b,c,d){this.dispatchConfig=a;this._targetInst=b;this.nativeEvent=c;a=this.constructor.Interface;for(var e in a)a.hasOwnProperty(e)&&((b=a[e])?this[e]=b(c):\"target\"===e?this.target=d:this[e]=c[e]);this.isDefaultPrevented=(null!=c.defaultPrevented?c.defaultPrevented:!1===c.returnValue)?hb:ib;this.isPropagationStopped=ib;return this}\nn(A.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():\"unknown\"!==typeof a.returnValue&&(a.returnValue=!1),this.isDefaultPrevented=hb)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():\"unknown\"!==typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=hb)},persist:function(){this.isPersistent=hb},isPersistent:ib,destructor:function(){var a=this.constructor.Interface,\nb;for(b in a)this[b]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null;this.isPropagationStopped=this.isDefaultPrevented=ib;this._dispatchInstances=this._dispatchListeners=null}});A.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};\nA.extend=function(a){function b(){}function c(){return d.apply(this,arguments)}var d=this;b.prototype=d.prototype;var e=new b;n(e,c.prototype);c.prototype=e;c.prototype.constructor=c;c.Interface=n({},d.Interface,a);c.extend=d.extend;jb(c);return c};jb(A);function kb(a,b,c,d){if(this.eventPool.length){var e=this.eventPool.pop();this.call(e,a,b,c,d);return e}return new this(a,b,c,d)}function lb(a){a instanceof this?void 0:t(\"279\");a.destructor();10>this.eventPool.length&&this.eventPool.push(a)}\nfunction jb(a){a.eventPool=[];a.getPooled=kb;a.release=lb}var mb=A.extend({data:null}),nb=A.extend({data:null}),ob=[9,13,27,32],pb=Sa&&\"CompositionEvent\"in window,qb=null;Sa&&\"documentMode\"in document&&(qb=document.documentMode);\nvar rb=Sa&&\"TextEvent\"in window&&!qb,sb=Sa&&(!pb||qb&&8<qb&&11>=qb),tb=String.fromCharCode(32),ub={beforeInput:{phasedRegistrationNames:{bubbled:\"onBeforeInput\",captured:\"onBeforeInputCapture\"},dependencies:[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]},compositionEnd:{phasedRegistrationNames:{bubbled:\"onCompositionEnd\",captured:\"onCompositionEndCapture\"},dependencies:\"blur compositionend keydown keypress keyup mousedown\".split(\" \")},compositionStart:{phasedRegistrationNames:{bubbled:\"onCompositionStart\",\ncaptured:\"onCompositionStartCapture\"},dependencies:\"blur compositionstart keydown keypress keyup mousedown\".split(\" \")},compositionUpdate:{phasedRegistrationNames:{bubbled:\"onCompositionUpdate\",captured:\"onCompositionUpdateCapture\"},dependencies:\"blur compositionupdate keydown keypress keyup mousedown\".split(\" \")}},vb=!1;\nfunction wb(a,b){switch(a){case \"keyup\":return-1!==ob.indexOf(b.keyCode);case \"keydown\":return 229!==b.keyCode;case \"keypress\":case \"mousedown\":case \"blur\":return!0;default:return!1}}function xb(a){a=a.detail;return\"object\"===typeof a&&\"data\"in a?a.data:null}var yb=!1;function zb(a,b){switch(a){case \"compositionend\":return xb(b);case \"keypress\":if(32!==b.which)return null;vb=!0;return tb;case \"textInput\":return a=b.data,a===tb&&vb?null:a;default:return null}}\nfunction Ab(a,b){if(yb)return\"compositionend\"===a||!pb&&wb(a,b)?(a=gb(),fb=eb=cb=null,yb=!1,a):null;switch(a){case \"paste\":return null;case \"keypress\":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case \"compositionend\":return sb&&\"ko\"!==b.locale?null:b.data;default:return null}}\nvar Bb={eventTypes:ub,extractEvents:function(a,b,c,d){var e=void 0;var f=void 0;if(pb)b:{switch(a){case \"compositionstart\":e=ub.compositionStart;break b;case \"compositionend\":e=ub.compositionEnd;break b;case \"compositionupdate\":e=ub.compositionUpdate;break b}e=void 0}else yb?wb(a,c)&&(e=ub.compositionEnd):\"keydown\"===a&&229===c.keyCode&&(e=ub.compositionStart);e?(sb&&\"ko\"!==c.locale&&(yb||e!==ub.compositionStart?e===ub.compositionEnd&&yb&&(f=gb()):(cb=d,eb=\"value\"in cb?cb.value:cb.textContent,yb=\n!0)),e=mb.getPooled(e,b,c,d),f?e.data=f:(f=xb(c),null!==f&&(e.data=f)),Ra(e),f=e):f=null;(a=rb?zb(a,c):Ab(a,c))?(b=nb.getPooled(ub.beforeInput,b,c,d),b.data=a,Ra(b)):b=null;return null===f?b:null===b?f:[f,b]}},Cb=null,Db=null,Eb=null;function Hb(a){if(a=va(a)){\"function\"!==typeof Cb?t(\"280\"):void 0;var b=ua(a.stateNode);Cb(a.stateNode,a.type,b)}}function Ib(a){Db?Eb?Eb.push(a):Eb=[a]:Db=a}function Jb(){if(Db){var a=Db,b=Eb;Eb=Db=null;Hb(a);if(b)for(a=0;a<b.length;a++)Hb(b[a])}}\nfunction Kb(a,b){return a(b)}function Lb(a,b,c){return a(b,c)}function Mb(){}var Nb=!1;function Ob(a,b){if(Nb)return a(b);Nb=!0;try{return Kb(a,b)}finally{if(Nb=!1,null!==Db||null!==Eb)Mb(),Jb()}}var Pb={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qb(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return\"input\"===b?!!Pb[a.type]:\"textarea\"===b?!0:!1}\nfunction Rb(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:a}function Sb(a){if(!Sa)return!1;a=\"on\"+a;var b=a in document;b||(b=document.createElement(\"div\"),b.setAttribute(a,\"return;\"),b=\"function\"===typeof b[a]);return b}function Tb(a){var b=a.type;return(a=a.nodeName)&&\"input\"===a.toLowerCase()&&(\"checkbox\"===b||\"radio\"===b)}\nfunction Ub(a){var b=Tb(a)?\"checked\":\"value\",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=\"\"+a[b];if(!a.hasOwnProperty(b)&&\"undefined\"!==typeof c&&\"function\"===typeof c.get&&\"function\"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=\"\"+a;f.call(this,a)}});Object.defineProperty(a,b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=\"\"+a},stopTracking:function(){a._valueTracker=\nnull;delete a[b]}}}}function Vb(a){a._valueTracker||(a._valueTracker=Ub(a))}function Wb(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d=\"\";a&&(d=Tb(a)?a.checked?\"true\":\"false\":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}\nvar Xb=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Yb=/^(.*)[\\\\\\/]/,D=\"function\"===typeof Symbol&&Symbol.for,Zb=D?Symbol.for(\"react.element\"):60103,$b=D?Symbol.for(\"react.portal\"):60106,ac=D?Symbol.for(\"react.fragment\"):60107,bc=D?Symbol.for(\"react.strict_mode\"):60108,cc=D?Symbol.for(\"react.profiler\"):60114,dc=D?Symbol.for(\"react.provider\"):60109,ec=D?Symbol.for(\"react.context\"):60110,fc=D?Symbol.for(\"react.concurrent_mode\"):60111,gc=D?Symbol.for(\"react.forward_ref\"):60112,hc=D?Symbol.for(\"react.suspense\"):\n60113,ic=D?Symbol.for(\"react.memo\"):60115,jc=D?Symbol.for(\"react.lazy\"):60116,kc=\"function\"===typeof Symbol&&Symbol.iterator;function lc(a){if(null===a||\"object\"!==typeof a)return null;a=kc&&a[kc]||a[\"@@iterator\"];return\"function\"===typeof a?a:null}\nfunction mc(a){if(null==a)return null;if(\"function\"===typeof a)return a.displayName||a.name||null;if(\"string\"===typeof a)return a;switch(a){case fc:return\"ConcurrentMode\";case ac:return\"Fragment\";case $b:return\"Portal\";case cc:return\"Profiler\";case bc:return\"StrictMode\";case hc:return\"Suspense\"}if(\"object\"===typeof a)switch(a.$$typeof){case ec:return\"Context.Consumer\";case dc:return\"Context.Provider\";case gc:var b=a.render;b=b.displayName||b.name||\"\";return a.displayName||(\"\"!==b?\"ForwardRef(\"+b+\n\")\":\"ForwardRef\");case ic:return mc(a.type);case jc:if(a=1===a._status?a._result:null)return mc(a)}return null}function nc(a){var b=\"\";do{a:switch(a.tag){case 2:case 16:case 0:case 1:case 5:case 8:case 13:var c=a._debugOwner,d=a._debugSource,e=mc(a.type);var f=null;c&&(f=mc(c.type));c=e;e=\"\";d?e=\" (at \"+d.fileName.replace(Yb,\"\")+\":\"+d.lineNumber+\")\":f&&(e=\" (created by \"+f+\")\");f=\"\\n    in \"+(c||\"Unknown\")+e;break a;default:f=\"\"}b+=f;a=a.return}while(a);return b}\nvar oc=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,pc=Object.prototype.hasOwnProperty,qc={},rc={};\nfunction sc(a){if(pc.call(rc,a))return!0;if(pc.call(qc,a))return!1;if(oc.test(a))return rc[a]=!0;qc[a]=!0;return!1}function tc(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case \"function\":case \"symbol\":return!0;case \"boolean\":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return\"data-\"!==a&&\"aria-\"!==a;default:return!1}}\nfunction uc(a,b,c,d){if(null===b||\"undefined\"===typeof b||tc(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function E(a,b,c,d,e){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b}var F={};\n\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(a){F[a]=new E(a,0,!1,a,null)});[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(a){var b=a[0];F[b]=new E(b,1,!1,a[1],null)});[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(a){F[a]=new E(a,2,!1,a.toLowerCase(),null)});\n[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(a){F[a]=new E(a,2,!1,a,null)});\"allowFullScreen async autoFocus autoPlay controls default defer disabled formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(a){F[a]=new E(a,3,!1,a.toLowerCase(),null)});[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(a){F[a]=new E(a,3,!0,a,null)});\n[\"capture\",\"download\"].forEach(function(a){F[a]=new E(a,4,!1,a,null)});[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(a){F[a]=new E(a,6,!1,a,null)});[\"rowSpan\",\"start\"].forEach(function(a){F[a]=new E(a,5,!1,a.toLowerCase(),null)});var vc=/[\\-:]([a-z])/g;function xc(a){return a[1].toUpperCase()}\n\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(a){var b=a.replace(vc,\nxc);F[b]=new E(b,1,!1,a,null)});\"xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(a){var b=a.replace(vc,xc);F[b]=new E(b,1,!1,a,\"http://www.w3.org/1999/xlink\")});[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(a){var b=a.replace(vc,xc);F[b]=new E(b,1,!1,a,\"http://www.w3.org/XML/1998/namespace\")});F.tabIndex=new E(\"tabIndex\",1,!1,\"tabindex\",null);\nfunction yc(a,b,c,d){var e=F.hasOwnProperty(b)?F[b]:null;var f=null!==e?0===e.type:d?!1:!(2<b.length)||\"o\"!==b[0]&&\"O\"!==b[0]||\"n\"!==b[1]&&\"N\"!==b[1]?!1:!0;f||(uc(b,c,e,d)&&(c=null),d||null===e?sc(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,\"\"+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:\"\":c:(b=e.attributeName,d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?\"\":\"\"+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c))))}\nfunction zc(a){switch(typeof a){case \"boolean\":case \"number\":case \"object\":case \"string\":case \"undefined\":return a;default:return\"\"}}function Ac(a,b){var c=b.checked;return n({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=c?c:a._wrapperState.initialChecked})}\nfunction Bc(a,b){var c=null==b.defaultValue?\"\":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=zc(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:\"checkbox\"===b.type||\"radio\"===b.type?null!=b.checked:null!=b.value}}function Cc(a,b){b=b.checked;null!=b&&yc(a,\"checked\",b,!1)}\nfunction Dc(a,b){Cc(a,b);var c=zc(b.value),d=b.type;if(null!=c)if(\"number\"===d){if(0===c&&\"\"===a.value||a.value!=c)a.value=\"\"+c}else a.value!==\"\"+c&&(a.value=\"\"+c);else if(\"submit\"===d||\"reset\"===d){a.removeAttribute(\"value\");return}b.hasOwnProperty(\"value\")?Ec(a,b.type,c):b.hasOwnProperty(\"defaultValue\")&&Ec(a,b.type,zc(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}\nfunction Fc(a,b,c){if(b.hasOwnProperty(\"value\")||b.hasOwnProperty(\"defaultValue\")){var d=b.type;if(!(\"submit\"!==d&&\"reset\"!==d||void 0!==b.value&&null!==b.value))return;b=\"\"+a._wrapperState.initialValue;c||b===a.value||(a.value=b);a.defaultValue=b}c=a.name;\"\"!==c&&(a.name=\"\");a.defaultChecked=!a.defaultChecked;a.defaultChecked=!!a._wrapperState.initialChecked;\"\"!==c&&(a.name=c)}\nfunction Ec(a,b,c){if(\"number\"!==b||a.ownerDocument.activeElement!==a)null==c?a.defaultValue=\"\"+a._wrapperState.initialValue:a.defaultValue!==\"\"+c&&(a.defaultValue=\"\"+c)}var Gc={change:{phasedRegistrationNames:{bubbled:\"onChange\",captured:\"onChangeCapture\"},dependencies:\"blur change click focus input keydown keyup selectionchange\".split(\" \")}};function Hc(a,b,c){a=A.getPooled(Gc.change,a,b,c);a.type=\"change\";Ib(c);Ra(a);return a}var Jc=null,Kc=null;function Lc(a){Ea(a)}\nfunction Mc(a){var b=Ka(a);if(Wb(b))return a}function Nc(a,b){if(\"change\"===a)return b}var Oc=!1;Sa&&(Oc=Sb(\"input\")&&(!document.documentMode||9<document.documentMode));function Pc(){Jc&&(Jc.detachEvent(\"onpropertychange\",Qc),Kc=Jc=null)}function Qc(a){\"value\"===a.propertyName&&Mc(Kc)&&(a=Hc(Kc,a,Rb(a)),Ob(Lc,a))}function Rc(a,b,c){\"focus\"===a?(Pc(),Jc=b,Kc=c,Jc.attachEvent(\"onpropertychange\",Qc)):\"blur\"===a&&Pc()}function Sc(a){if(\"selectionchange\"===a||\"keyup\"===a||\"keydown\"===a)return Mc(Kc)}\nfunction Tc(a,b){if(\"click\"===a)return Mc(b)}function Uc(a,b){if(\"input\"===a||\"change\"===a)return Mc(b)}\nvar Vc={eventTypes:Gc,_isInputEventSupported:Oc,extractEvents:function(a,b,c,d){var e=b?Ka(b):window,f=void 0,g=void 0,h=e.nodeName&&e.nodeName.toLowerCase();\"select\"===h||\"input\"===h&&\"file\"===e.type?f=Nc:Qb(e)?Oc?f=Uc:(f=Sc,g=Rc):(h=e.nodeName)&&\"input\"===h.toLowerCase()&&(\"checkbox\"===e.type||\"radio\"===e.type)&&(f=Tc);if(f&&(f=f(a,b)))return Hc(f,c,d);g&&g(a,e,b);\"blur\"===a&&(a=e._wrapperState)&&a.controlled&&\"number\"===e.type&&Ec(e,\"number\",e.value)}},Wc=A.extend({view:null,detail:null}),Xc={Alt:\"altKey\",\nControl:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function Yc(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Xc[a])?!!b[a]:!1}function Zc(){return Yc}\nvar $c=0,ad=0,bd=!1,cd=!1,dd=Wc.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Zc,button:null,buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)},movementX:function(a){if(\"movementX\"in a)return a.movementX;var b=$c;$c=a.screenX;return bd?\"mousemove\"===a.type?a.screenX-b:0:(bd=!0,0)},movementY:function(a){if(\"movementY\"in a)return a.movementY;\nvar b=ad;ad=a.screenY;return cd?\"mousemove\"===a.type?a.screenY-b:0:(cd=!0,0)}}),ed=dd.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),fd={mouseEnter:{registrationName:\"onMouseEnter\",dependencies:[\"mouseout\",\"mouseover\"]},mouseLeave:{registrationName:\"onMouseLeave\",dependencies:[\"mouseout\",\"mouseover\"]},pointerEnter:{registrationName:\"onPointerEnter\",dependencies:[\"pointerout\",\"pointerover\"]},pointerLeave:{registrationName:\"onPointerLeave\",\ndependencies:[\"pointerout\",\"pointerover\"]}},gd={eventTypes:fd,extractEvents:function(a,b,c,d){var e=\"mouseover\"===a||\"pointerover\"===a,f=\"mouseout\"===a||\"pointerout\"===a;if(e&&(c.relatedTarget||c.fromElement)||!f&&!e)return null;e=d.window===d?d:(e=d.ownerDocument)?e.defaultView||e.parentWindow:window;f?(f=b,b=(b=c.relatedTarget||c.toElement)?Ia(b):null):f=null;if(f===b)return null;var g=void 0,h=void 0,k=void 0,l=void 0;if(\"mouseout\"===a||\"mouseover\"===a)g=dd,h=fd.mouseLeave,k=fd.mouseEnter,l=\"mouse\";\nelse if(\"pointerout\"===a||\"pointerover\"===a)g=ed,h=fd.pointerLeave,k=fd.pointerEnter,l=\"pointer\";var m=null==f?e:Ka(f);e=null==b?e:Ka(b);a=g.getPooled(h,f,c,d);a.type=l+\"leave\";a.target=m;a.relatedTarget=e;c=g.getPooled(k,b,c,d);c.type=l+\"enter\";c.target=e;c.relatedTarget=m;d=b;if(f&&d)a:{b=f;e=d;l=0;for(g=b;g;g=Ma(g))l++;g=0;for(k=e;k;k=Ma(k))g++;for(;0<l-g;)b=Ma(b),l--;for(;0<g-l;)e=Ma(e),g--;for(;l--;){if(b===e||b===e.alternate)break a;b=Ma(b);e=Ma(e)}b=null}else b=null;e=b;for(b=[];f&&f!==e;){l=\nf.alternate;if(null!==l&&l===e)break;b.push(f);f=Ma(f)}for(f=[];d&&d!==e;){l=d.alternate;if(null!==l&&l===e)break;f.push(d);d=Ma(d)}for(d=0;d<b.length;d++)Pa(b[d],\"bubbled\",a);for(d=f.length;0<d--;)Pa(f[d],\"captured\",c);return[a,c]}},hd=Object.prototype.hasOwnProperty;function id(a,b){return a===b?0!==a||0!==b||1/a===1/b:a!==a&&b!==b}\nfunction jd(a,b){if(id(a,b))return!0;if(\"object\"!==typeof a||null===a||\"object\"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++)if(!hd.call(b,c[d])||!id(a[c[d]],b[c[d]]))return!1;return!0}function kd(a){var b=a;if(a.alternate)for(;b.return;)b=b.return;else{if(0!==(b.effectTag&2))return 1;for(;b.return;)if(b=b.return,0!==(b.effectTag&2))return 1}return 3===b.tag?2:3}function ld(a){2!==kd(a)?t(\"188\"):void 0}\nfunction md(a){var b=a.alternate;if(!b)return b=kd(a),3===b?t(\"188\"):void 0,1===b?null:a;for(var c=a,d=b;;){var e=c.return,f=e?e.alternate:null;if(!e||!f)break;if(e.child===f.child){for(var g=e.child;g;){if(g===c)return ld(e),a;if(g===d)return ld(e),b;g=g.sibling}t(\"188\")}if(c.return!==d.return)c=e,d=f;else{g=!1;for(var h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=f.child;h;){if(h===c){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}g?\nvoid 0:t(\"189\")}}c.alternate!==d?t(\"190\"):void 0}3!==c.tag?t(\"188\"):void 0;return c.stateNode.current===c?a:b}function nd(a){a=md(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}}return null}\nvar od=A.extend({animationName:null,elapsedTime:null,pseudoElement:null}),pd=A.extend({clipboardData:function(a){return\"clipboardData\"in a?a.clipboardData:window.clipboardData}}),qd=Wc.extend({relatedTarget:null});function rd(a){var b=a.keyCode;\"charCode\"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}\nvar sd={Esc:\"Escape\",Spacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},td={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",\n116:\"F5\",117:\"F6\",118:\"F7\",119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},ud=Wc.extend({key:function(a){if(a.key){var b=sd[a.key]||a.key;if(\"Unidentified\"!==b)return b}return\"keypress\"===a.type?(a=rd(a),13===a?\"Enter\":String.fromCharCode(a)):\"keydown\"===a.type||\"keyup\"===a.type?td[a.keyCode]||\"Unidentified\":\"\"},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Zc,charCode:function(a){return\"keypress\"===\na.type?rd(a):0},keyCode:function(a){return\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0},which:function(a){return\"keypress\"===a.type?rd(a):\"keydown\"===a.type||\"keyup\"===a.type?a.keyCode:0}}),vd=dd.extend({dataTransfer:null}),wd=Wc.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Zc}),xd=A.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),yd=dd.extend({deltaX:function(a){return\"deltaX\"in a?a.deltaX:\"wheelDeltaX\"in\na?-a.wheelDeltaX:0},deltaY:function(a){return\"deltaY\"in a?a.deltaY:\"wheelDeltaY\"in a?-a.wheelDeltaY:\"wheelDelta\"in a?-a.wheelDelta:0},deltaZ:null,deltaMode:null}),zd=[[\"abort\",\"abort\"],[Ya,\"animationEnd\"],[Za,\"animationIteration\"],[$a,\"animationStart\"],[\"canplay\",\"canPlay\"],[\"canplaythrough\",\"canPlayThrough\"],[\"drag\",\"drag\"],[\"dragenter\",\"dragEnter\"],[\"dragexit\",\"dragExit\"],[\"dragleave\",\"dragLeave\"],[\"dragover\",\"dragOver\"],[\"durationchange\",\"durationChange\"],[\"emptied\",\"emptied\"],[\"encrypted\",\"encrypted\"],\n[\"ended\",\"ended\"],[\"error\",\"error\"],[\"gotpointercapture\",\"gotPointerCapture\"],[\"load\",\"load\"],[\"loadeddata\",\"loadedData\"],[\"loadedmetadata\",\"loadedMetadata\"],[\"loadstart\",\"loadStart\"],[\"lostpointercapture\",\"lostPointerCapture\"],[\"mousemove\",\"mouseMove\"],[\"mouseout\",\"mouseOut\"],[\"mouseover\",\"mouseOver\"],[\"playing\",\"playing\"],[\"pointermove\",\"pointerMove\"],[\"pointerout\",\"pointerOut\"],[\"pointerover\",\"pointerOver\"],[\"progress\",\"progress\"],[\"scroll\",\"scroll\"],[\"seeking\",\"seeking\"],[\"stalled\",\"stalled\"],\n[\"suspend\",\"suspend\"],[\"timeupdate\",\"timeUpdate\"],[\"toggle\",\"toggle\"],[\"touchmove\",\"touchMove\"],[ab,\"transitionEnd\"],[\"waiting\",\"waiting\"],[\"wheel\",\"wheel\"]],Ad={},Bd={};function Cd(a,b){var c=a[0];a=a[1];var d=\"on\"+(a[0].toUpperCase()+a.slice(1));b={phasedRegistrationNames:{bubbled:d,captured:d+\"Capture\"},dependencies:[c],isInteractive:b};Ad[a]=b;Bd[c]=b}\n[[\"blur\",\"blur\"],[\"cancel\",\"cancel\"],[\"click\",\"click\"],[\"close\",\"close\"],[\"contextmenu\",\"contextMenu\"],[\"copy\",\"copy\"],[\"cut\",\"cut\"],[\"auxclick\",\"auxClick\"],[\"dblclick\",\"doubleClick\"],[\"dragend\",\"dragEnd\"],[\"dragstart\",\"dragStart\"],[\"drop\",\"drop\"],[\"focus\",\"focus\"],[\"input\",\"input\"],[\"invalid\",\"invalid\"],[\"keydown\",\"keyDown\"],[\"keypress\",\"keyPress\"],[\"keyup\",\"keyUp\"],[\"mousedown\",\"mouseDown\"],[\"mouseup\",\"mouseUp\"],[\"paste\",\"paste\"],[\"pause\",\"pause\"],[\"play\",\"play\"],[\"pointercancel\",\"pointerCancel\"],\n[\"pointerdown\",\"pointerDown\"],[\"pointerup\",\"pointerUp\"],[\"ratechange\",\"rateChange\"],[\"reset\",\"reset\"],[\"seeked\",\"seeked\"],[\"submit\",\"submit\"],[\"touchcancel\",\"touchCancel\"],[\"touchend\",\"touchEnd\"],[\"touchstart\",\"touchStart\"],[\"volumechange\",\"volumeChange\"]].forEach(function(a){Cd(a,!0)});zd.forEach(function(a){Cd(a,!1)});\nvar Dd={eventTypes:Ad,isInteractiveTopLevelEventType:function(a){a=Bd[a];return void 0!==a&&!0===a.isInteractive},extractEvents:function(a,b,c,d){var e=Bd[a];if(!e)return null;switch(a){case \"keypress\":if(0===rd(c))return null;case \"keydown\":case \"keyup\":a=ud;break;case \"blur\":case \"focus\":a=qd;break;case \"click\":if(2===c.button)return null;case \"auxclick\":case \"dblclick\":case \"mousedown\":case \"mousemove\":case \"mouseup\":case \"mouseout\":case \"mouseover\":case \"contextmenu\":a=dd;break;case \"drag\":case \"dragend\":case \"dragenter\":case \"dragexit\":case \"dragleave\":case \"dragover\":case \"dragstart\":case \"drop\":a=\nvd;break;case \"touchcancel\":case \"touchend\":case \"touchmove\":case \"touchstart\":a=wd;break;case Ya:case Za:case $a:a=od;break;case ab:a=xd;break;case \"scroll\":a=Wc;break;case \"wheel\":a=yd;break;case \"copy\":case \"cut\":case \"paste\":a=pd;break;case \"gotpointercapture\":case \"lostpointercapture\":case \"pointercancel\":case \"pointerdown\":case \"pointermove\":case \"pointerout\":case \"pointerover\":case \"pointerup\":a=ed;break;default:a=A}b=a.getPooled(e,b,c,d);Ra(b);return b}},Ed=Dd.isInteractiveTopLevelEventType,\nFd=[];function Gd(a){var b=a.targetInst,c=b;do{if(!c){a.ancestors.push(c);break}var d;for(d=c;d.return;)d=d.return;d=3!==d.tag?null:d.stateNode.containerInfo;if(!d)break;a.ancestors.push(c);c=Ia(d)}while(c);for(c=0;c<a.ancestors.length;c++){b=a.ancestors[c];var e=Rb(a.nativeEvent);d=a.topLevelType;for(var f=a.nativeEvent,g=null,h=0;h<pa.length;h++){var k=pa[h];k&&(k=k.extractEvents(d,b,f,e))&&(g=ya(g,k))}Ea(g)}}var Hd=!0;\nfunction G(a,b){if(!b)return null;var c=(Ed(a)?Id:Jd).bind(null,a);b.addEventListener(a,c,!1)}function Kd(a,b){if(!b)return null;var c=(Ed(a)?Id:Jd).bind(null,a);b.addEventListener(a,c,!0)}function Id(a,b){Lb(Jd,a,b)}\nfunction Jd(a,b){if(Hd){var c=Rb(b);c=Ia(c);null===c||\"number\"!==typeof c.tag||2===kd(c)||(c=null);if(Fd.length){var d=Fd.pop();d.topLevelType=a;d.nativeEvent=b;d.targetInst=c;a=d}else a={topLevelType:a,nativeEvent:b,targetInst:c,ancestors:[]};try{Ob(Gd,a)}finally{a.topLevelType=null,a.nativeEvent=null,a.targetInst=null,a.ancestors.length=0,10>Fd.length&&Fd.push(a)}}}var Ld={},Md=0,Nd=\"_reactListenersID\"+(\"\"+Math.random()).slice(2);\nfunction Od(a){Object.prototype.hasOwnProperty.call(a,Nd)||(a[Nd]=Md++,Ld[a[Nd]]={});return Ld[a[Nd]]}function Pd(a){a=a||(\"undefined\"!==typeof document?document:void 0);if(\"undefined\"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}function Qd(a){for(;a&&a.firstChild;)a=a.firstChild;return a}\nfunction Rd(a,b){var c=Qd(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=Qd(c)}}function Sd(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?Sd(a,b.parentNode):\"contains\"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}\nfunction Td(){for(var a=window,b=Pd();b instanceof a.HTMLIFrameElement;){try{a=b.contentDocument.defaultView}catch(c){break}b=Pd(a.document)}return b}function Ud(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&(\"input\"===b&&(\"text\"===a.type||\"search\"===a.type||\"tel\"===a.type||\"url\"===a.type||\"password\"===a.type)||\"textarea\"===b||\"true\"===a.contentEditable)}\nvar Vd=Sa&&\"documentMode\"in document&&11>=document.documentMode,Wd={select:{phasedRegistrationNames:{bubbled:\"onSelect\",captured:\"onSelectCapture\"},dependencies:\"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange\".split(\" \")}},Xd=null,Yd=null,Zd=null,$d=!1;\nfunction ae(a,b){var c=b.window===b?b.document:9===b.nodeType?b:b.ownerDocument;if($d||null==Xd||Xd!==Pd(c))return null;c=Xd;\"selectionStart\"in c&&Ud(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset});return Zd&&jd(Zd,c)?null:(Zd=c,a=A.getPooled(Wd.select,Yd,a,b),a.type=\"select\",a.target=Xd,Ra(a),a)}\nvar be={eventTypes:Wd,extractEvents:function(a,b,c,d){var e=d.window===d?d.document:9===d.nodeType?d:d.ownerDocument,f;if(!(f=!e)){a:{e=Od(e);f=ta.onSelect;for(var g=0;g<f.length;g++){var h=f[g];if(!e.hasOwnProperty(h)||!e[h]){e=!1;break a}}e=!0}f=!e}if(f)return null;e=b?Ka(b):window;switch(a){case \"focus\":if(Qb(e)||\"true\"===e.contentEditable)Xd=e,Yd=b,Zd=null;break;case \"blur\":Zd=Yd=Xd=null;break;case \"mousedown\":$d=!0;break;case \"contextmenu\":case \"mouseup\":case \"dragend\":return $d=!1,ae(c,d);case \"selectionchange\":if(Vd)break;\ncase \"keydown\":case \"keyup\":return ae(c,d)}return null}};Ca.injectEventPluginOrder(\"ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin\".split(\" \"));ua=La;va=Ja;wa=Ka;Ca.injectEventPluginsByName({SimpleEventPlugin:Dd,EnterLeaveEventPlugin:gd,ChangeEventPlugin:Vc,SelectEventPlugin:be,BeforeInputEventPlugin:Bb});function de(a){var b=\"\";aa.Children.forEach(a,function(a){null!=a&&(b+=a)});return b}\nfunction ee(a,b){a=n({children:void 0},b);if(b=de(b.children))a.children=b;return a}function fe(a,b,c,d){a=a.options;if(b){b={};for(var e=0;e<c.length;e++)b[\"$\"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty(\"$\"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=\"\"+zc(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}\nfunction ge(a,b){null!=b.dangerouslySetInnerHTML?t(\"91\"):void 0;return n({},b,{value:void 0,defaultValue:void 0,children:\"\"+a._wrapperState.initialValue})}function he(a,b){var c=b.value;null==c&&(c=b.defaultValue,b=b.children,null!=b&&(null!=c?t(\"92\"):void 0,Array.isArray(b)&&(1>=b.length?void 0:t(\"93\"),b=b[0]),c=b),null==c&&(c=\"\"));a._wrapperState={initialValue:zc(c)}}\nfunction ie(a,b){var c=zc(b.value),d=zc(b.defaultValue);null!=c&&(c=\"\"+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=\"\"+d)}function je(a){var b=a.textContent;b===a._wrapperState.initialValue&&(a.value=b)}var ke={html:\"http://www.w3.org/1999/xhtml\",mathml:\"http://www.w3.org/1998/Math/MathML\",svg:\"http://www.w3.org/2000/svg\"};\nfunction le(a){switch(a){case \"svg\":return\"http://www.w3.org/2000/svg\";case \"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}function me(a,b){return null==a||\"http://www.w3.org/1999/xhtml\"===a?le(b):\"http://www.w3.org/2000/svg\"===a&&\"foreignObject\"===b?\"http://www.w3.org/1999/xhtml\":a}\nvar ne=void 0,oe=function(a){return\"undefined\"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if(a.namespaceURI!==ke.svg||\"innerHTML\"in a)a.innerHTML=b;else{ne=ne||document.createElement(\"div\");ne.innerHTML=\"<svg>\"+b+\"</svg>\";for(b=ne.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}});\nfunction pe(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b}\nvar qe={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,\nfloodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},re=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(qe).forEach(function(a){re.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);qe[b]=qe[a]})});function se(a,b,c){return null==b||\"boolean\"===typeof b||\"\"===b?\"\":c||\"number\"!==typeof b||0===b||qe.hasOwnProperty(a)&&qe[a]?(\"\"+b).trim():b+\"px\"}\nfunction te(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf(\"--\"),e=se(c,b[c],d);\"float\"===c&&(c=\"cssFloat\");d?a.setProperty(c,e):a[c]=e}}var ue=n({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});\nfunction ve(a,b){b&&(ue[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML?t(\"137\",a,\"\"):void 0),null!=b.dangerouslySetInnerHTML&&(null!=b.children?t(\"60\"):void 0,\"object\"===typeof b.dangerouslySetInnerHTML&&\"__html\"in b.dangerouslySetInnerHTML?void 0:t(\"61\")),null!=b.style&&\"object\"!==typeof b.style?t(\"62\",\"\"):void 0)}\nfunction we(a,b){if(-1===a.indexOf(\"-\"))return\"string\"===typeof b.is;switch(a){case \"annotation-xml\":case \"color-profile\":case \"font-face\":case \"font-face-src\":case \"font-face-uri\":case \"font-face-format\":case \"font-face-name\":case \"missing-glyph\":return!1;default:return!0}}\nfunction xe(a,b){a=9===a.nodeType||11===a.nodeType?a:a.ownerDocument;var c=Od(a);b=ta[b];for(var d=0;d<b.length;d++){var e=b[d];if(!c.hasOwnProperty(e)||!c[e]){switch(e){case \"scroll\":Kd(\"scroll\",a);break;case \"focus\":case \"blur\":Kd(\"focus\",a);Kd(\"blur\",a);c.blur=!0;c.focus=!0;break;case \"cancel\":case \"close\":Sb(e)&&Kd(e,a);break;case \"invalid\":case \"submit\":case \"reset\":break;default:-1===bb.indexOf(e)&&G(e,a)}c[e]=!0}}}function ye(){}var ze=null,Ae=null;\nfunction Be(a,b){switch(a){case \"button\":case \"input\":case \"select\":case \"textarea\":return!!b.autoFocus}return!1}function Ce(a,b){return\"textarea\"===a||\"option\"===a||\"noscript\"===a||\"string\"===typeof b.children||\"number\"===typeof b.children||\"object\"===typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}var De=\"function\"===typeof setTimeout?setTimeout:void 0,Ee=\"function\"===typeof clearTimeout?clearTimeout:void 0;\nfunction Fe(a){for(a=a.nextSibling;a&&1!==a.nodeType&&3!==a.nodeType;)a=a.nextSibling;return a}function Ge(a){for(a=a.firstChild;a&&1!==a.nodeType&&3!==a.nodeType;)a=a.nextSibling;return a}new Set;var He=[],Ie=-1;function H(a){0>Ie||(a.current=He[Ie],He[Ie]=null,Ie--)}function I(a,b){Ie++;He[Ie]=a.current;a.current=b}var Je={},J={current:Je},K={current:!1},Ke=Je;\nfunction Le(a,b){var c=a.type.contextTypes;if(!c)return Je;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}function L(a){a=a.childContextTypes;return null!==a&&void 0!==a}function Me(a){H(K,a);H(J,a)}function Ne(a){H(K,a);H(J,a)}\nfunction Oe(a,b,c){J.current!==Je?t(\"168\"):void 0;I(J,b,a);I(K,c,a)}function Pe(a,b,c){var d=a.stateNode;a=b.childContextTypes;if(\"function\"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)e in a?void 0:t(\"108\",mc(b)||\"Unknown\",e);return n({},c,d)}function Qe(a){var b=a.stateNode;b=b&&b.__reactInternalMemoizedMergedChildContext||Je;Ke=J.current;I(J,b,a);I(K,K.current,a);return!0}\nfunction Re(a,b,c){var d=a.stateNode;d?void 0:t(\"169\");c?(b=Pe(a,b,Ke),d.__reactInternalMemoizedMergedChildContext=b,H(K,a),H(J,a),I(J,b,a)):H(K,a);I(K,c,a)}var Se=null,Te=null;function Ue(a){return function(b){try{return a(b)}catch(c){}}}\nfunction Ve(a){if(\"undefined\"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)return!0;try{var c=b.inject(a);Se=Ue(function(a){return b.onCommitFiberRoot(c,a)});Te=Ue(function(a){return b.onCommitFiberUnmount(c,a)})}catch(d){}return!0}\nfunction We(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.firstContextDependency=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.effectTag=0;this.lastEffect=this.firstEffect=this.nextEffect=null;this.childExpirationTime=this.expirationTime=0;this.alternate=null}function M(a,b,c,d){return new We(a,b,c,d)}\nfunction Xe(a){a=a.prototype;return!(!a||!a.isReactComponent)}function Ye(a){if(\"function\"===typeof a)return Xe(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===gc)return 11;if(a===ic)return 14}return 2}\nfunction Ze(a,b){var c=a.alternate;null===c?(c=M(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.effectTag=0,c.nextEffect=null,c.firstEffect=null,c.lastEffect=null);c.childExpirationTime=a.childExpirationTime;c.expirationTime=a.expirationTime;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;c.firstContextDependency=a.firstContextDependency;c.sibling=a.sibling;\nc.index=a.index;c.ref=a.ref;return c}\nfunction $e(a,b,c,d,e,f){var g=2;d=a;if(\"function\"===typeof a)Xe(a)&&(g=1);else if(\"string\"===typeof a)g=5;else a:switch(a){case ac:return af(c.children,e,f,b);case fc:return bf(c,e|3,f,b);case bc:return bf(c,e|2,f,b);case cc:return a=M(12,c,b,e|4),a.elementType=cc,a.type=cc,a.expirationTime=f,a;case hc:return a=M(13,c,b,e),a.elementType=hc,a.type=hc,a.expirationTime=f,a;default:if(\"object\"===typeof a&&null!==a)switch(a.$$typeof){case dc:g=10;break a;case ec:g=9;break a;case gc:g=11;break a;case ic:g=\n14;break a;case jc:g=16;d=null;break a}t(\"130\",null==a?a:typeof a,\"\")}b=M(g,c,b,e);b.elementType=a;b.type=d;b.expirationTime=f;return b}function af(a,b,c,d){a=M(7,a,d,b);a.expirationTime=c;return a}function bf(a,b,c,d){a=M(8,a,d,b);b=0===(b&1)?bc:fc;a.elementType=b;a.type=b;a.expirationTime=c;return a}function cf(a,b,c){a=M(6,a,null,b);a.expirationTime=c;return a}\nfunction df(a,b,c){b=M(4,null!==a.children?a.children:[],a.key,b);b.expirationTime=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}function ef(a,b){a.didError=!1;var c=a.earliestPendingTime;0===c?a.earliestPendingTime=a.latestPendingTime=b:c<b?a.earliestPendingTime=b:a.latestPendingTime>b&&(a.latestPendingTime=b);ff(b,a)}\nfunction gf(a,b){a.didError=!1;var c=a.latestPingedTime;0!==c&&c>=b&&(a.latestPingedTime=0);c=a.earliestPendingTime;var d=a.latestPendingTime;c===b?a.earliestPendingTime=d===b?a.latestPendingTime=0:d:d===b&&(a.latestPendingTime=c);c=a.earliestSuspendedTime;d=a.latestSuspendedTime;0===c?a.earliestSuspendedTime=a.latestSuspendedTime=b:c<b?a.earliestSuspendedTime=b:d>b&&(a.latestSuspendedTime=b);ff(b,a)}\nfunction hf(a,b){var c=a.earliestPendingTime;a=a.earliestSuspendedTime;c>b&&(b=c);a>b&&(b=a);return b}function ff(a,b){var c=b.earliestSuspendedTime,d=b.latestSuspendedTime,e=b.earliestPendingTime,f=b.latestPingedTime;e=0!==e?e:f;0===e&&(0===a||d<a)&&(e=d);a=e;0!==a&&c>a&&(a=c);b.nextExpirationTimeToWorkOn=e;b.expirationTime=a}var jf=!1;\nfunction kf(a){return{baseState:a,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function lf(a){return{baseState:a.baseState,firstUpdate:a.firstUpdate,lastUpdate:a.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}\nfunction mf(a){return{expirationTime:a,tag:0,payload:null,callback:null,next:null,nextEffect:null}}function nf(a,b){null===a.lastUpdate?a.firstUpdate=a.lastUpdate=b:(a.lastUpdate.next=b,a.lastUpdate=b)}\nfunction of(a,b){var c=a.alternate;if(null===c){var d=a.updateQueue;var e=null;null===d&&(d=a.updateQueue=kf(a.memoizedState))}else d=a.updateQueue,e=c.updateQueue,null===d?null===e?(d=a.updateQueue=kf(a.memoizedState),e=c.updateQueue=kf(c.memoizedState)):d=a.updateQueue=lf(e):null===e&&(e=c.updateQueue=lf(d));null===e||d===e?nf(d,b):null===d.lastUpdate||null===e.lastUpdate?(nf(d,b),nf(e,b)):(nf(d,b),e.lastUpdate=b)}\nfunction pf(a,b){var c=a.updateQueue;c=null===c?a.updateQueue=kf(a.memoizedState):qf(a,c);null===c.lastCapturedUpdate?c.firstCapturedUpdate=c.lastCapturedUpdate=b:(c.lastCapturedUpdate.next=b,c.lastCapturedUpdate=b)}function qf(a,b){var c=a.alternate;null!==c&&b===c.updateQueue&&(b=a.updateQueue=lf(b));return b}\nfunction rf(a,b,c,d,e,f){switch(c.tag){case 1:return a=c.payload,\"function\"===typeof a?a.call(f,d,e):a;case 3:a.effectTag=a.effectTag&-2049|64;case 0:a=c.payload;e=\"function\"===typeof a?a.call(f,d,e):a;if(null===e||void 0===e)break;return n({},d,e);case 2:jf=!0}return d}\nfunction sf(a,b,c,d,e){jf=!1;b=qf(a,b);for(var f=b.baseState,g=null,h=0,k=b.firstUpdate,l=f;null!==k;){var m=k.expirationTime;m<e?(null===g&&(g=k,f=l),h<m&&(h=m)):(l=rf(a,b,k,l,c,d),null!==k.callback&&(a.effectTag|=32,k.nextEffect=null,null===b.lastEffect?b.firstEffect=b.lastEffect=k:(b.lastEffect.nextEffect=k,b.lastEffect=k)));k=k.next}m=null;for(k=b.firstCapturedUpdate;null!==k;){var q=k.expirationTime;q<e?(null===m&&(m=k,null===g&&(f=l)),h<q&&(h=q)):(l=rf(a,b,k,l,c,d),null!==k.callback&&(a.effectTag|=\n32,k.nextEffect=null,null===b.lastCapturedEffect?b.firstCapturedEffect=b.lastCapturedEffect=k:(b.lastCapturedEffect.nextEffect=k,b.lastCapturedEffect=k)));k=k.next}null===g&&(b.lastUpdate=null);null===m?b.lastCapturedUpdate=null:a.effectTag|=32;null===g&&null===m&&(f=l);b.baseState=f;b.firstUpdate=g;b.firstCapturedUpdate=m;a.expirationTime=h;a.memoizedState=l}\nfunction tf(a,b,c){null!==b.firstCapturedUpdate&&(null!==b.lastUpdate&&(b.lastUpdate.next=b.firstCapturedUpdate,b.lastUpdate=b.lastCapturedUpdate),b.firstCapturedUpdate=b.lastCapturedUpdate=null);uf(b.firstEffect,c);b.firstEffect=b.lastEffect=null;uf(b.firstCapturedEffect,c);b.firstCapturedEffect=b.lastCapturedEffect=null}function uf(a,b){for(;null!==a;){var c=a.callback;if(null!==c){a.callback=null;var d=b;\"function\"!==typeof c?t(\"191\",c):void 0;c.call(d)}a=a.nextEffect}}\nfunction vf(a,b){return{value:a,source:b,stack:nc(b)}}var wf={current:null},xf=null,yf=null,zf=null;function Af(a,b){var c=a.type._context;I(wf,c._currentValue,a);c._currentValue=b}function Bf(a){var b=wf.current;H(wf,a);a.type._context._currentValue=b}function Cf(a){xf=a;zf=yf=null;a.firstContextDependency=null}\nfunction Df(a,b){if(zf!==a&&!1!==b&&0!==b){if(\"number\"!==typeof b||1073741823===b)zf=a,b=1073741823;b={context:a,observedBits:b,next:null};null===yf?(null===xf?t(\"293\"):void 0,xf.firstContextDependency=yf=b):yf=yf.next=b}return a._currentValue}var Ef={},N={current:Ef},Ff={current:Ef},Gf={current:Ef};function Hf(a){a===Ef?t(\"174\"):void 0;return a}\nfunction If(a,b){I(Gf,b,a);I(Ff,a,a);I(N,Ef,a);var c=b.nodeType;switch(c){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:me(null,\"\");break;default:c=8===c?b.parentNode:b,b=c.namespaceURI||null,c=c.tagName,b=me(b,c)}H(N,a);I(N,b,a)}function Jf(a){H(N,a);H(Ff,a);H(Gf,a)}function Kf(a){Hf(Gf.current);var b=Hf(N.current);var c=me(b,a.type);b!==c&&(I(Ff,a,a),I(N,c,a))}function Lf(a){Ff.current===a&&(H(N,a),H(Ff,a))}\nfunction O(a,b){if(a&&a.defaultProps){b=n({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c])}return b}function Mf(a){var b=a._result;switch(a._status){case 1:return b;case 2:throw b;case 0:throw b;default:throw a._status=0,b=a._ctor,b=b(),b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)}),a._result=b,b;}}var Nf=Xb.ReactCurrentOwner,Of=(new aa.Component).refs;\nfunction Pf(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:n({},b,c);a.memoizedState=c;d=a.updateQueue;null!==d&&0===a.expirationTime&&(d.baseState=c)}\nvar Uf={isMounted:function(a){return(a=a._reactInternalFiber)?2===kd(a):!1},enqueueSetState:function(a,b,c){a=a._reactInternalFiber;var d=Qf();d=Rf(d,a);var e=mf(d);e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Sf();of(a,e);Tf(a,d)},enqueueReplaceState:function(a,b,c){a=a._reactInternalFiber;var d=Qf();d=Rf(d,a);var e=mf(d);e.tag=1;e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Sf();of(a,e);Tf(a,d)},enqueueForceUpdate:function(a,b){a=a._reactInternalFiber;var c=Qf();c=Rf(c,a);var d=mf(c);d.tag=\n2;void 0!==b&&null!==b&&(d.callback=b);Sf();of(a,d);Tf(a,c)}};function Vf(a,b,c,d,e,f,g){a=a.stateNode;return\"function\"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,f,g):b.prototype&&b.prototype.isPureReactComponent?!jd(c,d)||!jd(e,f):!0}\nfunction Wf(a,b,c){var d=!1,e=Je;var f=b.contextType;\"object\"===typeof f&&null!==f?f=Nf.currentDispatcher.readContext(f):(e=L(b)?Ke:J.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?Le(a,e):Je);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Uf;a.stateNode=b;b._reactInternalFiber=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}\nfunction Xf(a,b,c,d){a=b.state;\"function\"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);\"function\"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Uf.enqueueReplaceState(b,b.state,null)}\nfunction Yf(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs=Of;var f=b.contextType;\"object\"===typeof f&&null!==f?e.context=Nf.currentDispatcher.readContext(f):(f=L(b)?Ke:J.current,e.context=Le(a,f));f=a.updateQueue;null!==f&&(sf(a,f,c,e,d),e.state=a.memoizedState);f=b.getDerivedStateFromProps;\"function\"===typeof f&&(Pf(a,b,f,c),e.state=a.memoizedState);\"function\"===typeof b.getDerivedStateFromProps||\"function\"===typeof e.getSnapshotBeforeUpdate||\"function\"!==typeof e.UNSAFE_componentWillMount&&\n\"function\"!==typeof e.componentWillMount||(b=e.state,\"function\"===typeof e.componentWillMount&&e.componentWillMount(),\"function\"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Uf.enqueueReplaceState(e,e.state,null),f=a.updateQueue,null!==f&&(sf(a,f,c,e,d),e.state=a.memoizedState));\"function\"===typeof e.componentDidMount&&(a.effectTag|=4)}var Zf=Array.isArray;\nfunction $f(a,b,c){a=c.ref;if(null!==a&&\"function\"!==typeof a&&\"object\"!==typeof a){if(c._owner){c=c._owner;var d=void 0;c&&(1!==c.tag?t(\"289\"):void 0,d=c.stateNode);d?void 0:t(\"147\",a);var e=\"\"+a;if(null!==b&&null!==b.ref&&\"function\"===typeof b.ref&&b.ref._stringRef===e)return b.ref;b=function(a){var b=d.refs;b===Of&&(b=d.refs={});null===a?delete b[e]:b[e]=a};b._stringRef=e;return b}\"string\"!==typeof a?t(\"284\"):void 0;c._owner?void 0:t(\"290\",a)}return a}\nfunction ag(a,b){\"textarea\"!==a.type&&t(\"31\",\"[object Object]\"===Object.prototype.toString.call(b)?\"object with keys {\"+Object.keys(b).join(\", \")+\"}\":b,\"\")}\nfunction bg(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c;c.nextEffect=null;c.effectTag=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b,c){a=Ze(a,b,c);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.effectTag=\n2,c):d;b.effectTag=2;return c}function g(b){a&&null===b.alternate&&(b.effectTag=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=cf(c,a.mode,d),b.return=a,b;b=e(b,c,d);b.return=a;return b}function k(a,b,c,d){if(null!==b&&b.elementType===c.type)return d=e(b,c.props,d),d.ref=$f(a,b,c),d.return=a,d;d=$e(c.type,c.key,c.props,null,a.mode,d);d.ref=$f(a,b,c);d.return=a;return d}function l(a,b,c,d){if(null===b||4!==b.tag||b.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==\nc.implementation)return b=df(c,a.mode,d),b.return=a,b;b=e(b,c.children||[],d);b.return=a;return b}function m(a,b,c,d,g){if(null===b||7!==b.tag)return b=af(c,a.mode,d,g),b.return=a,b;b=e(b,c,d);b.return=a;return b}function q(a,b,c){if(\"string\"===typeof b||\"number\"===typeof b)return b=cf(\"\"+b,a.mode,c),b.return=a,b;if(\"object\"===typeof b&&null!==b){switch(b.$$typeof){case Zb:return c=$e(b.type,b.key,b.props,null,a.mode,c),c.ref=$f(a,null,b),c.return=a,c;case $b:return b=df(b,a.mode,c),b.return=a,b}if(Zf(b)||\nlc(b))return b=af(b,a.mode,c,null),b.return=a,b;ag(a,b)}return null}function x(a,b,c,d){var e=null!==b?b.key:null;if(\"string\"===typeof c||\"number\"===typeof c)return null!==e?null:h(a,b,\"\"+c,d);if(\"object\"===typeof c&&null!==c){switch(c.$$typeof){case Zb:return c.key===e?c.type===ac?m(a,b,c.props.children,d,e):k(a,b,c,d):null;case $b:return c.key===e?l(a,b,c,d):null}if(Zf(c)||lc(c))return null!==e?null:m(a,b,c,d,null);ag(a,c)}return null}function z(a,b,c,d,e){if(\"string\"===typeof d||\"number\"===typeof d)return a=\na.get(c)||null,h(b,a,\"\"+d,e);if(\"object\"===typeof d&&null!==d){switch(d.$$typeof){case Zb:return a=a.get(null===d.key?c:d.key)||null,d.type===ac?m(b,a,d.props.children,e,d.key):k(b,a,d,e);case $b:return a=a.get(null===d.key?c:d.key)||null,l(b,a,d,e)}if(Zf(d)||lc(d))return a=a.get(c)||null,m(b,a,d,e,null);ag(b,d)}return null}function B(e,g,h,k){for(var l=null,r=null,m=g,u=g=0,p=null;null!==m&&u<h.length;u++){m.index>u?(p=m,m=null):p=m.sibling;var v=x(e,m,h[u],k);if(null===v){null===m&&(m=p);break}a&&\nm&&null===v.alternate&&b(e,m);g=f(v,g,u);null===r?l=v:r.sibling=v;r=v;m=p}if(u===h.length)return c(e,m),l;if(null===m){for(;u<h.length;u++)if(m=q(e,h[u],k))g=f(m,g,u),null===r?l=m:r.sibling=m,r=m;return l}for(m=d(e,m);u<h.length;u++)if(p=z(m,e,u,h[u],k))a&&null!==p.alternate&&m.delete(null===p.key?u:p.key),g=f(p,g,u),null===r?l=p:r.sibling=p,r=p;a&&m.forEach(function(a){return b(e,a)});return l}function Q(e,g,h,k){var l=lc(h);\"function\"!==typeof l?t(\"150\"):void 0;h=l.call(h);null==h?t(\"151\"):void 0;\nfor(var m=l=null,r=g,u=g=0,p=null,v=h.next();null!==r&&!v.done;u++,v=h.next()){r.index>u?(p=r,r=null):p=r.sibling;var y=x(e,r,v.value,k);if(null===y){r||(r=p);break}a&&r&&null===y.alternate&&b(e,r);g=f(y,g,u);null===m?l=y:m.sibling=y;m=y;r=p}if(v.done)return c(e,r),l;if(null===r){for(;!v.done;u++,v=h.next())v=q(e,v.value,k),null!==v&&(g=f(v,g,u),null===m?l=v:m.sibling=v,m=v);return l}for(r=d(e,r);!v.done;u++,v=h.next())v=z(r,e,u,v.value,k),null!==v&&(a&&null!==v.alternate&&r.delete(null===v.key?u:\nv.key),g=f(v,g,u),null===m?l=v:m.sibling=v,m=v);a&&r.forEach(function(a){return b(e,a)});return l}return function(a,d,f,h){var k=\"object\"===typeof f&&null!==f&&f.type===ac&&null===f.key;k&&(f=f.props.children);var l=\"object\"===typeof f&&null!==f;if(l)switch(f.$$typeof){case Zb:a:{l=f.key;for(k=d;null!==k;){if(k.key===l)if(7===k.tag?f.type===ac:k.elementType===f.type){c(a,k.sibling);d=e(k,f.type===ac?f.props.children:f.props,h);d.ref=$f(a,k,f);d.return=a;a=d;break a}else{c(a,k);break}else b(a,k);k=\nk.sibling}f.type===ac?(d=af(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=$e(f.type,f.key,f.props,null,a.mode,h),h.ref=$f(a,d,f),h.return=a,a=h)}return g(a);case $b:a:{for(k=f.key;null!==d;){if(d.key===k)if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[],h);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=df(f,a.mode,h);d.return=a;a=d}return g(a)}if(\"string\"===typeof f||\"number\"===typeof f)return f=\n\"\"+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f,h),d.return=a,a=d):(c(a,d),d=cf(f,a.mode,h),d.return=a,a=d),g(a);if(Zf(f))return B(a,d,f,h);if(lc(f))return Q(a,d,f,h);l&&ag(a,f);if(\"undefined\"===typeof f&&!k)switch(a.tag){case 1:case 0:h=a.type,t(\"152\",h.displayName||h.name||\"Component\")}return c(a,d)}}var cg=bg(!0),dg=bg(!1),eg=null,fg=null,gg=!1;\nfunction hg(a,b){var c=M(5,null,null,0);c.elementType=\"DELETED\";c.type=\"DELETED\";c.stateNode=b;c.return=a;c.effectTag=8;null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}function ig(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,!0):!1;case 6:return b=\"\"===a.pendingProps||3!==b.nodeType?null:b,null!==b?(a.stateNode=b,!0):!1;default:return!1}}\nfunction jg(a){if(gg){var b=fg;if(b){var c=b;if(!ig(a,b)){b=Fe(c);if(!b||!ig(a,b)){a.effectTag|=2;gg=!1;eg=a;return}hg(eg,c)}eg=a;fg=Ge(b)}else a.effectTag|=2,gg=!1,eg=a}}function kg(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag;)a=a.return;eg=a}function lg(a){if(a!==eg)return!1;if(!gg)return kg(a),gg=!0,!1;var b=a.type;if(5!==a.tag||\"head\"!==b&&\"body\"!==b&&!Ce(b,a.memoizedProps))for(b=fg;b;)hg(a,b),b=Fe(b);kg(a);fg=eg?Fe(a.stateNode):null;return!0}function mg(){fg=eg=null;gg=!1}var ng=Xb.ReactCurrentOwner;\nfunction P(a,b,c,d){b.child=null===a?dg(b,null,c,d):cg(b,a.child,c,d)}function og(a,b,c,d,e){c=c.render;var f=b.ref;Cf(b,e);d=c(d,f);b.effectTag|=1;P(a,b,d,e);return b.child}\nfunction pg(a,b,c,d,e,f){if(null===a){var g=c.type;if(\"function\"===typeof g&&!Xe(g)&&void 0===g.defaultProps&&null===c.compare)return b.tag=15,b.type=g,qg(a,b,g,d,e,f);a=$e(c.type,null,d,null,b.mode,f);a.ref=b.ref;a.return=b;return b.child=a}g=a.child;if(e<f&&(e=g.memoizedProps,c=c.compare,c=null!==c?c:jd,c(e,d)&&a.ref===b.ref))return rg(a,b,f);b.effectTag|=1;a=Ze(g,d,f);a.ref=b.ref;a.return=b;return b.child=a}\nfunction qg(a,b,c,d,e,f){return null!==a&&e<f&&jd(a.memoizedProps,d)&&a.ref===b.ref?rg(a,b,f):sg(a,b,c,d,f)}function tg(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.effectTag|=128}function sg(a,b,c,d,e){var f=L(c)?Ke:J.current;f=Le(b,f);Cf(b,e);c=c(d,f);b.effectTag|=1;P(a,b,c,e);return b.child}\nfunction ug(a,b,c,d,e){if(L(c)){var f=!0;Qe(b)}else f=!1;Cf(b,e);if(null===b.stateNode)null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),Wf(b,c,d,e),Yf(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var k=g.context,l=c.contextType;\"object\"===typeof l&&null!==l?l=Nf.currentDispatcher.readContext(l):(l=L(c)?Ke:J.current,l=Le(b,l));var m=c.getDerivedStateFromProps,q=\"function\"===typeof m||\"function\"===typeof g.getSnapshotBeforeUpdate;q||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\n\"function\"!==typeof g.componentWillReceiveProps||(h!==d||k!==l)&&Xf(b,g,d,l);jf=!1;var x=b.memoizedState;k=g.state=x;var z=b.updateQueue;null!==z&&(sf(b,z,d,g,e),k=b.memoizedState);h!==d||x!==k||K.current||jf?(\"function\"===typeof m&&(Pf(b,c,m,d),k=b.memoizedState),(h=jf||Vf(b,c,h,d,x,k,l))?(q||\"function\"!==typeof g.UNSAFE_componentWillMount&&\"function\"!==typeof g.componentWillMount||(\"function\"===typeof g.componentWillMount&&g.componentWillMount(),\"function\"===typeof g.UNSAFE_componentWillMount&&\ng.UNSAFE_componentWillMount()),\"function\"===typeof g.componentDidMount&&(b.effectTag|=4)):(\"function\"===typeof g.componentDidMount&&(b.effectTag|=4),b.memoizedProps=d,b.memoizedState=k),g.props=d,g.state=k,g.context=l,d=h):(\"function\"===typeof g.componentDidMount&&(b.effectTag|=4),d=!1)}else g=b.stateNode,h=b.memoizedProps,g.props=b.type===b.elementType?h:O(b.type,h),k=g.context,l=c.contextType,\"object\"===typeof l&&null!==l?l=Nf.currentDispatcher.readContext(l):(l=L(c)?Ke:J.current,l=Le(b,l)),m=c.getDerivedStateFromProps,\n(q=\"function\"===typeof m||\"function\"===typeof g.getSnapshotBeforeUpdate)||\"function\"!==typeof g.UNSAFE_componentWillReceiveProps&&\"function\"!==typeof g.componentWillReceiveProps||(h!==d||k!==l)&&Xf(b,g,d,l),jf=!1,k=b.memoizedState,x=g.state=k,z=b.updateQueue,null!==z&&(sf(b,z,d,g,e),x=b.memoizedState),h!==d||k!==x||K.current||jf?(\"function\"===typeof m&&(Pf(b,c,m,d),x=b.memoizedState),(m=jf||Vf(b,c,h,d,k,x,l))?(q||\"function\"!==typeof g.UNSAFE_componentWillUpdate&&\"function\"!==typeof g.componentWillUpdate||\n(\"function\"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,x,l),\"function\"===typeof g.UNSAFE_componentWillUpdate&&g.UNSAFE_componentWillUpdate(d,x,l)),\"function\"===typeof g.componentDidUpdate&&(b.effectTag|=4),\"function\"===typeof g.getSnapshotBeforeUpdate&&(b.effectTag|=256)):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=256),b.memoizedProps=\nd,b.memoizedState=x),g.props=d,g.state=x,g.context=l,d=m):(\"function\"!==typeof g.componentDidUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=4),\"function\"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=256),d=!1);return vg(a,b,c,d,f,e)}\nfunction vg(a,b,c,d,e,f){tg(a,b);var g=0!==(b.effectTag&64);if(!d&&!g)return e&&Re(b,c,!1),rg(a,b,f);d=b.stateNode;ng.current=b;var h=g&&\"function\"!==typeof c.getDerivedStateFromError?null:d.render();b.effectTag|=1;null!==a&&g?(b.child=cg(b,a.child,null,f),b.child=cg(b,null,h,f)):P(a,b,h,f);b.memoizedState=d.state;e&&Re(b,c,!0);return b.child}function wg(a){var b=a.stateNode;b.pendingContext?Oe(a,b.pendingContext,b.pendingContext!==b.context):b.context&&Oe(a,b.context,!1);If(a,b.containerInfo)}\nfunction xg(a,b,c){var d=b.mode,e=b.pendingProps,f=b.memoizedState;if(0===(b.effectTag&64)){f=null;var g=!1}else f={timedOutAt:null!==f?f.timedOutAt:0},g=!0,b.effectTag&=-65;null===a?g?(g=e.fallback,e=af(null,d,0,null),0===(b.mode&1)&&(e.child=null!==b.memoizedState?b.child.child:b.child),d=af(g,d,c,null),e.sibling=d,c=e,c.return=d.return=b):c=d=dg(b,null,e.children,c):null!==a.memoizedState?(d=a.child,a=d.sibling,g?(c=e.fallback,e=Ze(d,d.pendingProps,0),0===(b.mode&1)&&(g=null!==b.memoizedState?\nb.child.child:b.child,g!==d.child&&(e.child=g)),d=e.sibling=Ze(a,c,a.expirationTime),c=e,e.childExpirationTime=0,c.return=d.return=b):c=d=cg(b,d.child,e.children,c)):(a=a.child,g?(g=e.fallback,e=af(null,d,0,null),e.child=a,0===(b.mode&1)&&(e.child=null!==b.memoizedState?b.child.child:b.child),d=e.sibling=af(g,d,c,null),d.effectTag|=2,c=e,e.childExpirationTime=0,c.return=d.return=b):d=c=cg(b,a,e.children,c));b.memoizedState=f;b.child=c;return d}\nfunction rg(a,b,c){null!==a&&(b.firstContextDependency=a.firstContextDependency);if(b.childExpirationTime<c)return null;null!==a&&b.child!==a.child?t(\"153\"):void 0;if(null!==b.child){a=b.child;c=Ze(a,a.pendingProps,a.expirationTime);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Ze(a,a.pendingProps,a.expirationTime),c.return=b;c.sibling=null}return b.child}\nfunction yg(a,b,c){var d=b.expirationTime;if(null!==a&&a.memoizedProps===b.pendingProps&&!K.current&&d<c){switch(b.tag){case 3:wg(b);mg();break;case 5:Kf(b);break;case 1:L(b.type)&&Qe(b);break;case 4:If(b,b.stateNode.containerInfo);break;case 10:Af(b,b.memoizedProps.value);break;case 13:if(null!==b.memoizedState){d=b.child.childExpirationTime;if(0!==d&&d>=c)return xg(a,b,c);b=rg(a,b,c);return null!==b?b.sibling:null}}return rg(a,b,c)}b.expirationTime=0;switch(b.tag){case 2:d=b.elementType;null!==\na&&(a.alternate=null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;var e=Le(b,J.current);Cf(b,c);e=d(a,e);b.effectTag|=1;if(\"object\"===typeof e&&null!==e&&\"function\"===typeof e.render&&void 0===e.$$typeof){b.tag=1;if(L(d)){var f=!0;Qe(b)}else f=!1;b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null;var g=d.getDerivedStateFromProps;\"function\"===typeof g&&Pf(b,d,g,a);e.updater=Uf;b.stateNode=e;e._reactInternalFiber=b;Yf(b,d,a,c);b=vg(null,b,d,!0,f,c)}else b.tag=0,P(null,b,e,c),b=b.child;\nreturn b;case 16:e=b.elementType;null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2);f=b.pendingProps;a=Mf(e);b.type=a;e=b.tag=Ye(a);f=O(a,f);g=void 0;switch(e){case 0:g=sg(null,b,a,f,c);break;case 1:g=ug(null,b,a,f,c);break;case 11:g=og(null,b,a,f,c);break;case 14:g=pg(null,b,a,O(a.type,f),d,c);break;default:t(\"283\",a)}return g;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:O(d,e),sg(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:O(d,e),ug(a,b,d,\ne,c);case 3:wg(b);d=b.updateQueue;null===d?t(\"282\"):void 0;e=b.memoizedState;e=null!==e?e.element:null;sf(b,d,b.pendingProps,null,c);d=b.memoizedState.element;if(d===e)mg(),b=rg(a,b,c);else{e=b.stateNode;if(e=(null===a||null===a.child)&&e.hydrate)fg=Ge(b.stateNode.containerInfo),eg=b,e=gg=!0;e?(b.effectTag|=2,b.child=dg(b,null,d,c)):(P(a,b,d,c),mg());b=b.child}return b;case 5:return Kf(b),null===a&&jg(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:null,g=e.children,Ce(d,e)?g=null:null!==\nf&&Ce(d,f)&&(b.effectTag|=16),tg(a,b),1!==c&&b.mode&1&&e.hidden?(b.expirationTime=1,b=null):(P(a,b,g,c),b=b.child),b;case 6:return null===a&&jg(b),null;case 13:return xg(a,b,c);case 4:return If(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=cg(b,null,d,c):P(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:O(d,e),og(a,b,d,e,c);case 7:return P(a,b,b.pendingProps,c),b.child;case 8:return P(a,b,b.pendingProps.children,c),b.child;case 12:return P(a,b,b.pendingProps.children,\nc),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;g=b.memoizedProps;f=e.value;Af(b,f);if(null!==g){var h=g.value;f=h===f&&(0!==h||1/h===1/f)||h!==h&&f!==f?0:(\"function\"===typeof d._calculateChangedBits?d._calculateChangedBits(h,f):1073741823)|0;if(0===f){if(g.children===e.children&&!K.current){b=rg(a,b,c);break a}}else for(g=b.child,null!==g&&(g.return=b);null!==g;){h=g.firstContextDependency;if(null!==h){do{if(h.context===d&&0!==(h.observedBits&f)){if(1===g.tag){var k=mf(c);k.tag=2;of(g,k)}g.expirationTime<\nc&&(g.expirationTime=c);k=g.alternate;null!==k&&k.expirationTime<c&&(k.expirationTime=c);for(var l=g.return;null!==l;){k=l.alternate;if(l.childExpirationTime<c)l.childExpirationTime=c,null!==k&&k.childExpirationTime<c&&(k.childExpirationTime=c);else if(null!==k&&k.childExpirationTime<c)k.childExpirationTime=c;else break;l=l.return}}k=g.child;h=h.next}while(null!==h)}else k=10===g.tag?g.type===b.type?null:g.child:g.child;if(null!==k)k.return=g;else for(k=g;null!==k;){if(k===b){k=null;break}g=k.sibling;\nif(null!==g){g.return=k.return;k=g;break}k=k.return}g=k}}P(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,f=b.pendingProps,d=f.children,Cf(b,c),e=Df(e,f.unstable_observedBits),d=d(e),b.effectTag|=1,P(a,b,d,c),b.child;case 14:return e=b.type,f=O(e.type,b.pendingProps),pg(a,b,e,f,d,c);case 15:return qg(a,b,b.type,b.pendingProps,d,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:O(d,e),null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),b.tag=1,L(d)?(a=!0,Qe(b)):\na=!1,Cf(b,c),Wf(b,d,e,c),Yf(b,d,e,c),vg(null,b,d,!0,a,c);default:t(\"156\")}}function zg(a){a.effectTag|=4}var Ag=void 0,Bg=void 0,Fg=void 0,Gg=void 0;Ag=function(a,b){for(var c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};Bg=function(){};\nFg=function(a,b,c,d,e){var f=a.memoizedProps;if(f!==d){var g=b.stateNode;Hf(N.current);a=null;switch(c){case \"input\":f=Ac(g,f);d=Ac(g,d);a=[];break;case \"option\":f=ee(g,f);d=ee(g,d);a=[];break;case \"select\":f=n({},f,{value:void 0});d=n({},d,{value:void 0});a=[];break;case \"textarea\":f=ge(g,f);d=ge(g,d);a=[];break;default:\"function\"!==typeof f.onClick&&\"function\"===typeof d.onClick&&(g.onclick=ye)}ve(c,d);g=c=void 0;var h=null;for(c in f)if(!d.hasOwnProperty(c)&&f.hasOwnProperty(c)&&null!=f[c])if(\"style\"===\nc){var k=f[c];for(g in k)k.hasOwnProperty(g)&&(h||(h={}),h[g]=\"\")}else\"dangerouslySetInnerHTML\"!==c&&\"children\"!==c&&\"suppressContentEditableWarning\"!==c&&\"suppressHydrationWarning\"!==c&&\"autoFocus\"!==c&&(sa.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in d){var l=d[c];k=null!=f?f[c]:void 0;if(d.hasOwnProperty(c)&&l!==k&&(null!=l||null!=k))if(\"style\"===c)if(k){for(g in k)!k.hasOwnProperty(g)||l&&l.hasOwnProperty(g)||(h||(h={}),h[g]=\"\");for(g in l)l.hasOwnProperty(g)&&k[g]!==l[g]&&(h||\n(h={}),h[g]=l[g])}else h||(a||(a=[]),a.push(c,h)),h=l;else\"dangerouslySetInnerHTML\"===c?(l=l?l.__html:void 0,k=k?k.__html:void 0,null!=l&&k!==l&&(a=a||[]).push(c,\"\"+l)):\"children\"===c?k===l||\"string\"!==typeof l&&\"number\"!==typeof l||(a=a||[]).push(c,\"\"+l):\"suppressContentEditableWarning\"!==c&&\"suppressHydrationWarning\"!==c&&(sa.hasOwnProperty(c)?(null!=l&&xe(e,c),a||k===l||(a=[])):(a=a||[]).push(c,l))}h&&(a=a||[]).push(\"style\",h);e=a;(b.updateQueue=e)&&zg(b)}};Gg=function(a,b,c,d){c!==d&&zg(b)};\nfunction Hg(a,b){var c=b.source,d=b.stack;null===d&&null!==c&&(d=nc(c));null!==c&&mc(c.type);b=b.value;null!==a&&1===a.tag&&mc(a.type);try{console.error(b)}catch(e){setTimeout(function(){throw e;})}}function Ig(a){var b=a.ref;if(null!==b)if(\"function\"===typeof b)try{b(null)}catch(c){Jg(a,c)}else b.current=null}\nfunction Kg(a){\"function\"===typeof Te&&Te(a);switch(a.tag){case 0:case 11:case 14:case 15:var b=a.updateQueue;if(null!==b&&(b=b.lastEffect,null!==b)){var c=b=b.next;do{var d=c.destroy;if(null!==d){var e=a;try{d()}catch(f){Jg(e,f)}}c=c.next}while(c!==b)}break;case 1:Ig(a);b=a.stateNode;if(\"function\"===typeof b.componentWillUnmount)try{b.props=a.memoizedProps,b.state=a.memoizedState,b.componentWillUnmount()}catch(f){Jg(a,f)}break;case 5:Ig(a);break;case 4:Lg(a)}}\nfunction Mg(a){return 5===a.tag||3===a.tag||4===a.tag}\nfunction Ng(a){a:{for(var b=a.return;null!==b;){if(Mg(b)){var c=b;break a}b=b.return}t(\"160\");c=void 0}var d=b=void 0;switch(c.tag){case 5:b=c.stateNode;d=!1;break;case 3:b=c.stateNode.containerInfo;d=!0;break;case 4:b=c.stateNode.containerInfo;d=!0;break;default:t(\"161\")}c.effectTag&16&&(pe(b,\"\"),c.effectTag&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c.return||Mg(c.return)){c=null;break a}c=c.return}c.sibling.return=c.return;for(c=c.sibling;5!==c.tag&&6!==c.tag;){if(c.effectTag&2)continue b;\nif(null===c.child||4===c.tag)continue b;else c.child.return=c,c=c.child}if(!(c.effectTag&2)){c=c.stateNode;break a}}for(var e=a;;){if(5===e.tag||6===e.tag)if(c)if(d){var f=b,g=e.stateNode,h=c;8===f.nodeType?f.parentNode.insertBefore(g,h):f.insertBefore(g,h)}else b.insertBefore(e.stateNode,c);else d?(g=b,h=e.stateNode,8===g.nodeType?(f=g.parentNode,f.insertBefore(h,g)):(f=g,f.appendChild(h)),g=g._reactRootContainer,null!==g&&void 0!==g||null!==f.onclick||(f.onclick=ye)):b.appendChild(e.stateNode);\nelse if(4!==e.tag&&null!==e.child){e.child.return=e;e=e.child;continue}if(e===a)break;for(;null===e.sibling;){if(null===e.return||e.return===a)return;e=e.return}e.sibling.return=e.return;e=e.sibling}}\nfunction Lg(a){for(var b=a,c=!1,d=void 0,e=void 0;;){if(!c){c=b.return;a:for(;;){null===c?t(\"160\"):void 0;switch(c.tag){case 5:d=c.stateNode;e=!1;break a;case 3:d=c.stateNode.containerInfo;e=!0;break a;case 4:d=c.stateNode.containerInfo;e=!0;break a}c=c.return}c=!0}if(5===b.tag||6===b.tag){a:for(var f=b,g=f;;)if(Kg(g),null!==g.child&&4!==g.tag)g.child.return=g,g=g.child;else{if(g===f)break;for(;null===g.sibling;){if(null===g.return||g.return===f)break a;g=g.return}g.sibling.return=g.return;g=g.sibling}e?\n(f=d,g=b.stateNode,8===f.nodeType?f.parentNode.removeChild(g):f.removeChild(g)):d.removeChild(b.stateNode)}else if(4===b.tag?(d=b.stateNode.containerInfo,e=!0):Kg(b),null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return;b=b.return;4===b.tag&&(c=!1)}b.sibling.return=b.return;b=b.sibling}}\nfunction Og(a,b){switch(b.tag){case 0:case 11:case 14:case 15:break;case 1:break;case 5:var c=b.stateNode;if(null!=c){var d=b.memoizedProps,e=null!==a?a.memoizedProps:d;a=b.type;var f=b.updateQueue;b.updateQueue=null;if(null!==f){c[Ha]=d;\"input\"===a&&\"radio\"===d.type&&null!=d.name&&Cc(c,d);we(a,e);b=we(a,d);for(e=0;e<f.length;e+=2){var g=f[e],h=f[e+1];\"style\"===g?te(c,h):\"dangerouslySetInnerHTML\"===g?oe(c,h):\"children\"===g?pe(c,h):yc(c,g,h,b)}switch(a){case \"input\":Dc(c,d);break;case \"textarea\":ie(c,\nd);break;case \"select\":b=c._wrapperState.wasMultiple,c._wrapperState.wasMultiple=!!d.multiple,a=d.value,null!=a?fe(c,!!d.multiple,a,!1):b!==!!d.multiple&&(null!=d.defaultValue?fe(c,!!d.multiple,d.defaultValue,!0):fe(c,!!d.multiple,d.multiple?[]:\"\",!1))}}}break;case 6:null===b.stateNode?t(\"162\"):void 0;b.stateNode.nodeValue=b.memoizedProps;break;case 3:break;case 12:break;case 13:c=b.memoizedState;a=b;null===c?d=!1:(d=!0,a=b.child,0===c.timedOutAt&&(c.timedOutAt=Qf()));if(null!==a)a:for(b=c=a;;){if(5===\nb.tag)a=b.stateNode,d?a.style.display=\"none\":(a=b.stateNode,f=b.memoizedProps.style,f=void 0!==f&&null!==f&&f.hasOwnProperty(\"display\")?f.display:null,a.style.display=se(\"display\",f));else if(6===b.tag)b.stateNode.nodeValue=d?\"\":b.memoizedProps;else if(13===b.tag&&null!==b.memoizedState){a=b.child.sibling;a.return=b;b=a;continue}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===c)break a;for(;null===b.sibling;){if(null===b.return||b.return===c)break a;b=b.return}b.sibling.return=\nb.return;b=b.sibling}break;case 17:break;default:t(\"163\")}}function Pg(a,b,c){c=mf(c);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){Qg(d);Hg(a,b)};return c}\nfunction Rg(a,b,c){c=mf(c);c.tag=3;var d=a.type.getDerivedStateFromError;if(\"function\"===typeof d){var e=b.value;c.payload=function(){return d(e)}}var f=a.stateNode;null!==f&&\"function\"===typeof f.componentDidCatch&&(c.callback=function(){\"function\"!==typeof d&&(null===Sg?Sg=new Set([this]):Sg.add(this));var c=b.value,e=b.stack;Hg(a,b);this.componentDidCatch(c,{componentStack:null!==e?e:\"\"})});return c}\nfunction Tg(a){switch(a.tag){case 1:L(a.type)&&Me(a);var b=a.effectTag;return b&2048?(a.effectTag=b&-2049|64,a):null;case 3:return Jf(a),Ne(a),b=a.effectTag,0!==(b&64)?t(\"285\"):void 0,a.effectTag=b&-2049|64,a;case 5:return Lf(a),null;case 13:return b=a.effectTag,b&2048?(a.effectTag=b&-2049|64,a):null;case 4:return Jf(a),null;case 10:return Bf(a),null;default:return null}}\nvar Ug={readContext:Df},Vg=Xb.ReactCurrentOwner,Wg=1073741822,Xg=0,Yg=!1,R=null,S=null,T=0,Zg=-1,$g=!1,U=null,ah=!1,bh=null,ch=null,Sg=null;function dh(){if(null!==R)for(var a=R.return;null!==a;){var b=a;switch(b.tag){case 1:var c=b.type.childContextTypes;null!==c&&void 0!==c&&Me(b);break;case 3:Jf(b);Ne(b);break;case 5:Lf(b);break;case 4:Jf(b);break;case 10:Bf(b)}a=a.return}S=null;T=0;Zg=-1;$g=!1;R=null}function Sf(){null!==ch&&(ba.unstable_cancelCallback(bh),ch())}\nfunction eh(a){for(;;){var b=a.alternate,c=a.return,d=a.sibling;if(0===(a.effectTag&1024)){R=a;a:{var e=b;b=a;var f=T;var g=b.pendingProps;switch(b.tag){case 2:break;case 16:break;case 15:case 0:break;case 1:L(b.type)&&Me(b);break;case 3:Jf(b);Ne(b);g=b.stateNode;g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null);if(null===e||null===e.child)lg(b),b.effectTag&=-3;Bg(b);break;case 5:Lf(b);var h=Hf(Gf.current);f=b.type;if(null!==e&&null!=b.stateNode)Fg(e,b,f,g,h),e.ref!==b.ref&&(b.effectTag|=\n128);else if(g){var k=Hf(N.current);if(lg(b)){g=b;e=g.stateNode;var l=g.type,m=g.memoizedProps,q=h;e[Ga]=g;e[Ha]=m;f=void 0;h=l;switch(h){case \"iframe\":case \"object\":G(\"load\",e);break;case \"video\":case \"audio\":for(l=0;l<bb.length;l++)G(bb[l],e);break;case \"source\":G(\"error\",e);break;case \"img\":case \"image\":case \"link\":G(\"error\",e);G(\"load\",e);break;case \"form\":G(\"reset\",e);G(\"submit\",e);break;case \"details\":G(\"toggle\",e);break;case \"input\":Bc(e,m);G(\"invalid\",e);xe(q,\"onChange\");break;case \"select\":e._wrapperState=\n{wasMultiple:!!m.multiple};G(\"invalid\",e);xe(q,\"onChange\");break;case \"textarea\":he(e,m),G(\"invalid\",e),xe(q,\"onChange\")}ve(h,m);l=null;for(f in m)m.hasOwnProperty(f)&&(k=m[f],\"children\"===f?\"string\"===typeof k?e.textContent!==k&&(l=[\"children\",k]):\"number\"===typeof k&&e.textContent!==\"\"+k&&(l=[\"children\",\"\"+k]):sa.hasOwnProperty(f)&&null!=k&&xe(q,f));switch(h){case \"input\":Vb(e);Fc(e,m,!0);break;case \"textarea\":Vb(e);je(e,m);break;case \"select\":case \"option\":break;default:\"function\"===typeof m.onClick&&\n(e.onclick=ye)}f=l;g.updateQueue=f;g=null!==f?!0:!1;g&&zg(b)}else{m=b;e=f;q=g;l=9===h.nodeType?h:h.ownerDocument;k===ke.html&&(k=le(e));k===ke.html?\"script\"===e?(e=l.createElement(\"div\"),e.innerHTML=\"<script>\\x3c/script>\",l=e.removeChild(e.firstChild)):\"string\"===typeof q.is?l=l.createElement(e,{is:q.is}):(l=l.createElement(e),\"select\"===e&&q.multiple&&(l.multiple=!0)):l=l.createElementNS(k,e);e=l;e[Ga]=m;e[Ha]=g;Ag(e,b,!1,!1);q=e;l=f;m=g;var x=h,z=we(l,m);switch(l){case \"iframe\":case \"object\":G(\"load\",\nq);h=m;break;case \"video\":case \"audio\":for(h=0;h<bb.length;h++)G(bb[h],q);h=m;break;case \"source\":G(\"error\",q);h=m;break;case \"img\":case \"image\":case \"link\":G(\"error\",q);G(\"load\",q);h=m;break;case \"form\":G(\"reset\",q);G(\"submit\",q);h=m;break;case \"details\":G(\"toggle\",q);h=m;break;case \"input\":Bc(q,m);h=Ac(q,m);G(\"invalid\",q);xe(x,\"onChange\");break;case \"option\":h=ee(q,m);break;case \"select\":q._wrapperState={wasMultiple:!!m.multiple};h=n({},m,{value:void 0});G(\"invalid\",q);xe(x,\"onChange\");break;case \"textarea\":he(q,\nm);h=ge(q,m);G(\"invalid\",q);xe(x,\"onChange\");break;default:h=m}ve(l,h);k=void 0;var B=l,Q=q,v=h;for(k in v)if(v.hasOwnProperty(k)){var r=v[k];\"style\"===k?te(Q,r):\"dangerouslySetInnerHTML\"===k?(r=r?r.__html:void 0,null!=r&&oe(Q,r)):\"children\"===k?\"string\"===typeof r?(\"textarea\"!==B||\"\"!==r)&&pe(Q,r):\"number\"===typeof r&&pe(Q,\"\"+r):\"suppressContentEditableWarning\"!==k&&\"suppressHydrationWarning\"!==k&&\"autoFocus\"!==k&&(sa.hasOwnProperty(k)?null!=r&&xe(x,k):null!=r&&yc(Q,k,r,z))}switch(l){case \"input\":Vb(q);\nFc(q,m,!1);break;case \"textarea\":Vb(q);je(q,m);break;case \"option\":null!=m.value&&q.setAttribute(\"value\",\"\"+zc(m.value));break;case \"select\":h=q;h.multiple=!!m.multiple;q=m.value;null!=q?fe(h,!!m.multiple,q,!1):null!=m.defaultValue&&fe(h,!!m.multiple,m.defaultValue,!0);break;default:\"function\"===typeof h.onClick&&(q.onclick=ye)}(g=Be(f,g))&&zg(b);b.stateNode=e}null!==b.ref&&(b.effectTag|=128)}else null===b.stateNode?t(\"166\"):void 0;break;case 6:e&&null!=b.stateNode?Gg(e,b,e.memoizedProps,g):(\"string\"!==\ntypeof g&&(null===b.stateNode?t(\"166\"):void 0),e=Hf(Gf.current),Hf(N.current),lg(b)?(g=b,f=g.stateNode,e=g.memoizedProps,f[Ga]=g,(g=f.nodeValue!==e)&&zg(b)):(f=b,g=(9===e.nodeType?e:e.ownerDocument).createTextNode(g),g[Ga]=b,f.stateNode=g));break;case 11:break;case 13:g=b.memoizedState;if(0!==(b.effectTag&64)){b.expirationTime=f;R=b;break a}g=null!==g;f=null!==e&&null!==e.memoizedState;null!==e&&!g&&f&&(e=e.child.sibling,null!==e&&(h=b.firstEffect,null!==h?(b.firstEffect=e,e.nextEffect=h):(b.firstEffect=\nb.lastEffect=e,e.nextEffect=null),e.effectTag=8));if(g!==f||0===(b.effectTag&1)&&g)b.effectTag|=4;break;case 7:break;case 8:break;case 12:break;case 4:Jf(b);Bg(b);break;case 10:Bf(b);break;case 9:break;case 14:break;case 17:L(b.type)&&Me(b);break;default:t(\"156\")}R=null}b=a;if(1===T||1!==b.childExpirationTime){g=0;for(f=b.child;null!==f;)e=f.expirationTime,h=f.childExpirationTime,e>g&&(g=e),h>g&&(g=h),f=f.sibling;b.childExpirationTime=g}if(null!==R)return R;null!==c&&0===(c.effectTag&1024)&&(null===\nc.firstEffect&&(c.firstEffect=a.firstEffect),null!==a.lastEffect&&(null!==c.lastEffect&&(c.lastEffect.nextEffect=a.firstEffect),c.lastEffect=a.lastEffect),1<a.effectTag&&(null!==c.lastEffect?c.lastEffect.nextEffect=a:c.firstEffect=a,c.lastEffect=a))}else{a=Tg(a,T);if(null!==a)return a.effectTag&=1023,a;null!==c&&(c.firstEffect=c.lastEffect=null,c.effectTag|=1024)}if(null!==d)return d;if(null!==c)a=c;else break}return null}\nfunction fh(a){var b=yg(a.alternate,a,T);a.memoizedProps=a.pendingProps;null===b&&(b=eh(a));Vg.current=null;return b}\nfunction gh(a,b){Yg?t(\"243\"):void 0;Sf();Yg=!0;Vg.currentDispatcher=Ug;var c=a.nextExpirationTimeToWorkOn;if(c!==T||a!==S||null===R)dh(),S=a,T=c,R=Ze(S.current,null,T),a.pendingCommitExpirationTime=0;var d=!1;do{try{if(b)for(;null!==R&&!hh();)R=fh(R);else for(;null!==R;)R=fh(R)}catch(B){if(zf=yf=xf=null,null===R)d=!0,Qg(B);else{null===R?t(\"271\"):void 0;var e=R,f=e.return;if(null===f)d=!0,Qg(B);else{a:{var g=a,h=f,k=e,l=B;f=T;k.effectTag|=1024;k.firstEffect=k.lastEffect=null;if(null!==l&&\"object\"===\ntypeof l&&\"function\"===typeof l.then){var m=l;l=h;var q=-1,x=-1;do{if(13===l.tag){var z=l.alternate;if(null!==z&&(z=z.memoizedState,null!==z)){x=10*(1073741822-z.timedOutAt);break}z=l.pendingProps.maxDuration;if(\"number\"===typeof z)if(0>=z)q=0;else if(-1===q||z<q)q=z}l=l.return}while(null!==l);l=h;do{if(z=13===l.tag)z=void 0===l.memoizedProps.fallback?!1:null===l.memoizedState;if(z){h=ih.bind(null,g,l,k,0===(l.mode&1)?1073741823:f);m.then(h,h);if(0===(l.mode&1)){l.effectTag|=64;k.effectTag&=-1957;\n1===k.tag&&null===k.alternate&&(k.tag=17);k.expirationTime=f;break a}-1===q?g=1073741823:(-1===x&&(x=10*(1073741822-hf(g,f))-5E3),g=x+q);0<=g&&Zg<g&&(Zg=g);l.effectTag|=2048;l.expirationTime=f;break a}l=l.return}while(null!==l);l=Error((mc(k.type)||\"A React component\")+\" suspended while rendering, but no fallback UI was specified.\\n\\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.\"+nc(k))}$g=!0;l=vf(l,k);g=h;do{switch(g.tag){case 3:k=\nl;g.effectTag|=2048;g.expirationTime=f;f=Pg(g,k,f);pf(g,f);break a;case 1:if(k=l,h=g.type,m=g.stateNode,0===(g.effectTag&64)&&(\"function\"===typeof h.getDerivedStateFromError||null!==m&&\"function\"===typeof m.componentDidCatch&&(null===Sg||!Sg.has(m)))){g.effectTag|=2048;g.expirationTime=f;f=Rg(g,k,f);pf(g,f);break a}}g=g.return}while(null!==g)}R=eh(e);continue}}}break}while(1);Yg=!1;zf=yf=xf=Vg.currentDispatcher=null;if(d)S=null,a.finishedWork=null;else if(null!==R)a.finishedWork=null;else{d=a.current.alternate;\nnull===d?t(\"281\"):void 0;S=null;if($g){e=a.latestPendingTime;f=a.latestSuspendedTime;g=a.latestPingedTime;if(0!==e&&e<c||0!==f&&f<c||0!==g&&g<c){gf(a,c);jh(a,d,c,a.expirationTime,-1);return}if(!a.didError&&b){a.didError=!0;c=a.nextExpirationTimeToWorkOn=c;b=a.expirationTime=1073741823;jh(a,d,c,b,-1);return}}b&&-1!==Zg?(gf(a,c),b=10*(1073741822-hf(a,c)),b<Zg&&(Zg=b),b=10*(1073741822-Qf()),b=Zg-b,jh(a,d,c,a.expirationTime,0>b?0:b)):(a.pendingCommitExpirationTime=c,a.finishedWork=d)}}\nfunction Jg(a,b){for(var c=a.return;null!==c;){switch(c.tag){case 1:var d=c.stateNode;if(\"function\"===typeof c.type.getDerivedStateFromError||\"function\"===typeof d.componentDidCatch&&(null===Sg||!Sg.has(d))){a=vf(b,a);a=Rg(c,a,1073741823);of(c,a);Tf(c,1073741823);return}break;case 3:a=vf(b,a);a=Pg(c,a,1073741823);of(c,a);Tf(c,1073741823);return}c=c.return}3===a.tag&&(c=vf(b,a),c=Pg(a,c,1073741823),of(a,c),Tf(a,1073741823))}\nfunction Rf(a,b){0!==Xg?a=Xg:Yg?a=ah?1073741823:T:b.mode&1?(a=kh?1073741822-10*(((1073741822-a+15)/10|0)+1):1073741822-25*(((1073741822-a+500)/25|0)+1),null!==S&&a===T&&--a):a=1073741823;kh&&(0===lh||a<lh)&&(lh=a);return a}\nfunction ih(a,b,c,d){var e=a.earliestSuspendedTime;var f=a.latestSuspendedTime;if(0!==e&&d<=e&&d>=f){f=e=d;a.didError=!1;var g=a.latestPingedTime;if(0===g||g>f)a.latestPingedTime=f;ff(f,a)}else e=Qf(),e=Rf(e,b),ef(a,e);0!==(b.mode&1)&&a===S&&T===d&&(S=null);mh(b,e);0===(b.mode&1)&&(mh(c,e),1===c.tag&&null!==c.stateNode&&(b=mf(e),b.tag=2,of(c,b)));c=a.expirationTime;0!==c&&nh(a,c)}\nfunction mh(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);var d=a.return,e=null;if(null===d&&3===a.tag)e=a.stateNode;else for(;null!==d;){c=d.alternate;d.childExpirationTime<b&&(d.childExpirationTime=b);null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);if(null===d.return&&3===d.tag){e=d.stateNode;break}d=d.return}return e}\nfunction Tf(a,b){a=mh(a,b);null!==a&&(!Yg&&0!==T&&b>T&&dh(),ef(a,b),Yg&&!ah&&S===a||nh(a,a.expirationTime),oh>ph&&(oh=0,t(\"185\")))}function qh(a,b,c,d,e){var f=Xg;Xg=1073741823;try{return a(b,c,d,e)}finally{Xg=f}}var rh=null,V=null,sh=0,th=void 0,W=!1,uh=null,X=0,lh=0,vh=!1,wh=null,Z=!1,xh=!1,kh=!1,yh=null,zh=ba.unstable_now(),Ah=1073741822-(zh/10|0),Bh=Ah,ph=50,oh=0,Ch=null;function Dh(){Ah=1073741822-((ba.unstable_now()-zh)/10|0)}\nfunction Eh(a,b){if(0!==sh){if(b<sh)return;null!==th&&ba.unstable_cancelCallback(th)}sh=b;a=ba.unstable_now()-zh;th=ba.unstable_scheduleCallback(Fh,{timeout:10*(1073741822-b)-a})}function jh(a,b,c,d,e){a.expirationTime=d;0!==e||hh()?0<e&&(a.timeoutHandle=De(Gh.bind(null,a,b,c),e)):(a.pendingCommitExpirationTime=c,a.finishedWork=b)}function Gh(a,b,c){a.pendingCommitExpirationTime=c;a.finishedWork=b;Dh();Bh=Ah;Hh(a,c)}function Qf(){if(W)return Bh;Ih();if(0===X||1===X)Dh(),Bh=Ah;return Bh}\nfunction nh(a,b){null===a.nextScheduledRoot?(a.expirationTime=b,null===V?(rh=V=a,a.nextScheduledRoot=a):(V=V.nextScheduledRoot=a,V.nextScheduledRoot=rh)):b>a.expirationTime&&(a.expirationTime=b);W||(Z?xh&&(uh=a,X=1073741823,Jh(a,1073741823,!1)):1073741823===b?Kh(1073741823,!1):Eh(a,b))}\nfunction Ih(){var a=0,b=null;if(null!==V)for(var c=V,d=rh;null!==d;){var e=d.expirationTime;if(0===e){null===c||null===V?t(\"244\"):void 0;if(d===d.nextScheduledRoot){rh=V=d.nextScheduledRoot=null;break}else if(d===rh)rh=e=d.nextScheduledRoot,V.nextScheduledRoot=e,d.nextScheduledRoot=null;else if(d===V){V=c;V.nextScheduledRoot=rh;d.nextScheduledRoot=null;break}else c.nextScheduledRoot=d.nextScheduledRoot,d.nextScheduledRoot=null;d=c.nextScheduledRoot}else{e>a&&(a=e,b=d);if(d===V)break;if(1073741823===\na)break;c=d;d=d.nextScheduledRoot}}uh=b;X=a}var Lh=!1;function hh(){return Lh?!0:ba.unstable_shouldYield()?Lh=!0:!1}function Fh(){try{if(!hh()&&null!==rh){Dh();var a=rh;do{var b=a.expirationTime;0!==b&&Ah<=b&&(a.nextExpirationTimeToWorkOn=Ah);a=a.nextScheduledRoot}while(a!==rh)}Kh(0,!0)}finally{Lh=!1}}\nfunction Kh(a,b){Ih();if(b)for(Dh(),Bh=Ah;null!==uh&&0!==X&&a<=X&&!(Lh&&Ah>X);)Jh(uh,X,Ah>X),Ih(),Dh(),Bh=Ah;else for(;null!==uh&&0!==X&&a<=X;)Jh(uh,X,!1),Ih();b&&(sh=0,th=null);0!==X&&Eh(uh,X);oh=0;Ch=null;if(null!==yh)for(a=yh,yh=null,b=0;b<a.length;b++){var c=a[b];try{c._onComplete()}catch(d){vh||(vh=!0,wh=d)}}if(vh)throw a=wh,wh=null,vh=!1,a;}function Hh(a,b){W?t(\"253\"):void 0;uh=a;X=b;Jh(a,b,!1);Kh(1073741823,!1)}\nfunction Jh(a,b,c){W?t(\"245\"):void 0;W=!0;if(c){var d=a.finishedWork;null!==d?Mh(a,d,b):(a.finishedWork=null,d=a.timeoutHandle,-1!==d&&(a.timeoutHandle=-1,Ee(d)),gh(a,c),d=a.finishedWork,null!==d&&(hh()?a.finishedWork=d:Mh(a,d,b)))}else d=a.finishedWork,null!==d?Mh(a,d,b):(a.finishedWork=null,d=a.timeoutHandle,-1!==d&&(a.timeoutHandle=-1,Ee(d)),gh(a,c),d=a.finishedWork,null!==d&&Mh(a,d,b));W=!1}\nfunction Mh(a,b,c){var d=a.firstBatch;if(null!==d&&d._expirationTime>=c&&(null===yh?yh=[d]:yh.push(d),d._defer)){a.finishedWork=b;a.expirationTime=0;return}a.finishedWork=null;a===Ch?oh++:(Ch=a,oh=0);ah=Yg=!0;a.current===b?t(\"177\"):void 0;c=a.pendingCommitExpirationTime;0===c?t(\"261\"):void 0;a.pendingCommitExpirationTime=0;d=b.expirationTime;var e=b.childExpirationTime;d=e>d?e:d;a.didError=!1;0===d?(a.earliestPendingTime=0,a.latestPendingTime=0,a.earliestSuspendedTime=0,a.latestSuspendedTime=0,a.latestPingedTime=\n0):(e=a.latestPendingTime,0!==e&&(e>d?a.earliestPendingTime=a.latestPendingTime=0:a.earliestPendingTime>d&&(a.earliestPendingTime=a.latestPendingTime)),e=a.earliestSuspendedTime,0===e?ef(a,d):d<a.latestSuspendedTime?(a.earliestSuspendedTime=0,a.latestSuspendedTime=0,a.latestPingedTime=0,ef(a,d)):d>e&&ef(a,d));ff(0,a);Vg.current=null;1<b.effectTag?null!==b.lastEffect?(b.lastEffect.nextEffect=b,d=b.firstEffect):d=b:d=b.firstEffect;ze=Hd;e=Td();if(Ud(e)){if(\"selectionStart\"in e)var f={start:e.selectionStart,\nend:e.selectionEnd};else a:{f=(f=e.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&0!==g.rangeCount){f=g.anchorNode;var h=g.anchorOffset,k=g.focusNode;g=g.focusOffset;try{f.nodeType,k.nodeType}catch(db){f=null;break a}var l=0,m=-1,q=-1,x=0,z=0,B=e,Q=null;b:for(;;){for(var v;;){B!==f||0!==h&&3!==B.nodeType||(m=l+h);B!==k||0!==g&&3!==B.nodeType||(q=l+g);3===B.nodeType&&(l+=B.nodeValue.length);if(null===(v=B.firstChild))break;Q=B;B=v}for(;;){if(B===e)break b;Q===f&&\n++x===h&&(m=l);Q===k&&++z===g&&(q=l);if(null!==(v=B.nextSibling))break;B=Q;Q=B.parentNode}B=v}f=-1===m||-1===q?null:{start:m,end:q}}else f=null}f=f||{start:0,end:0}}else f=null;Ae={focusedElem:e,selectionRange:f};Hd=!1;for(U=d;null!==U;){e=!1;f=void 0;try{for(;null!==U;){if(U.effectTag&256)a:{var r=U.alternate;h=U;switch(h.tag){case 0:case 11:case 15:break a;case 1:if(h.effectTag&256&&null!==r){var u=r.memoizedProps,y=r.memoizedState,Y=h.stateNode,Th=Y.getSnapshotBeforeUpdate(h.elementType===h.type?\nu:O(h.type,u),y);Y.__reactInternalSnapshotBeforeUpdate=Th}break a;case 3:case 5:case 6:case 4:case 17:break a;default:t(\"163\")}}U=U.nextEffect}}catch(db){e=!0,f=db}e&&(null===U?t(\"178\"):void 0,Jg(U,f),null!==U&&(U=U.nextEffect))}for(U=d;null!==U;){r=!1;u=void 0;try{for(;null!==U;){var w=U.effectTag;w&16&&pe(U.stateNode,\"\");if(w&128){var C=U.alternate;if(null!==C){var p=C.ref;null!==p&&(\"function\"===typeof p?p(null):p.current=null)}}switch(w&14){case 2:Ng(U);U.effectTag&=-3;break;case 6:Ng(U);U.effectTag&=\n-3;Og(U.alternate,U);break;case 4:Og(U.alternate,U);break;case 8:y=U,Lg(y),y.return=null,y.child=null,y.alternate&&(y.alternate.child=null,y.alternate.return=null)}U=U.nextEffect}}catch(db){r=!0,u=db}r&&(null===U?t(\"178\"):void 0,Jg(U,u),null!==U&&(U=U.nextEffect))}p=Ae;C=Td();w=p.focusedElem;u=p.selectionRange;if(C!==w&&w&&w.ownerDocument&&Sd(w.ownerDocument.documentElement,w)){null!==u&&Ud(w)&&(C=u.start,p=u.end,void 0===p&&(p=C),\"selectionStart\"in w?(w.selectionStart=C,w.selectionEnd=Math.min(p,\nw.value.length)):(p=(C=w.ownerDocument||document)&&C.defaultView||window,p.getSelection&&(p=p.getSelection(),y=w.textContent.length,r=Math.min(u.start,y),u=void 0===u.end?r:Math.min(u.end,y),!p.extend&&r>u&&(y=u,u=r,r=y),y=Rd(w,r),Y=Rd(w,u),y&&Y&&(1!==p.rangeCount||p.anchorNode!==y.node||p.anchorOffset!==y.offset||p.focusNode!==Y.node||p.focusOffset!==Y.offset)&&(C=C.createRange(),C.setStart(y.node,y.offset),p.removeAllRanges(),r>u?(p.addRange(C),p.extend(Y.node,Y.offset)):(C.setEnd(Y.node,Y.offset),\np.addRange(C))))));C=[];for(p=w;p=p.parentNode;)1===p.nodeType&&C.push({element:p,left:p.scrollLeft,top:p.scrollTop});\"function\"===typeof w.focus&&w.focus();for(w=0;w<C.length;w++)p=C[w],p.element.scrollLeft=p.left,p.element.scrollTop=p.top}Ae=null;Hd=!!ze;ze=null;a.current=b;for(U=d;null!==U;){d=!1;w=void 0;try{for(C=c;null!==U;){var Fb=U.effectTag;if(Fb&36){var Gb=U.alternate;p=U;r=C;switch(p.tag){case 0:case 11:case 15:break;case 1:var wc=p.stateNode;if(p.effectTag&4)if(null===Gb)wc.componentDidMount();\nelse{var ci=p.elementType===p.type?Gb.memoizedProps:O(p.type,Gb.memoizedProps);wc.componentDidUpdate(ci,Gb.memoizedState,wc.__reactInternalSnapshotBeforeUpdate)}var Cg=p.updateQueue;null!==Cg&&tf(p,Cg,wc,r);break;case 3:var Dg=p.updateQueue;if(null!==Dg){u=null;if(null!==p.child)switch(p.child.tag){case 5:u=p.child.stateNode;break;case 1:u=p.child.stateNode}tf(p,Dg,u,r)}break;case 5:var di=p.stateNode;null===Gb&&p.effectTag&4&&Be(p.type,p.memoizedProps)&&di.focus();break;case 6:break;case 4:break;\ncase 12:break;case 13:break;case 17:break;default:t(\"163\")}}if(Fb&128){var Ic=U.ref;if(null!==Ic){var Eg=U.stateNode;switch(U.tag){case 5:var ce=Eg;break;default:ce=Eg}\"function\"===typeof Ic?Ic(ce):Ic.current=ce}}U=U.nextEffect}}catch(db){d=!0,w=db}d&&(null===U?t(\"178\"):void 0,Jg(U,w),null!==U&&(U=U.nextEffect))}Yg=ah=!1;\"function\"===typeof Se&&Se(b.stateNode);Fb=b.expirationTime;b=b.childExpirationTime;b=b>Fb?b:Fb;0===b&&(Sg=null);a.expirationTime=b;a.finishedWork=null}\nfunction Qg(a){null===uh?t(\"246\"):void 0;uh.expirationTime=0;vh||(vh=!0,wh=a)}function Nh(a,b){var c=Z;Z=!0;try{return a(b)}finally{(Z=c)||W||Kh(1073741823,!1)}}function Oh(a,b){if(Z&&!xh){xh=!0;try{return a(b)}finally{xh=!1}}return a(b)}function Ph(a,b,c){if(kh)return a(b,c);Z||W||0===lh||(Kh(lh,!1),lh=0);var d=kh,e=Z;Z=kh=!0;try{return a(b,c)}finally{kh=d,(Z=e)||W||Kh(1073741823,!1)}}\nfunction Qh(a,b,c,d,e){var f=b.current;a:if(c){c=c._reactInternalFiber;b:{2===kd(c)&&1===c.tag?void 0:t(\"170\");var g=c;do{switch(g.tag){case 3:g=g.stateNode.context;break b;case 1:if(L(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break b}}g=g.return}while(null!==g);t(\"171\");g=void 0}if(1===c.tag){var h=c.type;if(L(h)){c=Pe(c,h,g);break a}}c=g}else c=Je;null===b.context?b.context=c:b.pendingContext=c;b=e;e=mf(d);e.payload={element:a};b=void 0===b?null:b;null!==b&&(e.callback=b);\nSf();of(f,e);Tf(f,d);return d}function Rh(a,b,c,d){var e=b.current,f=Qf();e=Rf(f,e);return Qh(a,b,c,e,d)}function Sh(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function Uh(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:$b,key:null==d?null:\"\"+d,children:a,containerInfo:b,implementation:c}}\nCb=function(a,b,c){switch(b){case \"input\":Dc(a,c);b=c.name;if(\"radio\"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+b)+'][type=\"radio\"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=La(d);e?void 0:t(\"90\");Wb(d);Dc(d,e)}}}break;case \"textarea\":ie(a,c);break;case \"select\":b=c.value,null!=b&&fe(a,!!c.multiple,b,!1)}};\nfunction Vh(a){var b=1073741822-25*(((1073741822-Qf()+500)/25|0)+1);b>=Wg&&(b=Wg-1);this._expirationTime=Wg=b;this._root=a;this._callbacks=this._next=null;this._hasChildren=this._didComplete=!1;this._children=null;this._defer=!0}Vh.prototype.render=function(a){this._defer?void 0:t(\"250\");this._hasChildren=!0;this._children=a;var b=this._root._internalRoot,c=this._expirationTime,d=new Wh;Qh(a,b,null,c,d._onCommit);return d};\nVh.prototype.then=function(a){if(this._didComplete)a();else{var b=this._callbacks;null===b&&(b=this._callbacks=[]);b.push(a)}};\nVh.prototype.commit=function(){var a=this._root._internalRoot,b=a.firstBatch;this._defer&&null!==b?void 0:t(\"251\");if(this._hasChildren){var c=this._expirationTime;if(b!==this){this._hasChildren&&(c=this._expirationTime=b._expirationTime,this.render(this._children));for(var d=null,e=b;e!==this;)d=e,e=e._next;null===d?t(\"251\"):void 0;d._next=e._next;this._next=b;a.firstBatch=this}this._defer=!1;Hh(a,c);b=this._next;this._next=null;b=a.firstBatch=b;null!==b&&b._hasChildren&&b.render(b._children)}else this._next=\nnull,this._defer=!1};Vh.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=!0;var a=this._callbacks;if(null!==a)for(var b=0;b<a.length;b++)(0,a[b])()}};function Wh(){this._callbacks=null;this._didCommit=!1;this._onCommit=this._onCommit.bind(this)}Wh.prototype.then=function(a){if(this._didCommit)a();else{var b=this._callbacks;null===b&&(b=this._callbacks=[]);b.push(a)}};\nWh.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var a=this._callbacks;if(null!==a)for(var b=0;b<a.length;b++){var c=a[b];\"function\"!==typeof c?t(\"191\",c):void 0;c()}}};\nfunction Xh(a,b,c){b=M(3,null,null,b?3:0);a={current:b,containerInfo:a,pendingChildren:null,earliestPendingTime:0,latestPendingTime:0,earliestSuspendedTime:0,latestSuspendedTime:0,latestPingedTime:0,didError:!1,pendingCommitExpirationTime:0,finishedWork:null,timeoutHandle:-1,context:null,pendingContext:null,hydrate:c,nextExpirationTimeToWorkOn:0,expirationTime:0,firstBatch:null,nextScheduledRoot:null};this._internalRoot=b.stateNode=a}\nXh.prototype.render=function(a,b){var c=this._internalRoot,d=new Wh;b=void 0===b?null:b;null!==b&&d.then(b);Rh(a,c,null,d._onCommit);return d};Xh.prototype.unmount=function(a){var b=this._internalRoot,c=new Wh;a=void 0===a?null:a;null!==a&&c.then(a);Rh(null,b,null,c._onCommit);return c};Xh.prototype.legacy_renderSubtreeIntoContainer=function(a,b,c){var d=this._internalRoot,e=new Wh;c=void 0===c?null:c;null!==c&&e.then(c);Rh(b,d,a,e._onCommit);return e};\nXh.prototype.createBatch=function(){var a=new Vh(this),b=a._expirationTime,c=this._internalRoot,d=c.firstBatch;if(null===d)c.firstBatch=a,a._next=null;else{for(c=null;null!==d&&d._expirationTime>=b;)c=d,d=d._next;a._next=d;null!==c&&(c._next=a)}return a};function Yh(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||\" react-mount-point-unstable \"!==a.nodeValue))}Kb=Nh;Lb=Ph;Mb=function(){W||0===lh||(Kh(lh,!1),lh=0)};\nfunction Zh(a,b){b||(b=a?9===a.nodeType?a.documentElement:a.firstChild:null,b=!(!b||1!==b.nodeType||!b.hasAttribute(\"data-reactroot\")));if(!b)for(var c;c=a.lastChild;)a.removeChild(c);return new Xh(a,!1,b)}\nfunction $h(a,b,c,d,e){Yh(c)?void 0:t(\"200\");var f=c._reactRootContainer;if(f){if(\"function\"===typeof e){var g=e;e=function(){var a=Sh(f._internalRoot);g.call(a)}}null!=a?f.legacy_renderSubtreeIntoContainer(a,b,e):f.render(b,e)}else{f=c._reactRootContainer=Zh(c,d);if(\"function\"===typeof e){var h=e;e=function(){var a=Sh(f._internalRoot);h.call(a)}}Oh(function(){null!=a?f.legacy_renderSubtreeIntoContainer(a,b,e):f.render(b,e)})}return Sh(f._internalRoot)}\nfunction ai(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;Yh(b)?void 0:t(\"200\");return Uh(a,b,null,c)}\nvar bi={createPortal:ai,findDOMNode:function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternalFiber;void 0===b&&(\"function\"===typeof a.render?t(\"188\"):t(\"268\",Object.keys(a)));a=nd(b);a=null===a?null:a.stateNode;return a},hydrate:function(a,b,c){return $h(null,a,b,!0,c)},render:function(a,b,c){return $h(null,a,b,!1,c)},unstable_renderSubtreeIntoContainer:function(a,b,c,d){null==a||void 0===a._reactInternalFiber?t(\"38\"):void 0;return $h(a,b,c,!1,d)},unmountComponentAtNode:function(a){Yh(a)?\nvoid 0:t(\"40\");return a._reactRootContainer?(Oh(function(){$h(null,null,a,!1,function(){a._reactRootContainer=null})}),!0):!1},unstable_createPortal:function(){return ai.apply(void 0,arguments)},unstable_batchedUpdates:Nh,unstable_interactiveUpdates:Ph,flushSync:function(a,b){W?t(\"187\"):void 0;var c=Z;Z=!0;try{return qh(a,b)}finally{Z=c,Kh(1073741823,!1)}},unstable_flushControlled:function(a){var b=Z;Z=!0;try{qh(a)}finally{(Z=b)||W||Kh(1073741823,!1)}},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{Events:[Ja,\nKa,La,Ca.injectEventPluginsByName,qa,Ra,function(a){za(a,Qa)},Ib,Jb,Jd,Ea]},unstable_createRoot:function(a,b){Yh(a)?void 0:t(\"299\",\"unstable_createRoot\");return new Xh(a,!0,null!=b&&!0===b.hydrate)}};(function(a){var b=a.findFiberByHostInstance;return Ve(n({},a,{findHostInstanceByFiber:function(a){a=nd(a);return null===a?null:a.stateNode},findFiberByHostInstance:function(a){return b?b(a):null}}))})({findFiberByHostInstance:Ia,bundleType:0,version:\"16.6.3\",rendererPackageName:\"react-dom\"});\nvar ei={default:bi},fi=ei&&bi||ei;module.exports=fi.default||fi;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/scheduler.production.min.js');\n} else {\n  module.exports = require('./cjs/scheduler.development.js');\n}\n","/** @license React v0.11.3\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';Object.defineProperty(exports,\"__esModule\",{value:!0});var d=null,f=!1,h=3,k=-1,l=-1,m=!1,n=!1;function p(){if(!m){var a=d.expirationTime;n?q():n=!0;r(t,a)}}\nfunction u(){var a=d,b=d.next;if(d===b)d=null;else{var c=d.previous;d=c.next=b;b.previous=c}a.next=a.previous=null;c=a.callback;b=a.expirationTime;a=a.priorityLevel;var e=h,Q=l;h=a;l=b;try{var g=c()}finally{h=e,l=Q}if(\"function\"===typeof g)if(g={callback:g,priorityLevel:a,expirationTime:b,next:null,previous:null},null===d)d=g.next=g.previous=g;else{c=null;a=d;do{if(a.expirationTime>=b){c=a;break}a=a.next}while(a!==d);null===c?c=d:c===d&&(d=g,p());b=c.previous;b.next=c.previous=g;g.next=c;g.previous=\nb}}function v(){if(-1===k&&null!==d&&1===d.priorityLevel){m=!0;try{do u();while(null!==d&&1===d.priorityLevel)}finally{m=!1,null!==d?p():n=!1}}}function t(a){m=!0;var b=f;f=a;try{if(a)for(;null!==d;){var c=exports.unstable_now();if(d.expirationTime<=c){do u();while(null!==d&&d.expirationTime<=c)}else break}else if(null!==d){do u();while(null!==d&&!w())}}finally{m=!1,f=b,null!==d?p():n=!1,v()}}\nvar x=Date,y=\"function\"===typeof setTimeout?setTimeout:void 0,z=\"function\"===typeof clearTimeout?clearTimeout:void 0,A=\"function\"===typeof requestAnimationFrame?requestAnimationFrame:void 0,B=\"function\"===typeof cancelAnimationFrame?cancelAnimationFrame:void 0,C,D;function E(a){C=A(function(b){z(D);a(b)});D=y(function(){B(C);a(exports.unstable_now())},100)}\nif(\"object\"===typeof performance&&\"function\"===typeof performance.now){var F=performance;exports.unstable_now=function(){return F.now()}}else exports.unstable_now=function(){return x.now()};var r,q,w,G=null;\"undefined\"!==typeof window?G=window:\"undefined\"!==typeof global&&(G=global);\nif(G&&G._schedMock){var H=G._schedMock;r=H[0];q=H[1];w=H[2];exports.unstable_now=H[3]}else if(\"undefined\"===typeof window||\"function\"!==typeof MessageChannel){var I=null,J=function(a){if(null!==I)try{I(a)}finally{I=null}};r=function(a){null!==I?setTimeout(r,0,a):(I=a,setTimeout(J,0,!1))};q=function(){I=null};w=function(){return!1}}else{\"undefined\"!==typeof console&&(\"function\"!==typeof A&&console.error(\"This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills\"),\n\"function\"!==typeof B&&console.error(\"This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills\"));var K=null,L=!1,M=-1,N=!1,O=!1,P=0,R=33,S=33;w=function(){return P<=exports.unstable_now()};var T=new MessageChannel,U=T.port2;T.port1.onmessage=function(){L=!1;var a=K,b=M;K=null;M=-1;var c=exports.unstable_now(),e=!1;if(0>=P-c)if(-1!==b&&b<=c)e=!0;else{N||(N=!0,E(V));K=a;M=b;return}if(null!==a){O=!0;try{a(e)}finally{O=!1}}};\nvar V=function(a){if(null!==K){E(V);var b=a-P+S;b<S&&R<S?(8>b&&(b=8),S=b<R?R:b):R=b;P=a+S;L||(L=!0,U.postMessage(void 0))}else N=!1};r=function(a,b){K=a;M=b;O||0>b?U.postMessage(void 0):N||(N=!0,E(V))};q=function(){K=null;L=!1;M=-1}}exports.unstable_ImmediatePriority=1;exports.unstable_UserBlockingPriority=2;exports.unstable_NormalPriority=3;exports.unstable_IdlePriority=5;exports.unstable_LowPriority=4;\nexports.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=h,e=k;h=a;k=exports.unstable_now();try{return b()}finally{h=c,k=e,v()}};\nexports.unstable_scheduleCallback=function(a,b){var c=-1!==k?k:exports.unstable_now();if(\"object\"===typeof b&&null!==b&&\"number\"===typeof b.timeout)b=c+b.timeout;else switch(h){case 1:b=c+-1;break;case 2:b=c+250;break;case 5:b=c+1073741823;break;case 4:b=c+1E4;break;default:b=c+5E3}a={callback:a,priorityLevel:h,expirationTime:b,next:null,previous:null};if(null===d)d=a.next=a.previous=a,p();else{c=null;var e=d;do{if(e.expirationTime>b){c=e;break}e=e.next}while(e!==d);null===c?c=d:c===d&&(d=a,p());\nb=c.previous;b.next=c.previous=a;a.next=c;a.previous=b}return a};exports.unstable_cancelCallback=function(a){var b=a.next;if(null!==b){if(b===a)d=null;else{a===d&&(d=b);var c=a.previous;c.next=b;b.previous=c}a.next=a.previous=null}};exports.unstable_wrapCallback=function(a){var b=h;return function(){var c=h,e=k;h=b;k=exports.unstable_now();try{return a.apply(this,arguments)}finally{h=c,k=e,v()}}};exports.unstable_getCurrentPriorityLevel=function(){return h};\nexports.unstable_shouldYield=function(){return!f&&(null!==d&&d.expirationTime<l||w())};\n","\"use strict\";\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar PropTypes = _interopRequireWildcard(require(\"prop-types\"));\n\nvar _addClass = _interopRequireDefault(require(\"dom-helpers/class/addClass\"));\n\nvar _removeClass = _interopRequireDefault(require(\"dom-helpers/class/removeClass\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _Transition = _interopRequireDefault(require(\"./Transition\"));\n\nvar _PropTypes = require(\"./utils/PropTypes\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nvar addClass = function addClass(node, classes) {\n  return node && classes && classes.split(' ').forEach(function (c) {\n    return (0, _addClass.default)(node, c);\n  });\n};\n\nvar removeClass = function removeClass(node, classes) {\n  return node && classes && classes.split(' ').forEach(function (c) {\n    return (0, _removeClass.default)(node, c);\n  });\n};\n\nvar propTypes = process.env.NODE_ENV !== \"production\" ? _extends({}, _Transition.default.propTypes, {\n  /**\n   * The animation classNames applied to the component as it enters, exits or has finished the transition.\n   * A single name can be provided and it will be suffixed for each stage: e.g.\n   *\n   * `classNames=\"fade\"` applies `fade-enter`, `fade-enter-active`, `fade-enter-done`,\n   * `fade-exit`, `fade-exit-active`, `fade-exit-done`, `fade-appear`, and `fade-appear-active`.\n   * Each individual classNames can also be specified independently like:\n   *\n   * ```js\n   * classNames={{\n   *  appear: 'my-appear',\n   *  appearActive: 'my-active-appear',\n   *  enter: 'my-enter',\n   *  enterActive: 'my-active-enter',\n   *  enterDone: 'my-done-enter',\n   *  exit: 'my-exit',\n   *  exitActive: 'my-active-exit',\n   *  exitDone: 'my-done-exit',\n   * }}\n   * ```\n   *\n   * If you want to set these classes using CSS Modules:\n   *\n   * ```js\n   * import styles from './styles.css';\n   * ```\n   *\n   * you might want to use camelCase in your CSS file, that way could simply spread\n   * them instead of listing them one by one:\n   *\n   * ```js\n   * classNames={{ ...styles }}\n   * ```\n   *\n   * @type {string | {\n   *  appear?: string,\n   *  appearActive?: string,\n   *  enter?: string,\n   *  enterActive?: string,\n   *  enterDone?: string,\n   *  exit?: string,\n   *  exitActive?: string,\n   *  exitDone?: string,\n   * }}\n   */\n  classNames: _PropTypes.classNamesShape,\n\n  /**\n   * A `<Transition>` callback fired immediately after the 'enter' or 'appear' class is\n   * applied.\n   *\n   * @type Function(node: HtmlElement, isAppearing: bool)\n   */\n  onEnter: PropTypes.func,\n\n  /**\n   * A `<Transition>` callback fired immediately after the 'enter-active' or\n   * 'appear-active' class is applied.\n   *\n   * @type Function(node: HtmlElement, isAppearing: bool)\n   */\n  onEntering: PropTypes.func,\n\n  /**\n   * A `<Transition>` callback fired immediately after the 'enter' or\n   * 'appear' classes are **removed** and the `done` class is added to the DOM node.\n   *\n   * @type Function(node: HtmlElement, isAppearing: bool)\n   */\n  onEntered: PropTypes.func,\n\n  /**\n   * A `<Transition>` callback fired immediately after the 'exit' class is\n   * applied.\n   *\n   * @type Function(node: HtmlElement)\n   */\n  onExit: PropTypes.func,\n\n  /**\n   * A `<Transition>` callback fired immediately after the 'exit-active' is applied.\n   *\n   * @type Function(node: HtmlElement\n   */\n  onExiting: PropTypes.func,\n\n  /**\n   * A `<Transition>` callback fired immediately after the 'exit' classes\n   * are **removed** and the `exit-done` class is added to the DOM node.\n   *\n   * @type Function(node: HtmlElement)\n   */\n  onExited: PropTypes.func\n}) : {};;\n/**\n * A `Transition` component using CSS transitions and animations.\n * It's inspired by the excellent [ng-animate](http://www.nganimate.org/) library.\n *\n * `CSSTransition` applies a pair of class names during the `appear`, `enter`,\n * and `exit` stages of the transition. The first class is applied and then a\n * second \"active\" class in order to activate the css animation. After the animation,\n * matching `done` class names are applied to persist the animation state.\n *\n * When the `in` prop is toggled to `true` the Component will get\n * the `example-enter` CSS class and the `example-enter-active` CSS class\n * added in the next tick. This is a convention based on the `classNames` prop.\n */\n\nvar CSSTransition =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(CSSTransition, _React$Component);\n\n  function CSSTransition() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(args)) || this;\n\n    _this.onEnter = function (node, appearing) {\n      var _this$getClassNames = _this.getClassNames(appearing ? 'appear' : 'enter'),\n          className = _this$getClassNames.className;\n\n      _this.removeClasses(node, 'exit');\n\n      addClass(node, className);\n\n      if (_this.props.onEnter) {\n        _this.props.onEnter(node);\n      }\n    };\n\n    _this.onEntering = function (node, appearing) {\n      var _this$getClassNames2 = _this.getClassNames(appearing ? 'appear' : 'enter'),\n          activeClassName = _this$getClassNames2.activeClassName;\n\n      _this.reflowAndAddClass(node, activeClassName);\n\n      if (_this.props.onEntering) {\n        _this.props.onEntering(node);\n      }\n    };\n\n    _this.onEntered = function (node, appearing) {\n      var _this$getClassNames3 = _this.getClassNames('enter'),\n          doneClassName = _this$getClassNames3.doneClassName;\n\n      _this.removeClasses(node, appearing ? 'appear' : 'enter');\n\n      addClass(node, doneClassName);\n\n      if (_this.props.onEntered) {\n        _this.props.onEntered(node);\n      }\n    };\n\n    _this.onExit = function (node) {\n      var _this$getClassNames4 = _this.getClassNames('exit'),\n          className = _this$getClassNames4.className;\n\n      _this.removeClasses(node, 'appear');\n\n      _this.removeClasses(node, 'enter');\n\n      addClass(node, className);\n\n      if (_this.props.onExit) {\n        _this.props.onExit(node);\n      }\n    };\n\n    _this.onExiting = function (node) {\n      var _this$getClassNames5 = _this.getClassNames('exit'),\n          activeClassName = _this$getClassNames5.activeClassName;\n\n      _this.reflowAndAddClass(node, activeClassName);\n\n      if (_this.props.onExiting) {\n        _this.props.onExiting(node);\n      }\n    };\n\n    _this.onExited = function (node) {\n      var _this$getClassNames6 = _this.getClassNames('exit'),\n          doneClassName = _this$getClassNames6.doneClassName;\n\n      _this.removeClasses(node, 'exit');\n\n      addClass(node, doneClassName);\n\n      if (_this.props.onExited) {\n        _this.props.onExited(node);\n      }\n    };\n\n    _this.getClassNames = function (type) {\n      var classNames = _this.props.classNames;\n      var className = typeof classNames !== 'string' ? classNames[type] : classNames + '-' + type;\n      var activeClassName = typeof classNames !== 'string' ? classNames[type + 'Active'] : className + '-active';\n      var doneClassName = typeof classNames !== 'string' ? classNames[type + 'Done'] : className + '-done';\n      return {\n        className: className,\n        activeClassName: activeClassName,\n        doneClassName: doneClassName\n      };\n    };\n\n    return _this;\n  }\n\n  var _proto = CSSTransition.prototype;\n\n  _proto.removeClasses = function removeClasses(node, type) {\n    var _this$getClassNames7 = this.getClassNames(type),\n        className = _this$getClassNames7.className,\n        activeClassName = _this$getClassNames7.activeClassName,\n        doneClassName = _this$getClassNames7.doneClassName;\n\n    className && removeClass(node, className);\n    activeClassName && removeClass(node, activeClassName);\n    doneClassName && removeClass(node, doneClassName);\n  };\n\n  _proto.reflowAndAddClass = function reflowAndAddClass(node, className) {\n    // This is for to force a repaint,\n    // which is necessary in order to transition styles when adding a class name.\n    if (className) {\n      /* eslint-disable no-unused-expressions */\n      node && node.scrollTop;\n      /* eslint-enable no-unused-expressions */\n\n      addClass(node, className);\n    }\n  };\n\n  _proto.render = function render() {\n    var props = _extends({}, this.props);\n\n    delete props.classNames;\n    return _react.default.createElement(_Transition.default, _extends({}, props, {\n      onEnter: this.onEnter,\n      onEntered: this.onEntered,\n      onEntering: this.onEntering,\n      onExit: this.onExit,\n      onExiting: this.onExiting,\n      onExited: this.onExited\n    }));\n  };\n\n  return CSSTransition;\n}(_react.default.Component);\n\nCSSTransition.propTypes = process.env.NODE_ENV !== \"production\" ? propTypes : {};\nvar _default = CSSTransition;\nexports.default = _default;\nmodule.exports = exports[\"default\"];","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim\n  };\n\n  ReactPropTypes.checkPropTypes = emptyFunction;\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nexports.__esModule = true;\nexports.default = addClass;\n\nvar _hasClass = _interopRequireDefault(require(\"./hasClass\"));\n\nfunction addClass(element, className) {\n  if (element.classList) element.classList.add(className);else if (!(0, _hasClass.default)(element, className)) if (typeof element.className === 'string') element.className = element.className + ' ' + className;else element.setAttribute('class', (element.className && element.className.baseVal || '') + ' ' + className);\n}\n\nmodule.exports = exports[\"default\"];","function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nmodule.exports = _interopRequireDefault;","\"use strict\";\n\nexports.__esModule = true;\nexports.default = hasClass;\n\nfunction hasClass(element, className) {\n  if (element.classList) return !!className && element.classList.contains(className);else return (\" \" + (element.className.baseVal || element.className) + \" \").indexOf(\" \" + className + \" \") !== -1;\n}\n\nmodule.exports = exports[\"default\"];","'use strict';\n\nfunction replaceClassName(origClass, classToRemove) {\n  return origClass.replace(new RegExp('(^|\\\\s)' + classToRemove + '(?:\\\\s|$)', 'g'), '$1').replace(/\\s+/g, ' ').replace(/^\\s*|\\s*$/g, '');\n}\n\nmodule.exports = function removeClass(element, className) {\n  if (element.classList) element.classList.remove(className);else if (typeof element.className === 'string') element.className = replaceClassName(element.className, className);else element.setAttribute('class', replaceClassName(element.className && element.className.baseVal || '', className));\n};","\"use strict\";\n\nexports.__esModule = true;\nexports.default = void 0;\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _reactDom = require(\"react-dom\");\n\nvar _TransitionGroup = _interopRequireDefault(require(\"./TransitionGroup\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nvar propTypes = process.env.NODE_ENV !== \"production\" ? {\n  in: _propTypes.default.bool.isRequired,\n  children: function children(props, propName) {\n    if (_react.default.Children.count(props[propName]) !== 2) return new Error(\"\\\"\" + propName + \"\\\" must be exactly two transition components.\");\n    return null;\n  }\n} : {};;\n/**\n * The `<ReplaceTransition>` component is a specialized `Transition` component\n * that animates between two children.\n *\n * ```jsx\n * <ReplaceTransition in>\n *   <Fade><div>I appear first</div></Fade>\n *   <Fade><div>I replace the above</div></Fade>\n * </ReplaceTransition>\n * ```\n */\n\nvar ReplaceTransition =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inheritsLoose(ReplaceTransition, _React$Component);\n\n  function ReplaceTransition() {\n    var _this;\n\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n\n    _this = _React$Component.call.apply(_React$Component, [this].concat(_args)) || this;\n\n    _this.handleEnter = function () {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      return _this.handleLifecycle('onEnter', 0, args);\n    };\n\n    _this.handleEntering = function () {\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n\n      return _this.handleLifecycle('onEntering', 0, args);\n    };\n\n    _this.handleEntered = function () {\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n\n      return _this.handleLifecycle('onEntered', 0, args);\n    };\n\n    _this.handleExit = function () {\n      for (var _len5 = arguments.length, args = new Array(_len5), _key5 = 0; _key5 < _len5; _key5++) {\n        args[_key5] = arguments[_key5];\n      }\n\n      return _this.handleLifecycle('onExit', 1, args);\n    };\n\n    _this.handleExiting = function () {\n      for (var _len6 = arguments.length, args = new Array(_len6), _key6 = 0; _key6 < _len6; _key6++) {\n        args[_key6] = arguments[_key6];\n      }\n\n      return _this.handleLifecycle('onExiting', 1, args);\n    };\n\n    _this.handleExited = function () {\n      for (var _len7 = arguments.length, args = new Array(_len7), _key7 = 0; _key7 < _len7; _key7++) {\n        args[_key7] = arguments[_key7];\n      }\n\n      return _this.handleLifecycle('onExited', 1, args);\n    };\n\n    return _this;\n  }\n\n  var _proto = ReplaceTransition.prototype;\n\n  _proto.handleLifecycle = function handleLifecycle(handler, idx, originalArgs) {\n    var _child$props;\n\n    var children = this.props.children;\n\n    var child = _react.default.Children.toArray(children)[idx];\n\n    if (child.props[handler]) (_child$props = child.props)[handler].apply(_child$props, originalArgs);\n    if (this.props[handler]) this.props[handler]((0, _reactDom.findDOMNode)(this));\n  };\n\n  _proto.render = function render() {\n    var _this$props = this.props,\n        children = _this$props.children,\n        inProp = _this$props.in,\n        props = _objectWithoutPropertiesLoose(_this$props, [\"children\", \"in\"]);\n\n    var _React$Children$toArr = _react.default.Children.toArray(children),\n        first = _React$Children$toArr[0],\n        second = _React$Children$toArr[1];\n\n    delete props.onEnter;\n    delete props.onEntering;\n    delete props.onEntered;\n    delete props.onExit;\n    delete props.onExiting;\n    delete props.onExited;\n    return _react.default.createElement(_TransitionGroup.default, props, inProp ? _react.default.cloneElement(first, {\n      key: 'first',\n      onEnter: this.handleEnter,\n      onEntering: this.handleEntering,\n      onEntered: this.handleEntered\n    }) : _react.default.cloneElement(second, {\n      key: 'second',\n      onEnter: this.handleExit,\n      onEntering: this.handleExiting,\n      onEntered: this.handleExited\n    }));\n  };\n\n  return ReplaceTransition;\n}(_react.default.Component);\n\nReplaceTransition.propTypes = process.env.NODE_ENV !== \"production\" ? propTypes : {};\nvar _default = ReplaceTransition;\nexports.default = _default;\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nexports.__esModule = true;\nexports.getChildMapping = getChildMapping;\nexports.mergeChildMappings = mergeChildMappings;\nexports.getInitialChildMapping = getInitialChildMapping;\nexports.getNextChildMapping = getNextChildMapping;\n\nvar _react = require(\"react\");\n\n/**\n * Given `this.props.children`, return an object mapping key to child.\n *\n * @param {*} children `this.props.children`\n * @return {object} Mapping of key to child\n */\nfunction getChildMapping(children, mapFn) {\n  var mapper = function mapper(child) {\n    return mapFn && (0, _react.isValidElement)(child) ? mapFn(child) : child;\n  };\n\n  var result = Object.create(null);\n  if (children) _react.Children.map(children, function (c) {\n    return c;\n  }).forEach(function (child) {\n    // run the map function here instead so that the key is the computed one\n    result[child.key] = mapper(child);\n  });\n  return result;\n}\n/**\n * When you're adding or removing children some may be added or removed in the\n * same render pass. We want to show *both* since we want to simultaneously\n * animate elements in and out. This function takes a previous set of keys\n * and a new set of keys and merges them with its best guess of the correct\n * ordering. In the future we may expose some of the utilities in\n * ReactMultiChild to make this easy, but for now React itself does not\n * directly have this concept of the union of prevChildren and nextChildren\n * so we implement it here.\n *\n * @param {object} prev prev children as returned from\n * `ReactTransitionChildMapping.getChildMapping()`.\n * @param {object} next next children as returned from\n * `ReactTransitionChildMapping.getChildMapping()`.\n * @return {object} a key set that contains all keys in `prev` and all keys\n * in `next` in a reasonable order.\n */\n\n\nfunction mergeChildMappings(prev, next) {\n  prev = prev || {};\n  next = next || {};\n\n  function getValueForKey(key) {\n    return key in next ? next[key] : prev[key];\n  } // For each key of `next`, the list of keys to insert before that key in\n  // the combined list\n\n\n  var nextKeysPending = Object.create(null);\n  var pendingKeys = [];\n\n  for (var prevKey in prev) {\n    if (prevKey in next) {\n      if (pendingKeys.length) {\n        nextKeysPending[prevKey] = pendingKeys;\n        pendingKeys = [];\n      }\n    } else {\n      pendingKeys.push(prevKey);\n    }\n  }\n\n  var i;\n  var childMapping = {};\n\n  for (var nextKey in next) {\n    if (nextKeysPending[nextKey]) {\n      for (i = 0; i < nextKeysPending[nextKey].length; i++) {\n        var pendingNextKey = nextKeysPending[nextKey][i];\n        childMapping[nextKeysPending[nextKey][i]] = getValueForKey(pendingNextKey);\n      }\n    }\n\n    childMapping[nextKey] = getValueForKey(nextKey);\n  } // Finally, add the keys which didn't appear before any key in `next`\n\n\n  for (i = 0; i < pendingKeys.length; i++) {\n    childMapping[pendingKeys[i]] = getValueForKey(pendingKeys[i]);\n  }\n\n  return childMapping;\n}\n\nfunction getProp(child, prop, props) {\n  return props[prop] != null ? props[prop] : child.props[prop];\n}\n\nfunction getInitialChildMapping(props, onExited) {\n  return getChildMapping(props.children, function (child) {\n    return (0, _react.cloneElement)(child, {\n      onExited: onExited.bind(null, child),\n      in: true,\n      appear: getProp(child, 'appear', props),\n      enter: getProp(child, 'enter', props),\n      exit: getProp(child, 'exit', props)\n    });\n  });\n}\n\nfunction getNextChildMapping(nextProps, prevChildMapping, onExited) {\n  var nextChildMapping = getChildMapping(nextProps.children);\n  var children = mergeChildMappings(prevChildMapping, nextChildMapping);\n  Object.keys(children).forEach(function (key) {\n    var child = children[key];\n    if (!(0, _react.isValidElement)(child)) return;\n    var hasPrev = key in prevChildMapping;\n    var hasNext = key in nextChildMapping;\n    var prevChild = prevChildMapping[key];\n    var isLeaving = (0, _react.isValidElement)(prevChild) && !prevChild.props.in; // item is new (entering)\n\n    if (hasNext && (!hasPrev || isLeaving)) {\n      // console.log('entering', key)\n      children[key] = (0, _react.cloneElement)(child, {\n        onExited: onExited.bind(null, child),\n        in: true,\n        exit: getProp(child, 'exit', nextProps),\n        enter: getProp(child, 'enter', nextProps)\n      });\n    } else if (!hasNext && hasPrev && !isLeaving) {\n      // item is old (exiting)\n      // console.log('leaving', key)\n      children[key] = (0, _react.cloneElement)(child, {\n        in: false\n      });\n    } else if (hasNext && hasPrev && (0, _react.isValidElement)(prevChild)) {\n      // item hasn't changed transition states\n      // copy over the last transition props;\n      // console.log('unchanged', key)\n      children[key] = (0, _react.cloneElement)(child, {\n        onExited: onExited.bind(null, child),\n        in: prevChild.props.in,\n        exit: getProp(child, 'exit', nextProps),\n        enter: getProp(child, 'enter', nextProps)\n      });\n    }\n  });\n  return children;\n}","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"firebase/app\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"firebase/app\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"firebase/app\")) : factory(root[\"firebase/app\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function(__WEBPACK_EXTERNAL_MODULE_6__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(1);\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tvar _utils = __webpack_require__(2);\n\n\tvar _validators = __webpack_require__(5);\n\n\tvar _app = __webpack_require__(6);\n\n\tvar _app2 = _interopRequireDefault(_app);\n\n\tvar _push2 = __webpack_require__(7);\n\n\tvar _push3 = _interopRequireDefault(_push2);\n\n\tvar _fetch2 = __webpack_require__(8);\n\n\tvar _fetch3 = _interopRequireDefault(_fetch2);\n\n\tvar _post2 = __webpack_require__(9);\n\n\tvar _post3 = _interopRequireDefault(_post2);\n\n\tvar _sync2 = __webpack_require__(10);\n\n\tvar _sync3 = _interopRequireDefault(_sync2);\n\n\tvar _bind2 = __webpack_require__(11);\n\n\tvar _bind3 = _interopRequireDefault(_bind2);\n\n\tvar _update2 = __webpack_require__(12);\n\n\tvar _update3 = _interopRequireDefault(_update2);\n\n\tvar _reset2 = __webpack_require__(13);\n\n\tvar _reset3 = _interopRequireDefault(_reset2);\n\n\tvar _removeBinding2 = __webpack_require__(3);\n\n\tvar _removeBinding3 = _interopRequireDefault(_removeBinding2);\n\n\tvar _remove2 = __webpack_require__(14);\n\n\tvar _remove3 = _interopRequireDefault(_remove2);\n\n\tvar _fsSync2 = __webpack_require__(15);\n\n\tvar _fsSync3 = _interopRequireDefault(_fsSync2);\n\n\tvar _fsRemoveBinding2 = __webpack_require__(4);\n\n\tvar _fsRemoveBinding3 = _interopRequireDefault(_fsRemoveBinding2);\n\n\tvar _fsBind2 = __webpack_require__(16);\n\n\tvar _fsBind3 = _interopRequireDefault(_fsBind2);\n\n\tvar _fsGet2 = __webpack_require__(17);\n\n\tvar _fsGet3 = _interopRequireDefault(_fsGet2);\n\n\tvar _fsRemoveDoc2 = __webpack_require__(18);\n\n\tvar _fsRemoveDoc3 = _interopRequireDefault(_fsRemoveDoc2);\n\n\tvar _fsAddToCollection2 = __webpack_require__(19);\n\n\tvar _fsAddToCollection3 = _interopRequireDefault(_fsAddToCollection2);\n\n\tvar _fsRemoveFromCollection2 = __webpack_require__(20);\n\n\tvar _fsRemoveFromCollection3 = _interopRequireDefault(_fsRemoveFromCollection2);\n\n\tvar _fsUpdateDoc2 = __webpack_require__(21);\n\n\tvar _fsUpdateDoc3 = _interopRequireDefault(_fsUpdateDoc2);\n\n\tvar _fsReset2 = __webpack_require__(22);\n\n\tvar _fsReset3 = _interopRequireDefault(_fsReset2);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n\t//database\n\tmodule.exports = function () {\n\t  function init(db) {\n\t    return function () {\n\t      var refs = new Map();\n\t      var listeners = new Map();\n\t      var syncs = new WeakMap();\n\n\t      if (typeof db.ref === 'function') {\n\t        var rebase = {\n\t          initializedApp: db.app,\n\t          timestamp: _app2.default.database.ServerValue.TIMESTAMP,\n\t          listenTo: function listenTo(endpoint, options) {\n\t            return _bind3.default.call(this, endpoint, options, 'listenTo', {\n\t              db: db,\n\t              refs: refs,\n\t              listeners: listeners,\n\t              syncs: syncs\n\t            });\n\t          },\n\t          bindToState: function bindToState(endpoint, options) {\n\t            return _bind3.default.call(this, endpoint, options, 'bindToState', {\n\t              db: db,\n\t              refs: refs,\n\t              listeners: listeners\n\t            });\n\t          },\n\t          syncState: function syncState(endpoint, options) {\n\t            return _sync3.default.call(this, endpoint, options, {\n\t              db: db,\n\t              refs: refs,\n\t              listeners: listeners,\n\t              syncs: syncs\n\t            });\n\t          },\n\t          fetch: function fetch(endpoint, options) {\n\t            return (0, _fetch3.default)(endpoint, options, db);\n\t          },\n\t          post: function post(endpoint, options) {\n\t            return (0, _post3.default)(endpoint, options, db);\n\t          },\n\t          update: function update(endpoint, options) {\n\t            return (0, _update3.default)(endpoint, options, { db: db });\n\t          },\n\t          push: function push(endpoint, options) {\n\t            return (0, _push3.default)(endpoint, options, db);\n\t          },\n\t          removeBinding: function removeBinding(binding) {\n\t            (0, _removeBinding3.default)(binding, {\n\t              refs: refs,\n\t              listeners: listeners,\n\t              syncs: syncs\n\t            });\n\t          },\n\t          remove: function remove(endpoint, fn) {\n\t            return (0, _remove3.default)(endpoint, db, fn);\n\t          },\n\t          reset: function reset() {\n\t            return (0, _reset3.default)({\n\t              refs: refs,\n\t              listeners: listeners,\n\t              syncs: syncs\n\t            });\n\t          }\n\t        };\n\t      } else {\n\t        var rebase = {\n\t          initializedApp: db.app,\n\t          timestamp: _app2.default.firestore.FieldValue.serverTimestamp(),\n\t          bindDoc: function bindDoc(path, options) {\n\t            return _fsBind3.default.call(this, path, options, 'bindDoc', {\n\t              db: db,\n\t              refs: refs,\n\t              listeners: listeners\n\t            });\n\t          },\n\t          bindCollection: function bindCollection(path, options) {\n\t            return _fsBind3.default.call(this, path, options, 'bindCollection', {\n\t              db: db,\n\t              refs: refs,\n\t              listeners: listeners\n\t            });\n\t          },\n\t          syncDoc: function syncDoc(doc, options) {\n\t            return _fsSync3.default.call(this, doc, options, {\n\t              db: db,\n\t              refs: refs,\n\t              listeners: listeners,\n\t              syncs: syncs\n\t            });\n\t          },\n\t          listenToDoc: function listenToDoc(doc, options) {\n\t            return _fsBind3.default.call(this, doc, options, 'listenToDoc', {\n\t              db: db,\n\t              refs: refs,\n\t              listeners: listeners\n\t            });\n\t          },\n\t          listenToCollection: function listenToCollection(path, options) {\n\t            return _fsBind3.default.call(this, path, options, 'listenToCollection', {\n\t              db: db,\n\t              refs: refs,\n\t              listeners: listeners\n\t            });\n\t          },\n\t          addToCollection: function addToCollection(path, doc, key) {\n\t            return _fsAddToCollection3.default.call(this, path, doc, db, key);\n\t          },\n\t          updateDoc: function updateDoc(path, doc, options) {\n\t            return _fsUpdateDoc3.default.call(this, path, doc, db);\n\t          },\n\t          get: function get(path, options) {\n\t            return _fsGet3.default.call(this, path, options, db);\n\t          },\n\t          removeDoc: function removeDoc(path) {\n\t            return (0, _fsRemoveDoc3.default)(path, db);\n\t          },\n\t          removeFromCollection: function removeFromCollection(path, options) {\n\t            return (0, _fsRemoveFromCollection3.default)(path, db, options);\n\t          },\n\t          removeBinding: function removeBinding(binding) {\n\t            (0, _fsRemoveBinding3.default)(binding, {\n\t              refs: refs,\n\t              listeners: listeners,\n\t              syncs: syncs\n\t            });\n\t          },\n\t          reset: function reset() {\n\t            return (0, _fsReset3.default)({\n\t              refs: refs,\n\t              listeners: listeners,\n\t              syncs: syncs\n\t            });\n\t          }\n\t        };\n\t      }\n\t      return rebase;\n\t    }();\n\t  }\n\n\t  return {\n\t    createClass: function createClass(db) {\n\t      (0, _validators._validateDatabase)(db);\n\t      return init(db);\n\t    }\n\t  };\n\t}();\n\n\t//firestore\n\t//helpers\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports._fsCreateRef = exports._fsSetUnmountHandler = exports._setData = exports._handleError = exports._createNestedObject = exports._setUnmountHandler = exports._addFirestoreListener = exports._addListener = exports._fsUpdateSyncState = exports._updateSyncState = exports._firebaseRefsMixin = exports._addSync = exports._hasOwnNestedProperty = exports._getSegmentCount = exports._getNestedObject = exports._isNestedPath = exports._isObject = exports._isValid = exports._toArray = exports._fsPrepareData = exports._prepareData = exports._throwError = exports._setState = exports._returnRef = exports._addFirestoreQuery = exports._addQueries = exports._createHash = undefined;\n\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n\tvar _removeBinding2 = __webpack_require__(3);\n\n\tvar _removeBinding3 = _interopRequireDefault(_removeBinding2);\n\n\tvar _fsRemoveBinding2 = __webpack_require__(4);\n\n\tvar _fsRemoveBinding3 = _interopRequireDefault(_fsRemoveBinding2);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\tvar _isObject = function _isObject(obj) {\n\t  return Object.prototype.toString.call(obj) === '[object Object]' ? true : false;\n\t};\n\n\tvar _toArray = function _toArray(snapshot) {\n\t  var arr = [];\n\t  snapshot.forEach(function (childSnapshot) {\n\t    var val = childSnapshot.val();\n\t    if (_isObject(val)) {\n\t      val.key = childSnapshot.key;\n\t    }\n\t    arr.push(val);\n\t  });\n\t  return arr;\n\t};\n\n\tvar _isValid = function _isValid(value) {\n\t  return typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean' || (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' ? true : false;\n\t};\n\n\tvar _isNestedPath = function _isNestedPath(path) {\n\t  return path.split('.').length > 1 ? true : false;\n\t};\n\n\tvar _createNestedObject = function _createNestedObject(path, value) {\n\t  var obj = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\t  var keys = path.split('.');\n\t  var lastKey = value === undefined ? false : keys.pop();\n\t  var root = obj;\n\n\t  var _iteratorNormalCompletion = true;\n\t  var _didIteratorError = false;\n\t  var _iteratorError = undefined;\n\n\t  try {\n\t    for (var _iterator = keys[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t      var key = _step.value;\n\n\t      obj = obj[key] = obj[key] || {};\n\t    }\n\t  } catch (err) {\n\t    _didIteratorError = true;\n\t    _iteratorError = err;\n\t  } finally {\n\t    try {\n\t      if (!_iteratorNormalCompletion && _iterator.return) {\n\t        _iterator.return();\n\t      }\n\t    } finally {\n\t      if (_didIteratorError) {\n\t        throw _iteratorError;\n\t      }\n\t    }\n\t  }\n\n\t  if (lastKey) obj[lastKey] = value;\n\n\t  return root;\n\t};\n\n\tvar _getNestedObject = function _getNestedObject(obj, path) {\n\t  if (_isNestedPath(path) === false) return;\n\n\t  var keys = path.split('.');\n\t  var _iteratorNormalCompletion2 = true;\n\t  var _didIteratorError2 = false;\n\t  var _iteratorError2 = undefined;\n\n\t  try {\n\t    for (var _iterator2 = keys[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t      var key = _step2.value;\n\n\t      if (!obj || (typeof obj === 'undefined' ? 'undefined' : _typeof(obj)) !== 'object') return;\n\t      obj = obj[key];\n\t    }\n\t  } catch (err) {\n\t    _didIteratorError2 = true;\n\t    _iteratorError2 = err;\n\t  } finally {\n\t    try {\n\t      if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t        _iterator2.return();\n\t      }\n\t    } finally {\n\t      if (_didIteratorError2) {\n\t        throw _iteratorError2;\n\t      }\n\t    }\n\t  }\n\n\t  return obj;\n\t};\n\n\tvar _hasOwnNestedProperty = function _hasOwnNestedProperty(obj, path) {\n\t  return _getNestedObject(obj, path) === undefined ? false : true;\n\t};\n\n\tvar _prepareData = function _prepareData(snapshot) {\n\t  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t  var defaultValue = options.defaultValue,\n\t      asArray = options.asArray;\n\n\t  var data = snapshot.val();\n\t  if (data === null && _isValid(defaultValue)) return defaultValue;\n\t  if (asArray === true) return _toArray(snapshot);\n\t  return data === null ? {} : data;\n\t};\n\n\tvar _addSync = function _addSync(context, sync, syncs) {\n\t  var existingSyncs = syncs.get(context) || [];\n\t  existingSyncs.push(sync);\n\t  syncs.set(context, existingSyncs);\n\t};\n\n\tvar _throwError = function _throwError(msg, code) {\n\t  var err = new Error('REBASE: ' + msg);\n\t  err.code = code;\n\t  throw err;\n\t};\n\n\tvar _setState = function _setState(newState) {\n\t  this.setState(newState);\n\t};\n\n\tvar _returnRef = function _returnRef(endpoint, method, id, context) {\n\t  return { endpoint: endpoint, method: method, id: id, context: context };\n\t};\n\n\tvar _addQueries = function _addQueries(ref, queries) {\n\t  var needArgs = {\n\t    limitToFirst: true,\n\t    limitToLast: true,\n\t    orderByChild: true,\n\t    startAt: true,\n\t    endAt: true,\n\t    equalTo: true\n\t  };\n\n\t  for (var key in queries) {\n\t    /* istanbul ignore else */\n\t    if (queries.hasOwnProperty(key)) {\n\t      if (needArgs[key]) {\n\t        ref = ref[key](queries[key]);\n\t      } else {\n\t        ref = ref[key]();\n\t      }\n\t    }\n\t  }\n\t  return ref;\n\t};\n\n\tvar _addFirestoreQuery = function _addFirestoreQuery(ref, query) {\n\t  if (query) {\n\t    return query(ref);\n\t  }\n\t  return ref;\n\t};\n\n\tvar _createHash = function _createHash(endpoint, invoker) {\n\t  var hash = 0;\n\t  var str = endpoint + invoker + Math.random();\n\t  for (var i = 0; i < str.length; i++) {\n\t    var char = str.charCodeAt(i);\n\t    hash = (hash << 5) - hash + char;\n\t    hash = hash & hash;\n\t  }\n\t  return hash;\n\t};\n\n\tvar _firebaseRefsMixin = function _firebaseRefsMixin(id, ref, refs) {\n\t  refs.set(id, ref);\n\t};\n\n\tvar _handleError = function _handleError(onFailure, err) {\n\t  if (err && typeof onFailure === 'function') {\n\t    onFailure(err);\n\t  }\n\t};\n\n\tvar _setUnmountHandler = function _setUnmountHandler(context, id, refs, listeners, syncs) {\n\t  var removeListeners = function removeListeners() {\n\t    (0, _removeBinding3.default)({ context: context, id: id }, { refs: refs, listeners: listeners, syncs: syncs });\n\t  };\n\t  if (typeof context.componentWillUnmount === 'function') {\n\t    var unmount = context.componentWillUnmount;\n\t  }\n\t  context.componentWillUnmount = function () {\n\t    removeListeners();\n\t    if (unmount) unmount.call(context);\n\t  };\n\t};\n\n\tvar _fsSetUnmountHandler = function _fsSetUnmountHandler(context, id, refs, listeners, syncs) {\n\t  var removeListeners = function removeListeners() {\n\t    (0, _fsRemoveBinding3.default)({ context: context, id: id }, { refs: refs, listeners: listeners, syncs: syncs });\n\t  };\n\t  if (typeof context.componentWillUnmount === 'function') {\n\t    var unmount = context.componentWillUnmount;\n\t  }\n\t  context.componentWillUnmount = function () {\n\t    removeListeners();\n\t    if (unmount) unmount.call(context);\n\t  };\n\t};\n\n\tvar _setData = function _setData(ref, data, handleError, keepKeys) {\n\t  if (Array.isArray(data) && keepKeys) {\n\t    var shouldConvertToObject = data.reduce(function (acc, curr) {\n\t      return acc ? acc : _isObject(curr) && curr.hasOwnProperty('key');\n\t    }, false);\n\t    if (shouldConvertToObject) {\n\t      data = data.reduce(function (acc, item) {\n\t        acc[item.key] = item;\n\t        return acc;\n\t      }, {});\n\t    }\n\t  }\n\t  ref.set(data, handleError);\n\t};\n\n\tvar _updateSyncState = function _updateSyncState(ref, onFailure, keepKeys, data) {\n\t  if (_isObject(data)) {\n\t    for (var prop in data) {\n\t      //allow timestamps to be set\n\t      if (prop !== '.sv') {\n\t        _updateSyncState(ref.child(prop), onFailure, keepKeys, data[prop]);\n\t      } else {\n\t        _setData(ref, data, _handleError.bind(null, onFailure), keepKeys);\n\t      }\n\t    }\n\t  } else {\n\t    _setData(ref, data, _handleError.bind(null, onFailure), keepKeys);\n\t  }\n\t};\n\n\tvar _fsUpdateSyncState = function _fsUpdateSyncState(ref, data) {\n\t  ref.set(data);\n\t};\n\n\tvar _addListener = function _addListener(id, invoker, options, ref, listeners) {\n\t  ref = _addQueries(ref, options.queries);\n\t  var boundOnFailure = typeof options.onFailure === 'function' ? options.onFailure.bind(options.context) : null;\n\t  listeners.set(id, ref.on('value', function (snapshot) {\n\t    var data = _prepareData(snapshot, options);\n\t    if (invoker === 'listenTo') {\n\t      options.then.call(options.context, data);\n\t    } else {\n\t      var newState = _defineProperty({}, options.state, data);\n\t      if (_isNestedPath(options.state)) {\n\t        var root = options.state.split('.')[0];\n\t        // Merge the previous state with the new one\n\t        var prevState = _defineProperty({}, root, options.context.state[root]);\n\t        newState = _createNestedObject(options.state, data, prevState);\n\t      }\n\t      if (invoker === 'syncState') {\n\t        options.reactSetState.call(options.context, newState);\n\t        if (options.then && options.then.called === false) {\n\t          options.then.call(options.context);\n\t          options.then.called = true;\n\t        }\n\t      } else if (invoker === 'bindToState') {\n\t        _setState.call(options.context, newState);\n\t        if (options.then && options.then.called === false) {\n\t          options.then.call(options.context);\n\t          options.then.called = true;\n\t        }\n\t      }\n\t    }\n\t  }, boundOnFailure));\n\t};\n\n\tvar _addFirestoreListener = function _addFirestoreListener(id, invoker, options, ref, listeners) {\n\t  ref = _addFirestoreQuery(ref, options.query);\n\t  var boundOnFailure = typeof options.onFailure === 'function' ? options.onFailure.bind(options.context) : undefined;\n\t  listeners.set(id, ref.onSnapshot(function (snapshot) {\n\t    if (invoker.match(/^listenTo/)) {\n\t      if (invoker === 'listenToDoc') {\n\t        var newState = _fsPrepareData(snapshot, options);\n\t        return options.then.call(options.context, newState);\n\t      }\n\t      if (invoker === 'listenToCollection') {\n\t        var _newState2 = _fsPrepareData(snapshot, options, true);\n\t        return options.then.call(options.context, _newState2);\n\t      }\n\t    } else {\n\t      if (invoker === 'syncDoc') {\n\t        var _newState3 = _fsPrepareData(snapshot, options);\n\t        options.reactSetState.call(options.context, function (currentState) {\n\t          return Object.assign(currentState, _newState3);\n\t        });\n\t      } else if (invoker === 'bindDoc') {\n\t        var _newState4 = _fsPrepareData(snapshot, options);\n\t        _setState.call(options.context, function (currentState) {\n\t          return Object.assign(currentState, _newState4);\n\t        });\n\t      } else if (invoker === 'bindCollection') {\n\t        var _newState5 = _fsPrepareData(snapshot, options, true);\n\t        _setState.call(options.context, function (currentState) {\n\t          return Object.assign(currentState, _newState5);\n\t        });\n\t      }\n\t      if (options.then && options.then.called === false) {\n\t        options.then.call(options.context);\n\t        options.then.called = true;\n\t      }\n\t    }\n\t  }, boundOnFailure));\n\t};\n\n\tvar _getSegmentCount = function _getSegmentCount(path) {\n\t  return path.match(/^\\//) ? path.split('/').slice(1).length : path.split('/').length;\n\t};\n\n\tvar _fsPrepareData = function _fsPrepareData(snapshot, options) {\n\t  var isCollection = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n\t  var meta = {};\n\t  if (!isCollection) {\n\t    var data = {};\n\t    if (snapshot.exists) {\n\t      if (options.withRefs) meta.ref = snapshot.ref;\n\t      if (options.withIds) meta.id = snapshot.id;\n\t      data = snapshot.data();\n\t    } else {\n\t      data = {};\n\t    }\n\t    return options.state ? _defineProperty({}, options.state, Object.assign({}, data, meta)) : Object.assign({}, data, meta);\n\t  }\n\t  var collection = [];\n\t  if (!snapshot.empty) {\n\t    snapshot.forEach(function (doc) {\n\t      if (options.withRefs) meta.ref = doc.ref;\n\t      if (options.withIds) meta.id = doc.id;\n\t      collection.push(Object.assign({}, doc.data(), meta));\n\t    });\n\t  }\n\t  return options.state ? _defineProperty({}, options.state, collection) : collection;\n\t};\n\n\tvar _fsCreateRef = function _fsCreateRef(pathOrRef, db) {\n\t  if ((typeof pathOrRef === 'undefined' ? 'undefined' : _typeof(pathOrRef)) === 'object') {\n\t    return pathOrRef;\n\t  }\n\t  var segmentCount = _getSegmentCount(pathOrRef);\n\t  var ref;\n\t  if (segmentCount % 2 === 0) {\n\t    ref = db.doc(pathOrRef);\n\t  } else {\n\t    ref = db.collection(pathOrRef);\n\t  }\n\t  return ref;\n\t};\n\n\texports._createHash = _createHash;\n\texports._addQueries = _addQueries;\n\texports._addFirestoreQuery = _addFirestoreQuery;\n\texports._returnRef = _returnRef;\n\texports._setState = _setState;\n\texports._throwError = _throwError;\n\texports._prepareData = _prepareData;\n\texports._fsPrepareData = _fsPrepareData;\n\texports._toArray = _toArray;\n\texports._isValid = _isValid;\n\texports._isObject = _isObject;\n\texports._isNestedPath = _isNestedPath;\n\texports._getNestedObject = _getNestedObject;\n\texports._getSegmentCount = _getSegmentCount;\n\texports._hasOwnNestedProperty = _hasOwnNestedProperty;\n\texports._addSync = _addSync;\n\texports._firebaseRefsMixin = _firebaseRefsMixin;\n\texports._updateSyncState = _updateSyncState;\n\texports._fsUpdateSyncState = _fsUpdateSyncState;\n\texports._addListener = _addListener;\n\texports._addFirestoreListener = _addFirestoreListener;\n\texports._setUnmountHandler = _setUnmountHandler;\n\texports._createNestedObject = _createNestedObject;\n\texports._handleError = _handleError;\n\texports._setData = _setData;\n\texports._fsSetUnmountHandler = _fsSetUnmountHandler;\n\texports._fsCreateRef = _fsCreateRef;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _removeBinding;\n\n\tvar _utils = __webpack_require__(2);\n\n\tfunction _removeBinding(_ref, _ref2) {\n\t  var id = _ref.id,\n\t      context = _ref.context;\n\t  var refs = _ref2.refs,\n\t      listeners = _ref2.listeners,\n\t      syncs = _ref2.syncs;\n\n\t  var ref = refs.get(id);\n\t  var listener = listeners.get(id);\n\t  if (typeof ref !== 'undefined') {\n\t    ref.off('value', listener);\n\t    refs.delete(id);\n\t    listeners.delete(id);\n\t    if (syncs) {\n\t      var currentSyncs = syncs.get(context);\n\t      if (currentSyncs && currentSyncs.length > 0) {\n\t        var idx = currentSyncs.findIndex(function (item, index) {\n\t          return item.id === id;\n\t        });\n\t        /*istanbul ignore else */\n\t        if (idx !== -1) {\n\t          currentSyncs.splice(idx, 1);\n\t          syncs.set(context, currentSyncs);\n\t        }\n\t      }\n\t    }\n\t  }\n\t}\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _fsRemoveBinding;\n\tfunction _fsRemoveBinding(_ref, _ref2) {\n\t  var id = _ref.id,\n\t      context = _ref.context;\n\t  var refs = _ref2.refs,\n\t      listeners = _ref2.listeners,\n\t      syncs = _ref2.syncs;\n\n\t  var unsubscribe = listeners.get(id);\n\t  if (typeof unsubscribe === 'function') {\n\t    unsubscribe();\n\t    refs.delete(id);\n\t    listeners.delete(id);\n\t    if (syncs) {\n\t      var currentSyncs = syncs.get(context);\n\t      if (currentSyncs && currentSyncs.length > 0) {\n\t        var idx = currentSyncs.findIndex(function (item, index) {\n\t          return item.id === id;\n\t        });\n\t        /*istanbul ignore else */\n\t        if (idx !== -1) {\n\t          currentSyncs.splice(idx, 1);\n\t          syncs.set(context, currentSyncs);\n\t        }\n\t      }\n\t    }\n\t  }\n\t}\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports._validateCollectionPath = exports._validateDocumentPath = exports._validateEndpoint = exports._validateDatabase = exports.optionValidators = undefined;\n\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n\tvar _utils = __webpack_require__(2);\n\n\tvar optionValidators = {\n\t  notObject: function notObject(options) {\n\t    if (!(0, _utils._isObject)(options)) {\n\t      (0, _utils._throwError)('The options argument must be an object. Instead, got ' + options, 'INVALID_OPTIONS');\n\t    }\n\t  },\n\t  context: function context(options) {\n\t    this.notObject(options);\n\t    if (!options.context || !(0, _utils._isObject)(options.context)) {\n\t      this.makeError('context', 'object', options.context);\n\t    }\n\t  },\n\t  state: function state(options) {\n\t    this.notObject(options);\n\t    if (!options.state || typeof options.state !== 'string') {\n\t      this.makeError('state', 'string', options.state);\n\t    }\n\t  },\n\t  then: function then(options) {\n\t    this.notObject(options);\n\t    if (typeof options.then === 'undefined' || typeof options.then !== 'function') {\n\t      this.makeError('then', 'function', options.then);\n\t    }\n\t  },\n\t  data: function data(options) {\n\t    this.notObject(options);\n\t    if (typeof options.data === 'undefined') {\n\t      this.makeError('data', 'ANY', options.data);\n\t    }\n\t  },\n\t  query: function query(options) {\n\t    this.notObject(options);\n\t    var validQueries = ['limitToFirst', 'limitToLast', 'orderByChild', 'orderByValue', 'orderByKey', 'orderByPriority', 'startAt', 'endAt', 'equalTo'];\n\t    var queries = options.queries;\n\t    for (var key in queries) {\n\t      if (queries.hasOwnProperty(key) && validQueries.indexOf(key) === -1) {\n\t        (0, _utils._throwError)('The query field must contain valid Firebase queries.  Expected one of [' + validQueries.join(', ') + ']. Instead, got ' + key, 'INVALID_OPTIONS');\n\t      }\n\t    }\n\t  },\n\t  defaultValue: function defaultValue(options) {\n\t    this.notObject(options);\n\t    if (options.hasOwnProperty('defaultValue')) {\n\t      if (!(0, _utils._isValid)(options.defaultValue)) {\n\t        (0, _utils._throwError)('The typeof defaultValue must be one of string, number, boolean, object.', 'INVALID_OPTIONS');\n\t      }\n\t    }\n\t  },\n\t  makeError: function makeError(prop, type, actual) {\n\t    (0, _utils._throwError)('The options argument must contain a ' + prop + ' property of type ' + type + '. Instead, got ' + actual, 'INVALID_OPTIONS');\n\t  }\n\t};\n\n\tvar _validateEndpoint = function _validateEndpoint(endpoint) {\n\t  if ((typeof endpoint === 'undefined' ? 'undefined' : _typeof(endpoint)) === 'object') {\n\t    if (endpoint.hasOwnProperty('firestore')) {\n\t      return;\n\t    }\n\t  }\n\t  var defaultError = 'The Firebase endpoint you are trying to listen to';\n\t  var errorMsg;\n\t  if (typeof endpoint !== 'string') {\n\t    errorMsg = defaultError + ' must be a string. Instead, got ' + endpoint;\n\t  } else if (endpoint.length === 0) {\n\t    errorMsg = defaultError + ' must be a non-empty string. Instead, got ' + endpoint;\n\t  } else if (endpoint.length > 768) {\n\t    errorMsg = defaultError + ' is too long to be stored in Firebase. It must be less than 768 characters.';\n\t  } else if (/^$|[\\[\\]\\#\\$]|.{1}[\\.]/.test(endpoint)) {\n\t    errorMsg = defaultError + ' in invalid. Paths must be non-empty strings and can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\".';\n\t  }\n\n\t  if (typeof errorMsg !== 'undefined') {\n\t    (0, _utils._throwError)(errorMsg, 'INVALID_ENDPOINT');\n\t  }\n\t};\n\n\tvar _validateDatabase = function _validateDatabase(db) {\n\t  var defaultError = 'Rebase.createClass failed.';\n\t  var errorMsg;\n\t  if ((typeof db === 'undefined' ? 'undefined' : _typeof(db)) !== 'object' || !db.ref && !db.collection) {\n\t    errorMsg = defaultError + ' Expected an initialized firebase or firestore database object.';\n\t  }\n\t  if (typeof errorMsg !== 'undefined') {\n\t    (0, _utils._throwError)(errorMsg, 'INVALID_CONFIG');\n\t  }\n\t};\n\n\tvar _validateDocumentPath = function _validateDocumentPath(path) {\n\t  if ((typeof path === 'undefined' ? 'undefined' : _typeof(path)) === 'object' && path.hasOwnProperty('firestore')) return;\n\t  var defaultError = 'Invalid document path or reference.';\n\t  if (typeof path !== 'string') (0, _utils._throwError)(defaultError, 'INVALID_ENDPOINT');\n\t  var segmentCount = (0, _utils._getSegmentCount)(path);\n\t  if (segmentCount % 2 !== 0) (0, _utils._throwError)(defaultError, 'INVALID_ENDPOINT');\n\t};\n\n\tvar _validateCollectionPath = function _validateCollectionPath(path) {\n\t  if ((typeof path === 'undefined' ? 'undefined' : _typeof(path)) === 'object' && path.hasOwnProperty('firestore')) return;\n\t  var defaultError = 'Invalid collection path or reference.';\n\t  if (typeof path !== 'string') (0, _utils._throwError)(defaultError, 'INVALID_ENDPOINT');\n\t  var segmentCount = (0, _utils._getSegmentCount)(path);\n\t  if (segmentCount % 2 === 0) (0, _utils._throwError)(defaultError, 'INVALID_ENDPOINT');\n\t};\n\n\texports.optionValidators = optionValidators;\n\texports._validateDatabase = _validateDatabase;\n\texports._validateEndpoint = _validateEndpoint;\n\texports._validateDocumentPath = _validateDocumentPath;\n\texports._validateCollectionPath = _validateCollectionPath;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_6__;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _push;\n\n\tvar _validators = __webpack_require__(5);\n\n\tfunction _push(endpoint, options, db) {\n\t  (0, _validators._validateEndpoint)(endpoint);\n\t  _validators.optionValidators.data(options);\n\t  var ref = db.ref(endpoint);\n\t  var returnEndpoint;\n\t  if (options.then) {\n\t    returnEndpoint = ref.push(options.data, options.then);\n\t  } else {\n\t    returnEndpoint = ref.push(options.data);\n\t  }\n\t  return returnEndpoint;\n\t}\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _fetch;\n\n\tvar _validators = __webpack_require__(5);\n\n\tvar _utils = __webpack_require__(2);\n\n\tfunction _fetch(endpoint, options, db) {\n\t  (0, _validators._validateEndpoint)(endpoint);\n\t  _validators.optionValidators.defaultValue(options);\n\t  options.queries && _validators.optionValidators.query(options);\n\t  var ref = db.ref(endpoint);\n\t  ref = (0, _utils._addQueries)(ref, options.queries);\n\t  return ref.once('value').then(function (snapshot) {\n\t    var data = (0, _utils._prepareData)(snapshot, options);\n\t    if (options.then) {\n\t      options.then.call(options.context, data);\n\t    }\n\t    return data;\n\t  }).catch(function (err) {\n\t    //call onFailure callback if it exists otherwise rethrow error\n\t    if (options.onFailure && typeof options.onFailure === 'function') {\n\t      options.onFailure.call(options.context, err);\n\t    } else {\n\t      throw err;\n\t    }\n\t  });\n\t}\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _post;\n\n\tvar _validators = __webpack_require__(5);\n\n\tfunction _post(endpoint, options, db) {\n\t  (0, _validators._validateEndpoint)(endpoint);\n\t  _validators.optionValidators.data(options);\n\t  var ref = db.ref(endpoint);\n\t  if (options.then) {\n\t    return ref.set(options.data, options.then);\n\t  } else {\n\t    return ref.set(options.data);\n\t  }\n\t}\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _sync;\n\n\tvar _validators = __webpack_require__(5);\n\n\tvar _utils = __webpack_require__(2);\n\n\tfunction _sync(endpoint, options, state) {\n\t  (0, _validators._validateEndpoint)(endpoint);\n\t  _validators.optionValidators.context(options);\n\t  _validators.optionValidators.state(options);\n\t  _validators.optionValidators.defaultValue(options);\n\t  options.queries && _validators.optionValidators.query(options);\n\t  options.then && (options.then.called = false);\n\t  options.onFailure = options.onFailure ? options.onFailure.bind(options.context) : null;\n\t  options.keepKeys = options.keepKeys && options.asArray;\n\n\t  //store reference to react's setState\n\t  if (_sync.called !== true) {\n\t    _sync.reactSetState = options.context.setState;\n\t    _sync.called = true;\n\t  }\n\t  options.reactSetState = _sync.reactSetState;\n\n\t  var ref = state.db.ref(endpoint);\n\t  var id = (0, _utils._createHash)(endpoint, 'syncState');\n\t  (0, _utils._firebaseRefsMixin)(id, ref, state.refs);\n\t  (0, _utils._addListener)(id, 'syncState', options, ref, state.listeners);\n\t  (0, _utils._setUnmountHandler)(options.context, id, state.refs, state.listeners, state.syncs);\n\t  var sync = {\n\t    id: id,\n\t    updateFirebase: _utils._updateSyncState.bind(null, ref, options.onFailure, options.keepKeys),\n\t    stateKey: options.state\n\t  };\n\t  (0, _utils._addSync)(options.context, sync, state.syncs);\n\n\t  options.context.setState = function (data, cb) {\n\t    //if setState is a function, call it first before syncing to fb\n\t    if (typeof data === 'function') {\n\t      return _sync.reactSetState.call(options.context, data, function () {\n\t        if (cb) cb.call(options.context);\n\t        return options.context.setState.call(options.context, options.context.state);\n\t      });\n\t    }\n\t    //if callback is supplied, call setState first before syncing to fb\n\t    if (typeof cb === 'function') {\n\t      return _sync.reactSetState.call(options.context, data, function () {\n\t        cb();\n\t        return options.context.setState.call(options.context, data);\n\t      });\n\t    }\n\t    var syncsToCall = state.syncs.get(this);\n\t    //if sync does not exist, call original Component.setState\n\t    if (!syncsToCall || syncsToCall.length === 0) {\n\t      return _sync.reactSetState.call(this, data, cb);\n\t    }\n\t    var syncedKeys = syncsToCall.map(function (sync) {\n\t      return {\n\t        key: sync.stateKey,\n\t        update: sync.updateFirebase,\n\t        nested: (0, _utils._isNestedPath)(sync.stateKey)\n\t      };\n\t    });\n\t    syncedKeys.forEach(function (syncedKey) {\n\t      if (syncedKey.nested === true) {\n\t        if ((0, _utils._hasOwnNestedProperty)(data, syncedKey.key)) {\n\t          var datum = (0, _utils._getNestedObject)(data, syncedKey.key);\n\t          syncedKey.update(datum);\n\t        }\n\t      } else if (data.hasOwnProperty(syncedKey.key)) {\n\t        syncedKey.update(data[syncedKey.key]);\n\t      }\n\t    });\n\t    var allKeys = Object.keys(data);\n\t    allKeys.forEach(function (key) {\n\t      var absent = !syncedKeys.find(function (syncedKey) {\n\t        var k = syncedKey.key;\n\t        if (syncedKey.nested === true) {\n\t          // Check with the root\n\t          k = syncedKey.key.split('.')[0];\n\t        }\n\t        return k === key;\n\t      });\n\n\t      if (absent) {\n\t        var update = {};\n\t        update[key] = data[key];\n\t        _sync.reactSetState.call(options.context, update, cb);\n\t      }\n\t    });\n\t  };\n\t  return (0, _utils._returnRef)(endpoint, 'syncState', id, options.context);\n\t}\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _bind;\n\n\tvar _validators = __webpack_require__(5);\n\n\tvar _utils = __webpack_require__(2);\n\n\tfunction _bind(endpoint, options, invoker, state) {\n\t  (0, _validators._validateEndpoint)(endpoint);\n\t  _validators.optionValidators.context(options);\n\t  _validators.optionValidators.defaultValue(options);\n\t  invoker === 'listenTo' && _validators.optionValidators.then(options);\n\t  invoker === 'bindToState' && _validators.optionValidators.state(options);\n\t  options.queries && _validators.optionValidators.query(options);\n\t  options.then && (options.then.called = false);\n\n\t  var id = (0, _utils._createHash)(endpoint, invoker);\n\t  var ref = state.db.ref(endpoint);\n\t  (0, _utils._firebaseRefsMixin)(id, ref, state.refs);\n\t  (0, _utils._addListener)(id, invoker, options, ref, state.listeners);\n\t  (0, _utils._setUnmountHandler)(options.context, id, state.refs, state.listeners, state.syncs);\n\t  return (0, _utils._returnRef)(endpoint, invoker, id, options.context);\n\t}\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _update;\n\n\tvar _validators = __webpack_require__(5);\n\n\tfunction _update(endpoint, options, state) {\n\t  (0, _validators._validateEndpoint)(endpoint);\n\t  _validators.optionValidators.data(options);\n\t  var ref = state.db.ref(endpoint);\n\t  if (options.then) {\n\t    return ref.update(options.data, options.then);\n\t  } else {\n\t    return ref.update(options.data);\n\t  }\n\t}\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _reset;\n\tfunction _reset(state) {\n\t  state.refs.forEach(function (ref, id) {\n\t    ref.off('value', state.listeners.get(id));\n\t  });\n\t  state.listeners = new Map();\n\t  state.refs = new Map();\n\t  state.syncs = new WeakMap();\n\t  return null;\n\t}\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\n\texports.default = function (endpoint, db, fn) {\n\t  return db.ref().child(endpoint).remove(fn);\n\t};\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _fsSync;\n\n\tvar _validators = __webpack_require__(5);\n\n\tvar _utils = __webpack_require__(2);\n\n\tfunction _fsSync(document, options, state) {\n\t  //validate arguments\n\t  (0, _validators._validateDocumentPath)(document);\n\t  _validators.optionValidators.context(options);\n\t  _validators.optionValidators.state(options);\n\t  options.then && (options.then.called = false);\n\t  //store reference to react's setState\n\t  if (_fsSync.called !== true) {\n\t    _fsSync.reactSetState = options.context.setState;\n\t    _fsSync.called = true;\n\t  }\n\t  options.reactSetState = _fsSync.reactSetState;\n\n\t  var id = (0, _utils._createHash)(document, 'syncDoc');\n\t  var ref = (0, _utils._fsCreateRef)(document, state.db);\n\t  (0, _utils._firebaseRefsMixin)(id, ref, state.refs);\n\t  (0, _utils._addFirestoreListener)(id, 'syncDoc', options, ref, state.listeners);\n\t  (0, _utils._fsSetUnmountHandler)(options.context, id, state.refs, state.listeners, state.syncs);\n\t  var sync = {\n\t    id: id,\n\t    updateFirebase: _utils._fsUpdateSyncState.bind(null, ref),\n\t    stateKey: options.state\n\t  };\n\t  (0, _utils._addSync)(options.context, sync, state.syncs);\n\t  options.context.setState = function (data, cb) {\n\t    //if setState is a function, call it first before syncing to fb\n\t    if (typeof data === 'function') {\n\t      return _fsSync.reactSetState.call(options.context, data, function () {\n\t        if (cb) cb.call(options.context);\n\t        return options.context.setState.call(options.context, options.context.state);\n\t      });\n\t    }\n\t    //if callback is supplied, call setState first before syncing to fb\n\t    if (typeof cb === 'function') {\n\t      return _fsSync.reactSetState.call(options.context, data, function () {\n\t        cb();\n\t        return options.context.setState.call(options.context, data);\n\t      });\n\t    }\n\t    var syncsToCall = state.syncs.get(this);\n\t    //if sync does not exist, call original Component.setState\n\t    if (!syncsToCall || syncsToCall.length === 0) {\n\t      return _fsSync.reactSetState.call(this, data, cb);\n\t    }\n\t    //send the update of synced keys to firestore\n\t    var syncedKeys = syncsToCall.map(function (sync) {\n\t      return {\n\t        key: sync.stateKey,\n\t        update: sync.updateFirebase\n\t      };\n\t    });\n\t    syncedKeys.forEach(function (syncedKey) {\n\t      if (data[syncedKey.key]) {\n\t        syncedKey.update(data[syncedKey.key]);\n\t      }\n\t    });\n\t    //send the update of all other keys through setState\n\t    var allKeys = Object.keys(data);\n\t    allKeys.forEach(function (key) {\n\t      var absent = !syncedKeys.find(function (syncedKey) {\n\t        return syncedKey.key === key;\n\t      });\n\t      if (absent) {\n\t        var update = {};\n\t        update[key] = data[key];\n\t        _fsSync.reactSetState.call(options.context, function (currentState) {\n\t          return Object.assign(currentState, update);\n\t        }, cb);\n\t      }\n\t    });\n\t  };\n\t  return (0, _utils._returnRef)(document, 'syncDoc', id, options.context);\n\t}\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _fsBind;\n\n\tvar _validators = __webpack_require__(5);\n\n\tvar _utils = __webpack_require__(2);\n\n\tfunction _fsBind(path, options, invoker, state) {\n\t  _validators.optionValidators.context(options);\n\t  options.then && (options.then.called = false);\n\t  if (invoker === 'bindDoc') {\n\t    (0, _validators._validateDocumentPath)(path);\n\t  }\n\t  if (invoker === 'bindCollection') {\n\t    _validators.optionValidators.state(options);\n\t    (0, _validators._validateCollectionPath)(path);\n\t  }\n\t  if (invoker === 'listenToDoc') {\n\t    (0, _validators._validateDocumentPath)(path);\n\t    _validators.optionValidators.then(options);\n\t  }\n\t  if (invoker === 'listenToCollection') {\n\t    (0, _validators._validateCollectionPath)(path);\n\t    _validators.optionValidators.then(options);\n\t  }\n\t  var ref = (0, _utils._fsCreateRef)(path, state.db);\n\t  var id = (0, _utils._createHash)(path, invoker);\n\t  (0, _utils._firebaseRefsMixin)(id, ref, state.refs);\n\t  (0, _utils._addFirestoreListener)(id, invoker, options, ref, state.listeners);\n\t  (0, _utils._fsSetUnmountHandler)(options.context, id, state.refs, state.listeners, state.syncs);\n\t  return (0, _utils._returnRef)(path, invoker, id, options.context);\n\t}\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _fsGet;\n\n\tvar _utils = __webpack_require__(2);\n\n\tvar _validators = __webpack_require__(5);\n\n\tfunction _fsGet(endpoint) {\n\t  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\t  var db = arguments[2];\n\n\t  (0, _validators._validateEndpoint)(endpoint);\n\t  var ref = (0, _utils._fsCreateRef)(endpoint, db);\n\t  //check if ref is a collection\n\t  var isCollection = !!ref.add;\n\t  ref = (0, _utils._addFirestoreQuery)(ref, options.query);\n\t  return ref.get().then(function (snapshot) {\n\t    if (isCollection && !snapshot.empty || !isCollection && snapshot.exists) {\n\t      return (0, _utils._fsPrepareData)(snapshot, options, isCollection);\n\t    } else {\n\t      return Promise.reject(new Error('No Result'));\n\t    }\n\t  });\n\t}\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _fsRemoveDoc;\n\n\tvar _utils = __webpack_require__(2);\n\n\tfunction _fsRemoveDoc(path, db) {\n\t  var ref = (0, _utils._fsCreateRef)(path, db);\n\t  return ref.delete();\n\t}\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _fsAddToCollection;\n\n\tvar _validators = __webpack_require__(5);\n\n\tvar _utils = __webpack_require__(2);\n\n\tfunction _fsAddToCollection(path, doc, db, key) {\n\t  (0, _validators._validateCollectionPath)(path);\n\t  var ref = (0, _utils._fsCreateRef)(path, db);\n\t  if (key) {\n\t    return ref.doc(key).set(doc);\n\t  }\n\t  return ref.add(doc);\n\t}\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _fsRemoveFromCollection;\n\n\tvar _validators = __webpack_require__(5);\n\n\tvar _utils = __webpack_require__(2);\n\n\tfunction _fsRemoveFromCollection(path, db) {\n\t  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\t  (0, _validators._validateCollectionPath)(path);\n\t  var ref = (0, _utils._fsCreateRef)(path, db);\n\t  ref = (0, _utils._addFirestoreQuery)(ref, options.query);\n\t  return ref.get().then(function (snapshot) {\n\t    if (!snapshot.empty) {\n\t      var batch = db.batch();\n\t      snapshot.forEach(function (doc) {\n\t        batch.delete(doc.ref);\n\t      });\n\t      return batch.commit();\n\t    }\n\t  });\n\t}\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _fsUpdateDoc;\n\n\tvar _validators = __webpack_require__(5);\n\n\tvar _utils = __webpack_require__(2);\n\n\tfunction _fsUpdateDoc(document, data, db) {\n\t  (0, _validators._validateDocumentPath)(document);\n\t  var ref = (0, _utils._fsCreateRef)(document, db);\n\t  return ref.update(data);\n\t}\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = _fsReset;\n\tfunction _fsReset(state) {\n\t  state.listeners.forEach(function (unsubscribe, id) {\n\t    unsubscribe();\n\t  });\n\t  state.listeners = new Map();\n\t  state.refs = new Map();\n\t  state.syncs = new WeakMap();\n\t  return null;\n\t}\n\n/***/ })\n/******/ ])\n});\n;","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { jsonEval, stringify } from '@firebase/util';\n\n/**\n * Wraps a DOM Storage object and:\n * - automatically encode objects as JSON strings before storing them to allow us to store arbitrary types.\n * - prefixes names with \"firebase:\" to avoid collisions with app data.\n *\n * We automatically (see storage.js) create two such wrappers, one for sessionStorage,\n * and one for localStorage.\n *\n * @constructor\n */\nexport class DOMStorageWrapper {\n  // Use a prefix to avoid collisions with other stuff saved by the app.\n  private prefix_ = 'firebase:';\n\n  /**\n   * @param {Storage} domStorage_ The underlying storage object (e.g. localStorage or sessionStorage)\n   */\n  constructor(private domStorage_: Storage) {}\n\n  /**\n   * @param {string} key The key to save the value under\n   * @param {?Object} value The value being stored, or null to remove the key.\n   */\n  set(key: string, value: any | null) {\n    if (value == null) {\n      this.domStorage_.removeItem(this.prefixedName_(key));\n    } else {\n      this.domStorage_.setItem(this.prefixedName_(key), stringify(value));\n    }\n  }\n\n  /**\n   * @param {string} key\n   * @return {*} The value that was stored under this key, or null\n   */\n  get(key: string): any {\n    const storedVal = this.domStorage_.getItem(this.prefixedName_(key));\n    if (storedVal == null) {\n      return null;\n    } else {\n      return jsonEval(storedVal);\n    }\n  }\n\n  /**\n   * @param {string} key\n   */\n  remove(key: string) {\n    this.domStorage_.removeItem(this.prefixedName_(key));\n  }\n\n  isInMemoryStorage: boolean;\n\n  /**\n   * @param {string} name\n   * @return {string}\n   */\n  prefixedName_(name: string): string {\n    return this.prefix_ + name;\n  }\n\n  toString(): string {\n    return this.domStorage_.toString();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { contains } from '@firebase/util';\n\n/**\n * An in-memory storage implementation that matches the API of DOMStorageWrapper\n * (TODO: create interface for both to implement).\n *\n * @constructor\n */\nexport class MemoryStorage {\n  private cache_: { [k: string]: any } = {};\n\n  set(key: string, value: any | null) {\n    if (value == null) {\n      delete this.cache_[key];\n    } else {\n      this.cache_[key] = value;\n    }\n  }\n\n  get(key: string): any {\n    if (contains(this.cache_, key)) {\n      return this.cache_[key];\n    }\n    return null;\n  }\n\n  remove(key: string) {\n    delete this.cache_[key];\n  }\n\n  isInMemoryStorage = true;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DOMStorageWrapper } from './DOMStorageWrapper';\nimport { MemoryStorage } from './MemoryStorage';\n\ndeclare const window: any;\n\n/**\n * Helper to create a DOMStorageWrapper or else fall back to MemoryStorage.\n * TODO: Once MemoryStorage and DOMStorageWrapper have a shared interface this method annotation should change\n * to reflect this type\n *\n * @param {string} domStorageName Name of the underlying storage object\n *   (e.g. 'localStorage' or 'sessionStorage').\n * @return {?} Turning off type information until a common interface is defined.\n */\nconst createStoragefor = function(\n  domStorageName: string\n): DOMStorageWrapper | MemoryStorage {\n  try {\n    // NOTE: just accessing \"localStorage\" or \"window['localStorage']\" may throw a security exception,\n    // so it must be inside the try/catch.\n    if (\n      typeof window !== 'undefined' &&\n      typeof window[domStorageName] !== 'undefined'\n    ) {\n      // Need to test cache. Just because it's here doesn't mean it works\n      const domStorage = window[domStorageName];\n      domStorage.setItem('firebase:sentinel', 'cache');\n      domStorage.removeItem('firebase:sentinel');\n      return new DOMStorageWrapper(domStorage);\n    }\n  } catch (e) {}\n\n  // Failed to create wrapper.  Just return in-memory storage.\n  // TODO: log?\n  return new MemoryStorage();\n};\n\n/** A storage object that lasts across sessions */\nexport const PersistentStorage = createStoragefor('localStorage');\n\n/** A storage object that only lasts one session */\nexport const SessionStorage = createStoragefor('sessionStorage');\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Query } from '../../api/Query';\n\ndeclare const window: any;\ndeclare const Windows: any;\n\nimport { assert } from '@firebase/util';\nimport { base64 } from '@firebase/util';\nimport { Sha1 } from '@firebase/util';\nimport { stringToByteArray } from '@firebase/util';\nimport { stringify } from '@firebase/util';\nimport { SessionStorage } from '../storage/storage';\nimport { isNodeSdk } from '@firebase/util';\nimport { Logger, LogLevel } from '@firebase/logger';\n\nconst logClient = new Logger('@firebase/database');\n\n/**\n * Returns a locally-unique ID (generated by just incrementing up from 0 each time its called).\n * @type {function(): number} Generated ID.\n */\nexport const LUIDGenerator: () => number = (function() {\n  let id = 1;\n  return function() {\n    return id++;\n  };\n})();\n\n/**\n * Sha1 hash of the input string\n * @param {!string} str The string to hash\n * @return {!string} The resulting hash\n */\nexport const sha1 = function(str: string): string {\n  const utf8Bytes = stringToByteArray(str);\n  const sha1 = new Sha1();\n  sha1.update(utf8Bytes);\n  const sha1Bytes = sha1.digest();\n  return base64.encodeByteArray(sha1Bytes);\n};\n\n/**\n * @param {...*} var_args\n * @return {string}\n * @private\n */\nconst buildLogMessage_ = function(...var_args: any[]): string {\n  let message = '';\n  for (let i = 0; i < var_args.length; i++) {\n    if (\n      Array.isArray(var_args[i]) ||\n      (var_args[i] &&\n        typeof var_args[i] === 'object' &&\n        typeof var_args[i].length === 'number')\n    ) {\n      message += buildLogMessage_.apply(null, var_args[i]);\n    } else if (typeof var_args[i] === 'object') {\n      message += stringify(var_args[i]);\n    } else {\n      message += var_args[i];\n    }\n    message += ' ';\n  }\n\n  return message;\n};\n\n/**\n * Use this for all debug messages in Firebase.\n * @type {?function(string)}\n */\nexport let logger: ((a: string) => void) | null = null;\n\n/**\n * Flag to check for log availability on first log message\n * @type {boolean}\n * @private\n */\nlet firstLog_ = true;\n\n/**\n * The implementation of Firebase.enableLogging (defined here to break dependencies)\n * @param {boolean|?function(string)} logger_ A flag to turn on logging, or a custom logger\n * @param {boolean=} persistent Whether or not to persist logging settings across refreshes\n */\nexport const enableLogging = function(\n  logger_?: boolean | ((a: string) => void) | null,\n  persistent?: boolean\n) {\n  assert(\n    !persistent || logger_ === true || logger_ === false,\n    \"Can't turn on custom loggers persistently.\"\n  );\n  if (logger_ === true) {\n    logClient.logLevel = LogLevel.VERBOSE;\n    logger = logClient.log.bind(logClient);\n    if (persistent) SessionStorage.set('logging_enabled', true);\n  } else if (typeof logger_ === 'function') {\n    logger = logger_;\n  } else {\n    logger = null;\n    SessionStorage.remove('logging_enabled');\n  }\n};\n\n/**\n *\n * @param {...(string|Arguments)} var_args\n */\nexport const log = function(...var_args: string[]) {\n  if (firstLog_ === true) {\n    firstLog_ = false;\n    if (logger === null && SessionStorage.get('logging_enabled') === true)\n      enableLogging(true);\n  }\n\n  if (logger) {\n    const message = buildLogMessage_.apply(null, var_args);\n    logger(message);\n  }\n};\n\n/**\n * @param {!string} prefix\n * @return {function(...[*])}\n */\nexport const logWrapper = function(\n  prefix: string\n): (...var_args: any[]) => void {\n  return function(...var_args: any[]) {\n    log(prefix, ...var_args);\n  };\n};\n\n/**\n * @param {...string} var_args\n */\nexport const error = function(...var_args: string[]) {\n  const message = 'FIREBASE INTERNAL ERROR: ' + buildLogMessage_(...var_args);\n  logClient.error(message);\n};\n\n/**\n * @param {...string} var_args\n */\nexport const fatal = function(...var_args: string[]) {\n  const message = `FIREBASE FATAL ERROR: ${buildLogMessage_(...var_args)}`;\n  logClient.error(message);\n  throw new Error(message);\n};\n\n/**\n * @param {...*} var_args\n */\nexport const warn = function(...var_args: any[]) {\n  const message = 'FIREBASE WARNING: ' + buildLogMessage_(...var_args);\n  logClient.warn(message);\n};\n\n/**\n * Logs a warning if the containing page uses https. Called when a call to new Firebase\n * does not use https.\n */\nexport const warnIfPageIsSecure = function() {\n  // Be very careful accessing browser globals. Who knows what may or may not exist.\n  if (\n    typeof window !== 'undefined' &&\n    window.location &&\n    window.location.protocol &&\n    window.location.protocol.indexOf('https:') !== -1\n  ) {\n    warn(\n      'Insecure Firebase access from a secure page. ' +\n        'Please use https in calls to new Firebase().'\n    );\n  }\n};\n\n/**\n * @param {!String} methodName\n */\nexport const warnAboutUnsupportedMethod = function(methodName: string) {\n  warn(\n    methodName +\n      ' is unsupported and will likely change soon.  ' +\n      'Please do not use.'\n  );\n};\n\n/**\n * Returns true if data is NaN, or +/- Infinity.\n * @param {*} data\n * @return {boolean}\n */\nexport const isInvalidJSONNumber = function(data: any): boolean {\n  return (\n    typeof data === 'number' &&\n    (data != data || // NaN\n      data == Number.POSITIVE_INFINITY ||\n      data == Number.NEGATIVE_INFINITY)\n  );\n};\n\n/**\n * @param {function()} fn\n */\nexport const executeWhenDOMReady = function(fn: () => void) {\n  if (isNodeSdk() || document.readyState === 'complete') {\n    fn();\n  } else {\n    // Modeled after jQuery. Try DOMContentLoaded and onreadystatechange (which\n    // fire before onload), but fall back to onload.\n\n    let called = false;\n    let wrappedFn = function() {\n      if (!document.body) {\n        setTimeout(wrappedFn, Math.floor(10));\n        return;\n      }\n\n      if (!called) {\n        called = true;\n        fn();\n      }\n    };\n\n    if (document.addEventListener) {\n      document.addEventListener('DOMContentLoaded', wrappedFn, false);\n      // fallback to onload.\n      window.addEventListener('load', wrappedFn, false);\n    } else if ((document as any).attachEvent) {\n      // IE.\n      (document as any).attachEvent('onreadystatechange', function() {\n        if (document.readyState === 'complete') wrappedFn();\n      });\n      // fallback to onload.\n      (window as any).attachEvent('onload', wrappedFn);\n\n      // jQuery has an extra hack for IE that we could employ (based on\n      // http://javascript.nwbox.com/IEContentLoaded/) But it looks really old.\n      // I'm hoping we don't need it.\n    }\n  }\n};\n\n/**\n * Minimum key name. Invalid for actual data, used as a marker to sort before any valid names\n * @type {!string}\n */\nexport const MIN_NAME = '[MIN_NAME]';\n\n/**\n * Maximum key name. Invalid for actual data, used as a marker to sort above any valid names\n * @type {!string}\n */\nexport const MAX_NAME = '[MAX_NAME]';\n\n/**\n * Compares valid Firebase key names, plus min and max name\n * @param {!string} a\n * @param {!string} b\n * @return {!number}\n */\nexport const nameCompare = function(a: string, b: string): number {\n  if (a === b) {\n    return 0;\n  } else if (a === MIN_NAME || b === MAX_NAME) {\n    return -1;\n  } else if (b === MIN_NAME || a === MAX_NAME) {\n    return 1;\n  } else {\n    const aAsInt = tryParseInt(a),\n      bAsInt = tryParseInt(b);\n\n    if (aAsInt !== null) {\n      if (bAsInt !== null) {\n        return aAsInt - bAsInt == 0 ? a.length - b.length : aAsInt - bAsInt;\n      } else {\n        return -1;\n      }\n    } else if (bAsInt !== null) {\n      return 1;\n    } else {\n      return a < b ? -1 : 1;\n    }\n  }\n};\n\n/**\n * @param {!string} a\n * @param {!string} b\n * @return {!number} comparison result.\n */\nexport const stringCompare = function(a: string, b: string): number {\n  if (a === b) {\n    return 0;\n  } else if (a < b) {\n    return -1;\n  } else {\n    return 1;\n  }\n};\n\n/**\n * @param {string} key\n * @param {Object} obj\n * @return {*}\n */\nexport const requireKey = function(\n  key: string,\n  obj: { [k: string]: any }\n): any {\n  if (obj && key in obj) {\n    return obj[key];\n  } else {\n    throw new Error(\n      'Missing required key (' + key + ') in object: ' + stringify(obj)\n    );\n  }\n};\n\n/**\n * @param {*} obj\n * @return {string}\n */\nexport const ObjectToUniqueKey = function(obj: any): string {\n  if (typeof obj !== 'object' || obj === null) return stringify(obj);\n\n  const keys = [];\n  for (let k in obj) {\n    keys.push(k);\n  }\n\n  // Export as json, but with the keys sorted.\n  keys.sort();\n  let key = '{';\n  for (let i = 0; i < keys.length; i++) {\n    if (i !== 0) key += ',';\n    key += stringify(keys[i]);\n    key += ':';\n    key += ObjectToUniqueKey(obj[keys[i]]);\n  }\n\n  key += '}';\n  return key;\n};\n\n/**\n * Splits a string into a number of smaller segments of maximum size\n * @param {!string} str The string\n * @param {!number} segsize The maximum number of chars in the string.\n * @return {Array.<string>} The string, split into appropriately-sized chunks\n */\nexport const splitStringBySize = function(\n  str: string,\n  segsize: number\n): string[] {\n  const len = str.length;\n\n  if (len <= segsize) {\n    return [str];\n  }\n\n  const dataSegs = [];\n  for (let c = 0; c < len; c += segsize) {\n    if (c + segsize > len) {\n      dataSegs.push(str.substring(c, len));\n    } else {\n      dataSegs.push(str.substring(c, c + segsize));\n    }\n  }\n  return dataSegs;\n};\n\n/**\n * Apply a function to each (key, value) pair in an object or\n * apply a function to each (index, value) pair in an array\n * @param obj The object or array to iterate over\n * @param fn The function to apply\n */\nexport function each(obj: object, fn: (k: string, v: any) => void) {\n  for (const key in obj) {\n    if (obj.hasOwnProperty(key)) {\n      fn(key, obj[key]);\n    }\n  }\n}\n\n/**\n * Like goog.bind, but doesn't bother to create a closure if opt_context is null/undefined.\n * @param {function(*)} callback Callback function.\n * @param {?Object=} context Optional context to bind to.\n * @return {function(*)}\n */\nexport const bindCallback = function(\n  callback: (a: any) => void,\n  context?: object | null\n): Function {\n  return context ? callback.bind(context) : callback;\n};\n\n/**\n * Borrowed from http://hg.secondlife.com/llsd/src/tip/js/typedarray.js (MIT License)\n * I made one modification at the end and removed the NaN / Infinity\n * handling (since it seemed broken [caused an overflow] and we don't need it).  See MJL comments.\n * @param {!number} v A double\n * @return {string}\n */\nexport const doubleToIEEE754String = function(v: number): string {\n  assert(!isInvalidJSONNumber(v), 'Invalid JSON number'); // MJL\n\n  const ebits = 11,\n    fbits = 52;\n  let bias = (1 << (ebits - 1)) - 1,\n    s,\n    e,\n    f,\n    ln,\n    i,\n    bits,\n    str;\n\n  // Compute sign, exponent, fraction\n  // Skip NaN / Infinity handling --MJL.\n  if (v === 0) {\n    e = 0;\n    f = 0;\n    s = 1 / v === -Infinity ? 1 : 0;\n  } else {\n    s = v < 0;\n    v = Math.abs(v);\n\n    if (v >= Math.pow(2, 1 - bias)) {\n      // Normalized\n      ln = Math.min(Math.floor(Math.log(v) / Math.LN2), bias);\n      e = ln + bias;\n      f = Math.round(v * Math.pow(2, fbits - ln) - Math.pow(2, fbits));\n    } else {\n      // Denormalized\n      e = 0;\n      f = Math.round(v / Math.pow(2, 1 - bias - fbits));\n    }\n  }\n\n  // Pack sign, exponent, fraction\n  bits = [];\n  for (i = fbits; i; i -= 1) {\n    bits.push(f % 2 ? 1 : 0);\n    f = Math.floor(f / 2);\n  }\n  for (i = ebits; i; i -= 1) {\n    bits.push(e % 2 ? 1 : 0);\n    e = Math.floor(e / 2);\n  }\n  bits.push(s ? 1 : 0);\n  bits.reverse();\n  str = bits.join('');\n\n  // Return the data as a hex string. --MJL\n  let hexByteString = '';\n  for (i = 0; i < 64; i += 8) {\n    let hexByte = parseInt(str.substr(i, 8), 2).toString(16);\n    if (hexByte.length === 1) hexByte = '0' + hexByte;\n    hexByteString = hexByteString + hexByte;\n  }\n  return hexByteString.toLowerCase();\n};\n\n/**\n * Used to detect if we're in a Chrome content script (which executes in an\n * isolated environment where long-polling doesn't work).\n * @return {boolean}\n */\nexport const isChromeExtensionContentScript = function(): boolean {\n  return !!(\n    typeof window === 'object' &&\n    window['chrome'] &&\n    window['chrome']['extension'] &&\n    !/^chrome/.test(window.location.href)\n  );\n};\n\n/**\n * Used to detect if we're in a Windows 8 Store app.\n * @return {boolean}\n */\nexport const isWindowsStoreApp = function(): boolean {\n  // Check for the presence of a couple WinRT globals\n  return typeof Windows === 'object' && typeof Windows.UI === 'object';\n};\n\n/**\n * Converts a server error code to a Javascript Error\n * @param {!string} code\n * @param {!Query} query\n * @return {Error}\n */\nexport const errorForServerCode = function(code: string, query: Query): Error {\n  let reason = 'Unknown Error';\n  if (code === 'too_big') {\n    reason =\n      'The data requested exceeds the maximum size ' +\n      'that can be accessed with a single request.';\n  } else if (code == 'permission_denied') {\n    reason = \"Client doesn't have permission to access the desired data.\";\n  } else if (code == 'unavailable') {\n    reason = 'The service is unavailable';\n  }\n\n  const error = new Error(\n    code + ' at ' + query.path.toString() + ': ' + reason\n  );\n  (error as any).code = code.toUpperCase();\n  return error;\n};\n\n/**\n * Used to test for integer-looking strings\n * @type {RegExp}\n * @private\n */\nexport const INTEGER_REGEXP_ = new RegExp('^-?(0*)\\\\d{1,10}$');\n\n/**\n * If the string contains a 32-bit integer, return it.  Else return null.\n * @param {!string} str\n * @return {?number}\n */\nexport const tryParseInt = function(str: string): number | null {\n  if (INTEGER_REGEXP_.test(str)) {\n    const intVal = Number(str);\n    if (intVal >= -2147483648 && intVal <= 2147483647) {\n      return intVal;\n    }\n  }\n  return null;\n};\n\n/**\n * Helper to run some code but catch any exceptions and re-throw them later.\n * Useful for preventing user callbacks from breaking internal code.\n *\n * Re-throwing the exception from a setTimeout is a little evil, but it's very\n * convenient (we don't have to try to figure out when is a safe point to\n * re-throw it), and the behavior seems reasonable:\n *\n * * If you aren't pausing on exceptions, you get an error in the console with\n *   the correct stack trace.\n * * If you're pausing on all exceptions, the debugger will pause on your\n *   exception and then again when we rethrow it.\n * * If you're only pausing on uncaught exceptions, the debugger will only pause\n *   on us re-throwing it.\n *\n * @param {!function()} fn The code to guard.\n */\nexport const exceptionGuard = function(fn: () => void) {\n  try {\n    fn();\n  } catch (e) {\n    // Re-throw exception when it's safe.\n    setTimeout(function() {\n      // It used to be that \"throw e\" would result in a good console error with\n      // relevant context, but as of Chrome 39, you just get the firebase.js\n      // file/line number where we re-throw it, which is useless. So we log\n      // e.stack explicitly.\n      const stack = e.stack || '';\n      warn('Exception was thrown by user callback.', stack);\n      throw e;\n    }, Math.floor(0));\n  }\n};\n\n/**\n * Helper function to safely call opt_callback with the specified arguments.  It:\n * 1. Turns into a no-op if opt_callback is null or undefined.\n * 2. Wraps the call inside exceptionGuard to prevent exceptions from breaking our state.\n *\n * @param {?Function=} callback Optional onComplete callback.\n * @param {...*} var_args Arbitrary args to be passed to opt_onComplete\n */\nexport const callUserCallback = function(\n  callback?: Function | null,\n  ...var_args: any[]\n) {\n  if (typeof callback === 'function') {\n    exceptionGuard(function() {\n      callback(...var_args);\n    });\n  }\n};\n\n/**\n * @return {boolean} true if we think we're currently being crawled.\n */\nexport const beingCrawled = function(): boolean {\n  const userAgent =\n    (typeof window === 'object' &&\n      window['navigator'] &&\n      window['navigator']['userAgent']) ||\n    '';\n\n  // For now we whitelist the most popular crawlers.  We should refine this to be the set of crawlers we\n  // believe to support JavaScript/AJAX rendering.\n  // NOTE: Google Webmaster Tools doesn't really belong, but their \"This is how a visitor to your website\n  // would have seen the page\" is flaky if we don't treat it as a crawler.\n  return (\n    userAgent.search(\n      /googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i\n    ) >= 0\n  );\n};\n\n/**\n * Export a property of an object using a getter function.\n *\n * @param {!Object} object\n * @param {string} name\n * @param {!function(): *} fnGet\n */\nexport const exportPropGetter = function(\n  object: Object,\n  name: string,\n  fnGet: () => any\n) {\n  Object.defineProperty(object, name, { get: fnGet });\n};\n\n/**\n * Same as setTimeout() except on Node.JS it will /not/ prevent the process from exiting.\n *\n * It is removed with clearTimeout() as normal.\n *\n * @param {Function} fn Function to run.\n * @param {number} time Milliseconds to wait before running.\n * @return {number|Object} The setTimeout() return value.\n */\nexport const setTimeoutNonBlocking = function(\n  fn: Function,\n  time: number\n): number | Object {\n  const timeout: number | Object = setTimeout(fn, time);\n  if (typeof timeout === 'object' && (timeout as any)['unref']) {\n    (timeout as any)['unref']();\n  }\n  return timeout;\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nameCompare } from './util';\nimport { stringLength } from '@firebase/util';\n/**\n * An immutable object representing a parsed path.  It's immutable so that you\n * can pass them around to other functions without worrying about them changing\n * it.\n */\n\nexport class Path {\n  private pieces_: string[];\n  private pieceNum_: number;\n\n  /**\n   * Singleton to represent an empty path\n   *\n   * @const\n   */\n  static get Empty() {\n    return new Path('');\n  }\n\n  /**\n   * @param {string|Array.<string>} pathOrString Path string to parse,\n   *      or another path, or the raw tokens array\n   * @param {number=} pieceNum\n   */\n  constructor(pathOrString: string | string[], pieceNum?: number) {\n    if (pieceNum === void 0) {\n      this.pieces_ = (pathOrString as string).split('/');\n\n      // Remove empty pieces.\n      let copyTo = 0;\n      for (let i = 0; i < this.pieces_.length; i++) {\n        if (this.pieces_[i].length > 0) {\n          this.pieces_[copyTo] = this.pieces_[i];\n          copyTo++;\n        }\n      }\n      this.pieces_.length = copyTo;\n\n      this.pieceNum_ = 0;\n    } else {\n      this.pieces_ = pathOrString as string[];\n      this.pieceNum_ = pieceNum;\n    }\n  }\n\n  getFront(): string | null {\n    if (this.pieceNum_ >= this.pieces_.length) return null;\n\n    return this.pieces_[this.pieceNum_];\n  }\n\n  /**\n   * @return {number} The number of segments in this path\n   */\n  getLength(): number {\n    return this.pieces_.length - this.pieceNum_;\n  }\n\n  /**\n   * @return {!Path}\n   */\n  popFront(): Path {\n    let pieceNum = this.pieceNum_;\n    if (pieceNum < this.pieces_.length) {\n      pieceNum++;\n    }\n    return new Path(this.pieces_, pieceNum);\n  }\n\n  /**\n   * @return {?string}\n   */\n  getBack(): string | null {\n    if (this.pieceNum_ < this.pieces_.length)\n      return this.pieces_[this.pieces_.length - 1];\n\n    return null;\n  }\n\n  toString(): string {\n    let pathString = '';\n    for (let i = this.pieceNum_; i < this.pieces_.length; i++) {\n      if (this.pieces_[i] !== '') pathString += '/' + this.pieces_[i];\n    }\n\n    return pathString || '/';\n  }\n\n  toUrlEncodedString(): string {\n    let pathString = '';\n    for (let i = this.pieceNum_; i < this.pieces_.length; i++) {\n      if (this.pieces_[i] !== '')\n        pathString += '/' + encodeURIComponent(String(this.pieces_[i]));\n    }\n\n    return pathString || '/';\n  }\n\n  /**\n   * Shallow copy of the parts of the path.\n   *\n   * @param {number=} begin\n   * @return {!Array<string>}\n   */\n  slice(begin: number = 0): string[] {\n    return this.pieces_.slice(this.pieceNum_ + begin);\n  }\n\n  /**\n   * @return {?Path}\n   */\n  parent(): Path | null {\n    if (this.pieceNum_ >= this.pieces_.length) return null;\n\n    const pieces = [];\n    for (let i = this.pieceNum_; i < this.pieces_.length - 1; i++)\n      pieces.push(this.pieces_[i]);\n\n    return new Path(pieces, 0);\n  }\n\n  /**\n   * @param {string|!Path} childPathObj\n   * @return {!Path}\n   */\n  child(childPathObj: string | Path): Path {\n    const pieces = [];\n    for (let i = this.pieceNum_; i < this.pieces_.length; i++)\n      pieces.push(this.pieces_[i]);\n\n    if (childPathObj instanceof Path) {\n      for (\n        let i = childPathObj.pieceNum_;\n        i < childPathObj.pieces_.length;\n        i++\n      ) {\n        pieces.push(childPathObj.pieces_[i]);\n      }\n    } else {\n      const childPieces = childPathObj.split('/');\n      for (let i = 0; i < childPieces.length; i++) {\n        if (childPieces[i].length > 0) pieces.push(childPieces[i]);\n      }\n    }\n\n    return new Path(pieces, 0);\n  }\n\n  /**\n   * @return {boolean} True if there are no segments in this path\n   */\n  isEmpty(): boolean {\n    return this.pieceNum_ >= this.pieces_.length;\n  }\n\n  /**\n   * @param {!Path} outerPath\n   * @param {!Path} innerPath\n   * @return {!Path} The path from outerPath to innerPath\n   */\n  static relativePath(outerPath: Path, innerPath: Path): Path {\n    const outer = outerPath.getFront(),\n      inner = innerPath.getFront();\n    if (outer === null) {\n      return innerPath;\n    } else if (outer === inner) {\n      return Path.relativePath(outerPath.popFront(), innerPath.popFront());\n    } else {\n      throw new Error(\n        'INTERNAL ERROR: innerPath (' +\n          innerPath +\n          ') is not within ' +\n          'outerPath (' +\n          outerPath +\n          ')'\n      );\n    }\n  }\n\n  /**\n   * @param {!Path} left\n   * @param {!Path} right\n   * @return {number} -1, 0, 1 if left is less, equal, or greater than the right.\n   */\n  static comparePaths(left: Path, right: Path): number {\n    const leftKeys = left.slice();\n    const rightKeys = right.slice();\n    for (let i = 0; i < leftKeys.length && i < rightKeys.length; i++) {\n      const cmp = nameCompare(leftKeys[i], rightKeys[i]);\n      if (cmp !== 0) return cmp;\n    }\n    if (leftKeys.length === rightKeys.length) return 0;\n    return leftKeys.length < rightKeys.length ? -1 : 1;\n  }\n\n  /**\n   *\n   * @param {Path} other\n   * @return {boolean} true if paths are the same.\n   */\n  equals(other: Path): boolean {\n    if (this.getLength() !== other.getLength()) {\n      return false;\n    }\n\n    for (\n      let i = this.pieceNum_, j = other.pieceNum_;\n      i <= this.pieces_.length;\n      i++, j++\n    ) {\n      if (this.pieces_[i] !== other.pieces_[j]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   *\n   * @param {!Path} other\n   * @return {boolean} True if this path is a parent (or the same as) other\n   */\n  contains(other: Path): boolean {\n    let i = this.pieceNum_;\n    let j = other.pieceNum_;\n    if (this.getLength() > other.getLength()) {\n      return false;\n    }\n    while (i < this.pieces_.length) {\n      if (this.pieces_[i] !== other.pieces_[j]) {\n        return false;\n      }\n      ++i;\n      ++j;\n    }\n    return true;\n  }\n} // end Path\n\n/**\n * Dynamic (mutable) path used to count path lengths.\n *\n * This class is used to efficiently check paths for valid\n * length (in UTF8 bytes) and depth (used in path validation).\n *\n * Throws Error exception if path is ever invalid.\n *\n * The definition of a path always begins with '/'.\n */\nexport class ValidationPath {\n  /** @type {!Array<string>} */\n  private parts_: string[];\n  /** @type {number} Initialize to number of '/' chars needed in path. */\n  private byteLength_: number;\n\n  /**\n   * @param {!Path} path Initial Path.\n   * @param {string} errorPrefix_ Prefix for any error messages.\n   */\n  constructor(path: Path, private errorPrefix_: string) {\n    /** @type {!Array<string>} */\n    this.parts_ = path.slice();\n    /** @type {number} Initialize to number of '/' chars needed in path. */\n    this.byteLength_ = Math.max(1, this.parts_.length);\n\n    for (let i = 0; i < this.parts_.length; i++) {\n      this.byteLength_ += stringLength(this.parts_[i]);\n    }\n    this.checkValid_();\n  }\n\n  /** @const {number} Maximum key depth. */\n  static get MAX_PATH_DEPTH() {\n    return 32;\n  }\n\n  /** @const {number} Maximum number of (UTF8) bytes in a Firebase path. */\n  static get MAX_PATH_LENGTH_BYTES() {\n    return 768;\n  }\n\n  /** @param {string} child */\n  push(child: string) {\n    // Count the needed '/'\n    if (this.parts_.length > 0) {\n      this.byteLength_ += 1;\n    }\n    this.parts_.push(child);\n    this.byteLength_ += stringLength(child);\n    this.checkValid_();\n  }\n\n  pop() {\n    const last = this.parts_.pop();\n    this.byteLength_ -= stringLength(last);\n    // Un-count the previous '/'\n    if (this.parts_.length > 0) {\n      this.byteLength_ -= 1;\n    }\n  }\n\n  private checkValid_() {\n    if (this.byteLength_ > ValidationPath.MAX_PATH_LENGTH_BYTES) {\n      throw new Error(\n        this.errorPrefix_ +\n          'has a key path longer than ' +\n          ValidationPath.MAX_PATH_LENGTH_BYTES +\n          ' bytes (' +\n          this.byteLength_ +\n          ').'\n      );\n    }\n    if (this.parts_.length > ValidationPath.MAX_PATH_DEPTH) {\n      throw new Error(\n        this.errorPrefix_ +\n          'path specified exceeds the maximum depth that can be written (' +\n          ValidationPath.MAX_PATH_DEPTH +\n          ') or object contains a cycle ' +\n          this.toErrorString()\n      );\n    }\n  }\n\n  /**\n   * String for use in error messages - uses '.' notation for path.\n   *\n   * @return {string}\n   */\n  toErrorString(): string {\n    if (this.parts_.length == 0) {\n      return '';\n    }\n    return \"in property '\" + this.parts_.join('.') + \"'\";\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { PersistentStorage } from './storage/storage';\nimport { LONG_POLLING, WEBSOCKET } from '../realtime/Constants';\nimport { each } from './util/util';\n\n/**\n * A class that holds metadata about a Repo object\n *\n * @constructor\n */\nexport class RepoInfo {\n  host: string;\n  domain: string;\n  internalHost: string;\n\n  /**\n   * @param {string} host Hostname portion of the url for the repo\n   * @param {boolean} secure Whether or not this repo is accessed over ssl\n   * @param {string} namespace The namespace represented by the repo\n   * @param {boolean} webSocketOnly Whether to prefer websockets over all other transports (used by Nest).\n   * @param {string=} persistenceKey Override the default session persistence storage key\n   */\n  constructor(\n    host: string,\n    public secure: boolean,\n    public namespace: string,\n    public webSocketOnly: boolean,\n    public persistenceKey: string = '',\n    public includeNamespaceInQueryParams: boolean = false\n  ) {\n    this.host = host.toLowerCase();\n    this.domain = this.host.substr(this.host.indexOf('.') + 1);\n    this.internalHost = PersistentStorage.get('host:' + host) || this.host;\n  }\n\n  needsQueryParam(): boolean {\n    return (\n      this.host !== this.internalHost ||\n      this.isCustomHost() ||\n      this.includeNamespaceInQueryParams\n    );\n  }\n\n  isCacheableHost(): boolean {\n    return this.internalHost.substr(0, 2) === 's-';\n  }\n\n  isDemoHost() {\n    return this.domain === 'firebaseio-demo.com';\n  }\n\n  isCustomHost() {\n    return (\n      this.domain !== 'firebaseio.com' && this.domain !== 'firebaseio-demo.com'\n    );\n  }\n\n  updateHost(newHost: string) {\n    if (newHost !== this.internalHost) {\n      this.internalHost = newHost;\n      if (this.isCacheableHost()) {\n        PersistentStorage.set('host:' + this.host, this.internalHost);\n      }\n    }\n  }\n\n  /**\n   * Returns the websocket URL for this repo\n   * @param {string} type of connection\n   * @param {Object} params list\n   * @return {string} The URL for this repo\n   */\n  connectionURL(type: string, params: { [k: string]: string }): string {\n    assert(typeof type === 'string', 'typeof type must == string');\n    assert(typeof params === 'object', 'typeof params must == object');\n\n    let connURL: string;\n    if (type === WEBSOCKET) {\n      connURL =\n        (this.secure ? 'wss://' : 'ws://') + this.internalHost + '/.ws?';\n    } else if (type === LONG_POLLING) {\n      connURL =\n        (this.secure ? 'https://' : 'http://') + this.internalHost + '/.lp?';\n    } else {\n      throw new Error('Unknown connection type: ' + type);\n    }\n    if (this.needsQueryParam()) {\n      params['ns'] = this.namespace;\n    }\n\n    const pairs: string[] = [];\n\n    each(params, (key: string, value: string) => {\n      pairs.push(key + '=' + value);\n    });\n\n    return connURL + pairs.join('&');\n  }\n\n  /** @return {string} */\n  toString(): string {\n    let str = this.toURLString();\n    if (this.persistenceKey) {\n      str += '<' + this.persistenceKey + '>';\n    }\n    return str;\n  }\n\n  /** @return {string} */\n  toURLString(): string {\n    return (this.secure ? 'https://' : 'http://') + this.host;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport const PROTOCOL_VERSION = '5';\n\nexport const VERSION_PARAM = 'v';\n\nexport const TRANSPORT_SESSION_PARAM = 's';\n\nexport const REFERER_PARAM = 'r';\n\nexport const FORGE_REF = 'f';\n\nexport const FORGE_DOMAIN = 'firebaseio.com';\n\nexport const LAST_SESSION_PARAM = 'ls';\n\nexport const WEBSOCKET = 'websocket';\n\nexport const LONG_POLLING = 'long_polling';\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Path } from '../Path';\nimport { RepoInfo } from '../../RepoInfo';\nimport { warnIfPageIsSecure, warn, fatal } from '../util';\n\n/**\n * @param {!string} pathString\n * @return {string}\n */\nfunction decodePath(pathString: string): string {\n  let pathStringDecoded = '';\n  const pieces = pathString.split('/');\n  for (let i = 0; i < pieces.length; i++) {\n    if (pieces[i].length > 0) {\n      let piece = pieces[i];\n      try {\n        piece = decodeURIComponent(piece.replace(/\\+/g, ' '));\n      } catch (e) {}\n      pathStringDecoded += '/' + piece;\n    }\n  }\n  return pathStringDecoded;\n}\n\n/**\n * @param {!string} queryString\n * @return {!{[key:string]:string}} key value hash\n */\nfunction decodeQuery(queryString: string): { [key: string]: string } {\n  let results = {};\n  if (queryString.charAt(0) === '?') {\n    queryString = queryString.substring(1);\n  }\n  for (const segment of queryString.split('&')) {\n    if (segment.length === 0) {\n      continue;\n    }\n    const kv = segment.split('=');\n    if (kv.length === 2) {\n      results[decodeURIComponent(kv[0])] = decodeURIComponent(kv[1]);\n    } else {\n      warn(`Invalid query segment '${segment}' in query '${queryString}'`);\n    }\n  }\n  return results;\n}\n\n/**\n *\n * @param {!string} dataURL\n * @return {{repoInfo: !RepoInfo, path: !Path}}\n */\nexport const parseRepoInfo = function(\n  dataURL: string\n): { repoInfo: RepoInfo; path: Path } {\n  const parsedUrl = parseDatabaseURL(dataURL),\n    namespace = parsedUrl.namespace;\n\n  if (parsedUrl.domain === 'firebase') {\n    fatal(\n      parsedUrl.host +\n        ' is no longer supported. ' +\n        'Please use <YOUR FIREBASE>.firebaseio.com instead'\n    );\n  }\n\n  // Catch common error of uninitialized namespace value.\n  if (\n    (!namespace || namespace == 'undefined') &&\n    parsedUrl.domain !== 'localhost'\n  ) {\n    fatal(\n      'Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com'\n    );\n  }\n\n  if (!parsedUrl.secure) {\n    warnIfPageIsSecure();\n  }\n\n  const webSocketOnly = parsedUrl.scheme === 'ws' || parsedUrl.scheme === 'wss';\n\n  return {\n    repoInfo: new RepoInfo(\n      parsedUrl.host,\n      parsedUrl.secure,\n      namespace,\n      webSocketOnly,\n      /*persistenceKey=*/ '',\n      /*includeNamespaceInQueryParams=*/ namespace != parsedUrl.subdomain\n    ),\n    path: new Path(parsedUrl.pathString)\n  };\n};\n\n/**\n *\n * @param {!string} dataURL\n * @return {{host: string, port: number, domain: string, subdomain: string, secure: boolean, scheme: string, pathString: string, namespace: string}}\n */\nexport const parseDatabaseURL = function(\n  dataURL: string\n): {\n  host: string;\n  port: number;\n  domain: string;\n  subdomain: string;\n  secure: boolean;\n  scheme: string;\n  pathString: string;\n  namespace: string;\n} {\n  // Default to empty strings in the event of a malformed string.\n  let host = '',\n    domain = '',\n    subdomain = '',\n    pathString = '',\n    namespace = '';\n\n  // Always default to SSL, unless otherwise specified.\n  let secure = true,\n    scheme = 'https',\n    port = 443;\n\n  // Don't do any validation here. The caller is responsible for validating the result of parsing.\n  if (typeof dataURL === 'string') {\n    // Parse scheme.\n    let colonInd = dataURL.indexOf('//');\n    if (colonInd >= 0) {\n      scheme = dataURL.substring(0, colonInd - 1);\n      dataURL = dataURL.substring(colonInd + 2);\n    }\n\n    // Parse host, path, and query string.\n    let slashInd = dataURL.indexOf('/');\n    if (slashInd === -1) {\n      slashInd = dataURL.length;\n    }\n    let questionMarkInd = dataURL.indexOf('?');\n    if (questionMarkInd === -1) {\n      questionMarkInd = dataURL.length;\n    }\n    host = dataURL.substring(0, Math.min(slashInd, questionMarkInd));\n    if (slashInd < questionMarkInd) {\n      // For pathString, questionMarkInd will always come after slashInd\n      pathString = decodePath(dataURL.substring(slashInd, questionMarkInd));\n    }\n    let queryParams = decodeQuery(\n      dataURL.substring(Math.min(dataURL.length, questionMarkInd))\n    );\n\n    // If we have a port, use scheme for determining if it's secure.\n    colonInd = host.indexOf(':');\n    if (colonInd >= 0) {\n      secure = scheme === 'https' || scheme === 'wss';\n      port = parseInt(host.substring(colonInd + 1), 10);\n    } else {\n      colonInd = dataURL.length;\n    }\n\n    const parts = host.split('.');\n    if (parts.length === 3) {\n      // Normalize namespaces to lowercase to share storage / connection.\n      domain = parts[1];\n      subdomain = parts[0].toLowerCase();\n      // We interpret the subdomain of a 3 component URL as the namespace name.\n      namespace = subdomain;\n    } else if (parts.length === 2) {\n      domain = parts[0];\n    } else if (parts[0].slice(0, colonInd).toLowerCase() === 'localhost') {\n      domain = 'localhost';\n    }\n    // Always treat the value of the `ns` as the namespace name if it is present.\n    if ('ns' in queryParams) {\n      namespace = queryParams['ns'];\n    }\n  }\n\n  return {\n    host,\n    port,\n    domain,\n    subdomain,\n    secure,\n    scheme,\n    pathString,\n    namespace\n  };\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Index } from './Index';\nimport { Node, NamedNode } from '../Node';\nimport { nameCompare, MAX_NAME } from '../../util/util';\nimport { assert, assertionError } from '@firebase/util';\nimport { ChildrenNode } from '../ChildrenNode';\n\nlet __EMPTY_NODE: ChildrenNode;\n\nexport class KeyIndex extends Index {\n  static get __EMPTY_NODE() {\n    return __EMPTY_NODE;\n  }\n\n  static set __EMPTY_NODE(val) {\n    __EMPTY_NODE = val;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  compare(a: NamedNode, b: NamedNode): number {\n    return nameCompare(a.name, b.name);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isDefinedOn(node: Node): boolean {\n    // We could probably return true here (since every node has a key), but it's never called\n    // so just leaving unimplemented for now.\n    throw assertionError('KeyIndex.isDefinedOn not expected to be called.');\n  }\n\n  /**\n   * @inheritDoc\n   */\n  indexedValueChanged(oldNode: Node, newNode: Node): boolean {\n    return false; // The key for a node never changes.\n  }\n\n  /**\n   * @inheritDoc\n   */\n  minPost() {\n    return (NamedNode as any).MIN;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  maxPost(): NamedNode {\n    // TODO: This should really be created once and cached in a static property, but\n    // NamedNode isn't defined yet, so I can't use it in a static.  Bleh.\n    return new NamedNode(MAX_NAME, __EMPTY_NODE);\n  }\n\n  /**\n   * @param {*} indexValue\n   * @param {string} name\n   * @return {!NamedNode}\n   */\n  makePost(indexValue: string, name: string): NamedNode {\n    assert(\n      typeof indexValue === 'string',\n      'KeyIndex indexValue must always be a string.'\n    );\n    // We just use empty node, but it'll never be compared, since our comparator only looks at name.\n    return new NamedNode(indexValue, __EMPTY_NODE);\n  }\n\n  /**\n   * @return {!string} String representation for inclusion in a query spec\n   */\n  toString(): string {\n    return '.key';\n  }\n}\n\nexport const KEY_INDEX = new KeyIndex();\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { doubleToIEEE754String } from '../util/util';\nimport { contains } from '@firebase/util';\nimport { Node } from './Node';\n\nlet MAX_NODE: Node;\n\nexport function setMaxNode(val: Node) {\n  MAX_NODE = val;\n}\n\n/**\n * @param {(!string|!number)} priority\n * @return {!string}\n */\nexport const priorityHashText = function(priority: string | number): string {\n  if (typeof priority === 'number')\n    return 'number:' + doubleToIEEE754String(priority);\n  else return 'string:' + priority;\n};\n\n/**\n * Validates that a priority snapshot Node is valid.\n *\n * @param {!Node} priorityNode\n */\nexport const validatePriorityNode = function(priorityNode: Node) {\n  if (priorityNode.isLeafNode()) {\n    const val = priorityNode.val();\n    assert(\n      typeof val === 'string' ||\n        typeof val === 'number' ||\n        (typeof val === 'object' &&\n          contains(val as { [key: string]: unknown }, '.sv')),\n      'Priority must be a string or number.'\n    );\n  } else {\n    assert(\n      priorityNode === MAX_NODE || priorityNode.isEmpty(),\n      'priority of unexpected type.'\n    );\n  }\n  // Don't call getPriority() on MAX_NODE to avoid hitting assertion.\n  assert(\n    priorityNode === MAX_NODE || priorityNode.getPriority().isEmpty(),\n    \"Priority nodes can't have a priority of their own.\"\n  );\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Path, ValidationPath } from './Path';\nimport { contains, safeGet } from '@firebase/util';\nimport { isInvalidJSONNumber, each } from './util';\nimport { errorPrefix as errorPrefixFxn } from '@firebase/util';\nimport { stringLength } from '@firebase/util';\nimport { RepoInfo } from '../RepoInfo';\n\n/**\n * True for invalid Firebase keys\n * @type {RegExp}\n * @private\n */\nexport const INVALID_KEY_REGEX_ = /[\\[\\].#$\\/\\u0000-\\u001F\\u007F]/;\n\n/**\n * True for invalid Firebase paths.\n * Allows '/' in paths.\n * @type {RegExp}\n * @private\n */\nexport const INVALID_PATH_REGEX_ = /[\\[\\].#$\\u0000-\\u001F\\u007F]/;\n\n/**\n * Maximum number of characters to allow in leaf value\n * @type {number}\n * @private\n */\nexport const MAX_LEAF_SIZE_ = 10 * 1024 * 1024;\n\n/**\n * @param {*} key\n * @return {boolean}\n */\nexport const isValidKey = function(key: any): boolean {\n  return (\n    typeof key === 'string' && key.length !== 0 && !INVALID_KEY_REGEX_.test(key)\n  );\n};\n\n/**\n * @param {string} pathString\n * @return {boolean}\n */\nexport const isValidPathString = function(pathString: string): boolean {\n  return (\n    typeof pathString === 'string' &&\n    pathString.length !== 0 &&\n    !INVALID_PATH_REGEX_.test(pathString)\n  );\n};\n\n/**\n * @param {string} pathString\n * @return {boolean}\n */\nexport const isValidRootPathString = function(pathString: string): boolean {\n  if (pathString) {\n    // Allow '/.info/' at the beginning.\n    pathString = pathString.replace(/^\\/*\\.info(\\/|$)/, '/');\n  }\n\n  return isValidPathString(pathString);\n};\n\n/**\n * @param {*} priority\n * @return {boolean}\n */\nexport const isValidPriority = function(priority: any): boolean {\n  return (\n    priority === null ||\n    typeof priority === 'string' ||\n    (typeof priority === 'number' && !isInvalidJSONNumber(priority)) ||\n    (priority && typeof priority === 'object' && contains(priority, '.sv'))\n  );\n};\n\n/**\n * Pre-validate a datum passed as an argument to Firebase function.\n *\n * @param {string} fnName\n * @param {number} argumentNumber\n * @param {*} data\n * @param {!Path} path\n * @param {boolean} optional\n */\nexport const validateFirebaseDataArg = function(\n  fnName: string,\n  argumentNumber: number,\n  data: any,\n  path: Path,\n  optional: boolean\n) {\n  if (optional && data === undefined) return;\n\n  validateFirebaseData(\n    errorPrefixFxn(fnName, argumentNumber, optional),\n    data,\n    path\n  );\n};\n\n/**\n * Validate a data object client-side before sending to server.\n *\n * @param {string} errorPrefix\n * @param {*} data\n * @param {!Path|!ValidationPath} path_\n */\nexport const validateFirebaseData = function(\n  errorPrefix: string,\n  data: any,\n  path_: Path | ValidationPath\n) {\n  const path =\n    path_ instanceof Path ? new ValidationPath(path_, errorPrefix) : path_;\n\n  if (data === undefined) {\n    throw new Error(errorPrefix + 'contains undefined ' + path.toErrorString());\n  }\n  if (typeof data === 'function') {\n    throw new Error(\n      errorPrefix +\n        'contains a function ' +\n        path.toErrorString() +\n        ' with contents = ' +\n        data.toString()\n    );\n  }\n  if (isInvalidJSONNumber(data)) {\n    throw new Error(\n      errorPrefix + 'contains ' + data.toString() + ' ' + path.toErrorString()\n    );\n  }\n\n  // Check max leaf size, but try to avoid the utf8 conversion if we can.\n  if (\n    typeof data === 'string' &&\n    data.length > MAX_LEAF_SIZE_ / 3 &&\n    stringLength(data) > MAX_LEAF_SIZE_\n  ) {\n    throw new Error(\n      errorPrefix +\n        'contains a string greater than ' +\n        MAX_LEAF_SIZE_ +\n        ' utf8 bytes ' +\n        path.toErrorString() +\n        \" ('\" +\n        data.substring(0, 50) +\n        \"...')\"\n    );\n  }\n\n  // TODO = Perf = Consider combining the recursive validation of keys into NodeFromJSON\n  // to save extra walking of large objects.\n  if (data && typeof data === 'object') {\n    let hasDotValue = false;\n    let hasActualChild = false;\n    each(data, function(key: string, value: any) {\n      if (key === '.value') {\n        hasDotValue = true;\n      } else if (key !== '.priority' && key !== '.sv') {\n        hasActualChild = true;\n        if (!isValidKey(key)) {\n          throw new Error(\n            errorPrefix +\n              ' contains an invalid key (' +\n              key +\n              ') ' +\n              path.toErrorString() +\n              '.  Keys must be non-empty strings ' +\n              'and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"'\n          );\n        }\n      }\n\n      path.push(key);\n      validateFirebaseData(errorPrefix, value, path);\n      path.pop();\n    });\n\n    if (hasDotValue && hasActualChild) {\n      throw new Error(\n        errorPrefix +\n          ' contains \".value\" child ' +\n          path.toErrorString() +\n          ' in addition to actual children.'\n      );\n    }\n  }\n};\n\n/**\n * Pre-validate paths passed in the firebase function.\n *\n * @param {string} errorPrefix\n * @param {Array<!Path>} mergePaths\n */\nexport const validateFirebaseMergePaths = function(\n  errorPrefix: string,\n  mergePaths: Path[]\n) {\n  let i, curPath;\n  for (i = 0; i < mergePaths.length; i++) {\n    curPath = mergePaths[i];\n    const keys = curPath.slice();\n    for (let j = 0; j < keys.length; j++) {\n      if (keys[j] === '.priority' && j === keys.length - 1) {\n        // .priority is OK\n      } else if (!isValidKey(keys[j])) {\n        throw new Error(\n          errorPrefix +\n            'contains an invalid key (' +\n            keys[j] +\n            ') in path ' +\n            curPath.toString() +\n            '. Keys must be non-empty strings ' +\n            'and can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"'\n        );\n      }\n    }\n  }\n\n  // Check that update keys are not descendants of each other.\n  // We rely on the property that sorting guarantees that ancestors come\n  // right before descendants.\n  mergePaths.sort(Path.comparePaths);\n  let prevPath: Path | null = null;\n  for (i = 0; i < mergePaths.length; i++) {\n    curPath = mergePaths[i];\n    if (prevPath !== null && prevPath.contains(curPath)) {\n      throw new Error(\n        errorPrefix +\n          'contains a path ' +\n          prevPath.toString() +\n          ' that is ancestor of another path ' +\n          curPath.toString()\n      );\n    }\n    prevPath = curPath;\n  }\n};\n\n/**\n * pre-validate an object passed as an argument to firebase function (\n * must be an object - e.g. for firebase.update()).\n *\n * @param {string} fnName\n * @param {number} argumentNumber\n * @param {*} data\n * @param {!Path} path\n * @param {boolean} optional\n */\nexport const validateFirebaseMergeDataArg = function(\n  fnName: string,\n  argumentNumber: number,\n  data: any,\n  path: Path,\n  optional: boolean\n) {\n  if (optional && data === undefined) return;\n\n  const errorPrefix = errorPrefixFxn(fnName, argumentNumber, optional);\n\n  if (!(data && typeof data === 'object') || Array.isArray(data)) {\n    throw new Error(\n      errorPrefix + ' must be an object containing the children to replace.'\n    );\n  }\n\n  const mergePaths: Path[] = [];\n  each(data, function(key: string, value: any) {\n    const curPath = new Path(key);\n    validateFirebaseData(errorPrefix, value, path.child(curPath));\n    if (curPath.getBack() === '.priority') {\n      if (!isValidPriority(value)) {\n        throw new Error(\n          errorPrefix +\n            \"contains an invalid value for '\" +\n            curPath.toString() +\n            \"', which must be a valid \" +\n            'Firebase priority (a string, finite number, server value, or null).'\n        );\n      }\n    }\n    mergePaths.push(curPath);\n  });\n  validateFirebaseMergePaths(errorPrefix, mergePaths);\n};\n\nexport const validatePriority = function(\n  fnName: string,\n  argumentNumber: number,\n  priority: any,\n  optional: boolean\n) {\n  if (optional && priority === undefined) return;\n  if (isInvalidJSONNumber(priority))\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'is ' +\n        priority.toString() +\n        ', but must be a valid Firebase priority (a string, finite number, ' +\n        'server value, or null).'\n    );\n  // Special case to allow importing data with a .sv.\n  if (!isValidPriority(priority))\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'must be a valid Firebase priority ' +\n        '(a string, finite number, server value, or null).'\n    );\n};\n\nexport const validateEventType = function(\n  fnName: string,\n  argumentNumber: number,\n  eventType: string,\n  optional: boolean\n) {\n  if (optional && eventType === undefined) return;\n\n  switch (eventType) {\n    case 'value':\n    case 'child_added':\n    case 'child_removed':\n    case 'child_changed':\n    case 'child_moved':\n      break;\n    default:\n      throw new Error(\n        errorPrefixFxn(fnName, argumentNumber, optional) +\n          'must be a valid event type = \"value\", \"child_added\", \"child_removed\", ' +\n          '\"child_changed\", or \"child_moved\".'\n      );\n  }\n};\n\nexport const validateKey = function(\n  fnName: string,\n  argumentNumber: number,\n  key: string,\n  optional: boolean\n) {\n  if (optional && key === undefined) return;\n  if (!isValidKey(key))\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'was an invalid key = \"' +\n        key +\n        '\".  Firebase keys must be non-empty strings and ' +\n        'can\\'t contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\").'\n    );\n};\n\nexport const validatePathString = function(\n  fnName: string,\n  argumentNumber: number,\n  pathString: string,\n  optional: boolean\n) {\n  if (optional && pathString === undefined) return;\n\n  if (!isValidPathString(pathString))\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'was an invalid path = \"' +\n        pathString +\n        '\". Paths must be non-empty strings and ' +\n        'can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\"'\n    );\n};\n\nexport const validateRootPathString = function(\n  fnName: string,\n  argumentNumber: number,\n  pathString: string,\n  optional: boolean\n) {\n  if (pathString) {\n    // Allow '/.info/' at the beginning.\n    pathString = pathString.replace(/^\\/*\\.info(\\/|$)/, '/');\n  }\n\n  validatePathString(fnName, argumentNumber, pathString, optional);\n};\n\nexport const validateWritablePath = function(fnName: string, path: Path) {\n  if (path.getFront() === '.info') {\n    throw new Error(fnName + \" failed = Can't modify data under /.info/\");\n  }\n};\n\nexport const validateUrl = function(\n  fnName: string,\n  argumentNumber: number,\n  parsedUrl: { repoInfo: RepoInfo; path: Path }\n) {\n  // TODO = Validate server better.\n  const pathString = parsedUrl.path.toString();\n  if (\n    !(typeof parsedUrl.repoInfo.host === 'string') ||\n    parsedUrl.repoInfo.host.length === 0 ||\n    (!isValidKey(parsedUrl.repoInfo.namespace) &&\n      parsedUrl.repoInfo.host.split(':')[0] !== 'localhost') ||\n    (pathString.length !== 0 && !isValidRootPathString(pathString))\n  ) {\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, false) +\n        'must be a valid firebase URL and ' +\n        'the path can\\'t contain \".\", \"#\", \"$\", \"[\", or \"]\".'\n    );\n  }\n};\n\nexport const validateCredential = function(\n  fnName: string,\n  argumentNumber: number,\n  cred: any,\n  optional: boolean\n) {\n  if (optional && cred === undefined) return;\n  if (!(typeof cred === 'string'))\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'must be a valid credential (a string).'\n    );\n};\n\nexport const validateBoolean = function(\n  fnName: string,\n  argumentNumber: number,\n  bool: any,\n  optional: boolean\n) {\n  if (optional && bool === undefined) return;\n  if (typeof bool !== 'boolean')\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) + 'must be a boolean.'\n    );\n};\n\nexport const validateString = function(\n  fnName: string,\n  argumentNumber: number,\n  string: any,\n  optional: boolean\n) {\n  if (optional && string === undefined) return;\n  if (!(typeof string === 'string')) {\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'must be a valid string.'\n    );\n  }\n};\n\nexport const validateObject = function(\n  fnName: string,\n  argumentNumber: number,\n  obj: any,\n  optional: boolean\n) {\n  if (optional && obj === undefined) return;\n  if (!(obj && typeof obj === 'object') || obj === null) {\n    throw new Error(\n      errorPrefixFxn(fnName, argumentNumber, optional) +\n        'must be a valid object.'\n    );\n  }\n};\n\nexport const validateObjectContainsKey = function(\n  fnName: string,\n  argumentNumber: number,\n  obj: any,\n  key: string,\n  optional: boolean,\n  opt_type?: string\n) {\n  const objectContainsKey =\n    obj && typeof obj === 'object' && contains(obj, key);\n\n  if (!objectContainsKey) {\n    if (optional) {\n      return;\n    } else {\n      throw new Error(\n        errorPrefixFxn(fnName, argumentNumber, optional) +\n          'must contain the key \"' +\n          key +\n          '\"'\n      );\n    }\n  }\n\n  if (opt_type) {\n    const val = safeGet(obj, key);\n    if (\n      (opt_type === 'number' && !(typeof val === 'number')) ||\n      (opt_type === 'string' && !(typeof val === 'string')) ||\n      (opt_type === 'boolean' && !(typeof val === 'boolean')) ||\n      (opt_type === 'function' && !(typeof val === 'function')) ||\n      (opt_type === 'object' && !(typeof val === 'object') && val)\n    ) {\n      if (optional) {\n        throw new Error(\n          errorPrefixFxn(fnName, argumentNumber, optional) +\n            'contains invalid value for key \"' +\n            key +\n            '\" (must be of type \"' +\n            opt_type +\n            '\")'\n        );\n      } else {\n        throw new Error(\n          errorPrefixFxn(fnName, argumentNumber, optional) +\n            'must contain the key \"' +\n            key +\n            '\" with type \"' +\n            opt_type +\n            '\"'\n        );\n      }\n    }\n  }\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { validateArgCount, validateCallback } from '@firebase/util';\nimport {\n  validateWritablePath,\n  validateFirebaseDataArg,\n  validatePriority,\n  validateFirebaseMergeDataArg\n} from '../core/util/validation';\nimport { warn } from '../core/util/util';\nimport { Deferred } from '@firebase/util';\nimport { Repo } from '../core/Repo';\nimport { Path } from '../core/util/Path';\n\n/**\n * @constructor\n */\nexport class OnDisconnect {\n  /**\n   * @param {!Repo} repo_\n   * @param {!Path} path_\n   */\n  constructor(private repo_: Repo, private path_: Path) {}\n\n  /**\n   * @param {function(?Error)=} onComplete\n   * @return {!firebase.Promise}\n   */\n  cancel(onComplete?: (a: Error | null) => void): Promise<void> {\n    validateArgCount('OnDisconnect.cancel', 0, 1, arguments.length);\n    validateCallback('OnDisconnect.cancel', 1, onComplete, true);\n    const deferred = new Deferred<void>();\n    this.repo_.onDisconnectCancel(\n      this.path_,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {function(?Error)=} onComplete\n   * @return {!firebase.Promise}\n   */\n  remove(onComplete?: (a: Error | null) => void): Promise<void> {\n    validateArgCount('OnDisconnect.remove', 0, 1, arguments.length);\n    validateWritablePath('OnDisconnect.remove', this.path_);\n    validateCallback('OnDisconnect.remove', 1, onComplete, true);\n    const deferred = new Deferred<void>();\n    this.repo_.onDisconnectSet(\n      this.path_,\n      null,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {*} value\n   * @param {function(?Error)=} onComplete\n   * @return {!firebase.Promise}\n   */\n  set(value: any, onComplete?: (a: Error | null) => void): Promise<void> {\n    validateArgCount('OnDisconnect.set', 1, 2, arguments.length);\n    validateWritablePath('OnDisconnect.set', this.path_);\n    validateFirebaseDataArg('OnDisconnect.set', 1, value, this.path_, false);\n    validateCallback('OnDisconnect.set', 2, onComplete, true);\n    const deferred = new Deferred<void>();\n    this.repo_.onDisconnectSet(\n      this.path_,\n      value,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {*} value\n   * @param {number|string|null} priority\n   * @param {function(?Error)=} onComplete\n   * @return {!firebase.Promise}\n   */\n  setWithPriority(\n    value: any,\n    priority: number | string | null,\n    onComplete?: (a: Error | null) => void\n  ): Promise<void> {\n    validateArgCount('OnDisconnect.setWithPriority', 2, 3, arguments.length);\n    validateWritablePath('OnDisconnect.setWithPriority', this.path_);\n    validateFirebaseDataArg(\n      'OnDisconnect.setWithPriority',\n      1,\n      value,\n      this.path_,\n      false\n    );\n    validatePriority('OnDisconnect.setWithPriority', 2, priority, false);\n    validateCallback('OnDisconnect.setWithPriority', 3, onComplete, true);\n\n    const deferred = new Deferred<void>();\n    this.repo_.onDisconnectSetWithPriority(\n      this.path_,\n      value,\n      priority,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {!Object} objectToMerge\n   * @param {function(?Error)=} onComplete\n   * @return {!firebase.Promise}\n   */\n  update(\n    objectToMerge: object,\n    onComplete?: (a: Error | null) => void\n  ): Promise<void> {\n    validateArgCount('OnDisconnect.update', 1, 2, arguments.length);\n    validateWritablePath('OnDisconnect.update', this.path_);\n    if (Array.isArray(objectToMerge)) {\n      const newObjectToMerge: { [k: string]: any } = {};\n      for (let i = 0; i < objectToMerge.length; ++i) {\n        newObjectToMerge['' + i] = objectToMerge[i];\n      }\n      objectToMerge = newObjectToMerge;\n      warn(\n        'Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the ' +\n          'existing data, or an Object with integer keys if you really do want to only update some of the children.'\n      );\n    }\n    validateFirebaseMergeDataArg(\n      'OnDisconnect.update',\n      1,\n      objectToMerge,\n      this.path_,\n      false\n    );\n    validateCallback('OnDisconnect.update', 2, onComplete, true);\n    const deferred = new Deferred<void>();\n    this.repo_.onDisconnectUpdate(\n      this.path_,\n      objectToMerge,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DataSnapshot } from './DataSnapshot';\nimport { validateArgCount } from '@firebase/util';\n\nexport class TransactionResult {\n  /**\n   * A type for the resolve value of Firebase.transaction.\n   * @constructor\n   * @dict\n   * @param {boolean} committed\n   * @param {DataSnapshot} snapshot\n   */\n  constructor(public committed: boolean, public snapshot: DataSnapshot) {}\n\n  // Do not create public documentation. This is intended to make JSON serialization work but is otherwise unnecessary\n  // for end-users\n  toJSON(): object {\n    validateArgCount('TransactionResult.toJSON', 0, 1, arguments.length);\n    return { committed: this.committed, snapshot: this.snapshot.toJSON() };\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\n\n/**\n * Fancy ID generator that creates 20-character string identifiers with the\n * following properties:\n *\n * 1. They're based on timestamp so that they sort *after* any existing ids.\n * 2. They contain 72-bits of random data after the timestamp so that IDs won't\n *    collide with other clients' IDs.\n * 3. They sort *lexicographically* (so the timestamp is converted to characters\n *    that will sort properly).\n * 4. They're monotonically increasing. Even if you generate more than one in\n *    the same timestamp, the latter ones will sort after the former ones. We do\n *    this by using the previous random bits but \"incrementing\" them by 1 (only\n *    in the case of a timestamp collision).\n */\nexport const nextPushId = (function() {\n  // Modeled after base64 web-safe chars, but ordered by ASCII.\n  const PUSH_CHARS =\n    '-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz';\n\n  // Timestamp of last push, used to prevent local collisions if you push twice\n  // in one ms.\n  let lastPushTime = 0;\n\n  // We generate 72-bits of randomness which get turned into 12 characters and\n  // appended to the timestamp to prevent collisions with other clients. We\n  // store the last characters we generated because in the event of a collision,\n  // we'll use those same characters except \"incremented\" by one.\n  const lastRandChars: number[] = [];\n\n  return function(now: number) {\n    const duplicateTime = now === lastPushTime;\n    lastPushTime = now;\n\n    let i;\n    const timeStampChars = new Array(8);\n    for (i = 7; i >= 0; i--) {\n      timeStampChars[i] = PUSH_CHARS.charAt(now % 64);\n      // NOTE: Can't use << here because javascript will convert to int and lose\n      // the upper bits.\n      now = Math.floor(now / 64);\n    }\n    assert(now === 0, 'Cannot push at time == 0');\n\n    let id = timeStampChars.join('');\n\n    if (!duplicateTime) {\n      for (i = 0; i < 12; i++) {\n        lastRandChars[i] = Math.floor(Math.random() * 64);\n      }\n    } else {\n      // If the timestamp hasn't changed since last push, use the same random\n      // number, except incremented by 1.\n      for (i = 11; i >= 0 && lastRandChars[i] === 63; i--) {\n        lastRandChars[i] = 0;\n      }\n      lastRandChars[i]++;\n    }\n    for (i = 0; i < 12; i++) {\n      id += PUSH_CHARS.charAt(lastRandChars[i]);\n    }\n    assert(id.length === 20, 'nextPushId: Length should be 20.');\n\n    return id;\n  };\n})();\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Path } from '../util/Path';\nimport { Index } from './indexes/Index';\n\n/**\n * Node is an interface defining the common functionality for nodes in\n * a DataSnapshot.\n *\n * @interface\n */\nexport interface Node {\n  /**\n   * Whether this node is a leaf node.\n   * @return {boolean} Whether this is a leaf node.\n   */\n  isLeafNode(): boolean;\n\n  /**\n   * Gets the priority of the node.\n   * @return {!Node} The priority of the node.\n   */\n  getPriority(): Node;\n\n  /**\n   * Returns a duplicate node with the new priority.\n   * @param {!Node} newPriorityNode New priority to set for the node.\n   * @return {!Node} Node with new priority.\n   */\n  updatePriority(newPriorityNode: Node): Node;\n\n  /**\n   * Returns the specified immediate child, or null if it doesn't exist.\n   * @param {string} childName The name of the child to retrieve.\n   * @return {!Node} The retrieved child, or an empty node.\n   */\n  getImmediateChild(childName: string): Node;\n\n  /**\n   * Returns a child by path, or null if it doesn't exist.\n   * @param {!Path} path The path of the child to retrieve.\n   * @return {!Node} The retrieved child or an empty node.\n   */\n  getChild(path: Path): Node;\n\n  /**\n   * Returns the name of the child immediately prior to the specified childNode, or null.\n   * @param {!string} childName The name of the child to find the predecessor of.\n   * @param {!Node} childNode The node to find the predecessor of.\n   * @param {!Index} index The index to use to determine the predecessor\n   * @return {?string} The name of the predecessor child, or null if childNode is the first child.\n   */\n  getPredecessorChildName(\n    childName: String,\n    childNode: Node,\n    index: Index\n  ): string | null;\n\n  /**\n   * Returns a duplicate node, with the specified immediate child updated.\n   * Any value in the node will be removed.\n   * @param {string} childName The name of the child to update.\n   * @param {!Node} newChildNode The new child node\n   * @return {!Node} The updated node.\n   */\n  updateImmediateChild(childName: string, newChildNode: Node): Node;\n\n  /**\n   * Returns a duplicate node, with the specified child updated.  Any value will\n   * be removed.\n   * @param {!Path} path The path of the child to update.\n   * @param {!Node} newChildNode The new child node, which may be an empty node\n   * @return {!Node} The updated node.\n   */\n  updateChild(path: Path, newChildNode: Node): Node;\n\n  /**\n   * True if the immediate child specified exists\n   * @param {!string} childName\n   * @return {boolean}\n   */\n  hasChild(childName: string): boolean;\n\n  /**\n   * @return {boolean} True if this node has no value or children.\n   */\n  isEmpty(): boolean;\n\n  /**\n   * @return {number} The number of children of this node.\n   */\n  numChildren(): number;\n\n  /**\n   * Calls action for each child.\n   * @param {!Index} index\n   * @param {function(string, !Node)} action Action to be called for\n   * each child.  It's passed the child name and the child node.\n   * @return {*} The first truthy value return by action, or the last falsey one\n   */\n  forEachChild(index: Index, action: (a: string, b: Node) => void): any;\n\n  /**\n   * @param exportFormat True for export format (also wire protocol format).\n   * @return Value of this node as JSON.\n   */\n  val(exportFormat?: boolean): unknown;\n\n  /**\n   * @return {string} hash representing the node contents.\n   */\n  hash(): string;\n\n  /**\n   * @param {!Node} other Another node\n   * @return {!number} -1 for less than, 0 for equal, 1 for greater than other\n   */\n  compareTo(other: Node): number;\n\n  /**\n   * @param {!Node} other\n   * @return {boolean} Whether or not this snapshot equals other\n   */\n  equals(other: Node): boolean;\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {!Node} This node, with the specified index now available\n   */\n  withIndex(indexDefinition: Index): Node;\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {boolean}\n   */\n  isIndexed(indexDefinition: Index): boolean;\n}\n\n/**\n *\n * @param {!string} name\n * @param {!Node} node\n * @constructor\n * @struct\n */\nexport class NamedNode {\n  constructor(public name: string, public node: Node) {}\n\n  /**\n   *\n   * @param {!string} name\n   * @param {!Node} node\n   * @return {NamedNode}\n   */\n  static Wrap(name: string, node: Node) {\n    return new NamedNode(name, node);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Node, NamedNode } from '../Node';\nimport { MIN_NAME, MAX_NAME } from '../../util/util';\nimport { Comparator } from '../../util/SortedMap';\n\n/**\n *\n * @constructor\n */\nexport abstract class Index {\n  /**\n   * @param {!NamedNode} a\n   * @param {!NamedNode} b\n   * @return {number}\n   */\n  abstract compare(a: NamedNode, b: NamedNode): number;\n\n  /**\n   * @param {!Node} node\n   * @return {boolean}\n   */\n  abstract isDefinedOn(node: Node): boolean;\n\n  /**\n   * @return {function(!NamedNode, !NamedNode):number} A standalone comparison function for\n   * this index\n   */\n  getCompare(): Comparator<NamedNode> {\n    return this.compare.bind(this);\n  }\n\n  /**\n   * Given a before and after value for a node, determine if the indexed value has changed. Even if they are different,\n   * it's possible that the changes are isolated to parts of the snapshot that are not indexed.\n   *\n   * @param {!Node} oldNode\n   * @param {!Node} newNode\n   * @return {boolean} True if the portion of the snapshot being indexed changed between oldNode and newNode\n   */\n  indexedValueChanged(oldNode: Node, newNode: Node): boolean {\n    const oldWrapped = new NamedNode(MIN_NAME, oldNode);\n    const newWrapped = new NamedNode(MIN_NAME, newNode);\n    return this.compare(oldWrapped, newWrapped) !== 0;\n  }\n\n  /**\n   * @return {!NamedNode} a node wrapper that will sort equal to or less than\n   * any other node wrapper, using this index\n   */\n  minPost(): NamedNode {\n    return (NamedNode as any).MIN;\n  }\n\n  /**\n   * @return {!NamedNode} a node wrapper that will sort greater than or equal to\n   * any other node wrapper, using this index\n   */\n  abstract maxPost(): NamedNode;\n\n  /**\n   * @param {*} indexValue\n   * @param {string} name\n   * @return {!NamedNode}\n   */\n  abstract makePost(indexValue: any, name: string): NamedNode;\n\n  /**\n   * @return {!string} String representation for inclusion in a query spec\n   */\n  abstract toString(): string;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { doubleToIEEE754String, sha1 } from '../util/util';\nimport { priorityHashText, validatePriorityNode } from './snap';\nimport { Node } from './Node';\nimport { Path } from '../util/Path';\nimport { Index } from './indexes/Index';\nimport { ChildrenNodeConstructor } from './ChildrenNode';\n\nlet __childrenNodeConstructor: ChildrenNodeConstructor;\n\n/**\n * LeafNode is a class for storing leaf nodes in a DataSnapshot.  It\n * implements Node and stores the value of the node (a string,\n * number, or boolean) accessible via getValue().\n */\nexport class LeafNode implements Node {\n  static set __childrenNodeConstructor(val: ChildrenNodeConstructor) {\n    __childrenNodeConstructor = val;\n  }\n\n  static get __childrenNodeConstructor() {\n    return __childrenNodeConstructor;\n  }\n\n  /**\n   * The sort order for comparing leaf nodes of different types. If two leaf nodes have\n   * the same type, the comparison falls back to their value\n   * @type {Array.<!string>}\n   * @const\n   */\n  static VALUE_TYPE_ORDER = ['object', 'boolean', 'number', 'string'];\n\n  private lazyHash_: string | null = null;\n\n  /**\n   * @implements {Node}\n   * @param {!(string|number|boolean|Object)} value_ The value to store in this leaf node.\n   *                                         The object type is possible in the event of a deferred value\n   * @param {!Node=} priorityNode_ The priority of this node.\n   */\n  constructor(\n    private readonly value_: string | number | boolean | object,\n    private priorityNode_: Node = LeafNode.__childrenNodeConstructor.EMPTY_NODE\n  ) {\n    assert(\n      this.value_ !== undefined && this.value_ !== null,\n      \"LeafNode shouldn't be created with null/undefined value.\"\n    );\n\n    validatePriorityNode(this.priorityNode_);\n  }\n\n  /** @inheritDoc */\n  isLeafNode(): boolean {\n    return true;\n  }\n\n  /** @inheritDoc */\n  getPriority(): Node {\n    return this.priorityNode_;\n  }\n\n  /** @inheritDoc */\n  updatePriority(newPriorityNode: Node): Node {\n    return new LeafNode(this.value_, newPriorityNode);\n  }\n\n  /** @inheritDoc */\n  getImmediateChild(childName: string): Node {\n    // Hack to treat priority as a regular child\n    if (childName === '.priority') {\n      return this.priorityNode_;\n    } else {\n      return LeafNode.__childrenNodeConstructor.EMPTY_NODE;\n    }\n  }\n\n  /** @inheritDoc */\n  getChild(path: Path): Node {\n    if (path.isEmpty()) {\n      return this;\n    } else if (path.getFront() === '.priority') {\n      return this.priorityNode_;\n    } else {\n      return LeafNode.__childrenNodeConstructor.EMPTY_NODE;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  hasChild(): boolean {\n    return false;\n  }\n\n  /** @inheritDoc */\n  getPredecessorChildName(childName: String, childNode: Node): null {\n    return null;\n  }\n\n  /** @inheritDoc */\n  updateImmediateChild(childName: string, newChildNode: Node): Node {\n    if (childName === '.priority') {\n      return this.updatePriority(newChildNode);\n    } else if (newChildNode.isEmpty() && childName !== '.priority') {\n      return this;\n    } else {\n      return LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(\n        childName,\n        newChildNode\n      ).updatePriority(this.priorityNode_);\n    }\n  }\n\n  /** @inheritDoc */\n  updateChild(path: Path, newChildNode: Node): Node {\n    const front = path.getFront();\n    if (front === null) {\n      return newChildNode;\n    } else if (newChildNode.isEmpty() && front !== '.priority') {\n      return this;\n    } else {\n      assert(\n        front !== '.priority' || path.getLength() === 1,\n        '.priority must be the last token in a path'\n      );\n\n      return this.updateImmediateChild(\n        front,\n        LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(\n          path.popFront(),\n          newChildNode\n        )\n      );\n    }\n  }\n\n  /** @inheritDoc */\n  isEmpty(): boolean {\n    return false;\n  }\n\n  /** @inheritDoc */\n  numChildren(): number {\n    return 0;\n  }\n\n  /** @inheritDoc */\n  forEachChild(index: Index, action: (s: string, n: Node) => void): any {\n    return false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  val(exportFormat?: boolean): Object {\n    if (exportFormat && !this.getPriority().isEmpty())\n      return {\n        '.value': this.getValue(),\n        '.priority': this.getPriority().val()\n      };\n    else return this.getValue();\n  }\n\n  /** @inheritDoc */\n  hash(): string {\n    if (this.lazyHash_ === null) {\n      let toHash = '';\n      if (!this.priorityNode_.isEmpty())\n        toHash +=\n          'priority:' +\n          priorityHashText(this.priorityNode_.val() as number | string) +\n          ':';\n\n      const type = typeof this.value_;\n      toHash += type + ':';\n      if (type === 'number') {\n        toHash += doubleToIEEE754String(this.value_ as number);\n      } else {\n        toHash += this.value_;\n      }\n      this.lazyHash_ = sha1(toHash);\n    }\n    return this.lazyHash_;\n  }\n\n  /**\n   * Returns the value of the leaf node.\n   * @return {Object|string|number|boolean} The value of the node.\n   */\n  getValue(): object | string | number | boolean {\n    return this.value_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  compareTo(other: Node): number {\n    if (other === LeafNode.__childrenNodeConstructor.EMPTY_NODE) {\n      return 1;\n    } else if (other instanceof LeafNode.__childrenNodeConstructor) {\n      return -1;\n    } else {\n      assert(other.isLeafNode(), 'Unknown node type');\n      return this.compareToLeafNode_(other as LeafNode);\n    }\n  }\n\n  /**\n   * Comparison specifically for two leaf nodes\n   * @param {!LeafNode} otherLeaf\n   * @return {!number}\n   * @private\n   */\n  private compareToLeafNode_(otherLeaf: LeafNode): number {\n    const otherLeafType = typeof otherLeaf.value_;\n    const thisLeafType = typeof this.value_;\n    const otherIndex = LeafNode.VALUE_TYPE_ORDER.indexOf(otherLeafType);\n    const thisIndex = LeafNode.VALUE_TYPE_ORDER.indexOf(thisLeafType);\n    assert(otherIndex >= 0, 'Unknown leaf type: ' + otherLeafType);\n    assert(thisIndex >= 0, 'Unknown leaf type: ' + thisLeafType);\n    if (otherIndex === thisIndex) {\n      // Same type, compare values\n      if (thisLeafType === 'object') {\n        // Deferred value nodes are all equal, but we should also never get to this point...\n        return 0;\n      } else {\n        // Note that this works because true > false, all others are number or string comparisons\n        if (this.value_ < otherLeaf.value_) {\n          return -1;\n        } else if (this.value_ === otherLeaf.value_) {\n          return 0;\n        } else {\n          return 1;\n        }\n      }\n    } else {\n      return thisIndex - otherIndex;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  withIndex(): Node {\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isIndexed(): boolean {\n    return true;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  equals(other: Node): boolean {\n    /**\n     * @inheritDoc\n     */\n    if (other === this) {\n      return true;\n    } else if (other.isLeafNode()) {\n      const otherLeaf = other as LeafNode;\n      return (\n        this.value_ === otherLeaf.value_ &&\n        this.priorityNode_.equals(otherLeaf.priorityNode_)\n      );\n    } else {\n      return false;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Index } from './Index';\nimport { nameCompare, MAX_NAME } from '../../util/util';\nimport { NamedNode, Node } from '../Node';\nimport { LeafNode } from '../LeafNode';\n\nlet nodeFromJSON: (a: any) => Node;\nlet MAX_NODE: Node;\n\nexport function setNodeFromJSON(val: (a: any) => Node) {\n  nodeFromJSON = val;\n}\n\nexport function setMaxNode(val: Node) {\n  MAX_NODE = val;\n}\n\n/**\n * @constructor\n * @extends {Index}\n * @private\n */\nexport class PriorityIndex extends Index {\n  /**\n   * @inheritDoc\n   */\n  compare(a: NamedNode, b: NamedNode): number {\n    const aPriority = a.node.getPriority();\n    const bPriority = b.node.getPriority();\n    const indexCmp = aPriority.compareTo(bPriority);\n    if (indexCmp === 0) {\n      return nameCompare(a.name, b.name);\n    } else {\n      return indexCmp;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isDefinedOn(node: Node): boolean {\n    return !node.getPriority().isEmpty();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  indexedValueChanged(oldNode: Node, newNode: Node): boolean {\n    return !oldNode.getPriority().equals(newNode.getPriority());\n  }\n\n  /**\n   * @inheritDoc\n   */\n  minPost(): NamedNode {\n    return (NamedNode as any).MIN;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  maxPost(): NamedNode {\n    return new NamedNode(MAX_NAME, new LeafNode('[PRIORITY-POST]', MAX_NODE));\n  }\n\n  /**\n   * @param {*} indexValue\n   * @param {string} name\n   * @return {!NamedNode}\n   */\n  makePost(indexValue: any, name: string): NamedNode {\n    const priorityNode = nodeFromJSON(indexValue);\n    return new NamedNode(name, new LeafNode('[PRIORITY-POST]', priorityNode));\n  }\n\n  /**\n   * @return {!string} String representation for inclusion in a query spec\n   */\n  toString(): string {\n    return '.priority';\n  }\n}\n\nexport const PRIORITY_INDEX = new PriorityIndex();\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { buildChildSet } from './childSet';\nimport { contains, map, safeGet } from '@firebase/util';\nimport { NamedNode, Node } from './Node';\nimport { PRIORITY_INDEX } from './indexes/PriorityIndex';\nimport { KEY_INDEX } from './indexes/KeyIndex';\nimport { SortedMap } from '../util/SortedMap';\nimport { Index } from './indexes/Index';\n\nlet _defaultIndexMap: IndexMap;\n\nconst fallbackObject = {};\n\nexport class IndexMap {\n  /**\n   * The default IndexMap for nodes without a priority\n   */\n  static get Default(): IndexMap {\n    assert(\n      fallbackObject && PRIORITY_INDEX,\n      'ChildrenNode.ts has not been loaded'\n    );\n    _defaultIndexMap =\n      _defaultIndexMap ||\n      new IndexMap(\n        { '.priority': fallbackObject },\n        { '.priority': PRIORITY_INDEX }\n      );\n    return _defaultIndexMap;\n  }\n\n  constructor(\n    private indexes_: {\n      [k: string]: SortedMap<NamedNode, Node> | /*FallbackType*/ object;\n    },\n    private indexSet_: { [k: string]: Index }\n  ) {}\n\n  get(indexKey: string): SortedMap<NamedNode, Node> | null {\n    const sortedMap = safeGet(this.indexes_, indexKey);\n    if (!sortedMap) throw new Error('No index defined for ' + indexKey);\n\n    if (sortedMap instanceof SortedMap) {\n      return sortedMap;\n    } else {\n      // The index exists, but it falls back to just name comparison. Return null so that the calling code uses the\n      // regular child map\n      return null;\n    }\n  }\n\n  hasIndex(indexDefinition: Index): boolean {\n    return contains(this.indexSet_, indexDefinition.toString());\n  }\n\n  addIndex(\n    indexDefinition: Index,\n    existingChildren: SortedMap<string, Node>\n  ): IndexMap {\n    assert(\n      indexDefinition !== KEY_INDEX,\n      \"KeyIndex always exists and isn't meant to be added to the IndexMap.\"\n    );\n    const childList = [];\n    let sawIndexedValue = false;\n    const iter = existingChildren.getIterator(NamedNode.Wrap);\n    let next = iter.getNext();\n    while (next) {\n      sawIndexedValue =\n        sawIndexedValue || indexDefinition.isDefinedOn(next.node);\n      childList.push(next);\n      next = iter.getNext();\n    }\n    let newIndex;\n    if (sawIndexedValue) {\n      newIndex = buildChildSet(childList, indexDefinition.getCompare());\n    } else {\n      newIndex = fallbackObject;\n    }\n    const indexName = indexDefinition.toString();\n    const newIndexSet = { ...this.indexSet_ };\n    newIndexSet[indexName] = indexDefinition;\n    const newIndexes = { ...this.indexes_ };\n    newIndexes[indexName] = newIndex;\n    return new IndexMap(newIndexes, newIndexSet);\n  }\n\n  /**\n   * Ensure that this node is properly tracked in any indexes that we're maintaining\n   */\n  addToIndexes(\n    namedNode: NamedNode,\n    existingChildren: SortedMap<string, Node>\n  ): IndexMap {\n    const newIndexes = map(\n      this.indexes_,\n      (indexedChildren: SortedMap<NamedNode, Node>, indexName: string) => {\n        const index = safeGet(this.indexSet_, indexName);\n        assert(index, 'Missing index implementation for ' + indexName);\n        if (indexedChildren === fallbackObject) {\n          // Check to see if we need to index everything\n          if (index.isDefinedOn(namedNode.node)) {\n            // We need to build this index\n            const childList = [];\n            const iter = existingChildren.getIterator(NamedNode.Wrap);\n            let next = iter.getNext();\n            while (next) {\n              if (next.name != namedNode.name) {\n                childList.push(next);\n              }\n              next = iter.getNext();\n            }\n            childList.push(namedNode);\n            return buildChildSet(childList, index.getCompare());\n          } else {\n            // No change, this remains a fallback\n            return fallbackObject;\n          }\n        } else {\n          const existingSnap = existingChildren.get(namedNode.name);\n          let newChildren = indexedChildren;\n          if (existingSnap) {\n            newChildren = newChildren.remove(\n              new NamedNode(namedNode.name, existingSnap)\n            );\n          }\n          return newChildren.insert(namedNode, namedNode.node);\n        }\n      }\n    );\n    return new IndexMap(newIndexes, this.indexSet_);\n  }\n\n  /**\n   * Create a new IndexMap instance with the given value removed\n   */\n  removeFromIndexes(\n    namedNode: NamedNode,\n    existingChildren: SortedMap<string, Node>\n  ): IndexMap {\n    const newIndexes = map(this.indexes_, function(\n      indexedChildren: SortedMap<NamedNode, Node>\n    ) {\n      if (indexedChildren === fallbackObject) {\n        // This is the fallback. Just return it, nothing to do in this case\n        return indexedChildren;\n      } else {\n        const existingSnap = existingChildren.get(namedNode.name);\n        if (existingSnap) {\n          return indexedChildren.remove(\n            new NamedNode(namedNode.name, existingSnap)\n          );\n        } else {\n          // No record of this child\n          return indexedChildren;\n        }\n      }\n    });\n    return new IndexMap(newIndexes, this.indexSet_);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { sha1, MAX_NAME, MIN_NAME } from '../util/util';\nimport { SortedMap, SortedMapIterator } from '../util/SortedMap';\nimport { Node, NamedNode } from './Node';\nimport { validatePriorityNode, priorityHashText, setMaxNode } from './snap';\nimport {\n  PRIORITY_INDEX,\n  setMaxNode as setPriorityMaxNode\n} from './indexes/PriorityIndex';\nimport { KEY_INDEX, KeyIndex } from './indexes/KeyIndex';\nimport { IndexMap } from './IndexMap';\nimport { LeafNode } from './LeafNode';\nimport { NAME_COMPARATOR } from './comparators';\nimport { Index } from './indexes/Index';\nimport { Path } from '../util/Path';\n\nexport interface ChildrenNodeConstructor {\n  new (\n    children_: SortedMap<string, Node>,\n    priorityNode_: Node | null,\n    indexMap_: IndexMap\n  ): ChildrenNode;\n  EMPTY_NODE: ChildrenNode;\n}\n\n// TODO: For memory savings, don't store priorityNode_ if it's empty.\n\nlet EMPTY_NODE: ChildrenNode;\n\n/**\n * ChildrenNode is a class for storing internal nodes in a DataSnapshot\n * (i.e. nodes with children).  It implements Node and stores the\n * list of children in the children property, sorted by child name.\n *\n * @constructor\n * @implements {Node}\n */\nexport class ChildrenNode implements Node {\n  private lazyHash_: string | null = null;\n\n  static get EMPTY_NODE(): ChildrenNode {\n    return (\n      EMPTY_NODE ||\n      (EMPTY_NODE = new ChildrenNode(\n        new SortedMap<string, Node>(NAME_COMPARATOR),\n        null,\n        IndexMap.Default\n      ))\n    );\n  }\n\n  /**\n   *\n   * @param {!SortedMap.<string, !Node>} children_ List of children\n   * of this node..\n   * @param {?Node} priorityNode_ The priority of this node (as a snapshot node).\n   * @param {!IndexMap} indexMap_\n   */\n  constructor(\n    private readonly children_: SortedMap<string, Node>,\n    private readonly priorityNode_: Node | null,\n    private indexMap_: IndexMap\n  ) {\n    /**\n     * Note: The only reason we allow null priority is for EMPTY_NODE, since we can't use\n     * EMPTY_NODE as the priority of EMPTY_NODE.  We might want to consider making EMPTY_NODE its own\n     * class instead of an empty ChildrenNode.\n     */\n    if (this.priorityNode_) {\n      validatePriorityNode(this.priorityNode_);\n    }\n\n    if (this.children_.isEmpty()) {\n      assert(\n        !this.priorityNode_ || this.priorityNode_.isEmpty(),\n        'An empty node cannot have a priority'\n      );\n    }\n  }\n\n  /** @inheritDoc */\n  isLeafNode(): boolean {\n    return false;\n  }\n\n  /** @inheritDoc */\n  getPriority(): Node {\n    return this.priorityNode_ || EMPTY_NODE;\n  }\n\n  /** @inheritDoc */\n  updatePriority(newPriorityNode: Node): Node {\n    if (this.children_.isEmpty()) {\n      // Don't allow priorities on empty nodes\n      return this;\n    } else {\n      return new ChildrenNode(this.children_, newPriorityNode, this.indexMap_);\n    }\n  }\n\n  /** @inheritDoc */\n  getImmediateChild(childName: string): Node {\n    // Hack to treat priority as a regular child\n    if (childName === '.priority') {\n      return this.getPriority();\n    } else {\n      const child = this.children_.get(childName);\n      return child === null ? EMPTY_NODE : child;\n    }\n  }\n\n  /** @inheritDoc */\n  getChild(path: Path): Node {\n    const front = path.getFront();\n    if (front === null) return this;\n\n    return this.getImmediateChild(front).getChild(path.popFront());\n  }\n\n  /** @inheritDoc */\n  hasChild(childName: string): boolean {\n    return this.children_.get(childName) !== null;\n  }\n\n  /** @inheritDoc */\n  updateImmediateChild(childName: string, newChildNode: Node): Node {\n    assert(newChildNode, 'We should always be passing snapshot nodes');\n    if (childName === '.priority') {\n      return this.updatePriority(newChildNode);\n    } else {\n      const namedNode = new NamedNode(childName, newChildNode);\n      let newChildren, newIndexMap, newPriority;\n      if (newChildNode.isEmpty()) {\n        newChildren = this.children_.remove(childName);\n        newIndexMap = this.indexMap_.removeFromIndexes(\n          namedNode,\n          this.children_\n        );\n      } else {\n        newChildren = this.children_.insert(childName, newChildNode);\n        newIndexMap = this.indexMap_.addToIndexes(namedNode, this.children_);\n      }\n\n      newPriority = newChildren.isEmpty() ? EMPTY_NODE : this.priorityNode_;\n      return new ChildrenNode(newChildren, newPriority, newIndexMap);\n    }\n  }\n\n  /** @inheritDoc */\n  updateChild(path: Path, newChildNode: Node): Node {\n    const front = path.getFront();\n    if (front === null) {\n      return newChildNode;\n    } else {\n      assert(\n        path.getFront() !== '.priority' || path.getLength() === 1,\n        '.priority must be the last token in a path'\n      );\n      const newImmediateChild = this.getImmediateChild(front).updateChild(\n        path.popFront(),\n        newChildNode\n      );\n      return this.updateImmediateChild(front, newImmediateChild);\n    }\n  }\n\n  /** @inheritDoc */\n  isEmpty(): boolean {\n    return this.children_.isEmpty();\n  }\n\n  /** @inheritDoc */\n  numChildren(): number {\n    return this.children_.count();\n  }\n\n  /**\n   * @private\n   * @type {RegExp}\n   */\n  private static INTEGER_REGEXP_ = /^(0|[1-9]\\d*)$/;\n\n  /** @inheritDoc */\n  val(exportFormat?: boolean): object {\n    if (this.isEmpty()) return null;\n\n    const obj: { [k: string]: unknown } = {};\n    let numKeys = 0,\n      maxKey = 0,\n      allIntegerKeys = true;\n    this.forEachChild(PRIORITY_INDEX, function(key: string, childNode: Node) {\n      obj[key] = childNode.val(exportFormat);\n\n      numKeys++;\n      if (allIntegerKeys && ChildrenNode.INTEGER_REGEXP_.test(key)) {\n        maxKey = Math.max(maxKey, Number(key));\n      } else {\n        allIntegerKeys = false;\n      }\n    });\n\n    if (!exportFormat && allIntegerKeys && maxKey < 2 * numKeys) {\n      // convert to array.\n      const array: unknown[] = [];\n      for (let key in obj) array[(key as any) as number] = obj[key];\n\n      return array;\n    } else {\n      if (exportFormat && !this.getPriority().isEmpty()) {\n        obj['.priority'] = this.getPriority().val();\n      }\n      return obj;\n    }\n  }\n\n  /** @inheritDoc */\n  hash(): string {\n    if (this.lazyHash_ === null) {\n      let toHash = '';\n      if (!this.getPriority().isEmpty())\n        toHash +=\n          'priority:' +\n          priorityHashText(this.getPriority().val() as string | number) +\n          ':';\n\n      this.forEachChild(PRIORITY_INDEX, function(key, childNode) {\n        const childHash = childNode.hash();\n        if (childHash !== '') toHash += ':' + key + ':' + childHash;\n      });\n\n      this.lazyHash_ = toHash === '' ? '' : sha1(toHash);\n    }\n    return this.lazyHash_;\n  }\n\n  /** @inheritDoc */\n  getPredecessorChildName(\n    childName: string,\n    childNode: Node,\n    index: Index\n  ): string {\n    const idx = this.resolveIndex_(index);\n    if (idx) {\n      const predecessor = idx.getPredecessorKey(\n        new NamedNode(childName, childNode)\n      );\n      return predecessor ? predecessor.name : null;\n    } else {\n      return this.children_.getPredecessorKey(childName);\n    }\n  }\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {?string}\n   */\n  getFirstChildName(indexDefinition: Index): string | null {\n    const idx = this.resolveIndex_(indexDefinition);\n    if (idx) {\n      const minKey = idx.minKey();\n      return minKey && minKey.name;\n    } else {\n      return this.children_.minKey();\n    }\n  }\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {?NamedNode}\n   */\n  getFirstChild(indexDefinition: Index): NamedNode | null {\n    const minKey = this.getFirstChildName(indexDefinition);\n    if (minKey) {\n      return new NamedNode(minKey, this.children_.get(minKey));\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Given an index, return the key name of the largest value we have, according to that index\n   * @param {!Index} indexDefinition\n   * @return {?string}\n   */\n  getLastChildName(indexDefinition: Index): string | null {\n    const idx = this.resolveIndex_(indexDefinition);\n    if (idx) {\n      const maxKey = idx.maxKey();\n      return maxKey && maxKey.name;\n    } else {\n      return this.children_.maxKey();\n    }\n  }\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {?NamedNode}\n   */\n  getLastChild(indexDefinition: Index): NamedNode | null {\n    const maxKey = this.getLastChildName(indexDefinition);\n    if (maxKey) {\n      return new NamedNode(maxKey, this.children_.get(maxKey));\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  forEachChild(\n    index: Index,\n    action: (key: string, node: Node) => boolean | void\n  ): boolean {\n    const idx = this.resolveIndex_(index);\n    if (idx) {\n      return idx.inorderTraversal(function(wrappedNode) {\n        return action(wrappedNode.name, wrappedNode.node);\n      });\n    } else {\n      return this.children_.inorderTraversal(action);\n    }\n  }\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {SortedMapIterator}\n   */\n  getIterator(\n    indexDefinition: Index\n  ): SortedMapIterator<string | NamedNode, Node, NamedNode> {\n    return this.getIteratorFrom(indexDefinition.minPost(), indexDefinition);\n  }\n\n  /**\n   *\n   * @param {!NamedNode} startPost\n   * @param {!Index} indexDefinition\n   * @return {!SortedMapIterator}\n   */\n  getIteratorFrom(\n    startPost: NamedNode,\n    indexDefinition: Index\n  ): SortedMapIterator<string | NamedNode, Node, NamedNode> {\n    const idx = this.resolveIndex_(indexDefinition);\n    if (idx) {\n      return idx.getIteratorFrom(startPost, key => key);\n    } else {\n      const iterator = this.children_.getIteratorFrom(\n        startPost.name,\n        NamedNode.Wrap\n      );\n      let next = iterator.peek();\n      while (next != null && indexDefinition.compare(next, startPost) < 0) {\n        iterator.getNext();\n        next = iterator.peek();\n      }\n      return iterator;\n    }\n  }\n\n  /**\n   * @param {!Index} indexDefinition\n   * @return {!SortedMapIterator}\n   */\n  getReverseIterator(\n    indexDefinition: Index\n  ): SortedMapIterator<string | NamedNode, Node, NamedNode> {\n    return this.getReverseIteratorFrom(\n      indexDefinition.maxPost(),\n      indexDefinition\n    );\n  }\n\n  /**\n   * @param {!NamedNode} endPost\n   * @param {!Index} indexDefinition\n   * @return {!SortedMapIterator}\n   */\n  getReverseIteratorFrom(\n    endPost: NamedNode,\n    indexDefinition: Index\n  ): SortedMapIterator<string | NamedNode, Node, NamedNode> {\n    const idx = this.resolveIndex_(indexDefinition);\n    if (idx) {\n      return idx.getReverseIteratorFrom(endPost, function(key) {\n        return key;\n      });\n    } else {\n      const iterator = this.children_.getReverseIteratorFrom(\n        endPost.name,\n        NamedNode.Wrap\n      );\n      let next = iterator.peek();\n      while (next != null && indexDefinition.compare(next, endPost) > 0) {\n        iterator.getNext();\n        next = iterator.peek();\n      }\n      return iterator;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  compareTo(other: ChildrenNode): number {\n    if (this.isEmpty()) {\n      if (other.isEmpty()) {\n        return 0;\n      } else {\n        return -1;\n      }\n    } else if (other.isLeafNode() || other.isEmpty()) {\n      return 1;\n    } else if (other === MAX_NODE) {\n      return -1;\n    } else {\n      // Must be another node with children.\n      return 0;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  withIndex(indexDefinition: Index): Node {\n    if (\n      indexDefinition === KEY_INDEX ||\n      this.indexMap_.hasIndex(indexDefinition)\n    ) {\n      return this;\n    } else {\n      const newIndexMap = this.indexMap_.addIndex(\n        indexDefinition,\n        this.children_\n      );\n      return new ChildrenNode(this.children_, this.priorityNode_, newIndexMap);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isIndexed(index: Index): boolean {\n    return index === KEY_INDEX || this.indexMap_.hasIndex(index);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  equals(other: Node): boolean {\n    if (other === this) {\n      return true;\n    } else if (other.isLeafNode()) {\n      return false;\n    } else {\n      const otherChildrenNode = other as ChildrenNode;\n      if (!this.getPriority().equals(otherChildrenNode.getPriority())) {\n        return false;\n      } else if (\n        this.children_.count() === otherChildrenNode.children_.count()\n      ) {\n        const thisIter = this.getIterator(PRIORITY_INDEX);\n        const otherIter = otherChildrenNode.getIterator(PRIORITY_INDEX);\n        let thisCurrent = thisIter.getNext();\n        let otherCurrent = otherIter.getNext();\n        while (thisCurrent && otherCurrent) {\n          if (\n            thisCurrent.name !== otherCurrent.name ||\n            !thisCurrent.node.equals(otherCurrent.node)\n          ) {\n            return false;\n          }\n          thisCurrent = thisIter.getNext();\n          otherCurrent = otherIter.getNext();\n        }\n        return thisCurrent === null && otherCurrent === null;\n      } else {\n        return false;\n      }\n    }\n  }\n\n  /**\n   * Returns a SortedMap ordered by index, or null if the default (by-key) ordering can be used\n   * instead.\n   *\n   * @private\n   * @param {!Index} indexDefinition\n   * @return {?SortedMap.<NamedNode, Node>}\n   */\n  private resolveIndex_(\n    indexDefinition: Index\n  ): SortedMap<NamedNode, Node> | null {\n    if (indexDefinition === KEY_INDEX) {\n      return null;\n    } else {\n      return this.indexMap_.get(indexDefinition.toString());\n    }\n  }\n}\n\n/**\n * @constructor\n * @extends {ChildrenNode}\n * @private\n */\nexport class MaxNode extends ChildrenNode {\n  constructor() {\n    super(\n      new SortedMap<string, Node>(NAME_COMPARATOR),\n      ChildrenNode.EMPTY_NODE,\n      IndexMap.Default\n    );\n  }\n\n  compareTo(other: Node): number {\n    if (other === this) {\n      return 0;\n    } else {\n      return 1;\n    }\n  }\n\n  equals(other: Node): boolean {\n    // Not that we every compare it, but MAX_NODE is only ever equal to itself\n    return other === this;\n  }\n\n  getPriority(): MaxNode {\n    return this;\n  }\n\n  getImmediateChild(childName: string): ChildrenNode {\n    return ChildrenNode.EMPTY_NODE;\n  }\n\n  isEmpty(): boolean {\n    return false;\n  }\n}\n\n/**\n * Marker that will sort higher than any other snapshot.\n * @type {!MAX_NODE}\n * @const\n */\nexport const MAX_NODE = new MaxNode();\n\n/**\n * Document NamedNode extensions\n */\ndeclare module './Node' {\n  interface NamedNode {\n    MIN: NamedNode;\n    MAX: NamedNode;\n  }\n}\n\nObject.defineProperties(NamedNode, {\n  MIN: {\n    value: new NamedNode(MIN_NAME, ChildrenNode.EMPTY_NODE)\n  },\n  MAX: {\n    value: new NamedNode(MAX_NAME, MAX_NODE)\n  }\n});\n\n/**\n * Reference Extensions\n */\nKeyIndex.__EMPTY_NODE = ChildrenNode.EMPTY_NODE;\nLeafNode.__childrenNodeConstructor = ChildrenNode;\nsetMaxNode(MAX_NODE);\nsetPriorityMaxNode(MAX_NODE);\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Implementation of an immutable SortedMap using a Left-leaning\n * Red-Black Tree, adapted from the implementation in Mugs\n * (http://mads379.github.com/mugs/) by Mads Hartmann Jensen\n * (mads379@gmail.com).\n *\n * Original paper on Left-leaning Red-Black Trees:\n *   http://www.cs.princeton.edu/~rs/talks/LLRB/LLRB.pdf\n *\n * Invariant 1: No red node has a red child\n * Invariant 2: Every leaf path has the same number of black nodes\n * Invariant 3: Only the left child can be red (left leaning)\n */\n\n// TODO: There are some improvements I'd like to make to improve memory / perf:\n//  * Create two prototypes, LLRedNode and LLBlackNode, instead of storing a\n//    color property in every node.\n// TODO: It would also be good (and possibly necessary) to create a base\n// interface for LLRBNode and LLRBEmptyNode.\n\nexport type Comparator<K> = (key1: K, key2: K) => number;\n\n/**\n * An iterator over an LLRBNode.\n */\nexport class SortedMapIterator<K, V, T> {\n  /** @private\n   * @type {Array.<!LLRBNode>}\n   */\n  private nodeStack_: (LLRBNode<K, V> | LLRBEmptyNode<K, V>)[] = [];\n\n  /**\n   * @template K, V, T\n   * @param {LLRBNode|LLRBEmptyNode} node Node to iterate.\n   * @param {?K} startKey\n   * @param {function(K, K): number} comparator\n   * @param {boolean} isReverse_ Whether or not to iterate in reverse\n   * @param {(function(K, V):T)=} resultGenerator_\n   */\n  constructor(\n    node: LLRBNode<K, V> | LLRBEmptyNode<K, V>,\n    startKey: K | null,\n    comparator: Comparator<K>,\n    private isReverse_: boolean,\n    private resultGenerator_: ((k: K, v: V) => T) | null = null\n  ) {\n    let cmp = 1;\n    while (!node.isEmpty()) {\n      node = node as LLRBNode<K, V>;\n      cmp = startKey ? comparator(node.key, startKey) : 1;\n      // flip the comparison if we're going in reverse\n      if (isReverse_) cmp *= -1;\n\n      if (cmp < 0) {\n        // This node is less than our start key. ignore it\n        if (this.isReverse_) {\n          node = node.left;\n        } else {\n          node = node.right;\n        }\n      } else if (cmp === 0) {\n        // This node is exactly equal to our start key. Push it on the stack, but stop iterating;\n        this.nodeStack_.push(node);\n        break;\n      } else {\n        // This node is greater than our start key, add it to the stack and move to the next one\n        this.nodeStack_.push(node);\n        if (this.isReverse_) {\n          node = node.right;\n        } else {\n          node = node.left;\n        }\n      }\n    }\n  }\n\n  getNext(): T {\n    if (this.nodeStack_.length === 0) return null;\n\n    let node = this.nodeStack_.pop();\n    let result: T;\n    if (this.resultGenerator_)\n      result = this.resultGenerator_(node.key, node.value);\n    else result = { key: node.key, value: node.value } as any;\n\n    if (this.isReverse_) {\n      node = node.left;\n      while (!node.isEmpty()) {\n        this.nodeStack_.push(node);\n        node = node.right;\n      }\n    } else {\n      node = node.right;\n      while (!node.isEmpty()) {\n        this.nodeStack_.push(node);\n        node = node.left;\n      }\n    }\n\n    return result;\n  }\n\n  hasNext(): boolean {\n    return this.nodeStack_.length > 0;\n  }\n\n  peek(): T {\n    if (this.nodeStack_.length === 0) return null;\n\n    const node = this.nodeStack_[this.nodeStack_.length - 1];\n    if (this.resultGenerator_) {\n      return this.resultGenerator_(node.key, node.value);\n    } else {\n      return { key: node.key, value: node.value } as any;\n    }\n  }\n}\n\n/**\n * Represents a node in a Left-leaning Red-Black tree.\n */\nexport class LLRBNode<K, V> {\n  color: boolean;\n  left: LLRBNode<K, V> | LLRBEmptyNode<K, V>;\n  right: LLRBNode<K, V> | LLRBEmptyNode<K, V>;\n\n  /**\n   * @template K, V\n   * @param {!K} key Key associated with this node.\n   * @param {!V} value Value associated with this node.\n   * @param {?boolean} color Whether this node is red.\n   * @param {?(LLRBNode|LLRBEmptyNode)=} left Left child.\n   * @param {?(LLRBNode|LLRBEmptyNode)=} right Right child.\n   */\n  constructor(\n    public key: K,\n    public value: V,\n    color: boolean | null,\n    left?: LLRBNode<K, V> | LLRBEmptyNode<K, V> | null,\n    right?: LLRBNode<K, V> | LLRBEmptyNode<K, V> | null\n  ) {\n    this.color = color != null ? color : LLRBNode.RED;\n    this.left =\n      left != null ? left : (SortedMap.EMPTY_NODE as LLRBEmptyNode<K, V>);\n    this.right =\n      right != null ? right : (SortedMap.EMPTY_NODE as LLRBEmptyNode<K, V>);\n  }\n\n  static RED = true;\n  static BLACK = false;\n\n  /**\n   * Returns a copy of the current node, optionally replacing pieces of it.\n   *\n   * @param {?K} key New key for the node, or null.\n   * @param {?V} value New value for the node, or null.\n   * @param {?boolean} color New color for the node, or null.\n   * @param {?LLRBNode|LLRBEmptyNode} left New left child for the node, or null.\n   * @param {?LLRBNode|LLRBEmptyNode} right New right child for the node, or null.\n   * @return {!LLRBNode} The node copy.\n   */\n  copy(\n    key: K | null,\n    value: V | null,\n    color: boolean | null,\n    left: LLRBNode<K, V> | LLRBEmptyNode<K, V> | null,\n    right: LLRBNode<K, V> | LLRBEmptyNode<K, V> | null\n  ): LLRBNode<K, V> {\n    return new LLRBNode(\n      key != null ? key : this.key,\n      value != null ? value : this.value,\n      color != null ? color : this.color,\n      left != null ? left : this.left,\n      right != null ? right : this.right\n    );\n  }\n\n  /**\n   * @return {number} The total number of nodes in the tree.\n   */\n  count(): number {\n    return this.left.count() + 1 + this.right.count();\n  }\n\n  /**\n   * @return {boolean} True if the tree is empty.\n   */\n  isEmpty(): boolean {\n    return false;\n  }\n\n  /**\n   * Traverses the tree in key order and calls the specified action function\n   * for each node.\n   *\n   * @param {function(!K, !V):*} action Callback function to be called for each\n   *   node.  If it returns true, traversal is aborted.\n   * @return {*} The first truthy value returned by action, or the last falsey\n   *   value returned by action\n   */\n  inorderTraversal(action: (k: K, v: V) => any): boolean {\n    return (\n      this.left.inorderTraversal(action) ||\n      action(this.key, this.value) ||\n      this.right.inorderTraversal(action)\n    );\n  }\n\n  /**\n   * Traverses the tree in reverse key order and calls the specified action function\n   * for each node.\n   *\n   * @param {function(!Object, !Object)} action Callback function to be called for each\n   * node.  If it returns true, traversal is aborted.\n   * @return {*} True if traversal was aborted.\n   */\n  reverseTraversal(action: (k: K, v: V) => void): boolean {\n    return (\n      this.right.reverseTraversal(action) ||\n      action(this.key, this.value) ||\n      this.left.reverseTraversal(action)\n    );\n  }\n\n  /**\n   * @return {!Object} The minimum node in the tree.\n   * @private\n   */\n  private min_(): LLRBNode<K, V> {\n    if (this.left.isEmpty()) {\n      return this;\n    } else {\n      return (this.left as LLRBNode<K, V>).min_();\n    }\n  }\n\n  /**\n   * @return {!K} The maximum key in the tree.\n   */\n  minKey(): K {\n    return this.min_().key;\n  }\n\n  /**\n   * @return {!K} The maximum key in the tree.\n   */\n  maxKey(): K {\n    if (this.right.isEmpty()) {\n      return this.key;\n    } else {\n      return this.right.maxKey();\n    }\n  }\n\n  /**\n   *\n   * @param {!Object} key Key to insert.\n   * @param {!Object} value Value to insert.\n   * @param {Comparator} comparator Comparator.\n   * @return {!LLRBNode} New tree, with the key/value added.\n   */\n  insert(key: K, value: V, comparator: Comparator<K>): LLRBNode<K, V> {\n    let cmp, n;\n    n = this;\n    cmp = comparator(key, n.key);\n    if (cmp < 0) {\n      n = n.copy(null, null, null, n.left.insert(key, value, comparator), null);\n    } else if (cmp === 0) {\n      n = n.copy(null, value, null, null, null);\n    } else {\n      n = n.copy(\n        null,\n        null,\n        null,\n        null,\n        n.right.insert(key, value, comparator)\n      );\n    }\n    return n.fixUp_();\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode|LLRBEmptyNode} New tree, with the minimum key removed.\n   */\n  private removeMin_(): LLRBNode<K, V> | LLRBEmptyNode<K, V> {\n    if (this.left.isEmpty()) {\n      return SortedMap.EMPTY_NODE as LLRBEmptyNode<K, V>;\n    }\n    let n: LLRBNode<K, V> = this;\n    if (!n.left.isRed_() && !n.left.left.isRed_()) n = n.moveRedLeft_();\n    n = n.copy(null, null, null, (n.left as LLRBNode<K, V>).removeMin_(), null);\n    return n.fixUp_();\n  }\n\n  /**\n   * @param {!Object} key The key of the item to remove.\n   * @param {Comparator} comparator Comparator.\n   * @return {!LLRBNode|LLRBEmptyNode} New tree, with the specified item removed.\n   */\n  remove(\n    key: K,\n    comparator: Comparator<K>\n  ): LLRBNode<K, V> | LLRBEmptyNode<K, V> {\n    let n, smallest;\n    n = this;\n    if (comparator(key, n.key) < 0) {\n      if (!n.left.isEmpty() && !n.left.isRed_() && !n.left.left.isRed_()) {\n        n = n.moveRedLeft_();\n      }\n      n = n.copy(null, null, null, n.left.remove(key, comparator), null);\n    } else {\n      if (n.left.isRed_()) n = n.rotateRight_();\n      if (!n.right.isEmpty() && !n.right.isRed_() && !n.right.left.isRed_()) {\n        n = n.moveRedRight_();\n      }\n      if (comparator(key, n.key) === 0) {\n        if (n.right.isEmpty()) {\n          return SortedMap.EMPTY_NODE as LLRBEmptyNode<K, V>;\n        } else {\n          smallest = (n.right as LLRBNode<K, V>).min_();\n          n = n.copy(\n            smallest.key,\n            smallest.value,\n            null,\n            null,\n            (n.right as LLRBNode<K, V>).removeMin_()\n          );\n        }\n      }\n      n = n.copy(null, null, null, null, n.right.remove(key, comparator));\n    }\n    return n.fixUp_();\n  }\n\n  /**\n   * @private\n   * @return {boolean} Whether this is a RED node.\n   */\n  isRed_(): boolean {\n    return this.color;\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode} New tree after performing any needed rotations.\n   */\n  private fixUp_(): LLRBNode<K, V> {\n    let n = this as any;\n    if (n.right.isRed_() && !n.left.isRed_()) n = n.rotateLeft_();\n    if (n.left.isRed_() && n.left.left.isRed_()) n = n.rotateRight_();\n    if (n.left.isRed_() && n.right.isRed_()) n = n.colorFlip_();\n    return n;\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode} New tree, after moveRedLeft.\n   */\n  private moveRedLeft_(): LLRBNode<K, V> {\n    let n = this.colorFlip_();\n    if (n.right.left.isRed_()) {\n      n = n.copy(\n        null,\n        null,\n        null,\n        null,\n        (n.right as LLRBNode<K, V>).rotateRight_()\n      );\n      n = n.rotateLeft_();\n      n = n.colorFlip_();\n    }\n    return n;\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode} New tree, after moveRedRight.\n   */\n  private moveRedRight_(): LLRBNode<K, V> {\n    let n = this.colorFlip_();\n    if (n.left.left.isRed_()) {\n      n = n.rotateRight_();\n      n = n.colorFlip_();\n    }\n    return n;\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode} New tree, after rotateLeft.\n   */\n  private rotateLeft_(): LLRBNode<K, V> {\n    const nl = this.copy(null, null, LLRBNode.RED, null, this.right.left);\n    return this.right.copy(null, null, this.color, nl, null) as LLRBNode<K, V>;\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode} New tree, after rotateRight.\n   */\n  private rotateRight_(): LLRBNode<K, V> {\n    const nr = this.copy(null, null, LLRBNode.RED, this.left.right, null);\n    return this.left.copy(null, null, this.color, null, nr) as LLRBNode<K, V>;\n  }\n\n  /**\n   * @private\n   * @return {!LLRBNode} New tree, after colorFlip.\n   */\n  private colorFlip_(): LLRBNode<K, V> {\n    const left = this.left.copy(null, null, !this.left.color, null, null);\n    const right = this.right.copy(null, null, !this.right.color, null, null);\n    return this.copy(null, null, !this.color, left, right);\n  }\n\n  /**\n   * For testing.\n   *\n   * @private\n   * @return {boolean} True if all is well.\n   */\n  private checkMaxDepth_(): boolean {\n    const blackDepth = this.check_();\n    return Math.pow(2.0, blackDepth) <= this.count() + 1;\n  }\n\n  /**\n   * @private\n   * @return {number} Not sure what this returns exactly. :-).\n   */\n  check_(): number {\n    let blackDepth;\n    if (this.isRed_() && this.left.isRed_()) {\n      throw new Error(\n        'Red node has red child(' + this.key + ',' + this.value + ')'\n      );\n    }\n    if (this.right.isRed_()) {\n      throw new Error(\n        'Right child of (' + this.key + ',' + this.value + ') is red'\n      );\n    }\n    blackDepth = this.left.check_();\n    if (blackDepth !== this.right.check_()) {\n      throw new Error('Black depths differ');\n    } else {\n      return blackDepth + (this.isRed_() ? 0 : 1);\n    }\n  }\n}\n\n/**\n * Represents an empty node (a leaf node in the Red-Black Tree).\n */\nexport class LLRBEmptyNode<K, V> {\n  key: K;\n  value: V;\n  left: LLRBNode<K, V> | LLRBEmptyNode<K, V>;\n  right: LLRBNode<K, V> | LLRBEmptyNode<K, V>;\n  color: boolean;\n\n  /**\n   * Returns a copy of the current node.\n   *\n   * @return {!LLRBEmptyNode} The node copy.\n   */\n  copy(\n    key: K | null,\n    value: V | null,\n    color: boolean | null,\n    left: LLRBNode<K, V> | LLRBEmptyNode<K, V> | null,\n    right: LLRBNode<K, V> | LLRBEmptyNode<K, V> | null\n  ): LLRBEmptyNode<K, V> {\n    return this;\n  }\n\n  /**\n   * Returns a copy of the tree, with the specified key/value added.\n   *\n   * @param {!K} key Key to be added.\n   * @param {!V} value Value to be added.\n   * @param {Comparator} comparator Comparator.\n   * @return {!LLRBNode} New tree, with item added.\n   */\n  insert(key: K, value: V, comparator: Comparator<K>): LLRBNode<K, V> {\n    return new LLRBNode(key, value, null);\n  }\n\n  /**\n   * Returns a copy of the tree, with the specified key removed.\n   *\n   * @param {!K} key The key to remove.\n   * @param {Comparator} comparator Comparator.\n   * @return {!LLRBEmptyNode} New tree, with item removed.\n   */\n  remove(key: K, comparator: Comparator<K>): LLRBEmptyNode<K, V> {\n    return this;\n  }\n\n  /**\n   * @return {number} The total number of nodes in the tree.\n   */\n  count(): number {\n    return 0;\n  }\n\n  /**\n   * @return {boolean} True if the tree is empty.\n   */\n  isEmpty(): boolean {\n    return true;\n  }\n\n  /**\n   * Traverses the tree in key order and calls the specified action function\n   * for each node.\n   *\n   * @param {function(!K, !V):*} action Callback function to be called for each\n   * node.  If it returns true, traversal is aborted.\n   * @return {boolean} True if traversal was aborted.\n   */\n  inorderTraversal(action: (k: K, v: V) => any): boolean {\n    return false;\n  }\n\n  /**\n   * Traverses the tree in reverse key order and calls the specified action function\n   * for each node.\n   *\n   * @param {function(!K, !V)} action Callback function to be called for each\n   * node.  If it returns true, traversal is aborted.\n   * @return {boolean} True if traversal was aborted.\n   */\n  reverseTraversal(action: (k: K, v: V) => void): boolean {\n    return false;\n  }\n\n  /**\n   * @return {null}\n   */\n  minKey(): null {\n    return null;\n  }\n\n  /**\n   * @return {null}\n   */\n  maxKey(): null {\n    return null;\n  }\n\n  /**\n   * @private\n   * @return {number} Not sure what this returns exactly. :-).\n   */\n  check_(): number {\n    return 0;\n  }\n\n  /**\n   * @private\n   * @return {boolean} Whether this node is red.\n   */\n  isRed_() {\n    return false;\n  }\n}\n\n/**\n * An immutable sorted map implementation, based on a Left-leaning Red-Black\n * tree.\n */\nexport class SortedMap<K, V> {\n  /**\n   * Always use the same empty node, to reduce memory.\n   * @const\n   */\n  static EMPTY_NODE = new LLRBEmptyNode();\n\n  /**\n   * @template K, V\n   * @param {function(K, K):number} comparator_ Key comparator.\n   * @param {LLRBNode=} root_ (Optional) Root node for the map.\n   */\n  constructor(\n    private comparator_: Comparator<K>,\n    private root_:\n      | LLRBNode<K, V>\n      | LLRBEmptyNode<K, V> = SortedMap.EMPTY_NODE as LLRBEmptyNode<K, V>\n  ) {}\n\n  /**\n   * Returns a copy of the map, with the specified key/value added or replaced.\n   * (TODO: We should perhaps rename this method to 'put')\n   *\n   * @param {!K} key Key to be added.\n   * @param {!V} value Value to be added.\n   * @return {!SortedMap.<K, V>} New map, with item added.\n   */\n  insert(key: K, value: V): SortedMap<K, V> {\n    return new SortedMap(\n      this.comparator_,\n      this.root_\n        .insert(key, value, this.comparator_)\n        .copy(null, null, LLRBNode.BLACK, null, null)\n    );\n  }\n\n  /**\n   * Returns a copy of the map, with the specified key removed.\n   *\n   * @param {!K} key The key to remove.\n   * @return {!SortedMap.<K, V>} New map, with item removed.\n   */\n  remove(key: K): SortedMap<K, V> {\n    return new SortedMap(\n      this.comparator_,\n      this.root_\n        .remove(key, this.comparator_)\n        .copy(null, null, LLRBNode.BLACK, null, null)\n    );\n  }\n\n  /**\n   * Returns the value of the node with the given key, or null.\n   *\n   * @param {!K} key The key to look up.\n   * @return {?V} The value of the node with the given key, or null if the\n   * key doesn't exist.\n   */\n  get(key: K): V | null {\n    let cmp;\n    let node = this.root_;\n    while (!node.isEmpty()) {\n      cmp = this.comparator_(key, node.key);\n      if (cmp === 0) {\n        return node.value;\n      } else if (cmp < 0) {\n        node = node.left;\n      } else if (cmp > 0) {\n        node = node.right;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Returns the key of the item *before* the specified key, or null if key is the first item.\n   * @param {K} key The key to find the predecessor of\n   * @return {?K} The predecessor key.\n   */\n  getPredecessorKey(key: K): K | null {\n    let cmp,\n      node = this.root_,\n      rightParent = null;\n    while (!node.isEmpty()) {\n      cmp = this.comparator_(key, node.key);\n      if (cmp === 0) {\n        if (!node.left.isEmpty()) {\n          node = node.left;\n          while (!node.right.isEmpty()) node = node.right;\n          return node.key;\n        } else if (rightParent) {\n          return rightParent.key;\n        } else {\n          return null; // first item.\n        }\n      } else if (cmp < 0) {\n        node = node.left;\n      } else if (cmp > 0) {\n        rightParent = node;\n        node = node.right;\n      }\n    }\n\n    throw new Error(\n      'Attempted to find predecessor key for a nonexistent key.  What gives?'\n    );\n  }\n\n  /**\n   * @return {boolean} True if the map is empty.\n   */\n  isEmpty(): boolean {\n    return this.root_.isEmpty();\n  }\n\n  /**\n   * @return {number} The total number of nodes in the map.\n   */\n  count(): number {\n    return this.root_.count();\n  }\n\n  /**\n   * @return {?K} The minimum key in the map.\n   */\n  minKey(): K | null {\n    return this.root_.minKey();\n  }\n\n  /**\n   * @return {?K} The maximum key in the map.\n   */\n  maxKey(): K | null {\n    return this.root_.maxKey();\n  }\n\n  /**\n   * Traverses the map in key order and calls the specified action function\n   * for each key/value pair.\n   *\n   * @param {function(!K, !V):*} action Callback function to be called\n   * for each key/value pair.  If action returns true, traversal is aborted.\n   * @return {*} The first truthy value returned by action, or the last falsey\n   *   value returned by action\n   */\n  inorderTraversal(action: (k: K, v: V) => any): boolean {\n    return this.root_.inorderTraversal(action);\n  }\n\n  /**\n   * Traverses the map in reverse key order and calls the specified action function\n   * for each key/value pair.\n   *\n   * @param {function(!Object, !Object)} action Callback function to be called\n   * for each key/value pair.  If action returns true, traversal is aborted.\n   * @return {*} True if the traversal was aborted.\n   */\n  reverseTraversal(action: (k: K, v: V) => void): boolean {\n    return this.root_.reverseTraversal(action);\n  }\n\n  /**\n   * Returns an iterator over the SortedMap.\n   * @template T\n   * @param {(function(K, V):T)=} resultGenerator\n   * @return {SortedMapIterator.<K, V, T>} The iterator.\n   */\n  getIterator<T>(\n    resultGenerator?: (k: K, v: V) => T\n  ): SortedMapIterator<K, V, T> {\n    return new SortedMapIterator(\n      this.root_,\n      null,\n      this.comparator_,\n      false,\n      resultGenerator\n    );\n  }\n\n  getIteratorFrom<T>(\n    key: K,\n    resultGenerator?: (k: K, v: V) => T\n  ): SortedMapIterator<K, V, T> {\n    return new SortedMapIterator(\n      this.root_,\n      key,\n      this.comparator_,\n      false,\n      resultGenerator\n    );\n  }\n\n  getReverseIteratorFrom<T>(\n    key: K,\n    resultGenerator?: (k: K, v: V) => T\n  ): SortedMapIterator<K, V, T> {\n    return new SortedMapIterator(\n      this.root_,\n      key,\n      this.comparator_,\n      true,\n      resultGenerator\n    );\n  }\n\n  getReverseIterator<T>(\n    resultGenerator?: (k: K, v: V) => T\n  ): SortedMapIterator<K, V, T> {\n    return new SortedMapIterator(\n      this.root_,\n      null,\n      this.comparator_,\n      true,\n      resultGenerator\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { LLRBNode } from '../util/SortedMap';\nimport { SortedMap } from '../util/SortedMap';\nimport { NamedNode } from './Node';\n\nconst LOG_2 = Math.log(2);\n\n/**\n * @constructor\n */\nclass Base12Num {\n  count: number;\n  private current_: number;\n  private bits_: number;\n\n  /**\n   * @param {number} length\n   */\n  constructor(length: number) {\n    const logBase2 = (num: number) =>\n      parseInt((Math.log(num) / LOG_2) as any, 10);\n    const bitMask = (bits: number) => parseInt(Array(bits + 1).join('1'), 2);\n    this.count = logBase2(length + 1);\n    this.current_ = this.count - 1;\n    const mask = bitMask(this.count);\n    this.bits_ = (length + 1) & mask;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  nextBitIsOne(): boolean {\n    //noinspection JSBitwiseOperatorUsage\n    const result = !(this.bits_ & (0x1 << this.current_));\n    this.current_--;\n    return result;\n  }\n}\n\n/**\n * Takes a list of child nodes and constructs a SortedSet using the given comparison\n * function\n *\n * Uses the algorithm described in the paper linked here:\n * http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.46.1458\n *\n * @template K, V\n * @param {Array.<!NamedNode>} childList Unsorted list of children\n * @param {function(!NamedNode, !NamedNode):number} cmp The comparison method to be used\n * @param {(function(NamedNode):K)=} keyFn An optional function to extract K from a node wrapper, if K's\n *                                                        type is not NamedNode\n * @param {(function(K, K):number)=} mapSortFn An optional override for comparator used by the generated sorted map\n * @return {SortedMap.<K, V>}\n */\nexport const buildChildSet = function<K, V>(\n  childList: NamedNode[],\n  cmp: (a: NamedNode, b: NamedNode) => number,\n  keyFn?: (a: NamedNode) => K,\n  mapSortFn?: (a: K, b: K) => number\n): SortedMap<K, V> {\n  childList.sort(cmp);\n\n  const buildBalancedTree = function(\n    low: number,\n    high: number\n  ): LLRBNode<K, V> | null {\n    const length = high - low;\n    let namedNode: NamedNode;\n    let key: K;\n    if (length == 0) {\n      return null;\n    } else if (length == 1) {\n      namedNode = childList[low];\n      key = keyFn ? keyFn(namedNode) : ((namedNode as any) as K);\n      return new LLRBNode(\n        key,\n        (namedNode.node as any) as V,\n        LLRBNode.BLACK,\n        null,\n        null\n      );\n    } else {\n      const middle = parseInt((length / 2) as any, 10) + low;\n      const left = buildBalancedTree(low, middle);\n      const right = buildBalancedTree(middle + 1, high);\n      namedNode = childList[middle];\n      key = keyFn ? keyFn(namedNode) : ((namedNode as any) as K);\n      return new LLRBNode(\n        key,\n        (namedNode.node as any) as V,\n        LLRBNode.BLACK,\n        left,\n        right\n      );\n    }\n  };\n\n  const buildFrom12Array = function(base12: Base12Num): LLRBNode<K, V> {\n    let node: LLRBNode<K, V> = null;\n    let root = null;\n    let index = childList.length;\n\n    const buildPennant = function(chunkSize: number, color: boolean) {\n      const low = index - chunkSize;\n      const high = index;\n      index -= chunkSize;\n      const childTree = buildBalancedTree(low + 1, high);\n      const namedNode = childList[low];\n      const key: K = keyFn ? keyFn(namedNode) : ((namedNode as any) as K);\n      attachPennant(\n        new LLRBNode(key, (namedNode.node as any) as V, color, null, childTree)\n      );\n    };\n\n    const attachPennant = function(pennant: LLRBNode<K, V>) {\n      if (node) {\n        node.left = pennant;\n        node = pennant;\n      } else {\n        root = pennant;\n        node = pennant;\n      }\n    };\n\n    for (let i = 0; i < base12.count; ++i) {\n      const isOne = base12.nextBitIsOne();\n      // The number of nodes taken in each slice is 2^(arr.length - (i + 1))\n      const chunkSize = Math.pow(2, base12.count - (i + 1));\n      if (isOne) {\n        buildPennant(chunkSize, LLRBNode.BLACK);\n      } else {\n        // current == 2\n        buildPennant(chunkSize, LLRBNode.BLACK);\n        buildPennant(chunkSize, LLRBNode.RED);\n      }\n    }\n    return root;\n  };\n\n  const base12 = new Base12Num(childList.length);\n  const root = buildFrom12Array(base12);\n\n  return new SortedMap<K, V>(mapSortFn || (cmp as any), root);\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { nameCompare } from '../util/util';\nimport { NamedNode } from './Node';\n\nexport function NAME_ONLY_COMPARATOR(left: NamedNode, right: NamedNode) {\n  return nameCompare(left.name, right.name);\n}\n\nexport function NAME_COMPARATOR(left: string, right: string) {\n  return nameCompare(left, right);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ChildrenNode } from './ChildrenNode';\nimport { LeafNode } from './LeafNode';\nimport { NamedNode, Node } from './Node';\nimport { contains } from '@firebase/util';\nimport { assert } from '@firebase/util';\nimport { buildChildSet } from './childSet';\nimport { NAME_COMPARATOR, NAME_ONLY_COMPARATOR } from './comparators';\nimport { IndexMap } from './IndexMap';\nimport { PRIORITY_INDEX, setNodeFromJSON } from './indexes/PriorityIndex';\nimport { SortedMap } from '../util/SortedMap';\nimport { each } from '../util/util';\n\nconst USE_HINZE = true;\n\n/**\n * Constructs a snapshot node representing the passed JSON and returns it.\n * @param {*} json JSON to create a node for.\n * @param {?string|?number=} priority Optional priority to use.  This will be ignored if the\n * passed JSON contains a .priority property.\n * @return {!Node}\n */\nexport function nodeFromJSON(\n  json: any | null,\n  priority: string | number | null = null\n): Node {\n  if (json === null) {\n    return ChildrenNode.EMPTY_NODE;\n  }\n\n  if (typeof json === 'object' && '.priority' in json) {\n    priority = json['.priority'];\n  }\n\n  assert(\n    priority === null ||\n      typeof priority === 'string' ||\n      typeof priority === 'number' ||\n      (typeof priority === 'object' && '.sv' in (priority as object)),\n    'Invalid priority type found: ' + typeof priority\n  );\n\n  if (typeof json === 'object' && '.value' in json && json['.value'] !== null) {\n    json = json['.value'];\n  }\n\n  // Valid leaf nodes include non-objects or server-value wrapper objects\n  if (typeof json !== 'object' || '.sv' in json) {\n    const jsonLeaf = json as string | number | boolean | object;\n    return new LeafNode(jsonLeaf, nodeFromJSON(priority));\n  }\n\n  if (!(json instanceof Array) && USE_HINZE) {\n    const children: NamedNode[] = [];\n    let childrenHavePriority = false;\n    const hinzeJsonObj: { [k: string]: any } = json;\n    each(hinzeJsonObj, (key, child) => {\n      if (key.substring(0, 1) !== '.') {\n        // Ignore metadata nodes\n        const childNode = nodeFromJSON(child);\n        if (!childNode.isEmpty()) {\n          childrenHavePriority =\n            childrenHavePriority || !childNode.getPriority().isEmpty();\n          children.push(new NamedNode(key, childNode));\n        }\n      }\n    });\n\n    if (children.length == 0) {\n      return ChildrenNode.EMPTY_NODE;\n    }\n\n    const childSet = buildChildSet(\n      children,\n      NAME_ONLY_COMPARATOR,\n      namedNode => namedNode.name,\n      NAME_COMPARATOR\n    ) as SortedMap<string, Node>;\n    if (childrenHavePriority) {\n      const sortedChildSet = buildChildSet(\n        children,\n        PRIORITY_INDEX.getCompare()\n      );\n      return new ChildrenNode(\n        childSet,\n        nodeFromJSON(priority),\n        new IndexMap(\n          { '.priority': sortedChildSet },\n          { '.priority': PRIORITY_INDEX }\n        )\n      );\n    } else {\n      return new ChildrenNode(\n        childSet,\n        nodeFromJSON(priority),\n        IndexMap.Default\n      );\n    }\n  } else {\n    let node: Node = ChildrenNode.EMPTY_NODE;\n    each(json, (key: string, childData: any) => {\n      if (contains(json, key)) {\n        if (key.substring(0, 1) !== '.') {\n          // ignore metadata nodes.\n          const childNode = nodeFromJSON(childData);\n          if (childNode.isLeafNode() || !childNode.isEmpty())\n            node = node.updateImmediateChild(key, childNode);\n        }\n      }\n    });\n\n    return node.updatePriority(nodeFromJSON(priority));\n  }\n}\n\nsetNodeFromJSON(nodeFromJSON);\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Index } from './Index';\nimport { NamedNode, Node } from '../Node';\nimport { nameCompare } from '../../util/util';\nimport { nodeFromJSON } from '../nodeFromJSON';\n\n/**\n * @constructor\n * @extends {Index}\n * @private\n */\nexport class ValueIndex extends Index {\n  /**\n   * @inheritDoc\n   */\n  compare(a: NamedNode, b: NamedNode): number {\n    const indexCmp = a.node.compareTo(b.node);\n    if (indexCmp === 0) {\n      return nameCompare(a.name, b.name);\n    } else {\n      return indexCmp;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isDefinedOn(node: Node): boolean {\n    return true;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  indexedValueChanged(oldNode: Node, newNode: Node): boolean {\n    return !oldNode.equals(newNode);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  minPost(): NamedNode {\n    return (NamedNode as any).MIN;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  maxPost(): NamedNode {\n    return (NamedNode as any).MAX;\n  }\n\n  /**\n   * @param {*} indexValue\n   * @param {string} name\n   * @return {!NamedNode}\n   */\n  makePost(indexValue: object, name: string): NamedNode {\n    const valueNode = nodeFromJSON(indexValue);\n    return new NamedNode(name, valueNode);\n  }\n\n  /**\n   * @return {!string} String representation for inclusion in a query spec\n   */\n  toString(): string {\n    return '.value';\n  }\n}\n\nexport const VALUE_INDEX = new ValueIndex();\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { KEY_INDEX } from '../core/snap/indexes/KeyIndex';\nimport { PRIORITY_INDEX } from '../core/snap/indexes/PriorityIndex';\nimport { VALUE_INDEX } from '../core/snap/indexes/ValueIndex';\nimport { PathIndex } from '../core/snap/indexes/PathIndex';\nimport { MIN_NAME, MAX_NAME, ObjectToUniqueKey } from '../core/util/util';\nimport { Path } from '../core/util/Path';\nimport {\n  isValidPriority,\n  validateEventType,\n  validatePathString,\n  validateFirebaseDataArg,\n  validateKey\n} from '../core/util/validation';\nimport {\n  errorPrefix,\n  validateArgCount,\n  validateCallback,\n  validateContextObject\n} from '@firebase/util';\nimport {\n  ValueEventRegistration,\n  ChildEventRegistration,\n  EventRegistration\n} from '../core/view/EventRegistration';\nimport { Deferred } from '@firebase/util';\nimport { Repo } from '../core/Repo';\nimport { QueryParams } from '../core/view/QueryParams';\nimport { Reference } from './Reference';\nimport { DataSnapshot } from './DataSnapshot';\n\nlet __referenceConstructor: new (repo: Repo, path: Path) => Query;\n\nexport interface SnapshotCallback {\n  (a: DataSnapshot, b?: string | null): any;\n}\n\n/**\n * A Query represents a filter to be applied to a firebase location.  This object purely represents the\n * query expression (and exposes our public API to build the query).  The actual query logic is in ViewBase.js.\n *\n * Since every Firebase reference is a query, Firebase inherits from this object.\n */\nexport class Query {\n  static set __referenceConstructor(val) {\n    __referenceConstructor = val;\n  }\n\n  static get __referenceConstructor() {\n    assert(__referenceConstructor, 'Reference.ts has not been loaded');\n    return __referenceConstructor;\n  }\n\n  constructor(\n    public repo: Repo,\n    public path: Path,\n    private queryParams_: QueryParams,\n    private orderByCalled_: boolean\n  ) {}\n\n  /**\n   * Validates start/end values for queries.\n   * @param {!QueryParams} params\n   * @private\n   */\n  private static validateQueryEndpoints_(params: QueryParams) {\n    let startNode = null;\n    let endNode = null;\n    if (params.hasStart()) {\n      startNode = params.getIndexStartValue();\n    }\n    if (params.hasEnd()) {\n      endNode = params.getIndexEndValue();\n    }\n\n    if (params.getIndex() === KEY_INDEX) {\n      const tooManyArgsError =\n        'Query: When ordering by key, you may only pass one argument to ' +\n        'startAt(), endAt(), or equalTo().';\n      const wrongArgTypeError =\n        'Query: When ordering by key, the argument passed to startAt(), endAt(),' +\n        'or equalTo() must be a string.';\n      if (params.hasStart()) {\n        const startName = params.getIndexStartName();\n        if (startName != MIN_NAME) {\n          throw new Error(tooManyArgsError);\n        } else if (typeof startNode !== 'string') {\n          throw new Error(wrongArgTypeError);\n        }\n      }\n      if (params.hasEnd()) {\n        const endName = params.getIndexEndName();\n        if (endName != MAX_NAME) {\n          throw new Error(tooManyArgsError);\n        } else if (typeof endNode !== 'string') {\n          throw new Error(wrongArgTypeError);\n        }\n      }\n    } else if (params.getIndex() === PRIORITY_INDEX) {\n      if (\n        (startNode != null && !isValidPriority(startNode)) ||\n        (endNode != null && !isValidPriority(endNode))\n      ) {\n        throw new Error(\n          'Query: When ordering by priority, the first argument passed to startAt(), ' +\n            'endAt(), or equalTo() must be a valid priority value (null, a number, or a string).'\n        );\n      }\n    } else {\n      assert(\n        params.getIndex() instanceof PathIndex ||\n          params.getIndex() === VALUE_INDEX,\n        'unknown index type.'\n      );\n      if (\n        (startNode != null && typeof startNode === 'object') ||\n        (endNode != null && typeof endNode === 'object')\n      ) {\n        throw new Error(\n          'Query: First argument passed to startAt(), endAt(), or equalTo() cannot be ' +\n            'an object.'\n        );\n      }\n    }\n  }\n\n  /**\n   * Validates that limit* has been called with the correct combination of parameters\n   * @param {!QueryParams} params\n   * @private\n   */\n  private static validateLimit_(params: QueryParams) {\n    if (\n      params.hasStart() &&\n      params.hasEnd() &&\n      params.hasLimit() &&\n      !params.hasAnchoredLimit()\n    ) {\n      throw new Error(\n        \"Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.\"\n      );\n    }\n  }\n\n  /**\n   * Validates that no other order by call has been made\n   * @param {!string} fnName\n   * @private\n   */\n  private validateNoPreviousOrderByCall_(fnName: string) {\n    if (this.orderByCalled_ === true) {\n      throw new Error(fnName + \": You can't combine multiple orderBy calls.\");\n    }\n  }\n\n  /**\n   * @return {!QueryParams}\n   */\n  getQueryParams(): QueryParams {\n    return this.queryParams_;\n  }\n\n  /**\n   * @return {!Reference}\n   */\n  getRef(): Reference {\n    validateArgCount('Query.ref', 0, 0, arguments.length);\n    // This is a slight hack. We cannot goog.require('fb.api.Firebase'), since Firebase requires fb.api.Query.\n    // However, we will always export 'Firebase' to the global namespace, so it's guaranteed to exist by the time this\n    // method gets called.\n    return new Query.__referenceConstructor(this.repo, this.path) as Reference;\n  }\n\n  /**\n   * @param {!string} eventType\n   * @param {!function(DataSnapshot, string=)} callback\n   * @param {(function(Error)|Object)=} cancelCallbackOrContext\n   * @param {Object=} context\n   * @return {!function(DataSnapshot, string=)}\n   */\n  on(\n    eventType: string,\n    callback: SnapshotCallback,\n    cancelCallbackOrContext?: ((a: Error) => any) | Object | null,\n    context?: Object | null\n  ): SnapshotCallback {\n    validateArgCount('Query.on', 2, 4, arguments.length);\n    validateEventType('Query.on', 1, eventType, false);\n    validateCallback('Query.on', 2, callback, false);\n\n    const ret = Query.getCancelAndContextArgs_(\n      'Query.on',\n      cancelCallbackOrContext,\n      context\n    );\n\n    if (eventType === 'value') {\n      this.onValueEvent(callback, ret.cancel, ret.context);\n    } else {\n      const callbacks: { [k: string]: typeof callback } = {};\n      callbacks[eventType] = callback;\n      this.onChildEvent(callbacks, ret.cancel, ret.context);\n    }\n    return callback;\n  }\n\n  /**\n   * @param {!function(!DataSnapshot)} callback\n   * @param {?function(Error)} cancelCallback\n   * @param {?Object} context\n   * @protected\n   */\n  protected onValueEvent(\n    callback: (a: DataSnapshot) => void,\n    cancelCallback: ((a: Error) => void) | null,\n    context: Object | null\n  ) {\n    const container = new ValueEventRegistration(\n      callback,\n      cancelCallback || null,\n      context || null\n    );\n    this.repo.addEventCallbackForQuery(this, container);\n  }\n\n  /**\n   * @param {!Object.<string, !function(!DataSnapshot, ?string)>} callbacks\n   * @param {?function(Error)} cancelCallback\n   * @param {?Object} context\n   * @protected\n   */\n  onChildEvent(\n    callbacks: { [k: string]: SnapshotCallback },\n    cancelCallback: ((a: Error) => any) | null,\n    context: Object | null\n  ) {\n    const container = new ChildEventRegistration(\n      callbacks,\n      cancelCallback,\n      context\n    );\n    this.repo.addEventCallbackForQuery(this, container);\n  }\n\n  /**\n   * @param {string=} eventType\n   * @param {(function(!DataSnapshot, ?string=))=} callback\n   * @param {Object=} context\n   */\n  off(\n    eventType?: string,\n    callback?: SnapshotCallback,\n    context?: Object | null\n  ): void {\n    validateArgCount('Query.off', 0, 3, arguments.length);\n    validateEventType('Query.off', 1, eventType, true);\n    validateCallback('Query.off', 2, callback, true);\n    validateContextObject('Query.off', 3, context, true);\n\n    let container: EventRegistration | null = null;\n    let callbacks: { [k: string]: typeof callback } | null = null;\n    if (eventType === 'value') {\n      const valueCallback = callback || null;\n      container = new ValueEventRegistration(\n        valueCallback,\n        null,\n        context || null\n      );\n    } else if (eventType) {\n      if (callback) {\n        callbacks = {};\n        callbacks[eventType] = callback;\n      }\n      container = new ChildEventRegistration(callbacks, null, context || null);\n    }\n    this.repo.removeEventCallbackForQuery(this, container);\n  }\n\n  /**\n   * Attaches a listener, waits for the first event, and then removes the listener\n   * @param {!string} eventType\n   * @param {!function(!DataSnapshot, string=)} userCallback\n   * @param failureCallbackOrContext\n   * @param context\n   * @return {!firebase.Promise}\n   */\n  once(\n    eventType: string,\n    userCallback?: SnapshotCallback,\n    failureCallbackOrContext?: ((a: Error) => void) | Object | null,\n    context?: Object | null\n  ): Promise<DataSnapshot> {\n    validateArgCount('Query.once', 1, 4, arguments.length);\n    validateEventType('Query.once', 1, eventType, false);\n    validateCallback('Query.once', 2, userCallback, true);\n\n    const ret = Query.getCancelAndContextArgs_(\n      'Query.once',\n      failureCallbackOrContext,\n      context\n    );\n\n    // TODO: Implement this more efficiently (in particular, use 'get' wire protocol for 'value' event)\n    // TODO: consider actually wiring the callbacks into the promise. We cannot do this without a breaking change\n    // because the API currently expects callbacks will be called synchronously if the data is cached, but this is\n    // against the Promise specification.\n    let firstCall = true;\n    const deferred = new Deferred<DataSnapshot>();\n\n    // A dummy error handler in case a user wasn't expecting promises\n    deferred.promise.catch(() => {});\n\n    const onceCallback = (snapshot: DataSnapshot) => {\n      // NOTE: Even though we unsubscribe, we may get called multiple times if a single action (e.g. set() with JSON)\n      // triggers multiple events (e.g. child_added or child_changed).\n      if (firstCall) {\n        firstCall = false;\n        this.off(eventType, onceCallback);\n\n        if (userCallback) {\n          userCallback.bind(ret.context)(snapshot);\n        }\n        deferred.resolve(snapshot);\n      }\n    };\n\n    this.on(\n      eventType,\n      onceCallback,\n      /*cancel=*/ err => {\n        this.off(eventType, onceCallback);\n\n        if (ret.cancel) ret.cancel.bind(ret.context)(err);\n        deferred.reject(err);\n      }\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * Set a limit and anchor it to the start of the window.\n   * @param {!number} limit\n   * @return {!Query}\n   */\n  limitToFirst(limit: number): Query {\n    validateArgCount('Query.limitToFirst', 1, 1, arguments.length);\n    if (\n      typeof limit !== 'number' ||\n      Math.floor(limit) !== limit ||\n      limit <= 0\n    ) {\n      throw new Error(\n        'Query.limitToFirst: First argument must be a positive integer.'\n      );\n    }\n    if (this.queryParams_.hasLimit()) {\n      throw new Error(\n        'Query.limitToFirst: Limit was already set (by another call to limit, ' +\n          'limitToFirst, or limitToLast).'\n      );\n    }\n\n    return new Query(\n      this.repo,\n      this.path,\n      this.queryParams_.limitToFirst(limit),\n      this.orderByCalled_\n    );\n  }\n\n  /**\n   * Set a limit and anchor it to the end of the window.\n   * @param {!number} limit\n   * @return {!Query}\n   */\n  limitToLast(limit: number): Query {\n    validateArgCount('Query.limitToLast', 1, 1, arguments.length);\n    if (\n      typeof limit !== 'number' ||\n      Math.floor(limit) !== limit ||\n      limit <= 0\n    ) {\n      throw new Error(\n        'Query.limitToLast: First argument must be a positive integer.'\n      );\n    }\n    if (this.queryParams_.hasLimit()) {\n      throw new Error(\n        'Query.limitToLast: Limit was already set (by another call to limit, ' +\n          'limitToFirst, or limitToLast).'\n      );\n    }\n\n    return new Query(\n      this.repo,\n      this.path,\n      this.queryParams_.limitToLast(limit),\n      this.orderByCalled_\n    );\n  }\n\n  /**\n   * Given a child path, return a new query ordered by the specified grandchild path.\n   * @param {!string} path\n   * @return {!Query}\n   */\n  orderByChild(path: string): Query {\n    validateArgCount('Query.orderByChild', 1, 1, arguments.length);\n    if (path === '$key') {\n      throw new Error(\n        'Query.orderByChild: \"$key\" is invalid.  Use Query.orderByKey() instead.'\n      );\n    } else if (path === '$priority') {\n      throw new Error(\n        'Query.orderByChild: \"$priority\" is invalid.  Use Query.orderByPriority() instead.'\n      );\n    } else if (path === '$value') {\n      throw new Error(\n        'Query.orderByChild: \"$value\" is invalid.  Use Query.orderByValue() instead.'\n      );\n    }\n    validatePathString('Query.orderByChild', 1, path, false);\n    this.validateNoPreviousOrderByCall_('Query.orderByChild');\n    const parsedPath = new Path(path);\n    if (parsedPath.isEmpty()) {\n      throw new Error(\n        'Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.'\n      );\n    }\n    const index = new PathIndex(parsedPath);\n    const newParams = this.queryParams_.orderBy(index);\n    Query.validateQueryEndpoints_(newParams);\n\n    return new Query(this.repo, this.path, newParams, /*orderByCalled=*/ true);\n  }\n\n  /**\n   * Return a new query ordered by the KeyIndex\n   * @return {!Query}\n   */\n  orderByKey(): Query {\n    validateArgCount('Query.orderByKey', 0, 0, arguments.length);\n    this.validateNoPreviousOrderByCall_('Query.orderByKey');\n    const newParams = this.queryParams_.orderBy(KEY_INDEX);\n    Query.validateQueryEndpoints_(newParams);\n    return new Query(this.repo, this.path, newParams, /*orderByCalled=*/ true);\n  }\n\n  /**\n   * Return a new query ordered by the PriorityIndex\n   * @return {!Query}\n   */\n  orderByPriority(): Query {\n    validateArgCount('Query.orderByPriority', 0, 0, arguments.length);\n    this.validateNoPreviousOrderByCall_('Query.orderByPriority');\n    const newParams = this.queryParams_.orderBy(PRIORITY_INDEX);\n    Query.validateQueryEndpoints_(newParams);\n    return new Query(this.repo, this.path, newParams, /*orderByCalled=*/ true);\n  }\n\n  /**\n   * Return a new query ordered by the ValueIndex\n   * @return {!Query}\n   */\n  orderByValue(): Query {\n    validateArgCount('Query.orderByValue', 0, 0, arguments.length);\n    this.validateNoPreviousOrderByCall_('Query.orderByValue');\n    const newParams = this.queryParams_.orderBy(VALUE_INDEX);\n    Query.validateQueryEndpoints_(newParams);\n    return new Query(this.repo, this.path, newParams, /*orderByCalled=*/ true);\n  }\n\n  /**\n   * @param {number|string|boolean|null} value\n   * @param {?string=} name\n   * @return {!Query}\n   */\n  startAt(\n    value: number | string | boolean | null = null,\n    name?: string | null\n  ): Query {\n    validateArgCount('Query.startAt', 0, 2, arguments.length);\n    validateFirebaseDataArg('Query.startAt', 1, value, this.path, true);\n    validateKey('Query.startAt', 2, name, true);\n\n    const newParams = this.queryParams_.startAt(value, name);\n    Query.validateLimit_(newParams);\n    Query.validateQueryEndpoints_(newParams);\n    if (this.queryParams_.hasStart()) {\n      throw new Error(\n        'Query.startAt: Starting point was already set (by another call to startAt ' +\n          'or equalTo).'\n      );\n    }\n\n    // Calling with no params tells us to start at the beginning.\n    if (value === undefined) {\n      value = null;\n      name = null;\n    }\n    return new Query(this.repo, this.path, newParams, this.orderByCalled_);\n  }\n\n  /**\n   * @param {number|string|boolean|null} value\n   * @param {?string=} name\n   * @return {!Query}\n   */\n  endAt(\n    value: number | string | boolean | null = null,\n    name?: string | null\n  ): Query {\n    validateArgCount('Query.endAt', 0, 2, arguments.length);\n    validateFirebaseDataArg('Query.endAt', 1, value, this.path, true);\n    validateKey('Query.endAt', 2, name, true);\n\n    const newParams = this.queryParams_.endAt(value, name);\n    Query.validateLimit_(newParams);\n    Query.validateQueryEndpoints_(newParams);\n    if (this.queryParams_.hasEnd()) {\n      throw new Error(\n        'Query.endAt: Ending point was already set (by another call to endAt or ' +\n          'equalTo).'\n      );\n    }\n\n    return new Query(this.repo, this.path, newParams, this.orderByCalled_);\n  }\n\n  /**\n   * Load the selection of children with exactly the specified value, and, optionally,\n   * the specified name.\n   * @param {number|string|boolean|null} value\n   * @param {string=} name\n   * @return {!Query}\n   */\n  equalTo(value: number | string | boolean | null, name?: string) {\n    validateArgCount('Query.equalTo', 1, 2, arguments.length);\n    validateFirebaseDataArg('Query.equalTo', 1, value, this.path, false);\n    validateKey('Query.equalTo', 2, name, true);\n    if (this.queryParams_.hasStart()) {\n      throw new Error(\n        'Query.equalTo: Starting point was already set (by another call to startAt or ' +\n          'equalTo).'\n      );\n    }\n    if (this.queryParams_.hasEnd()) {\n      throw new Error(\n        'Query.equalTo: Ending point was already set (by another call to endAt or ' +\n          'equalTo).'\n      );\n    }\n    return this.startAt(value, name).endAt(value, name);\n  }\n\n  /**\n   * @return {!string} URL for this location.\n   */\n  toString(): string {\n    validateArgCount('Query.toString', 0, 0, arguments.length);\n\n    return this.repo.toString() + this.path.toUrlEncodedString();\n  }\n\n  // Do not create public documentation. This is intended to make JSON serialization work but is otherwise unnecessary\n  // for end-users.\n  toJSON() {\n    // An optional spacer argument is unnecessary for a string.\n    validateArgCount('Query.toJSON', 0, 1, arguments.length);\n    return this.toString();\n  }\n\n  /**\n   * An object representation of the query parameters used by this Query.\n   * @return {!Object}\n   */\n  queryObject(): Object {\n    return this.queryParams_.getQueryObject();\n  }\n\n  /**\n   * @return {!string}\n   */\n  queryIdentifier(): string {\n    const obj = this.queryObject();\n    const id = ObjectToUniqueKey(obj);\n    return id === '{}' ? 'default' : id;\n  }\n\n  /**\n   * Return true if this query and the provided query are equivalent; otherwise, return false.\n   * @param {Query} other\n   * @return {boolean}\n   */\n  isEqual(other: Query): boolean {\n    validateArgCount('Query.isEqual', 1, 1, arguments.length);\n    if (!(other instanceof Query)) {\n      const error =\n        'Query.isEqual failed: First argument must be an instance of firebase.database.Query.';\n      throw new Error(error);\n    }\n\n    const sameRepo = this.repo === other.repo;\n    const samePath = this.path.equals(other.path);\n    const sameQueryIdentifier =\n      this.queryIdentifier() === other.queryIdentifier();\n\n    return sameRepo && samePath && sameQueryIdentifier;\n  }\n\n  /**\n   * Helper used by .on and .once to extract the context and or cancel arguments.\n   * @param {!string} fnName The function name (on or once)\n   * @param {(function(Error)|Object)=} cancelOrContext\n   * @param {Object=} context\n   * @return {{cancel: ?function(Error), context: ?Object}}\n   * @private\n   */\n  private static getCancelAndContextArgs_(\n    fnName: string,\n    cancelOrContext?: ((a: Error) => void) | Object | null,\n    context?: Object | null\n  ): { cancel: ((a: Error) => void) | null; context: Object | null } {\n    const ret: {\n      cancel: ((a: Error) => void) | null;\n      context: Object | null;\n    } = { cancel: null, context: null };\n    if (cancelOrContext && context) {\n      ret.cancel = cancelOrContext as (a: Error) => void;\n      validateCallback(fnName, 3, ret.cancel, true);\n\n      ret.context = context;\n      validateContextObject(fnName, 4, ret.context, true);\n    } else if (cancelOrContext) {\n      // we have either a cancel callback or a context.\n      if (typeof cancelOrContext === 'object' && cancelOrContext !== null) {\n        // it's a context!\n        ret.context = cancelOrContext;\n      } else if (typeof cancelOrContext === 'function') {\n        ret.cancel = cancelOrContext as (a: Error) => void;\n      } else {\n        throw new Error(\n          errorPrefix(fnName, 3, true) +\n            ' must either be a cancel callback or a context object.'\n        );\n      }\n    }\n    return ret;\n  }\n\n  get ref(): Reference {\n    return this.getRef();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { Path } from '../util/Path';\n\n/**\n *\n * @enum\n */\nexport enum OperationType {\n  OVERWRITE,\n  MERGE,\n  ACK_USER_WRITE,\n  LISTEN_COMPLETE\n}\n\n/**\n * @interface\n */\nexport interface Operation {\n  /**\n   * @type {!OperationSource}\n   */\n  source: OperationSource;\n\n  /**\n   * @type {!OperationType}\n   */\n  type: OperationType;\n\n  /**\n   * @type {!Path}\n   */\n  path: Path;\n\n  /**\n   * @param {string} childName\n   * @return {?Operation}\n   */\n  operationForChild(childName: string): Operation | null;\n}\n\n/**\n * @param {boolean} fromUser\n * @param {boolean} fromServer\n * @param {?string} queryId\n * @param {boolean} tagged\n * @constructor\n */\nexport class OperationSource {\n  constructor(\n    public fromUser: boolean,\n    public fromServer: boolean,\n    public queryId: string | null,\n    public tagged: boolean\n  ) {\n    assert(!tagged || fromServer, 'Tagged queries must be from server.');\n  }\n  /**\n   * @const\n   * @type {!OperationSource}\n   */\n  static User = new OperationSource(\n    /*fromUser=*/ true,\n    false,\n    null,\n    /*tagged=*/ false\n  );\n\n  /**\n   * @const\n   * @type {!OperationSource}\n   */\n  static Server = new OperationSource(\n    false,\n    /*fromServer=*/ true,\n    null,\n    /*tagged=*/ false\n  );\n\n  /**\n   * @param {string} queryId\n   * @return {!OperationSource}\n   */\n  static forServerTaggedQuery = function(queryId: string): OperationSource {\n    return new OperationSource(\n      false,\n      /*fromServer=*/ true,\n      queryId,\n      /*tagged=*/ true\n    );\n  };\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { nameCompare, MAX_NAME } from '../../util/util';\nimport { Index } from './Index';\nimport { ChildrenNode, MAX_NODE } from '../ChildrenNode';\nimport { NamedNode, Node } from '../Node';\nimport { nodeFromJSON } from '../nodeFromJSON';\nimport { Path } from '../../util/Path';\n\n/**\n * @param {!Path} indexPath\n * @constructor\n * @extends {Index}\n */\nexport class PathIndex extends Index {\n  constructor(private indexPath_: Path) {\n    super();\n\n    assert(\n      !indexPath_.isEmpty() && indexPath_.getFront() !== '.priority',\n      \"Can't create PathIndex with empty path or .priority key\"\n    );\n  }\n\n  /**\n   * @param {!Node} snap\n   * @return {!Node}\n   * @protected\n   */\n  protected extractChild(snap: Node): Node {\n    return snap.getChild(this.indexPath_);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isDefinedOn(node: Node): boolean {\n    return !node.getChild(this.indexPath_).isEmpty();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  compare(a: NamedNode, b: NamedNode): number {\n    const aChild = this.extractChild(a.node);\n    const bChild = this.extractChild(b.node);\n    const indexCmp = aChild.compareTo(bChild);\n    if (indexCmp === 0) {\n      return nameCompare(a.name, b.name);\n    } else {\n      return indexCmp;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  makePost(indexValue: object, name: string): NamedNode {\n    const valueNode = nodeFromJSON(indexValue);\n    const node = ChildrenNode.EMPTY_NODE.updateChild(\n      this.indexPath_,\n      valueNode\n    );\n    return new NamedNode(name, node);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  maxPost(): NamedNode {\n    const node = ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_, MAX_NODE);\n    return new NamedNode(MAX_NAME, node);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  toString(): string {\n    return this.indexPath_.slice().join('/');\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { validateArgCount, validateCallback } from '@firebase/util';\nimport { validatePathString } from '../core/util/validation';\nimport { Path } from '../core/util/Path';\nimport { PRIORITY_INDEX } from '../core/snap/indexes/PriorityIndex';\nimport { Node } from '../core/snap/Node';\nimport { Reference } from './Reference';\nimport { Index } from '../core/snap/indexes/Index';\nimport { ChildrenNode } from '../core/snap/ChildrenNode';\n\n/**\n * Class representing a firebase data snapshot.  It wraps a SnapshotNode and\n * surfaces the public methods (val, forEach, etc.) we want to expose.\n */\nexport class DataSnapshot {\n  /**\n   * @param {!Node} node_ A SnapshotNode to wrap.\n   * @param {!Reference} ref_ The ref of the location this snapshot came from.\n   * @param {!Index} index_ The iteration order for this snapshot\n   */\n  constructor(\n    private readonly node_: Node,\n    private readonly ref_: Reference,\n    private readonly index_: Index\n  ) {}\n\n  /**\n   * Retrieves the snapshot contents as JSON.  Returns null if the snapshot is\n   * empty.\n   *\n   * @return {*} JSON representation of the DataSnapshot contents, or null if empty.\n   */\n  val(): any {\n    validateArgCount('DataSnapshot.val', 0, 0, arguments.length);\n    return this.node_.val();\n  }\n\n  /**\n   * Returns the snapshot contents as JSON, including priorities of node.  Suitable for exporting\n   * the entire node contents.\n   * @return {*} JSON representation of the DataSnapshot contents, or null if empty.\n   */\n  exportVal(): any {\n    validateArgCount('DataSnapshot.exportVal', 0, 0, arguments.length);\n    return this.node_.val(true);\n  }\n\n  // Do not create public documentation. This is intended to make JSON serialization work but is otherwise unnecessary\n  // for end-users\n  toJSON(): any {\n    // Optional spacer argument is unnecessary because we're depending on recursion rather than stringifying the content\n    validateArgCount('DataSnapshot.toJSON', 0, 1, arguments.length);\n    return this.exportVal();\n  }\n\n  /**\n   * Returns whether the snapshot contains a non-null value.\n   *\n   * @return {boolean} Whether the snapshot contains a non-null value, or is empty.\n   */\n  exists(): boolean {\n    validateArgCount('DataSnapshot.exists', 0, 0, arguments.length);\n    return !this.node_.isEmpty();\n  }\n\n  /**\n   * Returns a DataSnapshot of the specified child node's contents.\n   *\n   * @param {!string} childPathString Path to a child.\n   * @return {!DataSnapshot} DataSnapshot for child node.\n   */\n  child(childPathString: string): DataSnapshot {\n    validateArgCount('DataSnapshot.child', 0, 1, arguments.length);\n    // Ensure the childPath is a string (can be a number)\n    childPathString = String(childPathString);\n    validatePathString('DataSnapshot.child', 1, childPathString, false);\n\n    const childPath = new Path(childPathString);\n    const childRef = this.ref_.child(childPath);\n    return new DataSnapshot(\n      this.node_.getChild(childPath),\n      childRef,\n      PRIORITY_INDEX\n    );\n  }\n\n  /**\n   * Returns whether the snapshot contains a child at the specified path.\n   *\n   * @param {!string} childPathString Path to a child.\n   * @return {boolean} Whether the child exists.\n   */\n  hasChild(childPathString: string): boolean {\n    validateArgCount('DataSnapshot.hasChild', 1, 1, arguments.length);\n    validatePathString('DataSnapshot.hasChild', 1, childPathString, false);\n\n    const childPath = new Path(childPathString);\n    return !this.node_.getChild(childPath).isEmpty();\n  }\n\n  /**\n   * Returns the priority of the object, or null if no priority was set.\n   *\n   * @return {string|number|null} The priority.\n   */\n  getPriority(): string | number | null {\n    validateArgCount('DataSnapshot.getPriority', 0, 0, arguments.length);\n\n    // typecast here because we never return deferred values or internal priorities (MAX_PRIORITY)\n    return this.node_.getPriority().val() as string | number | null;\n  }\n\n  /**\n   * Iterates through child nodes and calls the specified action for each one.\n   *\n   * @param {function(!DataSnapshot)} action Callback function to be called\n   * for each child.\n   * @return {boolean} True if forEach was canceled by action returning true for\n   * one of the child nodes.\n   */\n  forEach(action: (d: DataSnapshot) => boolean | void): boolean {\n    validateArgCount('DataSnapshot.forEach', 1, 1, arguments.length);\n    validateCallback('DataSnapshot.forEach', 1, action, false);\n\n    if (this.node_.isLeafNode()) return false;\n\n    const childrenNode = this.node_ as ChildrenNode;\n    // Sanitize the return value to a boolean. ChildrenNode.forEachChild has a weird return type...\n    return !!childrenNode.forEachChild(this.index_, (key, node) => {\n      return action(\n        new DataSnapshot(node, this.ref_.child(key), PRIORITY_INDEX)\n      );\n    });\n  }\n\n  /**\n   * Returns whether this DataSnapshot has children.\n   * @return {boolean} True if the DataSnapshot contains 1 or more child nodes.\n   */\n  hasChildren(): boolean {\n    validateArgCount('DataSnapshot.hasChildren', 0, 0, arguments.length);\n\n    if (this.node_.isLeafNode()) return false;\n    else return !this.node_.isEmpty();\n  }\n\n  get key() {\n    return this.ref_.getKey();\n  }\n\n  /**\n   * Returns the number of children for this DataSnapshot.\n   * @return {number} The number of children that this DataSnapshot contains.\n   */\n  numChildren(): number {\n    validateArgCount('DataSnapshot.numChildren', 0, 0, arguments.length);\n\n    return this.node_.numChildren();\n  }\n\n  /**\n   * @return {Reference} The Firebase reference for the location this snapshot's data came from.\n   */\n  getRef(): Reference {\n    validateArgCount('DataSnapshot.ref', 0, 0, arguments.length);\n\n    return this.ref_;\n  }\n\n  get ref() {\n    return this.getRef();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { stringify } from '@firebase/util';\nimport { Path } from '../util/Path';\nimport { EventRegistration } from './EventRegistration';\nimport { DataSnapshot } from '../../api/DataSnapshot';\n\n/**\n * Encapsulates the data needed to raise an event\n * @interface\n */\nexport interface Event {\n  /**\n   * @return {!Path}\n   */\n  getPath(): Path;\n\n  /**\n   * @return {!string}\n   */\n  getEventType(): string;\n\n  /**\n   * @return {!function()}\n   */\n  getEventRunner(): () => void;\n\n  /**\n   * @return {!string}\n   */\n  toString(): string;\n}\n\n/**\n * Encapsulates the data needed to raise an event\n * @implements {Event}\n */\nexport class DataEvent implements Event {\n  /**\n   * @param {!string} eventType One of: value, child_added, child_changed, child_moved, child_removed\n   * @param {!EventRegistration} eventRegistration The function to call to with the event data. User provided\n   * @param {!DataSnapshot} snapshot The data backing the event\n   * @param {?string=} prevName Optional, the name of the previous child for child_* events.\n   */\n  constructor(\n    public eventType:\n      | 'value'\n      | ' child_added'\n      | ' child_changed'\n      | ' child_moved'\n      | ' child_removed',\n    public eventRegistration: EventRegistration,\n    public snapshot: DataSnapshot,\n    public prevName?: string | null\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  getPath(): Path {\n    const ref = this.snapshot.getRef();\n    if (this.eventType === 'value') {\n      return ref.path;\n    } else {\n      return ref.getParent().path;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getEventType(): string {\n    return this.eventType;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getEventRunner(): () => void {\n    return this.eventRegistration.getEventRunner(this);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  toString(): string {\n    return (\n      this.getPath().toString() +\n      ':' +\n      this.eventType +\n      ':' +\n      stringify(this.snapshot.exportVal())\n    );\n  }\n}\n\nexport class CancelEvent implements Event {\n  /**\n   * @param {EventRegistration} eventRegistration\n   * @param {Error} error\n   * @param {!Path} path\n   */\n  constructor(\n    public eventRegistration: EventRegistration,\n    public error: Error,\n    public path: Path\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  getPath(): Path {\n    return this.path;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getEventType(): string {\n    return 'cancel';\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getEventRunner(): () => void {\n    return this.eventRegistration.getEventRunner(this);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  toString(): string {\n    return this.path.toString() + ':cancel';\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DataSnapshot } from '../../api/DataSnapshot';\nimport { DataEvent, CancelEvent, Event } from './Event';\nimport { contains } from '@firebase/util';\nimport { assert } from '@firebase/util';\nimport { Path } from '../util/Path';\nimport { Change } from './Change';\nimport { Query } from '../../api/Query';\n\n/**\n * An EventRegistration is basically an event type ('value', 'child_added', etc.) and a callback\n * to be notified of that type of event.\n *\n * That said, it can also contain a cancel callback to be notified if the event is canceled.  And\n * currently, this code is organized around the idea that you would register multiple child_ callbacks\n * together, as a single EventRegistration.  Though currently we don't do that.\n */\nexport interface EventRegistration {\n  /**\n   * True if this container has a callback to trigger for this event type\n   * @param {!string} eventType\n   * @return {boolean}\n   */\n  respondsTo(eventType: string): boolean;\n\n  /**\n   * @param {!Change} change\n   * @param {!Query} query\n   * @return {!Event}\n   */\n  createEvent(change: Change, query: Query): Event;\n\n  /**\n   * Given event data, return a function to trigger the user's callback\n   * @param {!Event} eventData\n   * @return {function()}\n   */\n  getEventRunner(eventData: Event): () => void;\n\n  /**\n   * @param {!Error} error\n   * @param {!Path} path\n   * @return {?CancelEvent}\n   */\n  createCancelEvent(error: Error, path: Path): CancelEvent | null;\n\n  /**\n   * @param {!EventRegistration} other\n   * @return {boolean}\n   */\n  matches(other: EventRegistration): boolean;\n\n  /**\n   * False basically means this is a \"dummy\" callback container being used as a sentinel\n   * to remove all callback containers of a particular type.  (e.g. if the user does\n   * ref.off('value') without specifying a specific callback).\n   *\n   * (TODO: Rework this, since it's hacky)\n   *\n   * @return {boolean}\n   */\n  hasAnyCallback(): boolean;\n}\n\n/**\n * Represents registration for 'value' events.\n */\nexport class ValueEventRegistration implements EventRegistration {\n  /**\n   * @param {?function(!DataSnapshot)} callback_\n   * @param {?function(Error)} cancelCallback_\n   * @param {?Object} context_\n   */\n  constructor(\n    private callback_: ((d: DataSnapshot) => void) | null,\n    private cancelCallback_: ((e: Error) => void) | null,\n    private context_: Object | null\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  respondsTo(eventType: string): boolean {\n    return eventType === 'value';\n  }\n\n  /**\n   * @inheritDoc\n   */\n  createEvent(change: Change, query: Query): DataEvent {\n    const index = query.getQueryParams().getIndex();\n    return new DataEvent(\n      'value',\n      this,\n      new DataSnapshot(change.snapshotNode, query.getRef(), index)\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getEventRunner(eventData: CancelEvent | DataEvent): () => void {\n    const ctx = this.context_;\n    if (eventData.getEventType() === 'cancel') {\n      assert(\n        this.cancelCallback_,\n        'Raising a cancel event on a listener with no cancel callback'\n      );\n      const cancelCB = this.cancelCallback_;\n      return function() {\n        // We know that error exists, we checked above that this is a cancel event\n        cancelCB.call(ctx, (eventData as CancelEvent).error);\n      };\n    } else {\n      const cb = this.callback_;\n      return function() {\n        cb.call(ctx, (eventData as DataEvent).snapshot);\n      };\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  createCancelEvent(error: Error, path: Path): CancelEvent | null {\n    if (this.cancelCallback_) {\n      return new CancelEvent(this, error, path);\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  matches(other: EventRegistration): boolean {\n    if (!(other instanceof ValueEventRegistration)) {\n      return false;\n    } else if (!other.callback_ || !this.callback_) {\n      // If no callback specified, we consider it to match any callback.\n      return true;\n    } else {\n      return (\n        other.callback_ === this.callback_ && other.context_ === this.context_\n      );\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  hasAnyCallback(): boolean {\n    return this.callback_ !== null;\n  }\n}\n\n/**\n * Represents the registration of 1 or more child_xxx events.\n *\n * Currently, it is always exactly 1 child_xxx event, but the idea is we might let you\n * register a group of callbacks together in the future.\n *\n * @constructor\n * @implements {EventRegistration}\n */\nexport class ChildEventRegistration implements EventRegistration {\n  /**\n   * @param {?Object.<string, function(!DataSnapshot, ?string=)>} callbacks_\n   * @param {?function(Error)} cancelCallback_\n   * @param {Object=} context_\n   */\n  constructor(\n    private callbacks_: {\n      [k: string]: (d: DataSnapshot, s?: string | null) => void;\n    } | null,\n    private cancelCallback_: ((e: Error) => void) | null,\n    private context_?: Object\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  respondsTo(eventType: string): boolean {\n    let eventToCheck =\n      eventType === 'children_added' ? 'child_added' : eventType;\n    eventToCheck =\n      eventToCheck === 'children_removed' ? 'child_removed' : eventToCheck;\n    return contains(this.callbacks_, eventToCheck);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  createCancelEvent(error: Error, path: Path): CancelEvent | null {\n    if (this.cancelCallback_) {\n      return new CancelEvent(this, error, path);\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  createEvent(change: Change, query: Query): DataEvent {\n    assert(change.childName != null, 'Child events should have a childName.');\n    const ref = query.getRef().child(/** @type {!string} */ change.childName);\n    const index = query.getQueryParams().getIndex();\n    return new DataEvent(\n      change.type as any,\n      this,\n      new DataSnapshot(change.snapshotNode, ref, index as any),\n      change.prevName\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getEventRunner(eventData: CancelEvent | DataEvent): () => void {\n    const ctx = this.context_;\n    if (eventData.getEventType() === 'cancel') {\n      assert(\n        this.cancelCallback_,\n        'Raising a cancel event on a listener with no cancel callback'\n      );\n      const cancelCB = this.cancelCallback_;\n      return function() {\n        // We know that error exists, we checked above that this is a cancel event\n        cancelCB.call(ctx, (eventData as CancelEvent).error);\n      };\n    } else {\n      const cb = this.callbacks_[(eventData as DataEvent).eventType];\n      return function() {\n        cb.call(\n          ctx,\n          (eventData as DataEvent).snapshot,\n          (eventData as DataEvent).prevName\n        );\n      };\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  matches(other: EventRegistration): boolean {\n    if (other instanceof ChildEventRegistration) {\n      if (!this.callbacks_ || !other.callbacks_) {\n        return true;\n      } else if (this.context_ === other.context_) {\n        const otherKeys = Object.keys(other.callbacks_);\n        const thisKeys = Object.keys(this.callbacks_);\n        const otherCount = otherKeys.length;\n        const thisCount = thisKeys.length;\n        if (otherCount === thisCount) {\n          // If count is 1, do an exact match on eventType, if either is defined but null, it's a match.\n          // If event types don't match, not a match\n          // If count is not 1, exact match across all\n\n          if (otherCount === 1) {\n            const otherKey = otherKeys[0];\n            const thisKey = thisKeys[0];\n            return (\n              thisKey === otherKey &&\n              (!other.callbacks_[otherKey] ||\n                !this.callbacks_[thisKey] ||\n                other.callbacks_[otherKey] === this.callbacks_[thisKey])\n            );\n          } else {\n            // Exact match on each key.\n            return thisKeys.every(\n              eventType =>\n                other.callbacks_[eventType] === this.callbacks_[eventType]\n            );\n          }\n        }\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  hasAnyCallback(): boolean {\n    return this.callbacks_ !== null;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Path } from './util/Path';\nimport { PRIORITY_INDEX } from './snap/indexes/PriorityIndex';\nimport { Node } from './snap/Node';\n\n/**\n * Helper class to store a sparse set of snapshots.\n */\nexport class SparseSnapshotTree {\n  private value: Node | null = null;\n\n  private readonly children: Map<string, SparseSnapshotTree> = new Map();\n\n  /**\n   * Gets the node stored at the given path if one exists.\n   *\n   * @param path Path to look up snapshot for.\n   * @return The retrieved node, or null.\n   */\n  find(path: Path): Node | null {\n    if (this.value != null) {\n      return this.value.getChild(path);\n    } else if (!path.isEmpty() && this.children.size > 0) {\n      const childKey = path.getFront();\n      path = path.popFront();\n      if (this.children.has(childKey)) {\n        const childTree = this.children.get(childKey);\n        return childTree.find(path);\n      } else {\n        return null;\n      }\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Stores the given node at the specified path. If there is already a node\n   * at a shallower path, it merges the new data into that snapshot node.\n   *\n   * @param path Path to look up snapshot for.\n   * @param data The new data, or null.\n   */\n  remember(path: Path, data: Node) {\n    if (path.isEmpty()) {\n      this.value = data;\n      this.children.clear();\n    } else if (this.value !== null) {\n      this.value = this.value.updateChild(path, data);\n    } else {\n      const childKey = path.getFront();\n      if (!this.children.has(childKey)) {\n        this.children.set(childKey, new SparseSnapshotTree());\n      }\n\n      const child = this.children.get(childKey);\n      path = path.popFront();\n      child.remember(path, data);\n    }\n  }\n\n  /**\n   * Purge the data at path from the cache.\n   *\n   * @param path Path to look up snapshot for.\n   * @return True if this node should now be removed.\n   */\n  forget(path: Path): boolean {\n    if (path.isEmpty()) {\n      this.value = null;\n      this.children.clear();\n      return true;\n    } else {\n      if (this.value !== null) {\n        if (this.value.isLeafNode()) {\n          // We're trying to forget a node that doesn't exist\n          return false;\n        } else {\n          const value = this.value;\n          this.value = null;\n\n          const self = this;\n          value.forEachChild(PRIORITY_INDEX, function(key, tree) {\n            self.remember(new Path(key), tree);\n          });\n\n          return this.forget(path);\n        }\n      } else if (this.children.size > 0) {\n        const childKey = path.getFront();\n        path = path.popFront();\n        if (this.children.has(childKey)) {\n          const safeToRemove = this.children.get(childKey).forget(path);\n          if (safeToRemove) {\n            this.children.delete(childKey);\n          }\n        }\n\n        return this.children.size === 0;\n      } else {\n        return true;\n      }\n    }\n  }\n\n  /**\n   * Recursively iterates through all of the stored tree and calls the\n   * callback on each one.\n   *\n   * @param prefixPath Path to look up node for.\n   * @param func The function to invoke for each tree.\n   */\n  forEachTree(prefixPath: Path, func: (a: Path, b: Node) => any) {\n    if (this.value !== null) {\n      func(prefixPath, this.value);\n    } else {\n      this.forEachChild((key, tree) => {\n        const path = new Path(prefixPath.toString() + '/' + key);\n        tree.forEachTree(path, func);\n      });\n    }\n  }\n\n  /**\n   * Iterates through each immediate child and triggers the callback.\n   *\n   * @param func The function to invoke for each child.\n   */\n  forEachChild(func: (a: string, b: SparseSnapshotTree) => void) {\n    this.children.forEach((tree, key) => {\n      func(key, tree);\n    });\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { Path } from './Path';\nimport { SparseSnapshotTree } from '../SparseSnapshotTree';\nimport { LeafNode } from '../snap/LeafNode';\nimport { nodeFromJSON } from '../snap/nodeFromJSON';\nimport { PRIORITY_INDEX } from '../snap/indexes/PriorityIndex';\nimport { Node } from '../snap/Node';\nimport { ChildrenNode } from '../snap/ChildrenNode';\nimport { SyncTree } from '../SyncTree';\n\n/**\n * Generate placeholders for deferred values.\n * @param {?Object} values\n * @return {!Object}\n */\nexport const generateWithValues = function(\n  values: {\n    [k: string]: any;\n  } | null\n): { [k: string]: any } {\n  values = values || {};\n  values['timestamp'] = values['timestamp'] || new Date().getTime();\n  return values;\n};\n\n/**\n * Value to use when firing local events. When writing server values, fire\n * local events with an approximate value, otherwise return value as-is.\n * @param {(Object|string|number|boolean)} value\n * @param {!Object} serverValues\n * @return {!(string|number|boolean)}\n */\nexport const resolveDeferredValue = function(\n  value: { [k: string]: any } | string | number | boolean,\n  existing: Node,\n  serverValues: { [k: string]: any }\n): string | number | boolean {\n  if (!value || typeof value !== 'object') {\n    return value as string | number | boolean;\n  }\n  assert('.sv' in value, 'Unexpected leaf node or priority contents');\n\n  if (typeof value['.sv'] === 'string') {\n    return resolveScalarDeferredValue(value['.sv'], existing, serverValues);\n  } else if (typeof value['.sv'] === 'object') {\n    return resolveComplexDeferredValue(value['.sv'], existing, serverValues);\n  } else {\n    assert(false, 'Unexpected server value: ' + JSON.stringify(value, null, 2));\n  }\n};\n\nconst resolveScalarDeferredValue = function(\n  op: string,\n  existing: Node,\n  serverValues: { [k: string]: any }\n): string | number | boolean {\n  switch (op) {\n    case 'timestamp':\n      return serverValues['timestamp'];\n    default:\n      assert(false, 'Unexpected server value: ' + op);\n  }\n};\n\nconst resolveComplexDeferredValue = function(\n  op: Object,\n  existing: Node,\n  unused: { [k: string]: any }\n): string | number | boolean {\n  if (!op.hasOwnProperty('increment')) {\n    assert(false, 'Unexpected server value: ' + JSON.stringify(op, null, 2));\n  }\n  const delta = op['increment'];\n  if (typeof delta !== 'number') {\n    assert(false, 'Unexpected increment value: ' + delta);\n  }\n\n  // Incrementing a non-number sets the value to the incremented amount\n  if (!existing.isLeafNode()) {\n    return delta;\n  }\n\n  const leaf = existing as LeafNode;\n  const existingVal = leaf.getValue();\n  if (typeof existingVal !== 'number') {\n    return delta;\n  }\n\n  // No need to do over/underflow arithmetic here because JS only handles floats under the covers\n  return existingVal + delta;\n};\n\n/**\n * Recursively replace all deferred values and priorities in the tree with the\n * specified generated replacement values.\n * @param {!SparseSnapshotTree} tree\n * @param {!Object} serverValues\n * @return {!SparseSnapshotTree}\n */\nexport const resolveDeferredValueTree = function(\n  tree: SparseSnapshotTree,\n  syncTree: SyncTree,\n  serverValues: Object\n): SparseSnapshotTree {\n  const resolvedTree = new SparseSnapshotTree();\n  tree.forEachTree(new Path(''), function(path, node) {\n    const existing = syncTree.calcCompleteEventCache(path);\n    assert(\n      existing !== null && typeof existing !== 'undefined',\n      'Expected ChildrenNode.EMPTY_NODE for nulls'\n    );\n    resolvedTree.remember(\n      path,\n      resolveDeferredValueSnapshot(node, existing, serverValues)\n    );\n  });\n  return resolvedTree;\n};\n\n/**\n * Recursively replace all deferred values and priorities in the node with the\n * specified generated replacement values.  If there are no server values in the node,\n * it'll be returned as-is.\n * @param {!Node} node\n * @param {!Object} serverValues\n * @return {!Node}\n */\nexport const resolveDeferredValueSnapshot = function(\n  node: Node,\n  existing: Node,\n  serverValues: Object\n): Node {\n  const rawPri = node.getPriority().val() as\n    | object\n    | boolean\n    | null\n    | number\n    | string;\n  const priority = resolveDeferredValue(\n    rawPri,\n    existing.getPriority(),\n    serverValues\n  );\n  let newNode: Node;\n\n  if (node.isLeafNode()) {\n    const leafNode = node as LeafNode;\n    const value = resolveDeferredValue(\n      leafNode.getValue(),\n      existing,\n      serverValues\n    );\n    if (\n      value !== leafNode.getValue() ||\n      priority !== leafNode.getPriority().val()\n    ) {\n      return new LeafNode(value, nodeFromJSON(priority));\n    } else {\n      return node;\n    }\n  } else {\n    const childrenNode = node as ChildrenNode;\n    newNode = childrenNode;\n    if (priority !== childrenNode.getPriority().val()) {\n      newNode = newNode.updatePriority(new LeafNode(priority));\n    }\n    childrenNode.forEachChild(PRIORITY_INDEX, function(childName, childNode) {\n      const newChildNode = resolveDeferredValueSnapshot(\n        childNode,\n        existing.getImmediateChild(childName),\n        serverValues\n      );\n      if (newChildNode !== childNode) {\n        newNode = newNode.updateImmediateChild(childName, newChildNode);\n      }\n    });\n    return newNode;\n  }\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { SortedMap } from './SortedMap';\nimport { Path } from './Path';\nimport { stringCompare, each } from './util';\n\nlet emptyChildrenSingleton: SortedMap<string, ImmutableTree<null>>;\n\n/**\n * Singleton empty children collection.\n *\n * @const\n * @type {!SortedMap.<string, !ImmutableTree.<?>>}\n */\nconst EmptyChildren = (): SortedMap<string, ImmutableTree<null>> => {\n  if (!emptyChildrenSingleton) {\n    emptyChildrenSingleton = new SortedMap<string, ImmutableTree<null>>(\n      stringCompare\n    );\n  }\n  return emptyChildrenSingleton;\n};\n\n/**\n * A tree with immutable elements.\n */\nexport class ImmutableTree<T> {\n  static Empty = new ImmutableTree<any>(null);\n\n  /**\n   * @template T\n   * @param {!Object.<string, !T>} obj\n   * @return {!ImmutableTree.<!T>}\n   */\n  static fromObject<T>(obj: { [k: string]: T }): ImmutableTree<T> {\n    let tree: ImmutableTree<T> = ImmutableTree.Empty;\n    each(obj, (childPath: string, childSnap: T) => {\n      tree = tree.set(new Path(childPath), childSnap);\n    });\n    return tree;\n  }\n\n  /**\n   * @template T\n   * @param {?T} value\n   * @param {SortedMap.<string, !ImmutableTree.<T>>=} children\n   */\n  constructor(\n    public readonly value: T | null,\n    public readonly children: SortedMap<\n      string,\n      ImmutableTree<T>\n    > = EmptyChildren()\n  ) {}\n\n  /**\n   * True if the value is empty and there are no children\n   * @return {boolean}\n   */\n  isEmpty(): boolean {\n    return this.value === null && this.children.isEmpty();\n  }\n\n  /**\n   * Given a path and predicate, return the first node and the path to that node\n   * where the predicate returns true.\n   *\n   * TODO Do a perf test -- If we're creating a bunch of {path: value:} objects\n   * on the way back out, it may be better to pass down a pathSoFar obj.\n   *\n   * @param {!Path} relativePath The remainder of the path\n   * @param {function(T):boolean} predicate The predicate to satisfy to return a\n   *   node\n   * @return {?{path:!Path, value:!T}}\n   */\n  findRootMostMatchingPathAndValue(\n    relativePath: Path,\n    predicate: (a: T) => boolean\n  ): { path: Path; value: T } | null {\n    if (this.value != null && predicate(this.value)) {\n      return { path: Path.Empty, value: this.value };\n    } else {\n      if (relativePath.isEmpty()) {\n        return null;\n      } else {\n        const front = relativePath.getFront();\n        const child = this.children.get(front);\n        if (child !== null) {\n          const childExistingPathAndValue = child.findRootMostMatchingPathAndValue(\n            relativePath.popFront(),\n            predicate\n          );\n          if (childExistingPathAndValue != null) {\n            const fullPath = new Path(front).child(\n              childExistingPathAndValue.path\n            );\n            return { path: fullPath, value: childExistingPathAndValue.value };\n          } else {\n            return null;\n          }\n        } else {\n          return null;\n        }\n      }\n    }\n  }\n\n  /**\n   * Find, if it exists, the shortest subpath of the given path that points a defined\n   * value in the tree\n   * @param {!Path} relativePath\n   * @return {?{path: !Path, value: !T}}\n   */\n  findRootMostValueAndPath(\n    relativePath: Path\n  ): { path: Path; value: T } | null {\n    return this.findRootMostMatchingPathAndValue(relativePath, () => true);\n  }\n\n  /**\n   * @param {!Path} relativePath\n   * @return {!ImmutableTree.<T>} The subtree at the given path\n   */\n  subtree(relativePath: Path): ImmutableTree<T> {\n    if (relativePath.isEmpty()) {\n      return this;\n    } else {\n      const front = relativePath.getFront();\n      const childTree = this.children.get(front);\n      if (childTree !== null) {\n        return childTree.subtree(relativePath.popFront());\n      } else {\n        return ImmutableTree.Empty;\n      }\n    }\n  }\n\n  /**\n   * Sets a value at the specified path.\n   *\n   * @param {!Path} relativePath Path to set value at.\n   * @param {?T} toSet Value to set.\n   * @return {!ImmutableTree.<T>} Resulting tree.\n   */\n  set(relativePath: Path, toSet: T | null): ImmutableTree<T> {\n    if (relativePath.isEmpty()) {\n      return new ImmutableTree(toSet, this.children);\n    } else {\n      const front = relativePath.getFront();\n      const child = this.children.get(front) || ImmutableTree.Empty;\n      const newChild = child.set(relativePath.popFront(), toSet);\n      const newChildren = this.children.insert(front, newChild);\n      return new ImmutableTree(this.value, newChildren);\n    }\n  }\n\n  /**\n   * Removes the value at the specified path.\n   *\n   * @param {!Path} relativePath Path to value to remove.\n   * @return {!ImmutableTree.<T>} Resulting tree.\n   */\n  remove(relativePath: Path): ImmutableTree<T> {\n    if (relativePath.isEmpty()) {\n      if (this.children.isEmpty()) {\n        return ImmutableTree.Empty;\n      } else {\n        return new ImmutableTree(null, this.children);\n      }\n    } else {\n      const front = relativePath.getFront();\n      const child = this.children.get(front);\n      if (child) {\n        const newChild = child.remove(relativePath.popFront());\n        let newChildren;\n        if (newChild.isEmpty()) {\n          newChildren = this.children.remove(front);\n        } else {\n          newChildren = this.children.insert(front, newChild);\n        }\n        if (this.value === null && newChildren.isEmpty()) {\n          return ImmutableTree.Empty;\n        } else {\n          return new ImmutableTree(this.value, newChildren);\n        }\n      } else {\n        return this;\n      }\n    }\n  }\n\n  /**\n   * Gets a value from the tree.\n   *\n   * @param {!Path} relativePath Path to get value for.\n   * @return {?T} Value at path, or null.\n   */\n  get(relativePath: Path): T | null {\n    if (relativePath.isEmpty()) {\n      return this.value;\n    } else {\n      const front = relativePath.getFront();\n      const child = this.children.get(front);\n      if (child) {\n        return child.get(relativePath.popFront());\n      } else {\n        return null;\n      }\n    }\n  }\n\n  /**\n   * Replace the subtree at the specified path with the given new tree.\n   *\n   * @param {!Path} relativePath Path to replace subtree for.\n   * @param {!ImmutableTree} newTree New tree.\n   * @return {!ImmutableTree} Resulting tree.\n   */\n  setTree(relativePath: Path, newTree: ImmutableTree<T>): ImmutableTree<T> {\n    if (relativePath.isEmpty()) {\n      return newTree;\n    } else {\n      const front = relativePath.getFront();\n      const child = this.children.get(front) || ImmutableTree.Empty;\n      const newChild = child.setTree(relativePath.popFront(), newTree);\n      let newChildren;\n      if (newChild.isEmpty()) {\n        newChildren = this.children.remove(front);\n      } else {\n        newChildren = this.children.insert(front, newChild);\n      }\n      return new ImmutableTree(this.value, newChildren);\n    }\n  }\n\n  /**\n   * Performs a depth first fold on this tree. Transforms a tree into a single\n   * value, given a function that operates on the path to a node, an optional\n   * current value, and a map of child names to folded subtrees\n   * @template V\n   * @param {function(Path, ?T, Object.<string, V>):V} fn\n   * @return {V}\n   */\n  fold<V>(fn: (path: Path, value: T, children: { [k: string]: V }) => V): V {\n    return this.fold_(Path.Empty, fn);\n  }\n\n  /**\n   * Recursive helper for public-facing fold() method\n   * @template V\n   * @param {!Path} pathSoFar\n   * @param {function(Path, ?T, Object.<string, V>):V} fn\n   * @return {V}\n   * @private\n   */\n  private fold_<V>(\n    pathSoFar: Path,\n    fn: (path: Path, value: T | null, children: { [k: string]: V }) => V\n  ): V {\n    const accum: { [k: string]: V } = {};\n    this.children.inorderTraversal(function(\n      childKey: string,\n      childTree: ImmutableTree<T>\n    ) {\n      accum[childKey] = childTree.fold_(pathSoFar.child(childKey), fn);\n    });\n    return fn(pathSoFar, this.value, accum);\n  }\n\n  /**\n   * Find the first matching value on the given path. Return the result of applying f to it.\n   * @template V\n   * @param {!Path} path\n   * @param {!function(!Path, !T):?V} f\n   * @return {?V}\n   */\n  findOnPath<V>(path: Path, f: (path: Path, value: T) => V | null): V | null {\n    return this.findOnPath_(path, Path.Empty, f);\n  }\n\n  private findOnPath_<V>(\n    pathToFollow: Path,\n    pathSoFar: Path,\n    f: (path: Path, value: T) => V | null\n  ): V | null {\n    const result = this.value ? f(pathSoFar, this.value) : false;\n    if (result) {\n      return result;\n    } else {\n      if (pathToFollow.isEmpty()) {\n        return null;\n      } else {\n        const front = pathToFollow.getFront()!;\n        const nextChild = this.children.get(front);\n        if (nextChild) {\n          return nextChild.findOnPath_(\n            pathToFollow.popFront(),\n            pathSoFar.child(front),\n            f\n          );\n        } else {\n          return null;\n        }\n      }\n    }\n  }\n\n  /**\n   *\n   * @param {!Path} path\n   * @param {!function(!Path, !T)} f\n   * @returns {!ImmutableTree.<T>}\n   */\n  foreachOnPath(\n    path: Path,\n    f: (path: Path, value: T) => void\n  ): ImmutableTree<T> {\n    return this.foreachOnPath_(path, Path.Empty, f);\n  }\n\n  private foreachOnPath_(\n    pathToFollow: Path,\n    currentRelativePath: Path,\n    f: (path: Path, value: T) => void\n  ): ImmutableTree<T> {\n    if (pathToFollow.isEmpty()) {\n      return this;\n    } else {\n      if (this.value) {\n        f(currentRelativePath, this.value);\n      }\n      const front = pathToFollow.getFront();\n      const nextChild = this.children.get(front);\n      if (nextChild) {\n        return nextChild.foreachOnPath_(\n          pathToFollow.popFront(),\n          currentRelativePath.child(front),\n          f\n        );\n      } else {\n        return ImmutableTree.Empty;\n      }\n    }\n  }\n\n  /**\n   * Calls the given function for each node in the tree that has a value.\n   *\n   * @param {function(!Path, !T)} f A function to be called with\n   *   the path from the root of the tree to a node, and the value at that node.\n   *   Called in depth-first order.\n   */\n  foreach(f: (path: Path, value: T) => void) {\n    this.foreach_(Path.Empty, f);\n  }\n\n  private foreach_(\n    currentRelativePath: Path,\n    f: (path: Path, value: T) => void\n  ) {\n    this.children.inorderTraversal(function(childName, childTree) {\n      childTree.foreach_(currentRelativePath.child(childName), f);\n    });\n    if (this.value) {\n      f(currentRelativePath, this.value);\n    }\n  }\n\n  /**\n   *\n   * @param {function(string, !T)} f\n   */\n  foreachChild(f: (name: string, value: T) => void) {\n    this.children.inorderTraversal(\n      (childName: string, childTree: ImmutableTree<T>) => {\n        if (childTree.value) {\n          f(childName, childTree.value);\n        }\n      }\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CacheNode } from './view/CacheNode';\nimport { ChildrenNode } from './snap/ChildrenNode';\nimport { assert } from '@firebase/util';\nimport { ViewCache } from './view/ViewCache';\nimport { View } from './view/View';\nimport { Operation } from './operation/Operation';\nimport { WriteTreeRef } from './WriteTree';\nimport { Query } from '../api/Query';\nimport { EventRegistration } from './view/EventRegistration';\nimport { Node } from './snap/Node';\nimport { Path } from './util/Path';\nimport { Event } from './view/Event';\nimport { Reference, ReferenceConstructor } from '../api/Reference';\n\nlet __referenceConstructor: ReferenceConstructor;\n\n/**\n * SyncPoint represents a single location in a SyncTree with 1 or more event registrations, meaning we need to\n * maintain 1 or more Views at this location to cache server data and raise appropriate events for server changes\n * and user writes (set, transaction, update).\n *\n * It's responsible for:\n *  - Maintaining the set of 1 or more views necessary at this location (a SyncPoint with 0 views should be removed).\n *  - Proxying user / server operations to the views as appropriate (i.e. applyServerOverwrite,\n *    applyUserOverwrite, etc.)\n */\nexport class SyncPoint {\n  static set __referenceConstructor(val: ReferenceConstructor) {\n    assert(\n      !__referenceConstructor,\n      '__referenceConstructor has already been defined'\n    );\n    __referenceConstructor = val;\n  }\n\n  static get __referenceConstructor() {\n    assert(__referenceConstructor, 'Reference.ts has not been loaded');\n    return __referenceConstructor;\n  }\n\n  /**\n   * The Views being tracked at this location in the tree, stored as a map where the key is a\n   * queryId and the value is the View for that query.\n   *\n   * NOTE: This list will be quite small (usually 1, but perhaps 2 or 3; any more is an odd use case).\n   */\n  private readonly views: Map<string, View> = new Map();\n\n  isEmpty(): boolean {\n    return this.views.size === 0;\n  }\n\n  applyOperation(\n    operation: Operation,\n    writesCache: WriteTreeRef,\n    optCompleteServerCache: Node | null\n  ): Event[] {\n    const queryId = operation.source.queryId;\n    if (queryId !== null) {\n      const view = this.views.get(queryId);\n      assert(view != null, 'SyncTree gave us an op for an invalid query.');\n      return view.applyOperation(\n        operation,\n        writesCache,\n        optCompleteServerCache\n      );\n    } else {\n      let events: Event[] = [];\n\n      for (const view of this.views.values()) {\n        events = events.concat(\n          view.applyOperation(operation, writesCache, optCompleteServerCache)\n        );\n      }\n\n      return events;\n    }\n  }\n\n  /**\n   * Add an event callback for the specified query.\n   *\n   * @param {!Query} query\n   * @param {!EventRegistration} eventRegistration\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} serverCache Complete server cache, if we have it.\n   * @param {boolean} serverCacheComplete\n   * @return {!Array.<!Event>} Events to raise.\n   */\n  addEventRegistration(\n    query: Query,\n    eventRegistration: EventRegistration,\n    writesCache: WriteTreeRef,\n    serverCache: Node | null,\n    serverCacheComplete: boolean\n  ): Event[] {\n    const queryId = query.queryIdentifier();\n    let view = this.views.get(queryId);\n    if (!view) {\n      // TODO: make writesCache take flag for complete server node\n      let eventCache = writesCache.calcCompleteEventCache(\n        serverCacheComplete ? serverCache : null\n      );\n      let eventCacheComplete = false;\n      if (eventCache) {\n        eventCacheComplete = true;\n      } else if (serverCache instanceof ChildrenNode) {\n        eventCache = writesCache.calcCompleteEventChildren(serverCache);\n        eventCacheComplete = false;\n      } else {\n        eventCache = ChildrenNode.EMPTY_NODE;\n        eventCacheComplete = false;\n      }\n      const viewCache = new ViewCache(\n        new CacheNode(\n          /** @type {!Node} */ eventCache,\n          eventCacheComplete,\n          false\n        ),\n        new CacheNode(\n          /** @type {!Node} */ serverCache,\n          serverCacheComplete,\n          false\n        )\n      );\n      view = new View(query, viewCache);\n      this.views.set(queryId, view);\n    }\n\n    // This is guaranteed to exist now, we just created anything that was missing\n    view.addEventRegistration(eventRegistration);\n    return view.getInitialEvents(eventRegistration);\n  }\n\n  /**\n   * Remove event callback(s).  Return cancelEvents if a cancelError is specified.\n   *\n   * If query is the default query, we'll check all views for the specified eventRegistration.\n   * If eventRegistration is null, we'll remove all callbacks for the specified view(s).\n   *\n   * @param {!Query} query\n   * @param {?EventRegistration} eventRegistration If null, remove all callbacks.\n   * @param {Error=} cancelError If a cancelError is provided, appropriate cancel events will be returned.\n   * @return {{removed:!Array.<!Query>, events:!Array.<!Event>}} removed queries and any cancel events\n   */\n  removeEventRegistration(\n    query: Query,\n    eventRegistration: EventRegistration | null,\n    cancelError?: Error\n  ): { removed: Query[]; events: Event[] } {\n    const queryId = query.queryIdentifier();\n    const removed: Query[] = [];\n    let cancelEvents: Event[] = [];\n    const hadCompleteView = this.hasCompleteView();\n    if (queryId === 'default') {\n      // When you do ref.off(...), we search all views for the registration to remove.\n      for (const [viewQueryId, view] of this.views.entries()) {\n        cancelEvents = cancelEvents.concat(\n          view.removeEventRegistration(eventRegistration, cancelError)\n        );\n        if (view.isEmpty()) {\n          this.views.delete(viewQueryId);\n\n          // We'll deal with complete views later.\n          if (\n            !view\n              .getQuery()\n              .getQueryParams()\n              .loadsAllData()\n          ) {\n            removed.push(view.getQuery());\n          }\n        }\n      }\n    } else {\n      // remove the callback from the specific view.\n      const view = this.views.get(queryId);\n      if (view) {\n        cancelEvents = cancelEvents.concat(\n          view.removeEventRegistration(eventRegistration, cancelError)\n        );\n        if (view.isEmpty()) {\n          this.views.delete(queryId);\n\n          // We'll deal with complete views later.\n          if (\n            !view\n              .getQuery()\n              .getQueryParams()\n              .loadsAllData()\n          ) {\n            removed.push(view.getQuery());\n          }\n        }\n      }\n    }\n\n    if (hadCompleteView && !this.hasCompleteView()) {\n      // We removed our last complete view.\n      removed.push(\n        new SyncPoint.__referenceConstructor(query.repo, query.path)\n      );\n    }\n\n    return { removed: removed, events: cancelEvents };\n  }\n\n  getQueryViews(): View[] {\n    const result = [];\n    for (const view of this.views.values()) {\n      if (\n        !view\n          .getQuery()\n          .getQueryParams()\n          .loadsAllData()\n      ) {\n        result.push(view);\n      }\n    }\n    return result;\n  }\n\n  /**\n   * @param path The path to the desired complete snapshot\n   * @return A complete cache, if it exists\n   */\n  getCompleteServerCache(path: Path): Node | null {\n    let serverCache: Node | null = null;\n    for (const view of this.views.values()) {\n      serverCache = serverCache || view.getCompleteServerCache(path);\n    }\n    return serverCache;\n  }\n\n  viewForQuery(query: Query): View | null {\n    const params = query.getQueryParams();\n    if (params.loadsAllData()) {\n      return this.getCompleteView();\n    } else {\n      const queryId = query.queryIdentifier();\n      return this.views.get(queryId);\n    }\n  }\n\n  viewExistsForQuery(query: Query): boolean {\n    return this.viewForQuery(query) != null;\n  }\n\n  hasCompleteView(): boolean {\n    return this.getCompleteView() != null;\n  }\n\n  getCompleteView(): View | null {\n    for (const view of this.views.values()) {\n      if (\n        view\n          .getQuery()\n          .getQueryParams()\n          .loadsAllData()\n      ) {\n        return view;\n      }\n    }\n    return null;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { Path } from '../util/Path';\nimport { Operation, OperationSource, OperationType } from './Operation';\nimport { ImmutableTree } from '../util/ImmutableTree';\n\nexport class AckUserWrite implements Operation {\n  /** @inheritDoc */\n  type = OperationType.ACK_USER_WRITE;\n\n  /** @inheritDoc */\n  source = OperationSource.User;\n\n  /**\n   *\n   * @param {!Path} path\n   * @param {!ImmutableTree<!boolean>} affectedTree A tree containing true for each affected path. Affected paths can't overlap.\n   * @param {!boolean} revert\n   */\n  constructor(\n    /**@inheritDoc */ public path: Path,\n    /**@inheritDoc */ public affectedTree: ImmutableTree<boolean>,\n    /**@inheritDoc */ public revert: boolean\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  operationForChild(childName: string): AckUserWrite {\n    if (!this.path.isEmpty()) {\n      assert(\n        this.path.getFront() === childName,\n        'operationForChild called for unrelated child.'\n      );\n      return new AckUserWrite(\n        this.path.popFront(),\n        this.affectedTree,\n        this.revert\n      );\n    } else if (this.affectedTree.value != null) {\n      assert(\n        this.affectedTree.children.isEmpty(),\n        'affectedTree should not have overlapping affected paths.'\n      );\n      // All child locations are affected as well; just return same operation.\n      return this;\n    } else {\n      const childTree = this.affectedTree.subtree(new Path(childName));\n      return new AckUserWrite(Path.Empty, childTree, this.revert);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Path } from '../util/Path';\nimport { Operation, OperationSource, OperationType } from './Operation';\n\n/**\n * @param {!OperationSource} source\n * @param {!Path} path\n * @constructor\n * @implements {Operation}\n */\nexport class ListenComplete implements Operation {\n  /** @inheritDoc */\n  type = OperationType.LISTEN_COMPLETE;\n\n  constructor(public source: OperationSource, public path: Path) {}\n\n  operationForChild(childName: string): ListenComplete {\n    if (this.path.isEmpty()) {\n      return new ListenComplete(this.source, Path.Empty);\n    } else {\n      return new ListenComplete(this.source, this.path.popFront());\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Operation, OperationSource, OperationType } from './Operation';\nimport { Path } from '../util/Path';\nimport { Node } from '../snap/Node';\n\n/**\n * @param {!OperationSource} source\n * @param {!Path} path\n * @param {!Node} snap\n * @constructor\n * @implements {Operation}\n */\nexport class Overwrite implements Operation {\n  /** @inheritDoc */\n  type = OperationType.OVERWRITE;\n\n  constructor(\n    public source: OperationSource,\n    public path: Path,\n    public snap: Node\n  ) {}\n\n  operationForChild(childName: string): Overwrite {\n    if (this.path.isEmpty()) {\n      return new Overwrite(\n        this.source,\n        Path.Empty,\n        this.snap.getImmediateChild(childName)\n      );\n    } else {\n      return new Overwrite(this.source, this.path.popFront(), this.snap);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Operation, OperationSource, OperationType } from './Operation';\nimport { Overwrite } from './Overwrite';\nimport { Path } from '../util/Path';\nimport { assert } from '@firebase/util';\nimport { ImmutableTree } from '../util/ImmutableTree';\nimport { Node } from '../snap/Node';\n\n/**\n * @param {!OperationSource} source\n * @param {!Path} path\n * @param {!ImmutableTree.<!Node>} children\n * @constructor\n * @implements {Operation}\n */\nexport class Merge implements Operation {\n  /** @inheritDoc */\n  type = OperationType.MERGE;\n\n  constructor(\n    /**@inheritDoc */ public source: OperationSource,\n    /**@inheritDoc */ public path: Path,\n    /**@inheritDoc */ public children: ImmutableTree<Node>\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  operationForChild(childName: string): Operation {\n    if (this.path.isEmpty()) {\n      const childTree = this.children.subtree(new Path(childName));\n      if (childTree.isEmpty()) {\n        // This child is unaffected\n        return null;\n      } else if (childTree.value) {\n        // We have a snapshot for the child in question.  This becomes an overwrite of the child.\n        return new Overwrite(this.source, Path.Empty, childTree.value);\n      } else {\n        // This is a merge at a deeper level\n        return new Merge(this.source, Path.Empty, childTree);\n      }\n    } else {\n      assert(\n        this.path.getFront() === childName,\n        \"Can't get a merge for a child not on the path of the operation\"\n      );\n      return new Merge(this.source, this.path.popFront(), this.children);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  toString(): string {\n    return (\n      'Operation(' +\n      this.path +\n      ': ' +\n      this.source.toString() +\n      ' merge: ' +\n      this.children.toString() +\n      ')'\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Node } from '../snap/Node';\nimport { Path } from '../util/Path';\n\n/**\n * A cache node only stores complete children. Additionally it holds a flag whether the node can be considered fully\n * initialized in the sense that we know at one point in time this represented a valid state of the world, e.g.\n * initialized with data from the server, or a complete overwrite by the client. The filtered flag also tracks\n * whether a node potentially had children removed due to a filter.\n */\nexport class CacheNode {\n  /**\n   * @param {!Node} node_\n   * @param {boolean} fullyInitialized_\n   * @param {boolean} filtered_\n   */\n  constructor(\n    private node_: Node,\n    private fullyInitialized_: boolean,\n    private filtered_: boolean\n  ) {}\n\n  /**\n   * Returns whether this node was fully initialized with either server data or a complete overwrite by the client\n   * @return {boolean}\n   */\n  isFullyInitialized(): boolean {\n    return this.fullyInitialized_;\n  }\n\n  /**\n   * Returns whether this node is potentially missing children due to a filter applied to the node\n   * @return {boolean}\n   */\n  isFiltered(): boolean {\n    return this.filtered_;\n  }\n\n  /**\n   * @param {!Path} path\n   * @return {boolean}\n   */\n  isCompleteForPath(path: Path): boolean {\n    if (path.isEmpty()) {\n      return this.isFullyInitialized() && !this.filtered_;\n    }\n\n    const childKey = path.getFront();\n    return this.isCompleteForChild(childKey);\n  }\n\n  /**\n   * @param {!string} key\n   * @return {boolean}\n   */\n  isCompleteForChild(key: string): boolean {\n    return (\n      (this.isFullyInitialized() && !this.filtered_) || this.node_.hasChild(key)\n    );\n  }\n\n  /**\n   * @return {!Node}\n   */\n  getNode(): Node {\n    return this.node_;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ChildrenNode } from '../snap/ChildrenNode';\nimport { CacheNode } from './CacheNode';\nimport { Node } from '../snap/Node';\n\n/**\n * Stores the data we have cached for a view.\n *\n * serverSnap is the cached server data, eventSnap is the cached event data (server data plus any local writes).\n *\n * @constructor\n */\nexport class ViewCache {\n  /**\n   *\n   * @param {!CacheNode} eventCache_\n   * @param {!CacheNode} serverCache_\n   */\n  constructor(\n    private readonly eventCache_: CacheNode,\n    private readonly serverCache_: CacheNode\n  ) {}\n\n  /**\n   * @const\n   * @type {ViewCache}\n   */\n  static Empty = new ViewCache(\n    new CacheNode(\n      ChildrenNode.EMPTY_NODE,\n      /*fullyInitialized=*/ false,\n      /*filtered=*/ false\n    ),\n    new CacheNode(\n      ChildrenNode.EMPTY_NODE,\n      /*fullyInitialized=*/ false,\n      /*filtered=*/ false\n    )\n  );\n\n  /**\n   * @param {!Node} eventSnap\n   * @param {boolean} complete\n   * @param {boolean} filtered\n   * @return {!ViewCache}\n   */\n  updateEventSnap(\n    eventSnap: Node,\n    complete: boolean,\n    filtered: boolean\n  ): ViewCache {\n    return new ViewCache(\n      new CacheNode(eventSnap, complete, filtered),\n      this.serverCache_\n    );\n  }\n\n  /**\n   * @param {!Node} serverSnap\n   * @param {boolean} complete\n   * @param {boolean} filtered\n   * @return {!ViewCache}\n   */\n  updateServerSnap(\n    serverSnap: Node,\n    complete: boolean,\n    filtered: boolean\n  ): ViewCache {\n    return new ViewCache(\n      this.eventCache_,\n      new CacheNode(serverSnap, complete, filtered)\n    );\n  }\n\n  /**\n   * @return {!CacheNode}\n   */\n  getEventCache(): CacheNode {\n    return this.eventCache_;\n  }\n\n  /**\n   * @return {?Node}\n   */\n  getCompleteEventSnap(): Node | null {\n    return this.eventCache_.isFullyInitialized()\n      ? this.eventCache_.getNode()\n      : null;\n  }\n\n  /**\n   * @return {!CacheNode}\n   */\n  getServerCache(): CacheNode {\n    return this.serverCache_;\n  }\n\n  /**\n   * @return {?Node}\n   */\n  getCompleteServerSnap(): Node | null {\n    return this.serverCache_.isFullyInitialized()\n      ? this.serverCache_.getNode()\n      : null;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Node } from '../snap/Node';\n\n/**\n * @constructor\n * @struct\n * @param {!string} type The event type\n * @param {!Node} snapshotNode The data\n * @param {string=} childName The name for this child, if it's a child event\n * @param {Node=} oldSnap Used for intermediate processing of child changed events\n * @param {string=} prevName The name for the previous child, if applicable\n */\nexport class Change {\n  constructor(\n    public type: string,\n    public snapshotNode: Node,\n    public childName?: string,\n    public oldSnap?: Node,\n    public prevName?: string | null\n  ) {}\n\n  /**\n   * @param {!Node} snapshot\n   * @return {!Change}\n   */\n  static valueChange(snapshot: Node): Change {\n    return new Change(Change.VALUE, snapshot);\n  }\n\n  /**\n   * @param {string} childKey\n   * @param {!Node} snapshot\n   * @return {!Change}\n   */\n  static childAddedChange(childKey: string, snapshot: Node): Change {\n    return new Change(Change.CHILD_ADDED, snapshot, childKey);\n  }\n\n  /**\n   * @param {string} childKey\n   * @param {!Node} snapshot\n   * @return {!Change}\n   */\n  static childRemovedChange(childKey: string, snapshot: Node): Change {\n    return new Change(Change.CHILD_REMOVED, snapshot, childKey);\n  }\n\n  /**\n   * @param {string} childKey\n   * @param {!Node} newSnapshot\n   * @param {!Node} oldSnapshot\n   * @return {!Change}\n   */\n  static childChangedChange(\n    childKey: string,\n    newSnapshot: Node,\n    oldSnapshot: Node\n  ): Change {\n    return new Change(Change.CHILD_CHANGED, newSnapshot, childKey, oldSnapshot);\n  }\n\n  /**\n   * @param {string} childKey\n   * @param {!Node} snapshot\n   * @return {!Change}\n   */\n  static childMovedChange(childKey: string, snapshot: Node): Change {\n    return new Change(Change.CHILD_MOVED, snapshot, childKey);\n  }\n\n  //event types\n  /** Event type for a child added */\n  static CHILD_ADDED = 'child_added';\n\n  /** Event type for a child removed */\n  static CHILD_REMOVED = 'child_removed';\n\n  /** Event type for a child changed */\n  static CHILD_CHANGED = 'child_changed';\n\n  /** Event type for a child moved */\n  static CHILD_MOVED = 'child_moved';\n\n  /** Event type for a value change */\n  static VALUE = 'value';\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { Change } from '../Change';\nimport { ChildrenNode } from '../../snap/ChildrenNode';\nimport { PRIORITY_INDEX } from '../../snap/indexes/PriorityIndex';\nimport { NodeFilter } from './NodeFilter';\nimport { Index } from '../../snap/indexes/Index';\nimport { Path } from '../../util/Path';\nimport { CompleteChildSource } from '../CompleteChildSource';\nimport { ChildChangeAccumulator } from '../ChildChangeAccumulator';\nimport { Node } from '../../snap/Node';\n\n/**\n * Doesn't really filter nodes but applies an index to the node and keeps track of any changes\n *\n * @constructor\n * @implements {NodeFilter}\n * @param {!Index} index\n */\nexport class IndexedFilter implements NodeFilter {\n  constructor(private readonly index_: Index) {}\n\n  updateChild(\n    snap: Node,\n    key: string,\n    newChild: Node,\n    affectedPath: Path,\n    source: CompleteChildSource,\n    optChangeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    assert(\n      snap.isIndexed(this.index_),\n      'A node must be indexed if only a child is updated'\n    );\n    const oldChild = snap.getImmediateChild(key);\n    // Check if anything actually changed.\n    if (\n      oldChild.getChild(affectedPath).equals(newChild.getChild(affectedPath))\n    ) {\n      // There's an edge case where a child can enter or leave the view because affectedPath was set to null.\n      // In this case, affectedPath will appear null in both the old and new snapshots.  So we need\n      // to avoid treating these cases as \"nothing changed.\"\n      if (oldChild.isEmpty() == newChild.isEmpty()) {\n        // Nothing changed.\n\n        // This assert should be valid, but it's expensive (can dominate perf testing) so don't actually do it.\n        //assert(oldChild.equals(newChild), 'Old and new snapshots should be equal.');\n        return snap;\n      }\n    }\n\n    if (optChangeAccumulator != null) {\n      if (newChild.isEmpty()) {\n        if (snap.hasChild(key)) {\n          optChangeAccumulator.trackChildChange(\n            Change.childRemovedChange(key, oldChild)\n          );\n        } else {\n          assert(\n            snap.isLeafNode(),\n            'A child remove without an old child only makes sense on a leaf node'\n          );\n        }\n      } else if (oldChild.isEmpty()) {\n        optChangeAccumulator.trackChildChange(\n          Change.childAddedChange(key, newChild)\n        );\n      } else {\n        optChangeAccumulator.trackChildChange(\n          Change.childChangedChange(key, newChild, oldChild)\n        );\n      }\n    }\n    if (snap.isLeafNode() && newChild.isEmpty()) {\n      return snap;\n    } else {\n      // Make sure the node is indexed\n      return snap.updateImmediateChild(key, newChild).withIndex(this.index_);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updateFullNode(\n    oldSnap: Node,\n    newSnap: Node,\n    optChangeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    if (optChangeAccumulator != null) {\n      if (!oldSnap.isLeafNode()) {\n        oldSnap.forEachChild(PRIORITY_INDEX, function(key, childNode) {\n          if (!newSnap.hasChild(key)) {\n            optChangeAccumulator.trackChildChange(\n              Change.childRemovedChange(key, childNode)\n            );\n          }\n        });\n      }\n      if (!newSnap.isLeafNode()) {\n        newSnap.forEachChild(PRIORITY_INDEX, function(key, childNode) {\n          if (oldSnap.hasChild(key)) {\n            const oldChild = oldSnap.getImmediateChild(key);\n            if (!oldChild.equals(childNode)) {\n              optChangeAccumulator.trackChildChange(\n                Change.childChangedChange(key, childNode, oldChild)\n              );\n            }\n          } else {\n            optChangeAccumulator.trackChildChange(\n              Change.childAddedChange(key, childNode)\n            );\n          }\n        });\n      }\n    }\n    return newSnap.withIndex(this.index_);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updatePriority(oldSnap: Node, newPriority: Node): Node {\n    if (oldSnap.isEmpty()) {\n      return ChildrenNode.EMPTY_NODE;\n    } else {\n      return oldSnap.updatePriority(newPriority);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  filtersNodes(): boolean {\n    return false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getIndexedFilter(): IndexedFilter {\n    return this;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getIndex(): Index {\n    return this.index_;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Change } from './Change';\nimport { assert, assertionError } from '@firebase/util';\n\nexport class ChildChangeAccumulator {\n  private readonly changeMap: Map<string, Change> = new Map();\n\n  trackChildChange(change: Change) {\n    const type = change.type;\n    const childKey = change.childName!;\n    assert(\n      type == Change.CHILD_ADDED ||\n        type == Change.CHILD_CHANGED ||\n        type == Change.CHILD_REMOVED,\n      'Only child changes supported for tracking'\n    );\n    assert(\n      childKey !== '.priority',\n      'Only non-priority child changes can be tracked.'\n    );\n    const oldChange = this.changeMap.get(childKey);\n    if (oldChange) {\n      const oldType = oldChange.type;\n      if (type == Change.CHILD_ADDED && oldType == Change.CHILD_REMOVED) {\n        this.changeMap.set(\n          childKey,\n          Change.childChangedChange(\n            childKey,\n            change.snapshotNode,\n            oldChange.snapshotNode\n          )\n        );\n      } else if (\n        type == Change.CHILD_REMOVED &&\n        oldType == Change.CHILD_ADDED\n      ) {\n        this.changeMap.delete(childKey);\n      } else if (\n        type == Change.CHILD_REMOVED &&\n        oldType == Change.CHILD_CHANGED\n      ) {\n        this.changeMap.set(\n          childKey,\n          Change.childRemovedChange(childKey, oldChange.oldSnap)\n        );\n      } else if (\n        type == Change.CHILD_CHANGED &&\n        oldType == Change.CHILD_ADDED\n      ) {\n        this.changeMap.set(\n          childKey,\n          Change.childAddedChange(childKey, change.snapshotNode)\n        );\n      } else if (\n        type == Change.CHILD_CHANGED &&\n        oldType == Change.CHILD_CHANGED\n      ) {\n        this.changeMap.set(\n          childKey,\n          Change.childChangedChange(\n            childKey,\n            change.snapshotNode,\n            oldChange.oldSnap\n          )\n        );\n      } else {\n        throw assertionError(\n          'Illegal combination of changes: ' +\n            change +\n            ' occurred after ' +\n            oldChange\n        );\n      }\n    } else {\n      this.changeMap.set(childKey, change);\n    }\n  }\n\n  getChanges(): Change[] {\n    return Array.from(this.changeMap.values());\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CacheNode } from './CacheNode';\nimport { NamedNode, Node } from '../snap/Node';\nimport { Index } from '../snap/indexes/Index';\nimport { WriteTreeRef } from '../WriteTree';\nimport { ViewCache } from './ViewCache';\n\n/**\n * Since updates to filtered nodes might require nodes to be pulled in from \"outside\" the node, this interface\n * can help to get complete children that can be pulled in.\n * A class implementing this interface takes potentially multiple sources (e.g. user writes, server data from\n * other views etc.) to try it's best to get a complete child that might be useful in pulling into the view.\n *\n * @interface\n */\nexport interface CompleteChildSource {\n  /**\n   * @param {!string} childKey\n   * @return {?Node}\n   */\n  getCompleteChild(childKey: string): Node | null;\n\n  /**\n   * @param {!Index} index\n   * @param {!NamedNode} child\n   * @param {boolean} reverse\n   * @return {?NamedNode}\n   */\n  getChildAfterChild(\n    index: Index,\n    child: NamedNode,\n    reverse: boolean\n  ): NamedNode | null;\n}\n\n/**\n * An implementation of CompleteChildSource that never returns any additional children\n *\n * @private\n * @constructor\n * @implements CompleteChildSource\n */\nexport class NoCompleteChildSource_ implements CompleteChildSource {\n  /**\n   * @inheritDoc\n   */\n  getCompleteChild(childKey?: string): Node | null {\n    return null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getChildAfterChild(\n    index?: Index,\n    child?: NamedNode,\n    reverse?: boolean\n  ): NamedNode | null {\n    return null;\n  }\n}\n\n/**\n * Singleton instance.\n * @const\n * @type {!CompleteChildSource}\n */\nexport const NO_COMPLETE_CHILD_SOURCE = new NoCompleteChildSource_();\n\n/**\n * An implementation of CompleteChildSource that uses a WriteTree in addition to any other server data or\n * old event caches available to calculate complete children.\n *\n *\n * @implements CompleteChildSource\n */\nexport class WriteTreeCompleteChildSource implements CompleteChildSource {\n  /**\n   * @param {!WriteTreeRef} writes_\n   * @param {!ViewCache} viewCache_\n   * @param {?Node} optCompleteServerCache_\n   */\n  constructor(\n    private writes_: WriteTreeRef,\n    private viewCache_: ViewCache,\n    private optCompleteServerCache_: Node | null = null\n  ) {}\n\n  /**\n   * @inheritDoc\n   */\n  getCompleteChild(childKey: string): Node | null {\n    const node = this.viewCache_.getEventCache();\n    if (node.isCompleteForChild(childKey)) {\n      return node.getNode().getImmediateChild(childKey);\n    } else {\n      const serverNode =\n        this.optCompleteServerCache_ != null\n          ? new CacheNode(this.optCompleteServerCache_, true, false)\n          : this.viewCache_.getServerCache();\n      return this.writes_.calcCompleteChild(childKey, serverNode);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getChildAfterChild(\n    index: Index,\n    child: NamedNode,\n    reverse: boolean\n  ): NamedNode | null {\n    const completeServerData =\n      this.optCompleteServerCache_ != null\n        ? this.optCompleteServerCache_\n        : this.viewCache_.getCompleteServerSnap();\n    const nodes = this.writes_.calcIndexedSlice(\n      completeServerData,\n      child,\n      1,\n      reverse,\n      index\n    );\n    if (nodes.length === 0) {\n      return null;\n    } else {\n      return nodes[0];\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Operation, OperationType } from '../operation/Operation';\nimport { assert, assertionError } from '@firebase/util';\nimport { ChildChangeAccumulator } from './ChildChangeAccumulator';\nimport { Change } from './Change';\nimport { ChildrenNode } from '../snap/ChildrenNode';\nimport { KEY_INDEX } from '../snap/indexes/KeyIndex';\nimport { ImmutableTree } from '../util/ImmutableTree';\nimport { Path } from '../util/Path';\nimport {\n  WriteTreeCompleteChildSource,\n  NO_COMPLETE_CHILD_SOURCE,\n  CompleteChildSource\n} from './CompleteChildSource';\nimport { ViewCache } from './ViewCache';\nimport { NodeFilter } from './filter/NodeFilter';\nimport { WriteTreeRef } from '../WriteTree';\nimport { Overwrite } from '../operation/Overwrite';\nimport { Merge } from '../operation/Merge';\nimport { AckUserWrite } from '../operation/AckUserWrite';\nimport { Node } from '../snap/Node';\n\n/**\n * @constructor\n * @struct\n */\nexport class ProcessorResult {\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Array.<!Change>} changes\n   */\n  constructor(\n    public readonly viewCache: ViewCache,\n    public readonly changes: Change[]\n  ) {}\n}\n\n/**\n * @constructor\n */\nexport class ViewProcessor {\n  /**\n   * @param {!NodeFilter} filter_\n   */\n  constructor(private readonly filter_: NodeFilter) {}\n\n  /**\n   * @param {!ViewCache} viewCache\n   */\n  assertIndexed(viewCache: ViewCache) {\n    assert(\n      viewCache\n        .getEventCache()\n        .getNode()\n        .isIndexed(this.filter_.getIndex()),\n      'Event snap not indexed'\n    );\n    assert(\n      viewCache\n        .getServerCache()\n        .getNode()\n        .isIndexed(this.filter_.getIndex()),\n      'Server snap not indexed'\n    );\n  }\n\n  /**\n   * @param {!ViewCache} oldViewCache\n   * @param {!Operation} operation\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} completeCache\n   * @return {!ProcessorResult}\n   */\n  applyOperation(\n    oldViewCache: ViewCache,\n    operation: Operation,\n    writesCache: WriteTreeRef,\n    completeCache: Node | null\n  ): ProcessorResult {\n    const accumulator = new ChildChangeAccumulator();\n    let newViewCache, filterServerNode;\n    if (operation.type === OperationType.OVERWRITE) {\n      const overwrite = operation as Overwrite;\n      if (overwrite.source.fromUser) {\n        newViewCache = this.applyUserOverwrite_(\n          oldViewCache,\n          overwrite.path,\n          overwrite.snap,\n          writesCache,\n          completeCache,\n          accumulator\n        );\n      } else {\n        assert(overwrite.source.fromServer, 'Unknown source.');\n        // We filter the node if it's a tagged update or the node has been previously filtered  and the\n        // update is not at the root in which case it is ok (and necessary) to mark the node unfiltered\n        // again\n        filterServerNode =\n          overwrite.source.tagged ||\n          (oldViewCache.getServerCache().isFiltered() &&\n            !overwrite.path.isEmpty());\n        newViewCache = this.applyServerOverwrite_(\n          oldViewCache,\n          overwrite.path,\n          overwrite.snap,\n          writesCache,\n          completeCache,\n          filterServerNode,\n          accumulator\n        );\n      }\n    } else if (operation.type === OperationType.MERGE) {\n      const merge = operation as Merge;\n      if (merge.source.fromUser) {\n        newViewCache = this.applyUserMerge_(\n          oldViewCache,\n          merge.path,\n          merge.children,\n          writesCache,\n          completeCache,\n          accumulator\n        );\n      } else {\n        assert(merge.source.fromServer, 'Unknown source.');\n        // We filter the node if it's a tagged update or the node has been previously filtered\n        filterServerNode =\n          merge.source.tagged || oldViewCache.getServerCache().isFiltered();\n        newViewCache = this.applyServerMerge_(\n          oldViewCache,\n          merge.path,\n          merge.children,\n          writesCache,\n          completeCache,\n          filterServerNode,\n          accumulator\n        );\n      }\n    } else if (operation.type === OperationType.ACK_USER_WRITE) {\n      const ackUserWrite = operation as AckUserWrite;\n      if (!ackUserWrite.revert) {\n        newViewCache = this.ackUserWrite_(\n          oldViewCache,\n          ackUserWrite.path,\n          ackUserWrite.affectedTree,\n          writesCache,\n          completeCache,\n          accumulator\n        );\n      } else {\n        newViewCache = this.revertUserWrite_(\n          oldViewCache,\n          ackUserWrite.path,\n          writesCache,\n          completeCache,\n          accumulator\n        );\n      }\n    } else if (operation.type === OperationType.LISTEN_COMPLETE) {\n      newViewCache = this.listenComplete_(\n        oldViewCache,\n        operation.path,\n        writesCache,\n        accumulator\n      );\n    } else {\n      throw assertionError('Unknown operation type: ' + operation.type);\n    }\n    const changes = accumulator.getChanges();\n    ViewProcessor.maybeAddValueEvent_(oldViewCache, newViewCache, changes);\n    return new ProcessorResult(newViewCache, changes);\n  }\n\n  /**\n   * @param {!ViewCache} oldViewCache\n   * @param {!ViewCache} newViewCache\n   * @param {!Array.<!Change>} accumulator\n   * @private\n   */\n  private static maybeAddValueEvent_(\n    oldViewCache: ViewCache,\n    newViewCache: ViewCache,\n    accumulator: Change[]\n  ) {\n    const eventSnap = newViewCache.getEventCache();\n    if (eventSnap.isFullyInitialized()) {\n      const isLeafOrEmpty =\n        eventSnap.getNode().isLeafNode() || eventSnap.getNode().isEmpty();\n      const oldCompleteSnap = oldViewCache.getCompleteEventSnap();\n      if (\n        accumulator.length > 0 ||\n        !oldViewCache.getEventCache().isFullyInitialized() ||\n        (isLeafOrEmpty &&\n          !eventSnap.getNode().equals(/** @type {!Node} */ oldCompleteSnap)) ||\n        !eventSnap\n          .getNode()\n          .getPriority()\n          .equals(oldCompleteSnap.getPriority())\n      ) {\n        accumulator.push(\n          Change.valueChange(\n            /** @type {!Node} */ newViewCache.getCompleteEventSnap()\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Path} changePath\n   * @param {!WriteTreeRef} writesCache\n   * @param {!CompleteChildSource} source\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  private generateEventCacheAfterServerEvent_(\n    viewCache: ViewCache,\n    changePath: Path,\n    writesCache: WriteTreeRef,\n    source: CompleteChildSource,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    const oldEventSnap = viewCache.getEventCache();\n    if (writesCache.shadowingWrite(changePath) != null) {\n      // we have a shadowing write, ignore changes\n      return viewCache;\n    } else {\n      let newEventCache, serverNode;\n      if (changePath.isEmpty()) {\n        // TODO: figure out how this plays with \"sliding ack windows\"\n        assert(\n          viewCache.getServerCache().isFullyInitialized(),\n          'If change path is empty, we must have complete server data'\n        );\n        if (viewCache.getServerCache().isFiltered()) {\n          // We need to special case this, because we need to only apply writes to complete children, or\n          // we might end up raising events for incomplete children. If the server data is filtered deep\n          // writes cannot be guaranteed to be complete\n          const serverCache = viewCache.getCompleteServerSnap();\n          const completeChildren =\n            serverCache instanceof ChildrenNode\n              ? serverCache\n              : ChildrenNode.EMPTY_NODE;\n          const completeEventChildren = writesCache.calcCompleteEventChildren(\n            completeChildren\n          );\n          newEventCache = this.filter_.updateFullNode(\n            viewCache.getEventCache().getNode(),\n            completeEventChildren,\n            accumulator\n          );\n        } else {\n          const completeNode = writesCache.calcCompleteEventCache(\n            viewCache.getCompleteServerSnap()\n          );\n          newEventCache = this.filter_.updateFullNode(\n            viewCache.getEventCache().getNode(),\n            completeNode,\n            accumulator\n          );\n        }\n      } else {\n        const childKey = changePath.getFront();\n        if (childKey == '.priority') {\n          assert(\n            changePath.getLength() == 1,\n            \"Can't have a priority with additional path components\"\n          );\n          const oldEventNode = oldEventSnap.getNode();\n          serverNode = viewCache.getServerCache().getNode();\n          // we might have overwrites for this priority\n          const updatedPriority = writesCache.calcEventCacheAfterServerOverwrite(\n            changePath,\n            oldEventNode,\n            serverNode\n          );\n          if (updatedPriority != null) {\n            newEventCache = this.filter_.updatePriority(\n              oldEventNode,\n              updatedPriority\n            );\n          } else {\n            // priority didn't change, keep old node\n            newEventCache = oldEventSnap.getNode();\n          }\n        } else {\n          const childChangePath = changePath.popFront();\n          // update child\n          let newEventChild;\n          if (oldEventSnap.isCompleteForChild(childKey)) {\n            serverNode = viewCache.getServerCache().getNode();\n            const eventChildUpdate = writesCache.calcEventCacheAfterServerOverwrite(\n              changePath,\n              oldEventSnap.getNode(),\n              serverNode\n            );\n            if (eventChildUpdate != null) {\n              newEventChild = oldEventSnap\n                .getNode()\n                .getImmediateChild(childKey)\n                .updateChild(childChangePath, eventChildUpdate);\n            } else {\n              // Nothing changed, just keep the old child\n              newEventChild = oldEventSnap\n                .getNode()\n                .getImmediateChild(childKey);\n            }\n          } else {\n            newEventChild = writesCache.calcCompleteChild(\n              childKey,\n              viewCache.getServerCache()\n            );\n          }\n          if (newEventChild != null) {\n            newEventCache = this.filter_.updateChild(\n              oldEventSnap.getNode(),\n              childKey,\n              newEventChild,\n              childChangePath,\n              source,\n              accumulator\n            );\n          } else {\n            // no complete child available or no change\n            newEventCache = oldEventSnap.getNode();\n          }\n        }\n      }\n      return viewCache.updateEventSnap(\n        newEventCache,\n        oldEventSnap.isFullyInitialized() || changePath.isEmpty(),\n        this.filter_.filtersNodes()\n      );\n    }\n  }\n\n  /**\n   * @param {!ViewCache} oldViewCache\n   * @param {!Path} changePath\n   * @param {!Node} changedSnap\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} completeCache\n   * @param {boolean} filterServerNode\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  applyServerOverwrite_(\n    oldViewCache: ViewCache,\n    changePath: Path,\n    changedSnap: Node,\n    writesCache: WriteTreeRef,\n    completeCache: Node | null,\n    filterServerNode: boolean,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    const oldServerSnap = oldViewCache.getServerCache();\n    let newServerCache;\n    const serverFilter = filterServerNode\n      ? this.filter_\n      : this.filter_.getIndexedFilter();\n    if (changePath.isEmpty()) {\n      newServerCache = serverFilter.updateFullNode(\n        oldServerSnap.getNode(),\n        changedSnap,\n        null\n      );\n    } else if (serverFilter.filtersNodes() && !oldServerSnap.isFiltered()) {\n      // we want to filter the server node, but we didn't filter the server node yet, so simulate a full update\n      const newServerNode = oldServerSnap\n        .getNode()\n        .updateChild(changePath, changedSnap);\n      newServerCache = serverFilter.updateFullNode(\n        oldServerSnap.getNode(),\n        newServerNode,\n        null\n      );\n    } else {\n      const childKey = changePath.getFront();\n      if (\n        !oldServerSnap.isCompleteForPath(changePath) &&\n        changePath.getLength() > 1\n      ) {\n        // We don't update incomplete nodes with updates intended for other listeners\n        return oldViewCache;\n      }\n      const childChangePath = changePath.popFront();\n      const childNode = oldServerSnap.getNode().getImmediateChild(childKey);\n      const newChildNode = childNode.updateChild(childChangePath, changedSnap);\n      if (childKey == '.priority') {\n        newServerCache = serverFilter.updatePriority(\n          oldServerSnap.getNode(),\n          newChildNode\n        );\n      } else {\n        newServerCache = serverFilter.updateChild(\n          oldServerSnap.getNode(),\n          childKey,\n          newChildNode,\n          childChangePath,\n          NO_COMPLETE_CHILD_SOURCE,\n          null\n        );\n      }\n    }\n    const newViewCache = oldViewCache.updateServerSnap(\n      newServerCache,\n      oldServerSnap.isFullyInitialized() || changePath.isEmpty(),\n      serverFilter.filtersNodes()\n    );\n    const source = new WriteTreeCompleteChildSource(\n      writesCache,\n      newViewCache,\n      completeCache\n    );\n    return this.generateEventCacheAfterServerEvent_(\n      newViewCache,\n      changePath,\n      writesCache,\n      source,\n      accumulator\n    );\n  }\n\n  /**\n   * @param {!ViewCache} oldViewCache\n   * @param {!Path} changePath\n   * @param {!Node} changedSnap\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} completeCache\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  applyUserOverwrite_(\n    oldViewCache: ViewCache,\n    changePath: Path,\n    changedSnap: Node,\n    writesCache: WriteTreeRef,\n    completeCache: Node | null,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    const oldEventSnap = oldViewCache.getEventCache();\n    let newViewCache, newEventCache;\n    const source = new WriteTreeCompleteChildSource(\n      writesCache,\n      oldViewCache,\n      completeCache\n    );\n    if (changePath.isEmpty()) {\n      newEventCache = this.filter_.updateFullNode(\n        oldViewCache.getEventCache().getNode(),\n        changedSnap,\n        accumulator\n      );\n      newViewCache = oldViewCache.updateEventSnap(\n        newEventCache,\n        true,\n        this.filter_.filtersNodes()\n      );\n    } else {\n      const childKey = changePath.getFront();\n      if (childKey === '.priority') {\n        newEventCache = this.filter_.updatePriority(\n          oldViewCache.getEventCache().getNode(),\n          changedSnap\n        );\n        newViewCache = oldViewCache.updateEventSnap(\n          newEventCache,\n          oldEventSnap.isFullyInitialized(),\n          oldEventSnap.isFiltered()\n        );\n      } else {\n        const childChangePath = changePath.popFront();\n        const oldChild = oldEventSnap.getNode().getImmediateChild(childKey);\n        let newChild;\n        if (childChangePath.isEmpty()) {\n          // Child overwrite, we can replace the child\n          newChild = changedSnap;\n        } else {\n          const childNode = source.getCompleteChild(childKey);\n          if (childNode != null) {\n            if (\n              childChangePath.getBack() === '.priority' &&\n              childNode.getChild(childChangePath.parent()).isEmpty()\n            ) {\n              // This is a priority update on an empty node. If this node exists on the server, the\n              // server will send down the priority in the update, so ignore for now\n              newChild = childNode;\n            } else {\n              newChild = childNode.updateChild(childChangePath, changedSnap);\n            }\n          } else {\n            // There is no complete child node available\n            newChild = ChildrenNode.EMPTY_NODE;\n          }\n        }\n        if (!oldChild.equals(newChild)) {\n          const newEventSnap = this.filter_.updateChild(\n            oldEventSnap.getNode(),\n            childKey,\n            newChild,\n            childChangePath,\n            source,\n            accumulator\n          );\n          newViewCache = oldViewCache.updateEventSnap(\n            newEventSnap,\n            oldEventSnap.isFullyInitialized(),\n            this.filter_.filtersNodes()\n          );\n        } else {\n          newViewCache = oldViewCache;\n        }\n      }\n    }\n    return newViewCache;\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {string} childKey\n   * @return {boolean}\n   * @private\n   */\n  private static cacheHasChild_(\n    viewCache: ViewCache,\n    childKey: string\n  ): boolean {\n    return viewCache.getEventCache().isCompleteForChild(childKey);\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Path} path\n   * @param {ImmutableTree.<!Node>} changedChildren\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} serverCache\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  private applyUserMerge_(\n    viewCache: ViewCache,\n    path: Path,\n    changedChildren: ImmutableTree<Node>,\n    writesCache: WriteTreeRef,\n    serverCache: Node | null,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    // HACK: In the case of a limit query, there may be some changes that bump things out of the\n    // window leaving room for new items.  It's important we process these changes first, so we\n    // iterate the changes twice, first processing any that affect items currently in view.\n    // TODO: I consider an item \"in view\" if cacheHasChild is true, which checks both the server\n    // and event snap.  I'm not sure if this will result in edge cases when a child is in one but\n    // not the other.\n    let curViewCache = viewCache;\n    changedChildren.foreach((relativePath, childNode) => {\n      const writePath = path.child(relativePath);\n      if (ViewProcessor.cacheHasChild_(viewCache, writePath.getFront())) {\n        curViewCache = this.applyUserOverwrite_(\n          curViewCache,\n          writePath,\n          childNode,\n          writesCache,\n          serverCache,\n          accumulator\n        );\n      }\n    });\n\n    changedChildren.foreach((relativePath, childNode) => {\n      const writePath = path.child(relativePath);\n      if (!ViewProcessor.cacheHasChild_(viewCache, writePath.getFront())) {\n        curViewCache = this.applyUserOverwrite_(\n          curViewCache,\n          writePath,\n          childNode,\n          writesCache,\n          serverCache,\n          accumulator\n        );\n      }\n    });\n\n    return curViewCache;\n  }\n\n  /**\n   * @param {!Node} node\n   * @param {ImmutableTree.<!Node>} merge\n   * @return {!Node}\n   * @private\n   */\n  private applyMerge_(node: Node, merge: ImmutableTree<Node>): Node {\n    merge.foreach(function(relativePath, childNode) {\n      node = node.updateChild(relativePath, childNode);\n    });\n    return node;\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Path} path\n   * @param {!ImmutableTree.<!Node>} changedChildren\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} serverCache\n   * @param {boolean} filterServerNode\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  private applyServerMerge_(\n    viewCache: ViewCache,\n    path: Path,\n    changedChildren: ImmutableTree<Node>,\n    writesCache: WriteTreeRef,\n    serverCache: Node | null,\n    filterServerNode: boolean,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    // If we don't have a cache yet, this merge was intended for a previously listen in the same location. Ignore it and\n    // wait for the complete data update coming soon.\n    if (\n      viewCache\n        .getServerCache()\n        .getNode()\n        .isEmpty() &&\n      !viewCache.getServerCache().isFullyInitialized()\n    ) {\n      return viewCache;\n    }\n\n    // HACK: In the case of a limit query, there may be some changes that bump things out of the\n    // window leaving room for new items.  It's important we process these changes first, so we\n    // iterate the changes twice, first processing any that affect items currently in view.\n    // TODO: I consider an item \"in view\" if cacheHasChild is true, which checks both the server\n    // and event snap.  I'm not sure if this will result in edge cases when a child is in one but\n    // not the other.\n    let curViewCache = viewCache;\n    let viewMergeTree;\n    if (path.isEmpty()) {\n      viewMergeTree = changedChildren;\n    } else {\n      viewMergeTree = ImmutableTree.Empty.setTree(path, changedChildren);\n    }\n    const serverNode = viewCache.getServerCache().getNode();\n    viewMergeTree.children.inorderTraversal((childKey, childTree) => {\n      if (serverNode.hasChild(childKey)) {\n        const serverChild = viewCache\n          .getServerCache()\n          .getNode()\n          .getImmediateChild(childKey);\n        const newChild = this.applyMerge_(serverChild, childTree);\n        curViewCache = this.applyServerOverwrite_(\n          curViewCache,\n          new Path(childKey),\n          newChild,\n          writesCache,\n          serverCache,\n          filterServerNode,\n          accumulator\n        );\n      }\n    });\n    viewMergeTree.children.inorderTraversal((childKey, childMergeTree) => {\n      const isUnknownDeepMerge =\n        !viewCache.getServerCache().isCompleteForChild(childKey) &&\n        childMergeTree.value == null;\n      if (!serverNode.hasChild(childKey) && !isUnknownDeepMerge) {\n        const serverChild = viewCache\n          .getServerCache()\n          .getNode()\n          .getImmediateChild(childKey);\n        const newChild = this.applyMerge_(serverChild, childMergeTree);\n        curViewCache = this.applyServerOverwrite_(\n          curViewCache,\n          new Path(childKey),\n          newChild,\n          writesCache,\n          serverCache,\n          filterServerNode,\n          accumulator\n        );\n      }\n    });\n\n    return curViewCache;\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Path} ackPath\n   * @param {!ImmutableTree<!boolean>} affectedTree\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} completeCache\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  private ackUserWrite_(\n    viewCache: ViewCache,\n    ackPath: Path,\n    affectedTree: ImmutableTree<boolean>,\n    writesCache: WriteTreeRef,\n    completeCache: Node | null,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    if (writesCache.shadowingWrite(ackPath) != null) {\n      return viewCache;\n    }\n\n    // Only filter server node if it is currently filtered\n    const filterServerNode = viewCache.getServerCache().isFiltered();\n\n    // Essentially we'll just get our existing server cache for the affected paths and re-apply it as a server update\n    // now that it won't be shadowed.\n    const serverCache = viewCache.getServerCache();\n    if (affectedTree.value != null) {\n      // This is an overwrite.\n      if (\n        (ackPath.isEmpty() && serverCache.isFullyInitialized()) ||\n        serverCache.isCompleteForPath(ackPath)\n      ) {\n        return this.applyServerOverwrite_(\n          viewCache,\n          ackPath,\n          serverCache.getNode().getChild(ackPath),\n          writesCache,\n          completeCache,\n          filterServerNode,\n          accumulator\n        );\n      } else if (ackPath.isEmpty()) {\n        // This is a goofy edge case where we are acking data at this location but don't have full data.  We\n        // should just re-apply whatever we have in our cache as a merge.\n        let changedChildren = ImmutableTree.Empty;\n        serverCache.getNode().forEachChild(KEY_INDEX, function(name, node) {\n          changedChildren = changedChildren.set(new Path(name), node);\n        });\n        return this.applyServerMerge_(\n          viewCache,\n          ackPath,\n          changedChildren,\n          writesCache,\n          completeCache,\n          filterServerNode,\n          accumulator\n        );\n      } else {\n        return viewCache;\n      }\n    } else {\n      // This is a merge.\n      let changedChildren = ImmutableTree.Empty;\n      affectedTree.foreach(function(mergePath, value) {\n        const serverCachePath = ackPath.child(mergePath);\n        if (serverCache.isCompleteForPath(serverCachePath)) {\n          changedChildren = changedChildren.set(\n            mergePath,\n            serverCache.getNode().getChild(serverCachePath)\n          );\n        }\n      });\n      return this.applyServerMerge_(\n        viewCache,\n        ackPath,\n        changedChildren,\n        writesCache,\n        completeCache,\n        filterServerNode,\n        accumulator\n      );\n    }\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Path} path\n   * @param {!WriteTreeRef} writesCache\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  private listenComplete_(\n    viewCache: ViewCache,\n    path: Path,\n    writesCache: WriteTreeRef,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    const oldServerNode = viewCache.getServerCache();\n    const newViewCache = viewCache.updateServerSnap(\n      oldServerNode.getNode(),\n      oldServerNode.isFullyInitialized() || path.isEmpty(),\n      oldServerNode.isFiltered()\n    );\n    return this.generateEventCacheAfterServerEvent_(\n      newViewCache,\n      path,\n      writesCache,\n      NO_COMPLETE_CHILD_SOURCE,\n      accumulator\n    );\n  }\n\n  /**\n   * @param {!ViewCache} viewCache\n   * @param {!Path} path\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} completeServerCache\n   * @param {!ChildChangeAccumulator} accumulator\n   * @return {!ViewCache}\n   * @private\n   */\n  private revertUserWrite_(\n    viewCache: ViewCache,\n    path: Path,\n    writesCache: WriteTreeRef,\n    completeServerCache: Node | null,\n    accumulator: ChildChangeAccumulator\n  ): ViewCache {\n    let complete;\n    if (writesCache.shadowingWrite(path) != null) {\n      return viewCache;\n    } else {\n      const source = new WriteTreeCompleteChildSource(\n        writesCache,\n        viewCache,\n        completeServerCache\n      );\n      const oldEventCache = viewCache.getEventCache().getNode();\n      let newEventCache;\n      if (path.isEmpty() || path.getFront() === '.priority') {\n        let newNode;\n        if (viewCache.getServerCache().isFullyInitialized()) {\n          newNode = writesCache.calcCompleteEventCache(\n            viewCache.getCompleteServerSnap()\n          );\n        } else {\n          const serverChildren = viewCache.getServerCache().getNode();\n          assert(\n            serverChildren instanceof ChildrenNode,\n            'serverChildren would be complete if leaf node'\n          );\n          newNode = writesCache.calcCompleteEventChildren(\n            serverChildren as ChildrenNode\n          );\n        }\n        newNode = newNode as Node;\n        newEventCache = this.filter_.updateFullNode(\n          oldEventCache,\n          newNode,\n          accumulator\n        );\n      } else {\n        const childKey = path.getFront();\n        let newChild = writesCache.calcCompleteChild(\n          childKey,\n          viewCache.getServerCache()\n        );\n        if (\n          newChild == null &&\n          viewCache.getServerCache().isCompleteForChild(childKey)\n        ) {\n          newChild = oldEventCache.getImmediateChild(childKey);\n        }\n        if (newChild != null) {\n          newEventCache = this.filter_.updateChild(\n            oldEventCache,\n            childKey,\n            newChild,\n            path.popFront(),\n            source,\n            accumulator\n          );\n        } else if (\n          viewCache\n            .getEventCache()\n            .getNode()\n            .hasChild(childKey)\n        ) {\n          // No complete child available, delete the existing one, if any\n          newEventCache = this.filter_.updateChild(\n            oldEventCache,\n            childKey,\n            ChildrenNode.EMPTY_NODE,\n            path.popFront(),\n            source,\n            accumulator\n          );\n        } else {\n          newEventCache = oldEventCache;\n        }\n        if (\n          newEventCache.isEmpty() &&\n          viewCache.getServerCache().isFullyInitialized()\n        ) {\n          // We might have reverted all child writes. Maybe the old event was a leaf node\n          complete = writesCache.calcCompleteEventCache(\n            viewCache.getCompleteServerSnap()\n          );\n          if (complete.isLeafNode()) {\n            newEventCache = this.filter_.updateFullNode(\n              newEventCache,\n              complete,\n              accumulator\n            );\n          }\n        }\n      }\n      complete =\n        viewCache.getServerCache().isFullyInitialized() ||\n        writesCache.shadowingWrite(Path.Empty) != null;\n      return viewCache.updateEventSnap(\n        newEventCache,\n        complete,\n        this.filter_.filtersNodes()\n      );\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { NamedNode, Node } from '../snap/Node';\nimport { Change } from './Change';\nimport { assertionError } from '@firebase/util';\nimport { Query } from '../../api/Query';\nimport { Index } from '../snap/indexes/Index';\nimport { EventRegistration } from './EventRegistration';\nimport { Event } from './Event';\n\n/**\n * An EventGenerator is used to convert \"raw\" changes (Change) as computed by the\n * CacheDiffer into actual events (Event) that can be raised.  See generateEventsForChanges()\n * for details.\n *\n * @constructor\n */\nexport class EventGenerator {\n  private index_: Index;\n\n  /**\n   *\n   * @param {!Query} query_\n   */\n  constructor(private query_: Query) {\n    /**\n     * @private\n     * @type {!Index}\n     */\n    this.index_ = this.query_.getQueryParams().getIndex();\n  }\n\n  /**\n   * Given a set of raw changes (no moved events and prevName not specified yet), and a set of\n   * EventRegistrations that should be notified of these changes, generate the actual events to be raised.\n   *\n   * Notes:\n   *  - child_moved events will be synthesized at this time for any child_changed events that affect\n   *    our index.\n   *  - prevName will be calculated based on the index ordering.\n   *\n   * @param {!Array.<!Change>} changes\n   * @param {!Node} eventCache\n   * @param {!Array.<!EventRegistration>} eventRegistrations\n   * @return {!Array.<!Event>}\n   */\n  generateEventsForChanges(\n    changes: Change[],\n    eventCache: Node,\n    eventRegistrations: EventRegistration[]\n  ): Event[] {\n    const events: Event[] = [];\n    const moves: Change[] = [];\n\n    changes.forEach(change => {\n      if (\n        change.type === Change.CHILD_CHANGED &&\n        this.index_.indexedValueChanged(\n          change.oldSnap as Node,\n          change.snapshotNode\n        )\n      ) {\n        moves.push(\n          Change.childMovedChange(\n            change.childName as string,\n            change.snapshotNode\n          )\n        );\n      }\n    });\n\n    this.generateEventsForType_(\n      events,\n      Change.CHILD_REMOVED,\n      changes,\n      eventRegistrations,\n      eventCache\n    );\n    this.generateEventsForType_(\n      events,\n      Change.CHILD_ADDED,\n      changes,\n      eventRegistrations,\n      eventCache\n    );\n    this.generateEventsForType_(\n      events,\n      Change.CHILD_MOVED,\n      moves,\n      eventRegistrations,\n      eventCache\n    );\n    this.generateEventsForType_(\n      events,\n      Change.CHILD_CHANGED,\n      changes,\n      eventRegistrations,\n      eventCache\n    );\n    this.generateEventsForType_(\n      events,\n      Change.VALUE,\n      changes,\n      eventRegistrations,\n      eventCache\n    );\n\n    return events;\n  }\n\n  /**\n   * Given changes of a single change type, generate the corresponding events.\n   *\n   * @param {!Array.<!Event>} events\n   * @param {!string} eventType\n   * @param {!Array.<!Change>} changes\n   * @param {!Array.<!EventRegistration>} registrations\n   * @param {!Node} eventCache\n   * @private\n   */\n  private generateEventsForType_(\n    events: Event[],\n    eventType: string,\n    changes: Change[],\n    registrations: EventRegistration[],\n    eventCache: Node\n  ) {\n    const filteredChanges = changes.filter(change => change.type === eventType);\n\n    filteredChanges.sort(this.compareChanges_.bind(this));\n    filteredChanges.forEach(change => {\n      const materializedChange = this.materializeSingleChange_(\n        change,\n        eventCache\n      );\n      registrations.forEach(registration => {\n        if (registration.respondsTo(change.type)) {\n          events.push(\n            registration.createEvent(materializedChange, this.query_)\n          );\n        }\n      });\n    });\n  }\n\n  /**\n   * @param {!Change} change\n   * @param {!Node} eventCache\n   * @return {!Change}\n   * @private\n   */\n  private materializeSingleChange_(change: Change, eventCache: Node): Change {\n    if (change.type === 'value' || change.type === 'child_removed') {\n      return change;\n    } else {\n      change.prevName = eventCache.getPredecessorChildName(\n        /** @type {!string} */\n        change.childName,\n        change.snapshotNode,\n        this.index_\n      );\n      return change;\n    }\n  }\n\n  /**\n   * @param {!Change} a\n   * @param {!Change} b\n   * @return {number}\n   * @private\n   */\n  private compareChanges_(a: Change, b: Change) {\n    if (a.childName == null || b.childName == null) {\n      throw assertionError('Should only compare child_ events.');\n    }\n    const aWrapped = new NamedNode(a.childName, a.snapshotNode);\n    const bWrapped = new NamedNode(b.childName, b.snapshotNode);\n    return this.index_.compare(aWrapped, bWrapped);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IndexedFilter } from './filter/IndexedFilter';\nimport { ViewProcessor } from './ViewProcessor';\nimport { ChildrenNode } from '../snap/ChildrenNode';\nimport { CacheNode } from './CacheNode';\nimport { ViewCache } from './ViewCache';\nimport { EventGenerator } from './EventGenerator';\nimport { assert } from '@firebase/util';\nimport { Operation, OperationType } from '../operation/Operation';\nimport { Change } from './Change';\nimport { PRIORITY_INDEX } from '../snap/indexes/PriorityIndex';\nimport { Query } from '../../api/Query';\nimport { EventRegistration } from './EventRegistration';\nimport { Node } from '../snap/Node';\nimport { Path } from '../util/Path';\nimport { WriteTreeRef } from '../WriteTree';\nimport { CancelEvent, Event } from './Event';\n\n/**\n * A view represents a specific location and query that has 1 or more event registrations.\n *\n * It does several things:\n *  - Maintains the list of event registrations for this location/query.\n *  - Maintains a cache of the data visible for this location/query.\n *  - Applies new operations (via applyOperation), updates the cache, and based on the event\n *    registrations returns the set of events to be raised.\n * @constructor\n */\nexport class View {\n  private processor_: ViewProcessor;\n  private viewCache_: ViewCache;\n  private eventRegistrations_: EventRegistration[] = [];\n  private eventGenerator_: EventGenerator;\n\n  /**\n   *\n   * @param {!Query} query_\n   * @param {!ViewCache} initialViewCache\n   */\n  constructor(private query_: Query, initialViewCache: ViewCache) {\n    const params = this.query_.getQueryParams();\n\n    const indexFilter = new IndexedFilter(params.getIndex());\n    const filter = params.getNodeFilter();\n\n    /**\n     * @type {ViewProcessor}\n     * @private\n     */\n    this.processor_ = new ViewProcessor(filter);\n\n    const initialServerCache = initialViewCache.getServerCache();\n    const initialEventCache = initialViewCache.getEventCache();\n\n    // Don't filter server node with other filter than index, wait for tagged listen\n    const serverSnap = indexFilter.updateFullNode(\n      ChildrenNode.EMPTY_NODE,\n      initialServerCache.getNode(),\n      null\n    );\n    const eventSnap = filter.updateFullNode(\n      ChildrenNode.EMPTY_NODE,\n      initialEventCache.getNode(),\n      null\n    );\n    const newServerCache = new CacheNode(\n      serverSnap,\n      initialServerCache.isFullyInitialized(),\n      indexFilter.filtersNodes()\n    );\n    const newEventCache = new CacheNode(\n      eventSnap,\n      initialEventCache.isFullyInitialized(),\n      filter.filtersNodes()\n    );\n\n    /**\n     * @type {!ViewCache}\n     * @private\n     */\n    this.viewCache_ = new ViewCache(newEventCache, newServerCache);\n\n    /**\n     * @type {!EventGenerator}\n     * @private\n     */\n    this.eventGenerator_ = new EventGenerator(this.query_);\n  }\n\n  /**\n   * @return {!Query}\n   */\n  getQuery(): Query {\n    return this.query_;\n  }\n\n  /**\n   * @return {?Node}\n   */\n  getServerCache(): Node | null {\n    return this.viewCache_.getServerCache().getNode();\n  }\n\n  /**\n   * @param {!Path} path\n   * @return {?Node}\n   */\n  getCompleteServerCache(path: Path): Node | null {\n    const cache = this.viewCache_.getCompleteServerSnap();\n    if (cache) {\n      // If this isn't a \"loadsAllData\" view, then cache isn't actually a complete cache and\n      // we need to see if it contains the child we're interested in.\n      if (\n        this.query_.getQueryParams().loadsAllData() ||\n        (!path.isEmpty() && !cache.getImmediateChild(path.getFront()).isEmpty())\n      ) {\n        return cache.getChild(path);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  isEmpty(): boolean {\n    return this.eventRegistrations_.length === 0;\n  }\n\n  /**\n   * @param {!EventRegistration} eventRegistration\n   */\n  addEventRegistration(eventRegistration: EventRegistration) {\n    this.eventRegistrations_.push(eventRegistration);\n  }\n\n  /**\n   * @param {?EventRegistration} eventRegistration If null, remove all callbacks.\n   * @param {Error=} cancelError If a cancelError is provided, appropriate cancel events will be returned.\n   * @return {!Array.<!Event>} Cancel events, if cancelError was provided.\n   */\n  removeEventRegistration(\n    eventRegistration: EventRegistration | null,\n    cancelError?: Error\n  ): Event[] {\n    const cancelEvents: CancelEvent[] = [];\n    if (cancelError) {\n      assert(\n        eventRegistration == null,\n        'A cancel should cancel all event registrations.'\n      );\n      const path = this.query_.path;\n      this.eventRegistrations_.forEach(function(registration) {\n        cancelError /** @type {!Error} */ = cancelError;\n        const maybeEvent = registration.createCancelEvent(cancelError, path);\n        if (maybeEvent) {\n          cancelEvents.push(maybeEvent);\n        }\n      });\n    }\n\n    if (eventRegistration) {\n      let remaining = [];\n      for (let i = 0; i < this.eventRegistrations_.length; ++i) {\n        const existing = this.eventRegistrations_[i];\n        if (!existing.matches(eventRegistration)) {\n          remaining.push(existing);\n        } else if (eventRegistration.hasAnyCallback()) {\n          // We're removing just this one\n          remaining = remaining.concat(this.eventRegistrations_.slice(i + 1));\n          break;\n        }\n      }\n      this.eventRegistrations_ = remaining;\n    } else {\n      this.eventRegistrations_ = [];\n    }\n    return cancelEvents;\n  }\n\n  /**\n   * Applies the given Operation, updates our cache, and returns the appropriate events.\n   *\n   * @param {!Operation} operation\n   * @param {!WriteTreeRef} writesCache\n   * @param {?Node} completeServerCache\n   * @return {!Array.<!Event>}\n   */\n  applyOperation(\n    operation: Operation,\n    writesCache: WriteTreeRef,\n    completeServerCache: Node | null\n  ): Event[] {\n    if (\n      operation.type === OperationType.MERGE &&\n      operation.source.queryId !== null\n    ) {\n      assert(\n        this.viewCache_.getCompleteServerSnap(),\n        'We should always have a full cache before handling merges'\n      );\n      assert(\n        this.viewCache_.getCompleteEventSnap(),\n        'Missing event cache, even though we have a server cache'\n      );\n    }\n\n    const oldViewCache = this.viewCache_;\n    const result = this.processor_.applyOperation(\n      oldViewCache,\n      operation,\n      writesCache,\n      completeServerCache\n    );\n    this.processor_.assertIndexed(result.viewCache);\n\n    assert(\n      result.viewCache.getServerCache().isFullyInitialized() ||\n        !oldViewCache.getServerCache().isFullyInitialized(),\n      'Once a server snap is complete, it should never go back'\n    );\n\n    this.viewCache_ = result.viewCache;\n\n    return this.generateEventsForChanges_(\n      result.changes,\n      result.viewCache.getEventCache().getNode(),\n      null\n    );\n  }\n\n  /**\n   * @param {!EventRegistration} registration\n   * @return {!Array.<!Event>}\n   */\n  getInitialEvents(registration: EventRegistration): Event[] {\n    const eventSnap = this.viewCache_.getEventCache();\n    const initialChanges: Change[] = [];\n    if (!eventSnap.getNode().isLeafNode()) {\n      const eventNode = eventSnap.getNode() as ChildrenNode;\n      eventNode.forEachChild(PRIORITY_INDEX, function(key, childNode) {\n        initialChanges.push(Change.childAddedChange(key, childNode));\n      });\n    }\n    if (eventSnap.isFullyInitialized()) {\n      initialChanges.push(Change.valueChange(eventSnap.getNode()));\n    }\n    return this.generateEventsForChanges_(\n      initialChanges,\n      eventSnap.getNode(),\n      registration\n    );\n  }\n\n  /**\n   * @private\n   * @param {!Array.<!Change>} changes\n   * @param {!Node} eventCache\n   * @param {EventRegistration=} eventRegistration\n   * @return {!Array.<!Event>}\n   */\n  generateEventsForChanges_(\n    changes: Change[],\n    eventCache: Node,\n    eventRegistration?: EventRegistration\n  ): Event[] {\n    const registrations = eventRegistration\n      ? [eventRegistration]\n      : this.eventRegistrations_;\n    return this.eventGenerator_.generateEventsForChanges(\n      changes,\n      eventCache,\n      registrations\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ImmutableTree } from './util/ImmutableTree';\nimport { Path } from './util/Path';\nimport { Node, NamedNode } from './snap/Node';\nimport { PRIORITY_INDEX } from './snap/indexes/PriorityIndex';\nimport { assert } from '@firebase/util';\nimport { ChildrenNode } from './snap/ChildrenNode';\nimport { each } from './util/util';\n\n/**\n * This class holds a collection of writes that can be applied to nodes in unison. It abstracts away the logic with\n * dealing with priority writes and multiple nested writes. At any given path there is only allowed to be one write\n * modifying that path. Any write to an existing path or shadowing an existing path will modify that existing write\n * to reflect the write added.\n */\nexport class CompoundWrite {\n  constructor(private writeTree_: ImmutableTree<Node>) {}\n\n  static Empty = new CompoundWrite(new ImmutableTree(null));\n\n  addWrite(path: Path, node: Node): CompoundWrite {\n    if (path.isEmpty()) {\n      return new CompoundWrite(new ImmutableTree(node));\n    } else {\n      const rootmost = this.writeTree_.findRootMostValueAndPath(path);\n      if (rootmost != null) {\n        const rootMostPath = rootmost.path;\n        let value = rootmost.value;\n        const relativePath = Path.relativePath(rootMostPath, path);\n        value = value.updateChild(relativePath, node);\n        return new CompoundWrite(this.writeTree_.set(rootMostPath, value));\n      } else {\n        const subtree = new ImmutableTree(node);\n        const newWriteTree = this.writeTree_.setTree(path, subtree);\n        return new CompoundWrite(newWriteTree);\n      }\n    }\n  }\n\n  addWrites(path: Path, updates: { [name: string]: Node }): CompoundWrite {\n    let newWrite = this as CompoundWrite;\n    each(updates, function(childKey: string, node: Node) {\n      newWrite = newWrite.addWrite(path.child(childKey), node);\n    });\n    return newWrite;\n  }\n\n  /**\n   * Will remove a write at the given path and deeper paths. This will <em>not</em> modify a write at a higher\n   * location, which must be removed by calling this method with that path.\n   *\n   * @param path The path at which a write and all deeper writes should be removed\n   * @return {!CompoundWrite} The new CompoundWrite with the removed path\n   */\n  removeWrite(path: Path): CompoundWrite {\n    if (path.isEmpty()) {\n      return CompoundWrite.Empty;\n    } else {\n      const newWriteTree = this.writeTree_.setTree(path, ImmutableTree.Empty);\n      return new CompoundWrite(newWriteTree);\n    }\n  }\n\n  /**\n   * Returns whether this CompoundWrite will fully overwrite a node at a given location and can therefore be\n   * considered \"complete\".\n   *\n   * @param path The path to check for\n   * @return Whether there is a complete write at that path\n   */\n  hasCompleteWrite(path: Path): boolean {\n    return this.getCompleteNode(path) != null;\n  }\n\n  /**\n   * Returns a node for a path if and only if the node is a \"complete\" overwrite at that path. This will not aggregate\n   * writes from deeper paths, but will return child nodes from a more shallow path.\n   *\n   * @param path The path to get a complete write\n   * @return The node if complete at that path, or null otherwise.\n   */\n  getCompleteNode(path: Path): Node | null {\n    const rootmost = this.writeTree_.findRootMostValueAndPath(path);\n    if (rootmost != null) {\n      return this.writeTree_\n        .get(rootmost.path)\n        .getChild(Path.relativePath(rootmost.path, path));\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Returns all children that are guaranteed to be a complete overwrite.\n   *\n   * @return A list of all complete children.\n   */\n  getCompleteChildren(): NamedNode[] {\n    const children: NamedNode[] = [];\n    let node = this.writeTree_.value;\n    if (node != null) {\n      // If it's a leaf node, it has no children; so nothing to do.\n      if (!node.isLeafNode()) {\n        (node as ChildrenNode).forEachChild(PRIORITY_INDEX, function(\n          childName,\n          childNode\n        ) {\n          children.push(new NamedNode(childName, childNode));\n        });\n      }\n    } else {\n      this.writeTree_.children.inorderTraversal(function(childName, childTree) {\n        if (childTree.value != null) {\n          children.push(new NamedNode(childName, childTree.value));\n        }\n      });\n    }\n    return children;\n  }\n\n  childCompoundWrite(path: Path): CompoundWrite {\n    if (path.isEmpty()) {\n      return this;\n    } else {\n      const shadowingNode = this.getCompleteNode(path);\n      if (shadowingNode != null) {\n        return new CompoundWrite(new ImmutableTree(shadowingNode));\n      } else {\n        return new CompoundWrite(this.writeTree_.subtree(path));\n      }\n    }\n  }\n\n  /**\n   * Returns true if this CompoundWrite is empty and therefore does not modify any nodes.\n   * @return Whether this CompoundWrite is empty\n   */\n  isEmpty(): boolean {\n    return this.writeTree_.isEmpty();\n  }\n\n  /**\n   * Applies this CompoundWrite to a node. The node is returned with all writes from this CompoundWrite applied to the\n   * node\n   * @param node The node to apply this CompoundWrite to\n   * @return The node with all writes applied\n   */\n  apply(node: Node): Node {\n    return applySubtreeWrite(Path.Empty, this.writeTree_, node);\n  }\n}\n\nfunction applySubtreeWrite(\n  relativePath: Path,\n  writeTree: ImmutableTree<Node>,\n  node: Node\n): Node {\n  if (writeTree.value != null) {\n    // Since there a write is always a leaf, we're done here\n    return node.updateChild(relativePath, writeTree.value);\n  } else {\n    let priorityWrite = null;\n    writeTree.children.inorderTraversal(function(childKey, childTree) {\n      if (childKey === '.priority') {\n        // Apply priorities at the end so we don't update priorities for either empty nodes or forget\n        // to apply priorities to empty nodes that are later filled\n        assert(\n          childTree.value !== null,\n          'Priority writes must always be leaf nodes'\n        );\n        priorityWrite = childTree.value;\n      } else {\n        node = applySubtreeWrite(relativePath.child(childKey), childTree, node);\n      }\n    });\n    // If there was a priority write, we only apply it if the node is not empty\n    if (!node.getChild(relativePath).isEmpty() && priorityWrite !== null) {\n      node = node.updateChild(relativePath.child('.priority'), priorityWrite);\n    }\n    return node;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { safeGet } from '@firebase/util';\nimport { assert, assertionError } from '@firebase/util';\nimport { Path } from './util/Path';\nimport { CompoundWrite } from './CompoundWrite';\nimport { PRIORITY_INDEX } from './snap/indexes/PriorityIndex';\nimport { ChildrenNode } from './snap/ChildrenNode';\nimport { NamedNode, Node } from './snap/Node';\nimport { CacheNode } from './view/CacheNode';\nimport { Index } from './snap/indexes/Index';\nimport { each } from './util/util';\n\n/**\n * Defines a single user-initiated write operation. May be the result of a set(), transaction(), or update() call. In\n * the case of a set() or transaction, snap wil be non-null.  In the case of an update(), children will be non-null.\n */\nexport interface WriteRecord {\n  writeId: number;\n  path: Path;\n  snap?: Node | null;\n  children?: { [k: string]: Node } | null;\n  visible: boolean;\n}\n\n/**\n * WriteTree tracks all pending user-initiated writes and has methods to calculate the result of merging them\n * with underlying server data (to create \"event cache\" data).  Pending writes are added with addOverwrite()\n * and addMerge(), and removed with removeWrite().\n *\n * @constructor\n */\nexport class WriteTree {\n  /**\n   * A tree tracking the result of applying all visible writes.  This does not include transactions with\n   * applyLocally=false or writes that are completely shadowed by other writes.\n   *\n   * @type {!CompoundWrite}\n   * @private\n   */\n  private visibleWrites_: CompoundWrite = CompoundWrite.Empty;\n\n  /**\n   * A list of all pending writes, regardless of visibility and shadowed-ness.  Used to calculate arbitrary\n   * sets of the changed data, such as hidden writes (from transactions) or changes with certain writes excluded (also\n   * used by transactions).\n   *\n   * @type {!Array.<!WriteRecord>}\n   * @private\n   */\n  private allWrites_: WriteRecord[] = [];\n\n  private lastWriteId_ = -1;\n\n  /**\n   * Create a new WriteTreeRef for the given path. For use with a new sync point at the given path.\n   *\n   * @param {!Path} path\n   * @return {!WriteTreeRef}\n   */\n  childWrites(path: Path): WriteTreeRef {\n    return new WriteTreeRef(path, this);\n  }\n\n  /**\n   * Record a new overwrite from user code.\n   *\n   * @param {!Path} path\n   * @param {!Node} snap\n   * @param {!number} writeId\n   * @param {boolean=} visible This is set to false by some transactions. It should be excluded from event caches\n   */\n  addOverwrite(path: Path, snap: Node, writeId: number, visible?: boolean) {\n    assert(\n      writeId > this.lastWriteId_,\n      'Stacking an older write on top of newer ones'\n    );\n    if (visible === undefined) {\n      visible = true;\n    }\n    this.allWrites_.push({\n      path: path,\n      snap: snap,\n      writeId: writeId,\n      visible: visible\n    });\n\n    if (visible) {\n      this.visibleWrites_ = this.visibleWrites_.addWrite(path, snap);\n    }\n    this.lastWriteId_ = writeId;\n  }\n\n  /**\n   * Record a new merge from user code.\n   *\n   * @param {!Path} path\n   * @param {!Object.<string, !Node>} changedChildren\n   * @param {!number} writeId\n   */\n  addMerge(\n    path: Path,\n    changedChildren: { [k: string]: Node },\n    writeId: number\n  ) {\n    assert(\n      writeId > this.lastWriteId_,\n      'Stacking an older merge on top of newer ones'\n    );\n    this.allWrites_.push({\n      path: path,\n      children: changedChildren,\n      writeId: writeId,\n      visible: true\n    });\n\n    this.visibleWrites_ = this.visibleWrites_.addWrites(path, changedChildren);\n    this.lastWriteId_ = writeId;\n  }\n\n  /**\n   * @param {!number} writeId\n   * @return {?WriteRecord}\n   */\n  getWrite(writeId: number): WriteRecord | null {\n    for (let i = 0; i < this.allWrites_.length; i++) {\n      const record = this.allWrites_[i];\n      if (record.writeId === writeId) {\n        return record;\n      }\n    }\n    return null;\n  }\n\n  /**\n   * Remove a write (either an overwrite or merge) that has been successfully acknowledge by the server. Recalculates\n   * the tree if necessary.  We return true if it may have been visible, meaning views need to reevaluate.\n   *\n   * @param {!number} writeId\n   * @return {boolean} true if the write may have been visible (meaning we'll need to reevaluate / raise\n   * events as a result).\n   */\n  removeWrite(writeId: number): boolean {\n    // Note: disabling this check. It could be a transaction that preempted another transaction, and thus was applied\n    // out of order.\n    //const validClear = revert || this.allWrites_.length === 0 || writeId <= this.allWrites_[0].writeId;\n    //assert(validClear, \"Either we don't have this write, or it's the first one in the queue\");\n\n    const idx = this.allWrites_.findIndex(function(s) {\n      return s.writeId === writeId;\n    });\n    assert(idx >= 0, 'removeWrite called with nonexistent writeId.');\n    const writeToRemove = this.allWrites_[idx];\n    this.allWrites_.splice(idx, 1);\n\n    let removedWriteWasVisible = writeToRemove.visible;\n    let removedWriteOverlapsWithOtherWrites = false;\n\n    let i = this.allWrites_.length - 1;\n\n    while (removedWriteWasVisible && i >= 0) {\n      const currentWrite = this.allWrites_[i];\n      if (currentWrite.visible) {\n        if (\n          i >= idx &&\n          this.recordContainsPath_(currentWrite, writeToRemove.path)\n        ) {\n          // The removed write was completely shadowed by a subsequent write.\n          removedWriteWasVisible = false;\n        } else if (writeToRemove.path.contains(currentWrite.path)) {\n          // Either we're covering some writes or they're covering part of us (depending on which came first).\n          removedWriteOverlapsWithOtherWrites = true;\n        }\n      }\n      i--;\n    }\n\n    if (!removedWriteWasVisible) {\n      return false;\n    } else if (removedWriteOverlapsWithOtherWrites) {\n      // There's some shadowing going on. Just rebuild the visible writes from scratch.\n      this.resetTree_();\n      return true;\n    } else {\n      // There's no shadowing.  We can safely just remove the write(s) from visibleWrites.\n      if (writeToRemove.snap) {\n        this.visibleWrites_ = this.visibleWrites_.removeWrite(\n          writeToRemove.path\n        );\n      } else {\n        const children = writeToRemove.children;\n        each(children, (childName: string) => {\n          this.visibleWrites_ = this.visibleWrites_.removeWrite(\n            writeToRemove.path.child(childName)\n          );\n        });\n      }\n      return true;\n    }\n  }\n\n  /**\n   * Return a complete snapshot for the given path if there's visible write data at that path, else null.\n   * No server data is considered.\n   *\n   * @param {!Path} path\n   * @return {?Node}\n   */\n  getCompleteWriteData(path: Path): Node | null {\n    return this.visibleWrites_.getCompleteNode(path);\n  }\n\n  /**\n   * Given optional, underlying server data, and an optional set of constraints (exclude some sets, include hidden\n   * writes), attempt to calculate a complete snapshot for the given path\n   *\n   * @param {!Path} treePath\n   * @param {?Node} completeServerCache\n   * @param {Array.<number>=} writeIdsToExclude An optional set to be excluded\n   * @param {boolean=} includeHiddenWrites Defaults to false, whether or not to layer on writes with visible set to false\n   * @return {?Node}\n   */\n  calcCompleteEventCache(\n    treePath: Path,\n    completeServerCache: Node | null,\n    writeIdsToExclude?: number[],\n    includeHiddenWrites?: boolean\n  ): Node | null {\n    if (!writeIdsToExclude && !includeHiddenWrites) {\n      const shadowingNode = this.visibleWrites_.getCompleteNode(treePath);\n      if (shadowingNode != null) {\n        return shadowingNode;\n      } else {\n        const subMerge = this.visibleWrites_.childCompoundWrite(treePath);\n        if (subMerge.isEmpty()) {\n          return completeServerCache;\n        } else if (\n          completeServerCache == null &&\n          !subMerge.hasCompleteWrite(Path.Empty)\n        ) {\n          // We wouldn't have a complete snapshot, since there's no underlying data and no complete shadow\n          return null;\n        } else {\n          const layeredCache = completeServerCache || ChildrenNode.EMPTY_NODE;\n          return subMerge.apply(layeredCache);\n        }\n      }\n    } else {\n      const merge = this.visibleWrites_.childCompoundWrite(treePath);\n      if (!includeHiddenWrites && merge.isEmpty()) {\n        return completeServerCache;\n      } else {\n        // If the server cache is null, and we don't have a complete cache, we need to return null\n        if (\n          !includeHiddenWrites &&\n          completeServerCache == null &&\n          !merge.hasCompleteWrite(Path.Empty)\n        ) {\n          return null;\n        } else {\n          const filter = function(write: WriteRecord) {\n            return (\n              (write.visible || includeHiddenWrites) &&\n              (!writeIdsToExclude ||\n                !~writeIdsToExclude.indexOf(write.writeId)) &&\n              (write.path.contains(treePath) || treePath.contains(write.path))\n            );\n          };\n          const mergeAtPath = WriteTree.layerTree_(\n            this.allWrites_,\n            filter,\n            treePath\n          );\n          const layeredCache = completeServerCache || ChildrenNode.EMPTY_NODE;\n          return mergeAtPath.apply(layeredCache);\n        }\n      }\n    }\n  }\n\n  /**\n   * With optional, underlying server data, attempt to return a children node of children that we have complete data for.\n   * Used when creating new views, to pre-fill their complete event children snapshot.\n   *\n   * @param {!Path} treePath\n   * @param {?ChildrenNode} completeServerChildren\n   * @return {!ChildrenNode}\n   */\n  calcCompleteEventChildren(\n    treePath: Path,\n    completeServerChildren: ChildrenNode | null\n  ) {\n    let completeChildren = ChildrenNode.EMPTY_NODE as Node;\n    const topLevelSet = this.visibleWrites_.getCompleteNode(treePath);\n    if (topLevelSet) {\n      if (!topLevelSet.isLeafNode()) {\n        // we're shadowing everything. Return the children.\n        topLevelSet.forEachChild(PRIORITY_INDEX, function(\n          childName,\n          childSnap\n        ) {\n          completeChildren = completeChildren.updateImmediateChild(\n            childName,\n            childSnap\n          );\n        });\n      }\n      return completeChildren;\n    } else if (completeServerChildren) {\n      // Layer any children we have on top of this\n      // We know we don't have a top-level set, so just enumerate existing children\n      const merge = this.visibleWrites_.childCompoundWrite(treePath);\n      completeServerChildren.forEachChild(PRIORITY_INDEX, function(\n        childName,\n        childNode\n      ) {\n        const node = merge\n          .childCompoundWrite(new Path(childName))\n          .apply(childNode);\n        completeChildren = completeChildren.updateImmediateChild(\n          childName,\n          node\n        );\n      });\n      // Add any complete children we have from the set\n      merge.getCompleteChildren().forEach(function(namedNode) {\n        completeChildren = completeChildren.updateImmediateChild(\n          namedNode.name,\n          namedNode.node\n        );\n      });\n      return completeChildren;\n    } else {\n      // We don't have anything to layer on top of. Layer on any children we have\n      // Note that we can return an empty snap if we have a defined delete\n      const merge = this.visibleWrites_.childCompoundWrite(treePath);\n      merge.getCompleteChildren().forEach(function(namedNode) {\n        completeChildren = completeChildren.updateImmediateChild(\n          namedNode.name,\n          namedNode.node\n        );\n      });\n      return completeChildren;\n    }\n  }\n\n  /**\n   * Given that the underlying server data has updated, determine what, if anything, needs to be\n   * applied to the event cache.\n   *\n   * Possibilities:\n   *\n   * 1. No writes are shadowing. Events should be raised, the snap to be applied comes from the server data\n   *\n   * 2. Some write is completely shadowing. No events to be raised\n   *\n   * 3. Is partially shadowed. Events\n   *\n   * Either existingEventSnap or existingServerSnap must exist\n   *\n   * @param {!Path} treePath\n   * @param {!Path} childPath\n   * @param {?Node} existingEventSnap\n   * @param {?Node} existingServerSnap\n   * @return {?Node}\n   */\n  calcEventCacheAfterServerOverwrite(\n    treePath: Path,\n    childPath: Path,\n    existingEventSnap: Node | null,\n    existingServerSnap: Node | null\n  ): Node | null {\n    assert(\n      existingEventSnap || existingServerSnap,\n      'Either existingEventSnap or existingServerSnap must exist'\n    );\n    const path = treePath.child(childPath);\n    if (this.visibleWrites_.hasCompleteWrite(path)) {\n      // At this point we can probably guarantee that we're in case 2, meaning no events\n      // May need to check visibility while doing the findRootMostValueAndPath call\n      return null;\n    } else {\n      // No complete shadowing. We're either partially shadowing or not shadowing at all.\n      const childMerge = this.visibleWrites_.childCompoundWrite(path);\n      if (childMerge.isEmpty()) {\n        // We're not shadowing at all. Case 1\n        return existingServerSnap.getChild(childPath);\n      } else {\n        // This could be more efficient if the serverNode + updates doesn't change the eventSnap\n        // However this is tricky to find out, since user updates don't necessary change the server\n        // snap, e.g. priority updates on empty nodes, or deep deletes. Another special case is if the server\n        // adds nodes, but doesn't change any existing writes. It is therefore not enough to\n        // only check if the updates change the serverNode.\n        // Maybe check if the merge tree contains these special cases and only do a full overwrite in that case?\n        return childMerge.apply(existingServerSnap.getChild(childPath));\n      }\n    }\n  }\n\n  /**\n   * Returns a complete child for a given server snap after applying all user writes or null if there is no\n   * complete child for this ChildKey.\n   *\n   * @param {!Path} treePath\n   * @param {!string} childKey\n   * @param {!CacheNode} existingServerSnap\n   * @return {?Node}\n   */\n  calcCompleteChild(\n    treePath: Path,\n    childKey: string,\n    existingServerSnap: CacheNode\n  ): Node | null {\n    const path = treePath.child(childKey);\n    const shadowingNode = this.visibleWrites_.getCompleteNode(path);\n    if (shadowingNode != null) {\n      return shadowingNode;\n    } else {\n      if (existingServerSnap.isCompleteForChild(childKey)) {\n        const childMerge = this.visibleWrites_.childCompoundWrite(path);\n        return childMerge.apply(\n          existingServerSnap.getNode().getImmediateChild(childKey)\n        );\n      } else {\n        return null;\n      }\n    }\n  }\n\n  /**\n   * Returns a node if there is a complete overwrite for this path. More specifically, if there is a write at\n   * a higher path, this will return the child of that write relative to the write and this path.\n   * Returns null if there is no write at this path.\n   */\n  shadowingWrite(path: Path): Node | null {\n    return this.visibleWrites_.getCompleteNode(path);\n  }\n\n  /**\n   * This method is used when processing child remove events on a query. If we can, we pull in children that were outside\n   * the window, but may now be in the window.\n   */\n  calcIndexedSlice(\n    treePath: Path,\n    completeServerData: Node | null,\n    startPost: NamedNode,\n    count: number,\n    reverse: boolean,\n    index: Index\n  ): NamedNode[] {\n    let toIterate: Node;\n    const merge = this.visibleWrites_.childCompoundWrite(treePath);\n    const shadowingNode = merge.getCompleteNode(Path.Empty);\n    if (shadowingNode != null) {\n      toIterate = shadowingNode;\n    } else if (completeServerData != null) {\n      toIterate = merge.apply(completeServerData);\n    } else {\n      // no children to iterate on\n      return [];\n    }\n    toIterate = toIterate.withIndex(index);\n    if (!toIterate.isEmpty() && !toIterate.isLeafNode()) {\n      const nodes = [];\n      const cmp = index.getCompare();\n      const iter = reverse\n        ? (toIterate as ChildrenNode).getReverseIteratorFrom(startPost, index)\n        : (toIterate as ChildrenNode).getIteratorFrom(startPost, index);\n      let next = iter.getNext();\n      while (next && nodes.length < count) {\n        if (cmp(next, startPost) !== 0) {\n          nodes.push(next);\n        }\n        next = iter.getNext();\n      }\n      return nodes;\n    } else {\n      return [];\n    }\n  }\n\n  private recordContainsPath_(writeRecord: WriteRecord, path: Path): boolean {\n    if (writeRecord.snap) {\n      return writeRecord.path.contains(path);\n    } else {\n      for (const childName in writeRecord.children) {\n        if (\n          writeRecord.children.hasOwnProperty(childName) &&\n          writeRecord.path.child(childName).contains(path)\n        ) {\n          return true;\n        }\n      }\n      return false;\n    }\n  }\n\n  /**\n   * Re-layer the writes and merges into a tree so we can efficiently calculate event snapshots\n   */\n  private resetTree_() {\n    this.visibleWrites_ = WriteTree.layerTree_(\n      this.allWrites_,\n      WriteTree.DefaultFilter_,\n      Path.Empty\n    );\n    if (this.allWrites_.length > 0) {\n      this.lastWriteId_ = this.allWrites_[this.allWrites_.length - 1].writeId;\n    } else {\n      this.lastWriteId_ = -1;\n    }\n  }\n\n  /**\n   * The default filter used when constructing the tree. Keep everything that's visible.\n   */\n  private static DefaultFilter_(write: WriteRecord) {\n    return write.visible;\n  }\n\n  /**\n   * Static method. Given an array of WriteRecords, a filter for which ones to include, and a path, construct the tree of\n   * event data at that path.\n   */\n  private static layerTree_(\n    writes: WriteRecord[],\n    filter: (w: WriteRecord) => boolean,\n    treeRoot: Path\n  ): CompoundWrite {\n    let compoundWrite = CompoundWrite.Empty;\n    for (let i = 0; i < writes.length; ++i) {\n      const write = writes[i];\n      // Theory, a later set will either:\n      // a) abort a relevant transaction, so no need to worry about excluding it from calculating that transaction\n      // b) not be relevant to a transaction (separate branch), so again will not affect the data for that transaction\n      if (filter(write)) {\n        const writePath = write.path;\n        let relativePath;\n        if (write.snap) {\n          if (treeRoot.contains(writePath)) {\n            relativePath = Path.relativePath(treeRoot, writePath);\n            compoundWrite = compoundWrite.addWrite(relativePath, write.snap);\n          } else if (writePath.contains(treeRoot)) {\n            relativePath = Path.relativePath(writePath, treeRoot);\n            compoundWrite = compoundWrite.addWrite(\n              Path.Empty,\n              write.snap.getChild(relativePath)\n            );\n          } else {\n            // There is no overlap between root path and write path, ignore write\n          }\n        } else if (write.children) {\n          if (treeRoot.contains(writePath)) {\n            relativePath = Path.relativePath(treeRoot, writePath);\n            compoundWrite = compoundWrite.addWrites(\n              relativePath,\n              write.children\n            );\n          } else if (writePath.contains(treeRoot)) {\n            relativePath = Path.relativePath(writePath, treeRoot);\n            if (relativePath.isEmpty()) {\n              compoundWrite = compoundWrite.addWrites(\n                Path.Empty,\n                write.children\n              );\n            } else {\n              const child = safeGet(write.children, relativePath.getFront());\n              if (child) {\n                // There exists a child in this node that matches the root path\n                const deepNode = child.getChild(relativePath.popFront());\n                compoundWrite = compoundWrite.addWrite(Path.Empty, deepNode);\n              }\n            }\n          } else {\n            // There is no overlap between root path and write path, ignore write\n          }\n        } else {\n          throw assertionError('WriteRecord should have .snap or .children');\n        }\n      }\n    }\n    return compoundWrite;\n  }\n}\n\n/**\n * A WriteTreeRef wraps a WriteTree and a path, for convenient access to a particular subtree.  All of the methods\n * just proxy to the underlying WriteTree.\n *\n * @constructor\n */\nexport class WriteTreeRef {\n  /**\n   * The path to this particular write tree ref. Used for calling methods on writeTree_ while exposing a simpler\n   * interface to callers.\n   *\n   * @type {!Path}\n   * @private\n   * @const\n   */\n  private readonly treePath_: Path;\n\n  /**\n   * * A reference to the actual tree of write data. All methods are pass-through to the tree, but with the appropriate\n   * path prefixed.\n   *\n   * This lets us make cheap references to points in the tree for sync points without having to copy and maintain all of\n   * the data.\n   *\n   * @type {!WriteTree}\n   * @private\n   * @const\n   */\n  private readonly writeTree_: WriteTree;\n\n  /**\n   * @param {!Path} path\n   * @param {!WriteTree} writeTree\n   */\n  constructor(path: Path, writeTree: WriteTree) {\n    this.treePath_ = path;\n    this.writeTree_ = writeTree;\n  }\n\n  /**\n   * If possible, returns a complete event cache, using the underlying server data if possible. In addition, can be used\n   * to get a cache that includes hidden writes, and excludes arbitrary writes. Note that customizing the returned node\n   * can lead to a more expensive calculation.\n   *\n   * @param {?Node} completeServerCache\n   * @param {Array.<number>=} writeIdsToExclude Optional writes to exclude.\n   * @param {boolean=} includeHiddenWrites Defaults to false, whether or not to layer on writes with visible set to false\n   * @return {?Node}\n   */\n  calcCompleteEventCache(\n    completeServerCache: Node | null,\n    writeIdsToExclude?: number[],\n    includeHiddenWrites?: boolean\n  ): Node | null {\n    return this.writeTree_.calcCompleteEventCache(\n      this.treePath_,\n      completeServerCache,\n      writeIdsToExclude,\n      includeHiddenWrites\n    );\n  }\n\n  /**\n   * If possible, returns a children node containing all of the complete children we have data for. The returned data is a\n   * mix of the given server data and write data.\n   *\n   * @param {?ChildrenNode} completeServerChildren\n   * @return {!ChildrenNode}\n   */\n  calcCompleteEventChildren(\n    completeServerChildren: ChildrenNode | null\n  ): ChildrenNode {\n    return this.writeTree_.calcCompleteEventChildren(\n      this.treePath_,\n      completeServerChildren\n    ) as ChildrenNode;\n  }\n\n  /**\n   * Given that either the underlying server data has updated or the outstanding writes have updated, determine what,\n   * if anything, needs to be applied to the event cache.\n   *\n   * Possibilities:\n   *\n   * 1. No writes are shadowing. Events should be raised, the snap to be applied comes from the server data\n   *\n   * 2. Some write is completely shadowing. No events to be raised\n   *\n   * 3. Is partially shadowed. Events should be raised\n   *\n   * Either existingEventSnap or existingServerSnap must exist, this is validated via an assert\n   *\n   * @param {!Path} path\n   * @param {?Node} existingEventSnap\n   * @param {?Node} existingServerSnap\n   * @return {?Node}\n   */\n  calcEventCacheAfterServerOverwrite(\n    path: Path,\n    existingEventSnap: Node | null,\n    existingServerSnap: Node | null\n  ): Node | null {\n    return this.writeTree_.calcEventCacheAfterServerOverwrite(\n      this.treePath_,\n      path,\n      existingEventSnap,\n      existingServerSnap\n    );\n  }\n\n  /**\n   * Returns a node if there is a complete overwrite for this path. More specifically, if there is a write at\n   * a higher path, this will return the child of that write relative to the write and this path.\n   * Returns null if there is no write at this path.\n   *\n   * @param {!Path} path\n   * @return {?Node}\n   */\n  shadowingWrite(path: Path): Node | null {\n    return this.writeTree_.shadowingWrite(this.treePath_.child(path));\n  }\n\n  /**\n   * This method is used when processing child remove events on a query. If we can, we pull in children that were outside\n   * the window, but may now be in the window\n   *\n   * @param {?Node} completeServerData\n   * @param {!NamedNode} startPost\n   * @param {!number} count\n   * @param {boolean} reverse\n   * @param {!Index} index\n   * @return {!Array.<!NamedNode>}\n   */\n  calcIndexedSlice(\n    completeServerData: Node | null,\n    startPost: NamedNode,\n    count: number,\n    reverse: boolean,\n    index: Index\n  ): NamedNode[] {\n    return this.writeTree_.calcIndexedSlice(\n      this.treePath_,\n      completeServerData,\n      startPost,\n      count,\n      reverse,\n      index\n    );\n  }\n\n  /**\n   * Returns a complete child for a given server snap after applying all user writes or null if there is no\n   * complete child for this ChildKey.\n   *\n   * @param {!string} childKey\n   * @param {!CacheNode} existingServerCache\n   * @return {?Node}\n   */\n  calcCompleteChild(\n    childKey: string,\n    existingServerCache: CacheNode\n  ): Node | null {\n    return this.writeTree_.calcCompleteChild(\n      this.treePath_,\n      childKey,\n      existingServerCache\n    );\n  }\n\n  /**\n   * Return a WriteTreeRef for a child.\n   *\n   * @param {string} childName\n   * @return {!WriteTreeRef}\n   */\n  child(childName: string): WriteTreeRef {\n    return new WriteTreeRef(this.treePath_.child(childName), this.writeTree_);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { errorForServerCode, each } from './util/util';\nimport { AckUserWrite } from './operation/AckUserWrite';\nimport { ChildrenNode } from './snap/ChildrenNode';\nimport { ImmutableTree } from './util/ImmutableTree';\nimport { ListenComplete } from './operation/ListenComplete';\nimport { Merge } from './operation/Merge';\nimport { Operation, OperationSource } from './operation/Operation';\nimport { Overwrite } from './operation/Overwrite';\nimport { Path } from './util/Path';\nimport { SyncPoint } from './SyncPoint';\nimport { WriteTree, WriteTreeRef } from './WriteTree';\nimport { Query } from '../api/Query';\nimport { Node } from './snap/Node';\nimport { Event } from './view/Event';\nimport { EventRegistration } from './view/EventRegistration';\nimport { View } from './view/View';\n\n/**\n * @typedef {{\n *   startListening: function(\n *     !Query,\n *     ?number,\n *     function():string,\n *     function(!string, *):!Array.<!Event>\n *   ):!Array.<!Event>,\n *\n *   stopListening: function(!Query, ?number)\n * }}\n */\nexport interface ListenProvider {\n  startListening(\n    query: Query,\n    tag: number | null,\n    hashFn: () => string,\n    onComplete: (a: string, b?: any) => Event[]\n  ): Event[];\n\n  stopListening(a: Query, b: number | null): void;\n}\n\n/**\n * SyncTree is the central class for managing event callback registration, data caching, views\n * (query processing), and event generation.  There are typically two SyncTree instances for\n * each Repo, one for the normal Firebase data, and one for the .info data.\n *\n * It has a number of responsibilities, including:\n *  - Tracking all user event callbacks (registered via addEventRegistration() and removeEventRegistration()).\n *  - Applying and caching data changes for user set(), transaction(), and update() calls\n *    (applyUserOverwrite(), applyUserMerge()).\n *  - Applying and caching data changes for server data changes (applyServerOverwrite(),\n *    applyServerMerge()).\n *  - Generating user-facing events for server and user changes (all of the apply* methods\n *    return the set of events that need to be raised as a result).\n *  - Maintaining the appropriate set of server listens to ensure we are always subscribed\n *    to the correct set of paths and queries to satisfy the current set of user event\n *    callbacks (listens are started/stopped using the provided listenProvider).\n *\n * NOTE: Although SyncTree tracks event callbacks and calculates events to raise, the actual\n * events are returned to the caller rather than raised synchronously.\n *\n * @constructor\n */\nexport class SyncTree {\n  /**\n   * Tree of SyncPoints.  There's a SyncPoint at any location that has 1 or more views.\n   */\n  private syncPointTree_: ImmutableTree<SyncPoint> = ImmutableTree.Empty;\n\n  /**\n   * A tree of all pending user writes (user-initiated set()'s, transaction()'s, update()'s, etc.).\n   */\n  private pendingWriteTree_ = new WriteTree();\n\n  private readonly tagToQueryMap: Map<number, string> = new Map();\n  private readonly queryToTagMap: Map<string, number> = new Map();\n\n  /**\n   * @param {!ListenProvider} listenProvider_ Used by SyncTree to start / stop listening\n   *   to server data.\n   */\n  constructor(private listenProvider_: ListenProvider) {}\n\n  /**\n   * Apply the data changes for a user-generated set() or transaction() call.\n   *\n   * @return Events to raise.\n   */\n  applyUserOverwrite(\n    path: Path,\n    newData: Node,\n    writeId: number,\n    visible?: boolean\n  ): Event[] {\n    // Record pending write.\n    this.pendingWriteTree_.addOverwrite(path, newData, writeId, visible);\n\n    if (!visible) {\n      return [];\n    } else {\n      return this.applyOperationToSyncPoints_(\n        new Overwrite(OperationSource.User, path, newData)\n      );\n    }\n  }\n\n  /**\n   * Apply the data from a user-generated update() call\n   *\n   * @return Events to raise.\n   */\n  applyUserMerge(\n    path: Path,\n    changedChildren: { [k: string]: Node },\n    writeId: number\n  ): Event[] {\n    // Record pending merge.\n    this.pendingWriteTree_.addMerge(path, changedChildren, writeId);\n\n    const changeTree = ImmutableTree.fromObject(changedChildren);\n\n    return this.applyOperationToSyncPoints_(\n      new Merge(OperationSource.User, path, changeTree)\n    );\n  }\n\n  /**\n   * Acknowledge a pending user write that was previously registered with applyUserOverwrite() or applyUserMerge().\n   *\n   * @param revert True if the given write failed and needs to be reverted\n   * @return Events to raise.\n   */\n  ackUserWrite(writeId: number, revert: boolean = false) {\n    const write = this.pendingWriteTree_.getWrite(writeId);\n    const needToReevaluate = this.pendingWriteTree_.removeWrite(writeId);\n    if (!needToReevaluate) {\n      return [];\n    } else {\n      let affectedTree = ImmutableTree.Empty;\n      if (write.snap != null) {\n        // overwrite\n        affectedTree = affectedTree.set(Path.Empty, true);\n      } else {\n        each(write.children, function(pathString: string, node: Node) {\n          affectedTree = affectedTree.set(new Path(pathString), node);\n        });\n      }\n      return this.applyOperationToSyncPoints_(\n        new AckUserWrite(write.path, affectedTree, revert)\n      );\n    }\n  }\n\n  /**\n   * Apply new server data for the specified path..\n   *\n   * @return Events to raise.\n   */\n  applyServerOverwrite(path: Path, newData: Node): Event[] {\n    return this.applyOperationToSyncPoints_(\n      new Overwrite(OperationSource.Server, path, newData)\n    );\n  }\n\n  /**\n   * Apply new server data to be merged in at the specified path.\n   *\n   * @return Events to raise.\n   */\n  applyServerMerge(\n    path: Path,\n    changedChildren: { [k: string]: Node }\n  ): Event[] {\n    const changeTree = ImmutableTree.fromObject(changedChildren);\n\n    return this.applyOperationToSyncPoints_(\n      new Merge(OperationSource.Server, path, changeTree)\n    );\n  }\n\n  /**\n   * Apply a listen complete for a query\n   *\n   * @return Events to raise.\n   */\n  applyListenComplete(path: Path): Event[] {\n    return this.applyOperationToSyncPoints_(\n      new ListenComplete(OperationSource.Server, path)\n    );\n  }\n\n  /**\n   * Apply new server data for the specified tagged query.\n   *\n   * @return Events to raise.\n   */\n  applyTaggedQueryOverwrite(path: Path, snap: Node, tag: number): Event[] {\n    const queryKey = this.queryKeyForTag_(tag);\n    if (queryKey != null) {\n      const r = SyncTree.parseQueryKey_(queryKey);\n      const queryPath = r.path,\n        queryId = r.queryId;\n      const relativePath = Path.relativePath(queryPath, path);\n      const op = new Overwrite(\n        OperationSource.forServerTaggedQuery(queryId),\n        relativePath,\n        snap\n      );\n      return this.applyTaggedOperation_(queryPath, op);\n    } else {\n      // Query must have been removed already\n      return [];\n    }\n  }\n\n  /**\n   * Apply server data to be merged in for the specified tagged query.\n   *\n   * @return Events to raise.\n   */\n  applyTaggedQueryMerge(\n    path: Path,\n    changedChildren: { [k: string]: Node },\n    tag: number\n  ): Event[] {\n    const queryKey = this.queryKeyForTag_(tag);\n    if (queryKey) {\n      const r = SyncTree.parseQueryKey_(queryKey);\n      const queryPath = r.path,\n        queryId = r.queryId;\n      const relativePath = Path.relativePath(queryPath, path);\n      const changeTree = ImmutableTree.fromObject(changedChildren);\n      const op = new Merge(\n        OperationSource.forServerTaggedQuery(queryId),\n        relativePath,\n        changeTree\n      );\n      return this.applyTaggedOperation_(queryPath, op);\n    } else {\n      // We've already removed the query. No big deal, ignore the update\n      return [];\n    }\n  }\n\n  /**\n   * Apply a listen complete for a tagged query\n   *\n   * @return Events to raise.\n   */\n  applyTaggedListenComplete(path: Path, tag: number): Event[] {\n    const queryKey = this.queryKeyForTag_(tag);\n    if (queryKey) {\n      const r = SyncTree.parseQueryKey_(queryKey);\n      const queryPath = r.path,\n        queryId = r.queryId;\n      const relativePath = Path.relativePath(queryPath, path);\n      const op = new ListenComplete(\n        OperationSource.forServerTaggedQuery(queryId),\n        relativePath\n      );\n      return this.applyTaggedOperation_(queryPath, op);\n    } else {\n      // We've already removed the query. No big deal, ignore the update\n      return [];\n    }\n  }\n\n  /**\n   * Add an event callback for the specified query.\n   *\n   * @return Events to raise.\n   */\n  addEventRegistration(\n    query: Query,\n    eventRegistration: EventRegistration\n  ): Event[] {\n    const path = query.path;\n\n    let serverCache: Node | null = null;\n    let foundAncestorDefaultView = false;\n    // Any covering writes will necessarily be at the root, so really all we need to find is the server cache.\n    // Consider optimizing this once there's a better understanding of what actual behavior will be.\n    this.syncPointTree_.foreachOnPath(path, function(pathToSyncPoint, sp) {\n      const relativePath = Path.relativePath(pathToSyncPoint, path);\n      serverCache = serverCache || sp.getCompleteServerCache(relativePath);\n      foundAncestorDefaultView =\n        foundAncestorDefaultView || sp.hasCompleteView();\n    });\n    let syncPoint = this.syncPointTree_.get(path);\n    if (!syncPoint) {\n      syncPoint = new SyncPoint();\n      this.syncPointTree_ = this.syncPointTree_.set(path, syncPoint);\n    } else {\n      foundAncestorDefaultView =\n        foundAncestorDefaultView || syncPoint.hasCompleteView();\n      serverCache = serverCache || syncPoint.getCompleteServerCache(Path.Empty);\n    }\n\n    let serverCacheComplete;\n    if (serverCache != null) {\n      serverCacheComplete = true;\n    } else {\n      serverCacheComplete = false;\n      serverCache = ChildrenNode.EMPTY_NODE;\n      const subtree = this.syncPointTree_.subtree(path);\n      subtree.foreachChild(function(childName, childSyncPoint) {\n        const completeCache = childSyncPoint.getCompleteServerCache(Path.Empty);\n        if (completeCache) {\n          serverCache = serverCache.updateImmediateChild(\n            childName,\n            completeCache\n          );\n        }\n      });\n    }\n\n    const viewAlreadyExists = syncPoint.viewExistsForQuery(query);\n    if (!viewAlreadyExists && !query.getQueryParams().loadsAllData()) {\n      // We need to track a tag for this query\n      const queryKey = SyncTree.makeQueryKey_(query);\n      assert(\n        !this.queryToTagMap.has(queryKey),\n        'View does not exist, but we have a tag'\n      );\n      const tag = SyncTree.getNextQueryTag_();\n      this.queryToTagMap.set(queryKey, tag);\n      this.tagToQueryMap.set(tag, queryKey);\n    }\n    const writesCache = this.pendingWriteTree_.childWrites(path);\n    let events = syncPoint.addEventRegistration(\n      query,\n      eventRegistration,\n      writesCache,\n      serverCache,\n      serverCacheComplete\n    );\n    if (!viewAlreadyExists && !foundAncestorDefaultView) {\n      const view /** @type !View */ = syncPoint.viewForQuery(query);\n      events = events.concat(this.setupListener_(query, view));\n    }\n    return events;\n  }\n\n  /**\n   * Remove event callback(s).\n   *\n   * If query is the default query, we'll check all queries for the specified eventRegistration.\n   * If eventRegistration is null, we'll remove all callbacks for the specified query/queries.\n   *\n   * @param eventRegistration If null, all callbacks are removed.\n   * @param cancelError If a cancelError is provided, appropriate cancel events will be returned.\n   * @return Cancel events, if cancelError was provided.\n   */\n  removeEventRegistration(\n    query: Query,\n    eventRegistration: EventRegistration | null,\n    cancelError?: Error\n  ): Event[] {\n    // Find the syncPoint first. Then deal with whether or not it has matching listeners\n    const path = query.path;\n    const maybeSyncPoint = this.syncPointTree_.get(path);\n    let cancelEvents: Event[] = [];\n    // A removal on a default query affects all queries at that location. A removal on an indexed query, even one without\n    // other query constraints, does *not* affect all queries at that location. So this check must be for 'default', and\n    // not loadsAllData().\n    if (\n      maybeSyncPoint &&\n      (query.queryIdentifier() === 'default' ||\n        maybeSyncPoint.viewExistsForQuery(query))\n    ) {\n      /**\n       * @type {{removed: !Array.<!Query>, events: !Array.<!Event>}}\n       */\n      const removedAndEvents = maybeSyncPoint.removeEventRegistration(\n        query,\n        eventRegistration,\n        cancelError\n      );\n      if (maybeSyncPoint.isEmpty()) {\n        this.syncPointTree_ = this.syncPointTree_.remove(path);\n      }\n      const removed = removedAndEvents.removed;\n      cancelEvents = removedAndEvents.events;\n      // We may have just removed one of many listeners and can short-circuit this whole process\n      // We may also not have removed a default listener, in which case all of the descendant listeners should already be\n      // properly set up.\n      //\n      // Since indexed queries can shadow if they don't have other query constraints, check for loadsAllData(), instead of\n      // queryId === 'default'\n      const removingDefault =\n        -1 !==\n        removed.findIndex(function(query) {\n          return query.getQueryParams().loadsAllData();\n        });\n      const covered = this.syncPointTree_.findOnPath(path, function(\n        relativePath,\n        parentSyncPoint\n      ) {\n        return parentSyncPoint.hasCompleteView();\n      });\n\n      if (removingDefault && !covered) {\n        const subtree = this.syncPointTree_.subtree(path);\n        // There are potentially child listeners. Determine what if any listens we need to send before executing the\n        // removal\n        if (!subtree.isEmpty()) {\n          // We need to fold over our subtree and collect the listeners to send\n          const newViews = this.collectDistinctViewsForSubTree_(subtree);\n\n          // Ok, we've collected all the listens we need. Set them up.\n          for (let i = 0; i < newViews.length; ++i) {\n            const view = newViews[i],\n              newQuery = view.getQuery();\n            const listener = this.createListenerForView_(view);\n            this.listenProvider_.startListening(\n              SyncTree.queryForListening_(newQuery),\n              this.tagForQuery_(newQuery),\n              listener.hashFn,\n              listener.onComplete\n            );\n          }\n        } else {\n          // There's nothing below us, so nothing we need to start listening on\n        }\n      }\n      // If we removed anything and we're not covered by a higher up listen, we need to stop listening on this query\n      // The above block has us covered in terms of making sure we're set up on listens lower in the tree.\n      // Also, note that if we have a cancelError, it's already been removed at the provider level.\n      if (!covered && removed.length > 0 && !cancelError) {\n        // If we removed a default, then we weren't listening on any of the other queries here. Just cancel the one\n        // default. Otherwise, we need to iterate through and cancel each individual query\n        if (removingDefault) {\n          // We don't tag default listeners\n          const defaultTag: number | null = null;\n          this.listenProvider_.stopListening(\n            SyncTree.queryForListening_(query),\n            defaultTag\n          );\n        } else {\n          removed.forEach((queryToRemove: Query) => {\n            const tagToRemove = this.queryToTagMap.get(\n              SyncTree.makeQueryKey_(queryToRemove)\n            );\n            this.listenProvider_.stopListening(\n              SyncTree.queryForListening_(queryToRemove),\n              tagToRemove\n            );\n          });\n        }\n      }\n      // Now, clear all of the tags we're tracking for the removed listens\n      this.removeTags_(removed);\n    } else {\n      // No-op, this listener must've been already removed\n    }\n    return cancelEvents;\n  }\n\n  /**\n   * Returns a complete cache, if we have one, of the data at a particular path. If the location does not have a\n   * listener above it, we will get a false \"null\". This shouldn't be a problem because transactions will always\n   * have a listener above, and atomic operations would correctly show a jitter of <increment value> ->\n   *     <incremented total> as the write is applied locally and then acknowledged at the server.\n   *\n   * Note: this method will *include* hidden writes from transaction with applyLocally set to false.\n   *\n   * @param path The path to the data we want\n   * @param writeIdsToExclude A specific set to be excluded\n   */\n  calcCompleteEventCache(path: Path, writeIdsToExclude?: number[]): Node {\n    const includeHiddenSets = true;\n    const writeTree = this.pendingWriteTree_;\n    const serverCache = this.syncPointTree_.findOnPath(path, function(\n      pathSoFar,\n      syncPoint\n    ) {\n      const relativePath = Path.relativePath(pathSoFar, path);\n      const serverCache = syncPoint.getCompleteServerCache(relativePath);\n      if (serverCache) {\n        return serverCache;\n      }\n    });\n    return writeTree.calcCompleteEventCache(\n      path,\n      serverCache,\n      writeIdsToExclude,\n      includeHiddenSets\n    );\n  }\n\n  /**\n   * This collapses multiple unfiltered views into a single view, since we only need a single\n   * listener for them.\n   */\n  private collectDistinctViewsForSubTree_(\n    subtree: ImmutableTree<SyncPoint>\n  ): View[] {\n    return subtree.fold<View[]>(\n      (relativePath, maybeChildSyncPoint, childMap) => {\n        if (maybeChildSyncPoint && maybeChildSyncPoint.hasCompleteView()) {\n          const completeView = maybeChildSyncPoint.getCompleteView();\n          return [completeView];\n        } else {\n          // No complete view here, flatten any deeper listens into an array\n          let views: View[] = [];\n          if (maybeChildSyncPoint) {\n            views = maybeChildSyncPoint.getQueryViews();\n          }\n          each(childMap, function(_key: string, childViews: View[]) {\n            views = views.concat(childViews);\n          });\n          return views;\n        }\n      }\n    );\n  }\n\n  private removeTags_(queries: Query[]) {\n    for (let j = 0; j < queries.length; ++j) {\n      const removedQuery = queries[j];\n      if (!removedQuery.getQueryParams().loadsAllData()) {\n        // We should have a tag for this\n        const removedQueryKey = SyncTree.makeQueryKey_(removedQuery);\n        const removedQueryTag = this.queryToTagMap.get(removedQueryKey);\n        this.queryToTagMap.delete(removedQueryKey);\n        this.tagToQueryMap.delete(removedQueryTag);\n      }\n    }\n  }\n\n  /**\n   * Normalizes a query to a query we send the server for listening\n   *\n   * @return The normalized query\n   */\n  private static queryForListening_(query: Query): Query {\n    if (\n      query.getQueryParams().loadsAllData() &&\n      !query.getQueryParams().isDefault()\n    ) {\n      // We treat queries that load all data as default queries\n      // Cast is necessary because ref() technically returns Firebase which is actually fb.api.Firebase which inherits\n      // from Query\n      return query.getRef()!;\n    } else {\n      return query;\n    }\n  }\n\n  /**\n   * For a given new listen, manage the de-duplication of outstanding subscriptions.\n   *\n   * @return This method can return events to support synchronous data sources\n   */\n  private setupListener_(query: Query, view: View): Event[] {\n    const path = query.path;\n    const tag = this.tagForQuery_(query);\n    const listener = this.createListenerForView_(view);\n\n    const events = this.listenProvider_.startListening(\n      SyncTree.queryForListening_(query),\n      tag,\n      listener.hashFn,\n      listener.onComplete\n    );\n\n    const subtree = this.syncPointTree_.subtree(path);\n    // The root of this subtree has our query. We're here because we definitely need to send a listen for that, but we\n    // may need to shadow other listens as well.\n    if (tag) {\n      assert(\n        !subtree.value.hasCompleteView(),\n        \"If we're adding a query, it shouldn't be shadowed\"\n      );\n    } else {\n      // Shadow everything at or below this location, this is a default listener.\n      const queriesToStop = subtree.fold<Query[]>(function(\n        relativePath,\n        maybeChildSyncPoint,\n        childMap\n      ) {\n        if (\n          !relativePath.isEmpty() &&\n          maybeChildSyncPoint &&\n          maybeChildSyncPoint.hasCompleteView()\n        ) {\n          return [maybeChildSyncPoint.getCompleteView().getQuery()];\n        } else {\n          // No default listener here, flatten any deeper queries into an array\n          let queries: Query[] = [];\n          if (maybeChildSyncPoint) {\n            queries = queries.concat(\n              maybeChildSyncPoint.getQueryViews().map(view => view.getQuery())\n            );\n          }\n          each(childMap, function(_key: string, childQueries: Query[]) {\n            queries = queries.concat(childQueries);\n          });\n          return queries;\n        }\n      });\n      for (let i = 0; i < queriesToStop.length; ++i) {\n        const queryToStop = queriesToStop[i];\n        this.listenProvider_.stopListening(\n          SyncTree.queryForListening_(queryToStop),\n          this.tagForQuery_(queryToStop)\n        );\n      }\n    }\n    return events;\n  }\n\n  private createListenerForView_(\n    view: View\n  ): { hashFn(): string; onComplete(a: string, b?: any): Event[] } {\n    const query = view.getQuery();\n    const tag = this.tagForQuery_(query);\n\n    return {\n      hashFn: () => {\n        const cache = view.getServerCache() || ChildrenNode.EMPTY_NODE;\n        return cache.hash();\n      },\n      onComplete: (status: string): Event[] => {\n        if (status === 'ok') {\n          if (tag) {\n            return this.applyTaggedListenComplete(query.path, tag);\n          } else {\n            return this.applyListenComplete(query.path);\n          }\n        } else {\n          // If a listen failed, kill all of the listeners here, not just the one that triggered the error.\n          // Note that this may need to be scoped to just this listener if we change permissions on filtered children\n          const error = errorForServerCode(status, query);\n          return this.removeEventRegistration(\n            query,\n            /*eventRegistration*/ null,\n            error\n          );\n        }\n      }\n    };\n  }\n\n  /**\n   * Given a query, computes a \"queryKey\" suitable for use in our queryToTagMap_.\n   */\n  private static makeQueryKey_(query: Query): string {\n    return query.path.toString() + '$' + query.queryIdentifier();\n  }\n\n  /**\n   * Given a queryKey (created by makeQueryKey), parse it back into a path and queryId.\n   */\n  private static parseQueryKey_(\n    queryKey: string\n  ): { queryId: string; path: Path } {\n    const splitIndex = queryKey.indexOf('$');\n    assert(\n      splitIndex !== -1 && splitIndex < queryKey.length - 1,\n      'Bad queryKey.'\n    );\n    return {\n      queryId: queryKey.substr(splitIndex + 1),\n      path: new Path(queryKey.substr(0, splitIndex))\n    };\n  }\n\n  /**\n   * Return the query associated with the given tag, if we have one\n   */\n  private queryKeyForTag_(tag: number): string | null {\n    return this.tagToQueryMap.get(tag);\n  }\n\n  /**\n   * Return the tag associated with the given query.\n   */\n  private tagForQuery_(query: Query): number | null {\n    const queryKey = SyncTree.makeQueryKey_(query);\n    return this.queryToTagMap.get(queryKey);\n  }\n\n  /**\n   * Static tracker for next query tag.\n   */\n  private static nextQueryTag_ = 1;\n\n  /**\n   * Static accessor for query tags.\n   */\n  private static getNextQueryTag_(): number {\n    return SyncTree.nextQueryTag_++;\n  }\n\n  /**\n   * A helper method to apply tagged operations\n   */\n  private applyTaggedOperation_(\n    queryPath: Path,\n    operation: Operation\n  ): Event[] {\n    const syncPoint = this.syncPointTree_.get(queryPath);\n    assert(syncPoint, \"Missing sync point for query tag that we're tracking\");\n    const writesCache = this.pendingWriteTree_.childWrites(queryPath);\n    return syncPoint.applyOperation(\n      operation,\n      writesCache,\n      /*serverCache=*/ null\n    );\n  }\n\n  /**\n   * A helper method that visits all descendant and ancestor SyncPoints, applying the operation.\n   *\n   * NOTES:\n   * - Descendant SyncPoints will be visited first (since we raise events depth-first).\n\n   * - We call applyOperation() on each SyncPoint passing three things:\n   *   1. A version of the Operation that has been made relative to the SyncPoint location.\n   *   2. A WriteTreeRef of any writes we have cached at the SyncPoint location.\n   *   3. A snapshot Node with cached server data, if we have it.\n\n   * - We concatenate all of the events returned by each SyncPoint and return the result.\n   */\n  private applyOperationToSyncPoints_(operation: Operation): Event[] {\n    return this.applyOperationHelper_(\n      operation,\n      this.syncPointTree_,\n      /*serverCache=*/ null,\n      this.pendingWriteTree_.childWrites(Path.Empty)\n    );\n  }\n\n  /**\n   * Recursive helper for applyOperationToSyncPoints_\n   */\n  private applyOperationHelper_(\n    operation: Operation,\n    syncPointTree: ImmutableTree<SyncPoint>,\n    serverCache: Node | null,\n    writesCache: WriteTreeRef\n  ): Event[] {\n    if (operation.path.isEmpty()) {\n      return this.applyOperationDescendantsHelper_(\n        operation,\n        syncPointTree,\n        serverCache,\n        writesCache\n      );\n    } else {\n      const syncPoint = syncPointTree.get(Path.Empty);\n\n      // If we don't have cached server data, see if we can get it from this SyncPoint.\n      if (serverCache == null && syncPoint != null) {\n        serverCache = syncPoint.getCompleteServerCache(Path.Empty);\n      }\n\n      let events: Event[] = [];\n      const childName = operation.path.getFront();\n      const childOperation = operation.operationForChild(childName);\n      const childTree = syncPointTree.children.get(childName);\n      if (childTree && childOperation) {\n        const childServerCache = serverCache\n          ? serverCache.getImmediateChild(childName)\n          : null;\n        const childWritesCache = writesCache.child(childName);\n        events = events.concat(\n          this.applyOperationHelper_(\n            childOperation,\n            childTree,\n            childServerCache,\n            childWritesCache\n          )\n        );\n      }\n\n      if (syncPoint) {\n        events = events.concat(\n          syncPoint.applyOperation(operation, writesCache, serverCache)\n        );\n      }\n\n      return events;\n    }\n  }\n\n  /**\n   * Recursive helper for applyOperationToSyncPoints_\n   */\n  private applyOperationDescendantsHelper_(\n    operation: Operation,\n    syncPointTree: ImmutableTree<SyncPoint>,\n    serverCache: Node | null,\n    writesCache: WriteTreeRef\n  ): Event[] {\n    const syncPoint = syncPointTree.get(Path.Empty);\n\n    // If we don't have cached server data, see if we can get it from this SyncPoint.\n    if (serverCache == null && syncPoint != null) {\n      serverCache = syncPoint.getCompleteServerCache(Path.Empty);\n    }\n\n    let events: Event[] = [];\n    syncPointTree.children.inorderTraversal((childName, childTree) => {\n      const childServerCache = serverCache\n        ? serverCache.getImmediateChild(childName)\n        : null;\n      const childWritesCache = writesCache.child(childName);\n      const childOperation = operation.operationForChild(childName);\n      if (childOperation) {\n        events = events.concat(\n          this.applyOperationDescendantsHelper_(\n            childOperation,\n            childTree,\n            childServerCache,\n            childWritesCache\n          )\n        );\n      }\n    });\n\n    if (syncPoint) {\n      events = events.concat(\n        syncPoint.applyOperation(operation, writesCache, serverCache)\n      );\n    }\n\n    return events;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ChildrenNode } from './snap/ChildrenNode';\nimport { Path } from './util/Path';\nimport { Node } from './snap/Node';\n\n/**\n * Mutable object which basically just stores a reference to the \"latest\" immutable snapshot.\n *\n * @constructor\n */\nexport class SnapshotHolder {\n  private rootNode_: Node = ChildrenNode.EMPTY_NODE;\n\n  getNode(path: Path): Node {\n    return this.rootNode_.getChild(path);\n  }\n\n  updateSnapshot(path: Path, newSnapshotNode: Node) {\n    this.rootNode_ = this.rootNode_.updateChild(path, newSnapshotNode);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FirebaseAuthTokenData } from '@firebase/app-types/private';\nimport {\n  FirebaseAuthInternal,\n  FirebaseAuthInternalName\n} from '@firebase/auth-interop-types';\nimport { Provider } from '@firebase/component';\nimport { log, warn } from './util/util';\nimport { FirebaseApp } from '@firebase/app-types';\n\n/**\n * Abstraction around FirebaseApp's token fetching capabilities.\n */\nexport class AuthTokenProvider {\n  private auth_: FirebaseAuthInternal | null = null;\n  constructor(\n    private app_: FirebaseApp,\n    private authProvider_: Provider<FirebaseAuthInternalName>\n  ) {\n    this.auth_ = authProvider_.getImmediate({ optional: true });\n    if (!this.auth_) {\n      authProvider_.get().then(auth => (this.auth_ = auth));\n    }\n  }\n\n  /**\n   * @param {boolean} forceRefresh\n   * @return {!Promise<FirebaseAuthTokenData>}\n   */\n  getToken(forceRefresh: boolean): Promise<FirebaseAuthTokenData> {\n    if (!this.auth_) {\n      return Promise.resolve(null);\n    }\n\n    return this.auth_.getToken(forceRefresh).catch(function(error) {\n      // TODO: Need to figure out all the cases this is raised and whether\n      // this makes sense.\n      if (error && error.code === 'auth/token-not-initialized') {\n        log('Got auth/token-not-initialized error.  Treating as null token.');\n        return null;\n      } else {\n        return Promise.reject(error);\n      }\n    });\n  }\n\n  addTokenChangeListener(listener: (token: string | null) => void) {\n    // TODO: We might want to wrap the listener and call it with no args to\n    // avoid a leaky abstraction, but that makes removing the listener harder.\n    if (this.auth_) {\n      this.auth_.addAuthTokenListener(listener);\n    } else {\n      setTimeout(() => listener(null), 0);\n      this.authProvider_\n        .get()\n        .then(auth => auth.addAuthTokenListener(listener));\n    }\n  }\n\n  removeTokenChangeListener(listener: (token: string | null) => void) {\n    this.authProvider_\n      .get()\n      .then(auth => auth.removeAuthTokenListener(listener));\n  }\n\n  notifyForInvalidToken() {\n    let errorMessage =\n      'Provided authentication credentials for the app named \"' +\n      this.app_.name +\n      '\" are invalid. This usually indicates your app was not ' +\n      'initialized correctly. ';\n    if ('credential' in this.app_.options) {\n      errorMessage +=\n        'Make sure the \"credential\" property provided to initializeApp() ' +\n        'is authorized to access the specified \"databaseURL\" and is from the correct ' +\n        'project.';\n    } else if ('serviceAccount' in this.app_.options) {\n      errorMessage +=\n        'Make sure the \"serviceAccount\" property provided to initializeApp() ' +\n        'is authorized to access the specified \"databaseURL\" and is from the correct ' +\n        'project.';\n    } else {\n      errorMessage +=\n        'Make sure the \"apiKey\" and \"databaseURL\" properties provided to ' +\n        'initializeApp() match the values provided for your app at ' +\n        'https://console.firebase.google.com/.';\n    }\n    warn(errorMessage);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { deepCopy } from '@firebase/util';\nimport { contains } from '@firebase/util';\n\n/**\n * Tracks a collection of stats.\n *\n * @constructor\n */\nexport class StatsCollection {\n  private counters_: { [k: string]: number } = {};\n\n  incrementCounter(name: string, amount: number = 1) {\n    if (!contains(this.counters_, name)) this.counters_[name] = 0;\n\n    this.counters_[name] += amount;\n  }\n\n  get() {\n    return deepCopy(this.counters_);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StatsCollection } from './StatsCollection';\nimport { RepoInfo } from '../RepoInfo';\n\nexport class StatsManager {\n  private static collections_: { [k: string]: StatsCollection } = {};\n  private static reporters_: { [k: string]: any } = {};\n\n  static getCollection(repoInfo: RepoInfo): StatsCollection {\n    const hashString = repoInfo.toString();\n\n    if (!this.collections_[hashString]) {\n      this.collections_[hashString] = new StatsCollection();\n    }\n\n    return this.collections_[hashString];\n  }\n\n  static getOrCreateReporter<T>(\n    repoInfo: RepoInfo,\n    creatorFunction: () => T\n  ): T {\n    const hashString = repoInfo.toString();\n\n    if (!this.reporters_[hashString]) {\n      this.reporters_[hashString] = creatorFunction();\n    }\n\n    return this.reporters_[hashString];\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { StatsCollection } from './StatsCollection';\nimport { each } from '../util/util';\n\n/**\n * Returns the delta from the previous call to get stats.\n *\n * @param collection_ The collection to \"listen\" to.\n * @constructor\n */\nexport class StatsListener {\n  private last_: { [k: string]: number } | null = null;\n\n  constructor(private collection_: StatsCollection) {}\n\n  get(): { [k: string]: number } {\n    const newStats = this.collection_.get();\n\n    const delta = { ...newStats };\n    if (this.last_) {\n      each(this.last_, (stat: string, value: number) => {\n        delta[stat] = delta[stat] - value;\n      });\n    }\n    this.last_ = newStats;\n\n    return delta;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { contains } from '@firebase/util';\nimport { setTimeoutNonBlocking, each } from '../util/util';\nimport { StatsListener } from './StatsListener';\nimport { StatsCollection } from './StatsCollection';\nimport { ServerActions } from '../ServerActions';\n\n// Assuming some apps may have a short amount of time on page, and a bulk of firebase operations probably\n// happen on page load, we try to report our first set of stats pretty quickly, but we wait at least 10\n// seconds to try to ensure the Firebase connection is established / settled.\nconst FIRST_STATS_MIN_TIME = 10 * 1000;\nconst FIRST_STATS_MAX_TIME = 30 * 1000;\n\n// We'll continue to report stats on average every 5 minutes.\nconst REPORT_STATS_INTERVAL = 5 * 60 * 1000;\n\n/**\n * @constructor\n */\nexport class StatsReporter {\n  private statsListener_: StatsListener;\n  private statsToReport_: { [k: string]: boolean } = {};\n\n  /**\n   * @param collection\n   * @param server_\n   */\n  constructor(collection: StatsCollection, private server_: ServerActions) {\n    this.statsListener_ = new StatsListener(collection);\n\n    const timeout =\n      FIRST_STATS_MIN_TIME +\n      (FIRST_STATS_MAX_TIME - FIRST_STATS_MIN_TIME) * Math.random();\n    setTimeoutNonBlocking(this.reportStats_.bind(this), Math.floor(timeout));\n  }\n\n  includeStat(stat: string) {\n    this.statsToReport_[stat] = true;\n  }\n\n  private reportStats_() {\n    const stats = this.statsListener_.get();\n    const reportedStats: typeof stats = {};\n    let haveStatsToReport = false;\n\n    each(stats, (stat: string, value: number) => {\n      if (value > 0 && contains(this.statsToReport_, stat)) {\n        reportedStats[stat] = value;\n        haveStatsToReport = true;\n      }\n    });\n\n    if (haveStatsToReport) {\n      this.server_.reportStats(reportedStats);\n    }\n\n    // queue our next run.\n    setTimeoutNonBlocking(\n      this.reportStats_.bind(this),\n      Math.floor(Math.random() * 2 * REPORT_STATS_INTERVAL)\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Path } from '../util/Path';\nimport { log, logger, exceptionGuard } from '../util/util';\nimport { Event } from './Event';\n\n/**\n * The event queue serves a few purposes:\n * 1. It ensures we maintain event order in the face of event callbacks doing operations that result in more\n *    events being queued.\n * 2. raiseQueuedEvents() handles being called reentrantly nicely.  That is, if in the course of raising events,\n *    raiseQueuedEvents() is called again, the \"inner\" call will pick up raising events where the \"outer\" call\n *    left off, ensuring that the events are still raised synchronously and in order.\n * 3. You can use raiseEventsAtPath and raiseEventsForChangedPath to ensure only relevant previously-queued\n *    events are raised synchronously.\n *\n * NOTE: This can all go away if/when we move to async events.\n *\n * @constructor\n */\nexport class EventQueue {\n  /**\n   * @private\n   * @type {!Array.<EventList>}\n   */\n  private eventLists_: EventList[] = [];\n\n  /**\n   * Tracks recursion depth of raiseQueuedEvents_, for debugging purposes.\n   * @private\n   * @type {!number}\n   */\n  private recursionDepth_ = 0;\n\n  /**\n   * @param {!Array.<Event>} eventDataList The new events to queue.\n   */\n  queueEvents(eventDataList: Event[]) {\n    // We group events by path, storing them in a single EventList, to make it easier to skip over them quickly.\n    let currList = null;\n    for (let i = 0; i < eventDataList.length; i++) {\n      const eventData = eventDataList[i];\n      const eventPath = eventData.getPath();\n      if (currList !== null && !eventPath.equals(currList.getPath())) {\n        this.eventLists_.push(currList);\n        currList = null;\n      }\n\n      if (currList === null) {\n        currList = new EventList(eventPath);\n      }\n\n      currList.add(eventData);\n    }\n    if (currList) {\n      this.eventLists_.push(currList);\n    }\n  }\n\n  /**\n   * Queues the specified events and synchronously raises all events (including previously queued ones)\n   * for the specified path.\n   *\n   * It is assumed that the new events are all for the specified path.\n   *\n   * @param {!Path} path The path to raise events for.\n   * @param {!Array.<Event>} eventDataList The new events to raise.\n   */\n  raiseEventsAtPath(path: Path, eventDataList: Event[]) {\n    this.queueEvents(eventDataList);\n    this.raiseQueuedEventsMatchingPredicate_((eventPath: Path) =>\n      eventPath.equals(path)\n    );\n  }\n\n  /**\n   * Queues the specified events and synchronously raises all events (including previously queued ones) for\n   * locations related to the specified change path (i.e. all ancestors and descendants).\n   *\n   * It is assumed that the new events are all related (ancestor or descendant) to the specified path.\n   *\n   * @param {!Path} changedPath The path to raise events for.\n   * @param {!Array.<!Event>} eventDataList The events to raise\n   */\n  raiseEventsForChangedPath(changedPath: Path, eventDataList: Event[]) {\n    this.queueEvents(eventDataList);\n\n    this.raiseQueuedEventsMatchingPredicate_((eventPath: Path) => {\n      return eventPath.contains(changedPath) || changedPath.contains(eventPath);\n    });\n  }\n\n  /**\n   * @param {!function(!Path):boolean} predicate\n   * @private\n   */\n  private raiseQueuedEventsMatchingPredicate_(\n    predicate: (path: Path) => boolean\n  ) {\n    this.recursionDepth_++;\n\n    let sentAll = true;\n    for (let i = 0; i < this.eventLists_.length; i++) {\n      const eventList = this.eventLists_[i];\n      if (eventList) {\n        const eventPath = eventList.getPath();\n        if (predicate(eventPath)) {\n          this.eventLists_[i].raise();\n          this.eventLists_[i] = null;\n        } else {\n          sentAll = false;\n        }\n      }\n    }\n\n    if (sentAll) {\n      this.eventLists_ = [];\n    }\n\n    this.recursionDepth_--;\n  }\n}\n\n/**\n * @param {!Path} path\n * @constructor\n */\nexport class EventList {\n  /**\n   * @type {!Array.<Event>}\n   * @private\n   */\n  private events_: Event[] = [];\n\n  constructor(private readonly path_: Path) {}\n\n  /**\n   * @param {!Event} eventData\n   */\n  add(eventData: Event) {\n    this.events_.push(eventData);\n  }\n\n  /**\n   * Iterates through the list and raises each event\n   */\n  raise() {\n    for (let i = 0; i < this.events_.length; i++) {\n      const eventData = this.events_[i];\n      if (eventData !== null) {\n        this.events_[i] = null;\n        const eventFn = eventData.getEventRunner();\n        if (logger) {\n          log('event: ' + eventData.toString());\n        }\n        exceptionGuard(eventFn);\n      }\n    }\n  }\n\n  /**\n   * @return {!Path}\n   */\n  getPath(): Path {\n    return this.path_;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\n\n/**\n * Base class to be used if you want to emit events. Call the constructor with\n * the set of allowed event names.\n */\nexport abstract class EventEmitter {\n  private listeners_: {\n    [eventType: string]: Array<{\n      callback(...args: any[]): void;\n      context: any;\n    }>;\n  } = {};\n\n  /**\n   * @param {!Array.<string>} allowedEvents_\n   */\n  constructor(private allowedEvents_: Array<string>) {\n    assert(\n      Array.isArray(allowedEvents_) && allowedEvents_.length > 0,\n      'Requires a non-empty array'\n    );\n  }\n\n  /**\n   * To be overridden by derived classes in order to fire an initial event when\n   * somebody subscribes for data.\n   *\n   * @param {!string} eventType\n   * @return {Array.<*>} Array of parameters to trigger initial event with.\n   */\n  abstract getInitialEvent(eventType: string): any[];\n\n  /**\n   * To be called by derived classes to trigger events.\n   * @param {!string} eventType\n   * @param {...*} var_args\n   */\n  protected trigger(eventType: string, ...var_args: any[]) {\n    if (Array.isArray(this.listeners_[eventType])) {\n      // Clone the list, since callbacks could add/remove listeners.\n      const listeners = [...this.listeners_[eventType]];\n\n      for (let i = 0; i < listeners.length; i++) {\n        listeners[i].callback.apply(listeners[i].context, var_args);\n      }\n    }\n  }\n\n  on(eventType: string, callback: (a: any) => void, context: any) {\n    this.validateEventType_(eventType);\n    this.listeners_[eventType] = this.listeners_[eventType] || [];\n    this.listeners_[eventType].push({ callback, context });\n\n    const eventData = this.getInitialEvent(eventType);\n    if (eventData) {\n      callback.apply(context, eventData);\n    }\n  }\n\n  off(eventType: string, callback: (a: any) => void, context: any) {\n    this.validateEventType_(eventType);\n    const listeners = this.listeners_[eventType] || [];\n    for (let i = 0; i < listeners.length; i++) {\n      if (\n        listeners[i].callback === callback &&\n        (!context || context === listeners[i].context)\n      ) {\n        listeners.splice(i, 1);\n        return;\n      }\n    }\n  }\n\n  private validateEventType_(eventType: string) {\n    assert(\n      this.allowedEvents_.find(function(et) {\n        return et === eventType;\n      }),\n      'Unknown event: ' + eventType\n    );\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { EventEmitter } from './EventEmitter';\nimport { assert } from '@firebase/util';\n\ndeclare const document: any;\n\n/**\n * @extends {EventEmitter}\n */\nexport class VisibilityMonitor extends EventEmitter {\n  private visible_: boolean;\n\n  static getInstance() {\n    return new VisibilityMonitor();\n  }\n\n  constructor() {\n    super(['visible']);\n    let hidden: string;\n    let visibilityChange: string;\n    if (\n      typeof document !== 'undefined' &&\n      typeof document.addEventListener !== 'undefined'\n    ) {\n      if (typeof document['hidden'] !== 'undefined') {\n        // Opera 12.10 and Firefox 18 and later support\n        visibilityChange = 'visibilitychange';\n        hidden = 'hidden';\n      } else if (typeof document['mozHidden'] !== 'undefined') {\n        visibilityChange = 'mozvisibilitychange';\n        hidden = 'mozHidden';\n      } else if (typeof document['msHidden'] !== 'undefined') {\n        visibilityChange = 'msvisibilitychange';\n        hidden = 'msHidden';\n      } else if (typeof document['webkitHidden'] !== 'undefined') {\n        visibilityChange = 'webkitvisibilitychange';\n        hidden = 'webkitHidden';\n      }\n    }\n\n    // Initially, we always assume we are visible. This ensures that in browsers\n    // without page visibility support or in cases where we are never visible\n    // (e.g. chrome extension), we act as if we are visible, i.e. don't delay\n    // reconnects\n    this.visible_ = true;\n\n    if (visibilityChange) {\n      document.addEventListener(\n        visibilityChange,\n        () => {\n          const visible = !document[hidden];\n          if (visible !== this.visible_) {\n            this.visible_ = visible;\n            this.trigger('visible', visible);\n          }\n        },\n        false\n      );\n    }\n  }\n\n  /**\n   * @param {!string} eventType\n   * @return {Array.<boolean>}\n   */\n  getInitialEvent(eventType: string): boolean[] {\n    assert(eventType === 'visible', 'Unknown event type: ' + eventType);\n    return [this.visible_];\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { EventEmitter } from './EventEmitter';\nimport { isMobileCordova } from '@firebase/util';\n\n/**\n * Monitors online state (as reported by window.online/offline events).\n *\n * The expectation is that this could have many false positives (thinks we are online\n * when we're not), but no false negatives.  So we can safely use it to determine when\n * we definitely cannot reach the internet.\n *\n * @extends {EventEmitter}\n */\nexport class OnlineMonitor extends EventEmitter {\n  private online_ = true;\n\n  static getInstance() {\n    return new OnlineMonitor();\n  }\n\n  constructor() {\n    super(['online']);\n\n    // We've had repeated complaints that Cordova apps can get stuck \"offline\", e.g.\n    // https://forum.ionicframework.com/t/firebase-connection-is-lost-and-never-come-back/43810\n    // It would seem that the 'online' event does not always fire consistently. So we disable it\n    // for Cordova.\n    if (\n      typeof window !== 'undefined' &&\n      typeof window.addEventListener !== 'undefined' &&\n      !isMobileCordova()\n    ) {\n      window.addEventListener(\n        'online',\n        () => {\n          if (!this.online_) {\n            this.online_ = true;\n            this.trigger('online', true);\n          }\n        },\n        false\n      );\n\n      window.addEventListener(\n        'offline',\n        () => {\n          if (this.online_) {\n            this.online_ = false;\n            this.trigger('online', false);\n          }\n        },\n        false\n      );\n    }\n  }\n\n  /**\n   * @param {!string} eventType\n   * @return {Array.<boolean>}\n   */\n  getInitialEvent(eventType: string): boolean[] {\n    assert(eventType === 'online', 'Unknown event type: ' + eventType);\n    return [this.online_];\n  }\n\n  /**\n   * @return {boolean}\n   */\n  currentlyOnline(): boolean {\n    return this.online_;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { exceptionGuard } from '../../core/util/util';\n\n/**\n * This class ensures the packets from the server arrive in order\n * This class takes data from the server and ensures it gets passed into the callbacks in order.\n * @constructor\n */\nexport class PacketReceiver {\n  pendingResponses: any[] = [];\n  currentResponseNum = 0;\n  closeAfterResponse = -1;\n  onClose: (() => void) | null = null;\n\n  /**\n   * @param onMessage_\n   */\n  constructor(private onMessage_: (a: Object) => void) {}\n\n  closeAfter(responseNum: number, callback: () => void) {\n    this.closeAfterResponse = responseNum;\n    this.onClose = callback;\n    if (this.closeAfterResponse < this.currentResponseNum) {\n      this.onClose();\n      this.onClose = null;\n    }\n  }\n\n  /**\n   * Each message from the server comes with a response number, and an array of data. The responseNumber\n   * allows us to ensure that we process them in the right order, since we can't be guaranteed that all\n   * browsers will respond in the same order as the requests we sent\n   * @param {number} requestNum\n   * @param {Array} data\n   */\n  handleResponse(requestNum: number, data: any[]) {\n    this.pendingResponses[requestNum] = data;\n    while (this.pendingResponses[this.currentResponseNum]) {\n      const toProcess = this.pendingResponses[this.currentResponseNum];\n      delete this.pendingResponses[this.currentResponseNum];\n      for (let i = 0; i < toProcess.length; ++i) {\n        if (toProcess[i]) {\n          exceptionGuard(() => {\n            this.onMessage_(toProcess[i]);\n          });\n        }\n      }\n      if (this.currentResponseNum === this.closeAfterResponse) {\n        if (this.onClose) {\n          this.onClose();\n          this.onClose = null;\n        }\n        break;\n      }\n      this.currentResponseNum++;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  executeWhenDOMReady,\n  isChromeExtensionContentScript,\n  isWindowsStoreApp,\n  log,\n  logWrapper,\n  LUIDGenerator,\n  splitStringBySize\n} from '../core/util/util';\nimport { StatsManager } from '../core/stats/StatsManager';\nimport { PacketReceiver } from './polling/PacketReceiver';\nimport {\n  FORGE_DOMAIN,\n  FORGE_REF,\n  LAST_SESSION_PARAM,\n  LONG_POLLING,\n  PROTOCOL_VERSION,\n  REFERER_PARAM,\n  TRANSPORT_SESSION_PARAM,\n  VERSION_PARAM\n} from './Constants';\nimport { base64Encode, stringify } from '@firebase/util';\nimport { isNodeSdk } from '@firebase/util';\nimport { Transport } from './Transport';\nimport { RepoInfo } from '../core/RepoInfo';\nimport { StatsCollection } from '../core/stats/StatsCollection';\n\n// URL query parameters associated with longpolling\nexport const FIREBASE_LONGPOLL_START_PARAM = 'start';\nexport const FIREBASE_LONGPOLL_CLOSE_COMMAND = 'close';\nexport const FIREBASE_LONGPOLL_COMMAND_CB_NAME = 'pLPCommand';\nexport const FIREBASE_LONGPOLL_DATA_CB_NAME = 'pRTLPCB';\nexport const FIREBASE_LONGPOLL_ID_PARAM = 'id';\nexport const FIREBASE_LONGPOLL_PW_PARAM = 'pw';\nexport const FIREBASE_LONGPOLL_SERIAL_PARAM = 'ser';\nexport const FIREBASE_LONGPOLL_CALLBACK_ID_PARAM = 'cb';\nexport const FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM = 'seg';\nexport const FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET = 'ts';\nexport const FIREBASE_LONGPOLL_DATA_PARAM = 'd';\nexport const FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM = 'disconn';\nexport const FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM = 'dframe';\n\n//Data size constants.\n//TODO: Perf: the maximum length actually differs from browser to browser.\n// We should check what browser we're on and set accordingly.\nconst MAX_URL_DATA_SIZE = 1870;\nconst SEG_HEADER_SIZE = 30; //ie: &seg=8299234&ts=982389123&d=\nconst MAX_PAYLOAD_SIZE = MAX_URL_DATA_SIZE - SEG_HEADER_SIZE;\n\n/**\n * Keepalive period\n * send a fresh request at minimum every 25 seconds. Opera has a maximum request\n * length of 30 seconds that we can't exceed.\n * @const\n * @type {number}\n */\nconst KEEPALIVE_REQUEST_INTERVAL = 25000;\n\n/**\n * How long to wait before aborting a long-polling connection attempt.\n * @const\n * @type {number}\n */\nconst LP_CONNECT_TIMEOUT = 30000;\n\n/**\n * This class manages a single long-polling connection.\n *\n * @constructor\n * @implements {Transport}\n */\nexport class BrowserPollConnection implements Transport {\n  bytesSent = 0;\n  bytesReceived = 0;\n  urlFn: (params: object) => string;\n  scriptTagHolder: FirebaseIFrameScriptHolder;\n  myDisconnFrame: HTMLIFrameElement;\n  curSegmentNum: number;\n  myPacketOrderer: PacketReceiver;\n  id: string;\n  password: string;\n  private log_: (...a: any[]) => void;\n  private stats_: StatsCollection;\n  private everConnected_ = false;\n  private isClosed_: boolean;\n  private connectTimeoutTimer_: number | null;\n  private onDisconnect_: ((a?: boolean) => void) | null;\n\n  /**\n   * @param {string} connId An identifier for this connection, used for logging\n   * @param {RepoInfo} repoInfo The info for the endpoint to send data to.\n   * @param {string=} transportSessionId Optional transportSessionid if we are reconnecting for an existing\n   *                                         transport session\n   * @param {string=}  lastSessionId Optional lastSessionId if the PersistentConnection has already created a\n   *                                     connection previously\n   */\n  constructor(\n    public connId: string,\n    public repoInfo: RepoInfo,\n    public transportSessionId?: string,\n    public lastSessionId?: string\n  ) {\n    this.log_ = logWrapper(connId);\n    this.stats_ = StatsManager.getCollection(repoInfo);\n    this.urlFn = (params: { [k: string]: string }) =>\n      repoInfo.connectionURL(LONG_POLLING, params);\n  }\n\n  /**\n   *\n   * @param {function(Object)} onMessage Callback when messages arrive\n   * @param {function()} onDisconnect Callback with connection lost.\n   */\n  open(onMessage: (msg: Object) => void, onDisconnect: (a?: boolean) => void) {\n    this.curSegmentNum = 0;\n    this.onDisconnect_ = onDisconnect;\n    this.myPacketOrderer = new PacketReceiver(onMessage);\n    this.isClosed_ = false;\n\n    this.connectTimeoutTimer_ = setTimeout(() => {\n      this.log_('Timed out trying to connect.');\n      // Make sure we clear the host cache\n      this.onClosed_();\n      this.connectTimeoutTimer_ = null;\n    }, Math.floor(LP_CONNECT_TIMEOUT)) as any;\n\n    // Ensure we delay the creation of the iframe until the DOM is loaded.\n    executeWhenDOMReady(() => {\n      if (this.isClosed_) return;\n\n      //Set up a callback that gets triggered once a connection is set up.\n      this.scriptTagHolder = new FirebaseIFrameScriptHolder(\n        (...args) => {\n          const [command, arg1, arg2, arg3, arg4] = args;\n          this.incrementIncomingBytes_(args);\n          if (!this.scriptTagHolder) return; // we closed the connection.\n\n          if (this.connectTimeoutTimer_) {\n            clearTimeout(this.connectTimeoutTimer_);\n            this.connectTimeoutTimer_ = null;\n          }\n          this.everConnected_ = true;\n          if (command == FIREBASE_LONGPOLL_START_PARAM) {\n            this.id = arg1;\n            this.password = arg2;\n          } else if (command === FIREBASE_LONGPOLL_CLOSE_COMMAND) {\n            // Don't clear the host cache. We got a response from the server, so we know it's reachable\n            if (arg1) {\n              // We aren't expecting any more data (other than what the server's already in the process of sending us\n              // through our already open polls), so don't send any more.\n              this.scriptTagHolder.sendNewPolls = false;\n\n              // arg1 in this case is the last response number sent by the server. We should try to receive\n              // all of the responses up to this one before closing\n              this.myPacketOrderer.closeAfter(arg1, () => {\n                this.onClosed_();\n              });\n            } else {\n              this.onClosed_();\n            }\n          } else {\n            throw new Error('Unrecognized command received: ' + command);\n          }\n        },\n        (...args) => {\n          const [pN, data] = args;\n          this.incrementIncomingBytes_(args);\n          this.myPacketOrderer.handleResponse(pN, data);\n        },\n        () => {\n          this.onClosed_();\n        },\n        this.urlFn\n      );\n\n      //Send the initial request to connect. The serial number is simply to keep the browser from pulling previous results\n      //from cache.\n      const urlParams: { [k: string]: string | number } = {};\n      urlParams[FIREBASE_LONGPOLL_START_PARAM] = 't';\n      urlParams[FIREBASE_LONGPOLL_SERIAL_PARAM] = Math.floor(\n        Math.random() * 100000000\n      );\n      if (this.scriptTagHolder.uniqueCallbackIdentifier)\n        urlParams[\n          FIREBASE_LONGPOLL_CALLBACK_ID_PARAM\n        ] = this.scriptTagHolder.uniqueCallbackIdentifier;\n      urlParams[VERSION_PARAM] = PROTOCOL_VERSION;\n      if (this.transportSessionId) {\n        urlParams[TRANSPORT_SESSION_PARAM] = this.transportSessionId;\n      }\n      if (this.lastSessionId) {\n        urlParams[LAST_SESSION_PARAM] = this.lastSessionId;\n      }\n      if (\n        typeof location !== 'undefined' &&\n        location.href &&\n        location.href.indexOf(FORGE_DOMAIN) !== -1\n      ) {\n        urlParams[REFERER_PARAM] = FORGE_REF;\n      }\n      const connectURL = this.urlFn(urlParams);\n      this.log_('Connecting via long-poll to ' + connectURL);\n      this.scriptTagHolder.addTag(connectURL, () => {\n        /* do nothing */\n      });\n    });\n  }\n\n  /**\n   * Call this when a handshake has completed successfully and we want to consider the connection established\n   */\n  start() {\n    this.scriptTagHolder.startLongPoll(this.id, this.password);\n    this.addDisconnectPingFrame(this.id, this.password);\n  }\n\n  private static forceAllow_: boolean;\n\n  /**\n   * Forces long polling to be considered as a potential transport\n   */\n  static forceAllow() {\n    BrowserPollConnection.forceAllow_ = true;\n  }\n\n  private static forceDisallow_: boolean;\n\n  /**\n   * Forces longpolling to not be considered as a potential transport\n   */\n  static forceDisallow() {\n    BrowserPollConnection.forceDisallow_ = true;\n  }\n\n  // Static method, use string literal so it can be accessed in a generic way\n  static isAvailable() {\n    if (isNodeSdk()) {\n      return false;\n    } else if (BrowserPollConnection.forceAllow_) {\n      return true;\n    } else {\n      // NOTE: In React-Native there's normally no 'document', but if you debug a React-Native app in\n      // the Chrome debugger, 'document' is defined, but document.createElement is null (2015/06/08).\n      return (\n        !BrowserPollConnection.forceDisallow_ &&\n        typeof document !== 'undefined' &&\n        document.createElement != null &&\n        !isChromeExtensionContentScript() &&\n        !isWindowsStoreApp()\n      );\n    }\n  }\n\n  /**\n   * No-op for polling\n   */\n  markConnectionHealthy() {}\n\n  /**\n   * Stops polling and cleans up the iframe\n   * @private\n   */\n  private shutdown_() {\n    this.isClosed_ = true;\n\n    if (this.scriptTagHolder) {\n      this.scriptTagHolder.close();\n      this.scriptTagHolder = null;\n    }\n\n    //remove the disconnect frame, which will trigger an XHR call to the server to tell it we're leaving.\n    if (this.myDisconnFrame) {\n      document.body.removeChild(this.myDisconnFrame);\n      this.myDisconnFrame = null;\n    }\n\n    if (this.connectTimeoutTimer_) {\n      clearTimeout(this.connectTimeoutTimer_);\n      this.connectTimeoutTimer_ = null;\n    }\n  }\n\n  /**\n   * Triggered when this transport is closed\n   * @private\n   */\n  private onClosed_() {\n    if (!this.isClosed_) {\n      this.log_('Longpoll is closing itself');\n      this.shutdown_();\n\n      if (this.onDisconnect_) {\n        this.onDisconnect_(this.everConnected_);\n        this.onDisconnect_ = null;\n      }\n    }\n  }\n\n  /**\n   * External-facing close handler. RealTime has requested we shut down. Kill our connection and tell the server\n   * that we've left.\n   */\n  close() {\n    if (!this.isClosed_) {\n      this.log_('Longpoll is being closed.');\n      this.shutdown_();\n    }\n  }\n\n  /**\n   * Send the JSON object down to the server. It will need to be stringified, base64 encoded, and then\n   * broken into chunks (since URLs have a small maximum length).\n   * @param {!Object} data The JSON data to transmit.\n   */\n  send(data: Object) {\n    const dataStr = stringify(data);\n    this.bytesSent += dataStr.length;\n    this.stats_.incrementCounter('bytes_sent', dataStr.length);\n\n    //first, lets get the base64-encoded data\n    const base64data = base64Encode(dataStr);\n\n    //We can only fit a certain amount in each URL, so we need to split this request\n    //up into multiple pieces if it doesn't fit in one request.\n    const dataSegs = splitStringBySize(base64data, MAX_PAYLOAD_SIZE);\n\n    //Enqueue each segment for transmission. We assign each chunk a sequential ID and a total number\n    //of segments so that we can reassemble the packet on the server.\n    for (let i = 0; i < dataSegs.length; i++) {\n      this.scriptTagHolder.enqueueSegment(\n        this.curSegmentNum,\n        dataSegs.length,\n        dataSegs[i]\n      );\n      this.curSegmentNum++;\n    }\n  }\n\n  /**\n   * This is how we notify the server that we're leaving.\n   * We aren't able to send requests with DHTML on a window close event, but we can\n   * trigger XHR requests in some browsers (everything but Opera basically).\n   * @param {!string} id\n   * @param {!string} pw\n   */\n  addDisconnectPingFrame(id: string, pw: string) {\n    if (isNodeSdk()) return;\n    this.myDisconnFrame = document.createElement('iframe');\n    const urlParams: { [k: string]: string } = {};\n    urlParams[FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM] = 't';\n    urlParams[FIREBASE_LONGPOLL_ID_PARAM] = id;\n    urlParams[FIREBASE_LONGPOLL_PW_PARAM] = pw;\n    this.myDisconnFrame.src = this.urlFn(urlParams);\n    this.myDisconnFrame.style.display = 'none';\n\n    document.body.appendChild(this.myDisconnFrame);\n  }\n\n  /**\n   * Used to track the bytes received by this client\n   * @param {*} args\n   * @private\n   */\n  private incrementIncomingBytes_(args: any) {\n    // TODO: This is an annoying perf hit just to track the number of incoming bytes.  Maybe it should be opt-in.\n    const bytesReceived = stringify(args).length;\n    this.bytesReceived += bytesReceived;\n    this.stats_.incrementCounter('bytes_received', bytesReceived);\n  }\n}\n\nexport interface IFrameElement extends HTMLIFrameElement {\n  doc: Document;\n}\n\n/*********************************************************************************************\n * A wrapper around an iframe that is used as a long-polling script holder.\n * @constructor\n *********************************************************************************************/\nexport class FirebaseIFrameScriptHolder {\n  //We maintain a count of all of the outstanding requests, because if we have too many active at once it can cause\n  //problems in some browsers.\n  outstandingRequests = new Set<number>();\n\n  //A queue of the pending segments waiting for transmission to the server.\n  pendingSegs: { seg: number; ts: number; d: any }[] = [];\n\n  //A serial number. We use this for two things:\n  // 1) A way to ensure the browser doesn't cache responses to polls\n  // 2) A way to make the server aware when long-polls arrive in a different order than we started them. The\n  //    server needs to release both polls in this case or it will cause problems in Opera since Opera can only execute\n  //    JSONP code in the order it was added to the iframe.\n  currentSerial = Math.floor(Math.random() * 100000000);\n\n  // This gets set to false when we're \"closing down\" the connection (e.g. we're switching transports but there's still\n  // incoming data from the server that we're waiting for).\n  sendNewPolls = true;\n\n  uniqueCallbackIdentifier: number;\n  myIFrame: IFrameElement;\n  alive: boolean;\n  myID: string;\n  myPW: string;\n  commandCB: (command: string, ...args: any[]) => void;\n  onMessageCB: (...args: any[]) => void;\n\n  /**\n   * @param commandCB - The callback to be called when control commands are recevied from the server.\n   * @param onMessageCB - The callback to be triggered when responses arrive from the server.\n   * @param onDisconnect - The callback to be triggered when this tag holder is closed\n   * @param urlFn - A function that provides the URL of the endpoint to send data to.\n   */\n  constructor(\n    commandCB: (command: string, ...args: any[]) => void,\n    onMessageCB: (...args: any[]) => void,\n    public onDisconnect: () => void,\n    public urlFn: (a: object) => string\n  ) {\n    if (!isNodeSdk()) {\n      //Each script holder registers a couple of uniquely named callbacks with the window. These are called from the\n      //iframes where we put the long-polling script tags. We have two callbacks:\n      //   1) Command Callback - Triggered for control issues, like starting a connection.\n      //   2) Message Callback - Triggered when new data arrives.\n      this.uniqueCallbackIdentifier = LUIDGenerator();\n      (window as any)[\n        FIREBASE_LONGPOLL_COMMAND_CB_NAME + this.uniqueCallbackIdentifier\n      ] = commandCB;\n      (window as any)[\n        FIREBASE_LONGPOLL_DATA_CB_NAME + this.uniqueCallbackIdentifier\n      ] = onMessageCB;\n\n      //Create an iframe for us to add script tags to.\n      this.myIFrame = FirebaseIFrameScriptHolder.createIFrame_();\n\n      // Set the iframe's contents.\n      let script = '';\n      // if we set a javascript url, it's IE and we need to set the document domain. The javascript url is sufficient\n      // for ie9, but ie8 needs to do it again in the document itself.\n      if (\n        this.myIFrame.src &&\n        this.myIFrame.src.substr(0, 'javascript:'.length) === 'javascript:'\n      ) {\n        const currentDomain = document.domain;\n        script = '<script>document.domain=\"' + currentDomain + '\";</script>';\n      }\n      const iframeContents = '<html><body>' + script + '</body></html>';\n      try {\n        this.myIFrame.doc.open();\n        this.myIFrame.doc.write(iframeContents);\n        this.myIFrame.doc.close();\n      } catch (e) {\n        log('frame writing exception');\n        if (e.stack) {\n          log(e.stack);\n        }\n        log(e);\n      }\n    } else {\n      this.commandCB = commandCB;\n      this.onMessageCB = onMessageCB;\n    }\n  }\n\n  /**\n   * Each browser has its own funny way to handle iframes. Here we mush them all together into one object that I can\n   * actually use.\n   * @private\n   * @return {Element}\n   */\n  private static createIFrame_(): IFrameElement {\n    const iframe = document.createElement('iframe') as IFrameElement;\n    iframe.style.display = 'none';\n\n    // This is necessary in order to initialize the document inside the iframe\n    if (document.body) {\n      document.body.appendChild(iframe);\n      try {\n        // If document.domain has been modified in IE, this will throw an error, and we need to set the\n        // domain of the iframe's document manually. We can do this via a javascript: url as the src attribute\n        // Also note that we must do this *after* the iframe has been appended to the page. Otherwise it doesn't work.\n        const a = iframe.contentWindow.document;\n        if (!a) {\n          // Apologies for the log-spam, I need to do something to keep closure from optimizing out the assignment above.\n          log('No IE domain setting required');\n        }\n      } catch (e) {\n        const domain = document.domain;\n        iframe.src =\n          \"javascript:void((function(){document.open();document.domain='\" +\n          domain +\n          \"';document.close();})())\";\n      }\n    } else {\n      // LongPollConnection attempts to delay initialization until the document is ready, so hopefully this\n      // never gets hit.\n      throw 'Document body has not initialized. Wait to initialize Firebase until after the document is ready.';\n    }\n\n    // Get the document of the iframe in a browser-specific way.\n    if (iframe.contentDocument) {\n      (iframe as any).doc = iframe.contentDocument; // Firefox, Opera, Safari\n    } else if (iframe.contentWindow) {\n      (iframe as any).doc = iframe.contentWindow.document; // Internet Explorer\n    } else if ((iframe as any).document) {\n      (iframe as any).doc = (iframe as any).document; //others?\n    }\n\n    return iframe;\n  }\n\n  /**\n   * Cancel all outstanding queries and remove the frame.\n   */\n  close() {\n    //Mark this iframe as dead, so no new requests are sent.\n    this.alive = false;\n\n    if (this.myIFrame) {\n      //We have to actually remove all of the html inside this iframe before removing it from the\n      //window, or IE will continue loading and executing the script tags we've already added, which\n      //can lead to some errors being thrown. Setting innerHTML seems to be the easiest way to do this.\n      this.myIFrame.doc.body.innerHTML = '';\n      setTimeout(() => {\n        if (this.myIFrame !== null) {\n          document.body.removeChild(this.myIFrame);\n          this.myIFrame = null;\n        }\n      }, Math.floor(0));\n    }\n\n    // Protect from being called recursively.\n    const onDisconnect = this.onDisconnect;\n    if (onDisconnect) {\n      this.onDisconnect = null;\n      onDisconnect();\n    }\n  }\n\n  /**\n   * Actually start the long-polling session by adding the first script tag(s) to the iframe.\n   * @param {!string} id - The ID of this connection\n   * @param {!string} pw - The password for this connection\n   */\n  startLongPoll(id: string, pw: string) {\n    this.myID = id;\n    this.myPW = pw;\n    this.alive = true;\n\n    //send the initial request. If there are requests queued, make sure that we transmit as many as we are currently able to.\n    while (this.newRequest_()) {}\n  }\n\n  /**\n   * This is called any time someone might want a script tag to be added. It adds a script tag when there aren't\n   * too many outstanding requests and we are still alive.\n   *\n   * If there are outstanding packet segments to send, it sends one. If there aren't, it sends a long-poll anyways if\n   * needed.\n   */\n  private newRequest_() {\n    // We keep one outstanding request open all the time to receive data, but if we need to send data\n    // (pendingSegs.length > 0) then we create a new request to send the data.  The server will automatically\n    // close the old request.\n    if (\n      this.alive &&\n      this.sendNewPolls &&\n      this.outstandingRequests.size < (this.pendingSegs.length > 0 ? 2 : 1)\n    ) {\n      //construct our url\n      this.currentSerial++;\n      const urlParams: { [k: string]: string | number } = {};\n      urlParams[FIREBASE_LONGPOLL_ID_PARAM] = this.myID;\n      urlParams[FIREBASE_LONGPOLL_PW_PARAM] = this.myPW;\n      urlParams[FIREBASE_LONGPOLL_SERIAL_PARAM] = this.currentSerial;\n      let theURL = this.urlFn(urlParams);\n      //Now add as much data as we can.\n      let curDataString = '';\n      let i = 0;\n\n      while (this.pendingSegs.length > 0) {\n        //first, lets see if the next segment will fit.\n        const nextSeg = this.pendingSegs[0];\n        if (\n          nextSeg.d.length + SEG_HEADER_SIZE + curDataString.length <=\n          MAX_URL_DATA_SIZE\n        ) {\n          //great, the segment will fit. Lets append it.\n          const theSeg = this.pendingSegs.shift();\n          curDataString =\n            curDataString +\n            '&' +\n            FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM +\n            i +\n            '=' +\n            theSeg.seg +\n            '&' +\n            FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET +\n            i +\n            '=' +\n            theSeg.ts +\n            '&' +\n            FIREBASE_LONGPOLL_DATA_PARAM +\n            i +\n            '=' +\n            theSeg.d;\n          i++;\n        } else {\n          break;\n        }\n      }\n\n      theURL = theURL + curDataString;\n      this.addLongPollTag_(theURL, this.currentSerial);\n\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  /**\n   * Queue a packet for transmission to the server.\n   * @param segnum - A sequential id for this packet segment used for reassembly\n   * @param totalsegs - The total number of segments in this packet\n   * @param data - The data for this segment.\n   */\n  enqueueSegment(segnum: number, totalsegs: number, data: any) {\n    //add this to the queue of segments to send.\n    this.pendingSegs.push({ seg: segnum, ts: totalsegs, d: data });\n\n    //send the data immediately if there isn't already data being transmitted, unless\n    //startLongPoll hasn't been called yet.\n    if (this.alive) {\n      this.newRequest_();\n    }\n  }\n\n  /**\n   * Add a script tag for a regular long-poll request.\n   * @param {!string} url - The URL of the script tag.\n   * @param {!number} serial - The serial number of the request.\n   * @private\n   */\n  private addLongPollTag_(url: string, serial: number) {\n    //remember that we sent this request.\n    this.outstandingRequests.add(serial);\n\n    const doNewRequest = () => {\n      this.outstandingRequests.delete(serial);\n      this.newRequest_();\n    };\n\n    // If this request doesn't return on its own accord (by the server sending us some data), we'll\n    // create a new one after the KEEPALIVE interval to make sure we always keep a fresh request open.\n    const keepaliveTimeout = setTimeout(\n      doNewRequest,\n      Math.floor(KEEPALIVE_REQUEST_INTERVAL)\n    );\n\n    const readyStateCB = () => {\n      // Request completed.  Cancel the keepalive.\n      clearTimeout(keepaliveTimeout);\n\n      // Trigger a new request so we can continue receiving data.\n      doNewRequest();\n    };\n\n    this.addTag(url, readyStateCB);\n  }\n\n  /**\n   * Add an arbitrary script tag to the iframe.\n   * @param {!string} url - The URL for the script tag source.\n   * @param {!function()} loadCB - A callback to be triggered once the script has loaded.\n   */\n  addTag(url: string, loadCB: () => void) {\n    if (isNodeSdk()) {\n      (this as any).doNodeLongPoll(url, loadCB);\n    } else {\n      setTimeout(() => {\n        try {\n          // if we're already closed, don't add this poll\n          if (!this.sendNewPolls) return;\n          const newScript = this.myIFrame.doc.createElement('script');\n          newScript.type = 'text/javascript';\n          newScript.async = true;\n          newScript.src = url;\n          newScript.onload = (newScript as any).onreadystatechange = function() {\n            const rstate = (newScript as any).readyState;\n            if (!rstate || rstate === 'loaded' || rstate === 'complete') {\n              newScript.onload = (newScript as any).onreadystatechange = null;\n              if (newScript.parentNode) {\n                newScript.parentNode.removeChild(newScript);\n              }\n              loadCB();\n            }\n          };\n          newScript.onerror = () => {\n            log('Long-poll script failed to load: ' + url);\n            this.sendNewPolls = false;\n            this.close();\n          };\n          this.myIFrame.doc.body.appendChild(newScript);\n        } catch (e) {\n          // TODO: we should make this error visible somehow\n        }\n      }, Math.floor(1));\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** The semver (www.semver.org) version of the SDK. */\nexport let SDK_VERSION = '';\n\n// SDK_VERSION should be set before any database instance is created\nexport function setSDKVersion(version: string): void {\n  SDK_VERSION = version;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { RepoInfo } from '../core/RepoInfo';\n\ndeclare const MozWebSocket: any;\n\nimport { assert, CONSTANTS as ENV_CONSTANTS } from '@firebase/util';\nimport { logWrapper, splitStringBySize } from '../core/util/util';\nimport { StatsManager } from '../core/stats/StatsManager';\nimport {\n  FORGE_DOMAIN,\n  FORGE_REF,\n  LAST_SESSION_PARAM,\n  PROTOCOL_VERSION,\n  REFERER_PARAM,\n  TRANSPORT_SESSION_PARAM,\n  VERSION_PARAM,\n  WEBSOCKET\n} from './Constants';\nimport { PersistentStorage } from '../core/storage/storage';\nimport { jsonEval, stringify } from '@firebase/util';\nimport { isNodeSdk } from '@firebase/util';\nimport { Transport } from './Transport';\nimport { StatsCollection } from '../core/stats/StatsCollection';\nimport { SDK_VERSION } from '../core/version';\n\nconst WEBSOCKET_MAX_FRAME_SIZE = 16384;\nconst WEBSOCKET_KEEPALIVE_INTERVAL = 45000;\n\nlet WebSocketImpl = null;\nif (typeof MozWebSocket !== 'undefined') {\n  WebSocketImpl = MozWebSocket;\n} else if (typeof WebSocket !== 'undefined') {\n  WebSocketImpl = WebSocket;\n}\n\nexport function setWebSocketImpl(impl) {\n  WebSocketImpl = impl;\n}\n\n/**\n * Create a new websocket connection with the given callbacks.\n * @constructor\n * @implements {Transport}\n */\nexport class WebSocketConnection implements Transport {\n  keepaliveTimer: number | null = null;\n  frames: string[] | null = null;\n  totalFrames = 0;\n  bytesSent = 0;\n  bytesReceived = 0;\n  connURL: string;\n  onDisconnect: (a?: boolean) => void;\n  onMessage: (msg: Object) => void;\n  mySock: any | null;\n  private log_: (...a: any[]) => void;\n  private stats_: StatsCollection;\n  private everConnected_: boolean;\n  private isClosed_: boolean;\n\n  /**\n   * @param {string} connId identifier for this transport\n   * @param {RepoInfo} repoInfo The info for the websocket endpoint.\n   * @param {string=} transportSessionId Optional transportSessionId if this is connecting to an existing transport\n   *                                         session\n   * @param {string=} lastSessionId Optional lastSessionId if there was a previous connection\n   */\n  constructor(\n    public connId: string,\n    repoInfo: RepoInfo,\n    transportSessionId?: string,\n    lastSessionId?: string\n  ) {\n    this.log_ = logWrapper(this.connId);\n    this.stats_ = StatsManager.getCollection(repoInfo);\n    this.connURL = WebSocketConnection.connectionURL_(\n      repoInfo,\n      transportSessionId,\n      lastSessionId\n    );\n  }\n\n  /**\n   * @param {RepoInfo} repoInfo The info for the websocket endpoint.\n   * @param {string=} transportSessionId Optional transportSessionId if this is connecting to an existing transport\n   *                                         session\n   * @param {string=} lastSessionId Optional lastSessionId if there was a previous connection\n   * @return {string} connection url\n   * @private\n   */\n  private static connectionURL_(\n    repoInfo: RepoInfo,\n    transportSessionId?: string,\n    lastSessionId?: string\n  ): string {\n    const urlParams: { [k: string]: string } = {};\n    urlParams[VERSION_PARAM] = PROTOCOL_VERSION;\n\n    if (\n      !isNodeSdk() &&\n      typeof location !== 'undefined' &&\n      location.href &&\n      location.href.indexOf(FORGE_DOMAIN) !== -1\n    ) {\n      urlParams[REFERER_PARAM] = FORGE_REF;\n    }\n    if (transportSessionId) {\n      urlParams[TRANSPORT_SESSION_PARAM] = transportSessionId;\n    }\n    if (lastSessionId) {\n      urlParams[LAST_SESSION_PARAM] = lastSessionId;\n    }\n    return repoInfo.connectionURL(WEBSOCKET, urlParams);\n  }\n\n  /**\n   *\n   * @param onMessage Callback when messages arrive\n   * @param onDisconnect Callback with connection lost.\n   */\n  open(onMessage: (msg: Object) => void, onDisconnect: (a?: boolean) => void) {\n    this.onDisconnect = onDisconnect;\n    this.onMessage = onMessage;\n\n    this.log_('Websocket connecting to ' + this.connURL);\n\n    this.everConnected_ = false;\n    // Assume failure until proven otherwise.\n    PersistentStorage.set('previous_websocket_failure', true);\n\n    try {\n      if (isNodeSdk()) {\n        const device = ENV_CONSTANTS.NODE_ADMIN ? 'AdminNode' : 'Node';\n        // UA Format: Firebase/<wire_protocol>/<sdk_version>/<platform>/<device>\n        const options: { [k: string]: object } = {\n          headers: {\n            'User-Agent': `Firebase/${PROTOCOL_VERSION}/${SDK_VERSION}/${process.platform}/${device}`\n          }\n        };\n\n        // Plumb appropriate http_proxy environment variable into faye-websocket if it exists.\n        const env = process['env'];\n        const proxy =\n          this.connURL.indexOf('wss://') == 0\n            ? env['HTTPS_PROXY'] || env['https_proxy']\n            : env['HTTP_PROXY'] || env['http_proxy'];\n\n        if (proxy) {\n          options['proxy'] = { origin: proxy };\n        }\n\n        this.mySock = new WebSocketImpl(this.connURL, [], options);\n      } else {\n        this.mySock = new WebSocketImpl(this.connURL);\n      }\n    } catch (e) {\n      this.log_('Error instantiating WebSocket.');\n      const error = e.message || e.data;\n      if (error) {\n        this.log_(error);\n      }\n      this.onClosed_();\n      return;\n    }\n\n    this.mySock.onopen = () => {\n      this.log_('Websocket connected.');\n      this.everConnected_ = true;\n    };\n\n    this.mySock.onclose = () => {\n      this.log_('Websocket connection was disconnected.');\n      this.mySock = null;\n      this.onClosed_();\n    };\n\n    this.mySock.onmessage = (m: object) => {\n      this.handleIncomingFrame(m);\n    };\n\n    this.mySock.onerror = (e: any) => {\n      this.log_('WebSocket error.  Closing connection.');\n      const error = e.message || e.data;\n      if (error) {\n        this.log_(error);\n      }\n      this.onClosed_();\n    };\n  }\n\n  /**\n   * No-op for websockets, we don't need to do anything once the connection is confirmed as open\n   */\n  start() {}\n\n  static forceDisallow_: Boolean;\n\n  static forceDisallow() {\n    WebSocketConnection.forceDisallow_ = true;\n  }\n\n  static isAvailable(): boolean {\n    let isOldAndroid = false;\n    if (typeof navigator !== 'undefined' && navigator.userAgent) {\n      const oldAndroidRegex = /Android ([0-9]{0,}\\.[0-9]{0,})/;\n      const oldAndroidMatch = navigator.userAgent.match(oldAndroidRegex);\n      if (oldAndroidMatch && oldAndroidMatch.length > 1) {\n        if (parseFloat(oldAndroidMatch[1]) < 4.4) {\n          isOldAndroid = true;\n        }\n      }\n    }\n\n    return (\n      !isOldAndroid &&\n      WebSocketImpl !== null &&\n      !WebSocketConnection.forceDisallow_\n    );\n  }\n\n  /**\n   * Number of response before we consider the connection \"healthy.\"\n   * @type {number}\n   */\n  static responsesRequiredToBeHealthy = 2;\n\n  /**\n   * Time to wait for the connection te become healthy before giving up.\n   * @type {number}\n   */\n  static healthyTimeout = 30000;\n\n  /**\n   * Returns true if we previously failed to connect with this transport.\n   * @return {boolean}\n   */\n  static previouslyFailed(): boolean {\n    // If our persistent storage is actually only in-memory storage,\n    // we default to assuming that it previously failed to be safe.\n    return (\n      PersistentStorage.isInMemoryStorage ||\n      PersistentStorage.get('previous_websocket_failure') === true\n    );\n  }\n\n  markConnectionHealthy() {\n    PersistentStorage.remove('previous_websocket_failure');\n  }\n\n  private appendFrame_(data: string) {\n    this.frames.push(data);\n    if (this.frames.length == this.totalFrames) {\n      const fullMess = this.frames.join('');\n      this.frames = null;\n      const jsonMess = jsonEval(fullMess) as object;\n\n      //handle the message\n      this.onMessage(jsonMess);\n    }\n  }\n\n  /**\n   * @param {number} frameCount The number of frames we are expecting from the server\n   * @private\n   */\n  private handleNewFrameCount_(frameCount: number) {\n    this.totalFrames = frameCount;\n    this.frames = [];\n  }\n\n  /**\n   * Attempts to parse a frame count out of some text. If it can't, assumes a value of 1\n   * @param {!String} data\n   * @return {?String} Any remaining data to be process, or null if there is none\n   * @private\n   */\n  private extractFrameCount_(data: string): string | null {\n    assert(this.frames === null, 'We already have a frame buffer');\n    // TODO: The server is only supposed to send up to 9999 frames (i.e. length <= 4), but that isn't being enforced\n    // currently.  So allowing larger frame counts (length <= 6).  See https://app.asana.com/0/search/8688598998380/8237608042508\n    if (data.length <= 6) {\n      const frameCount = Number(data);\n      if (!isNaN(frameCount)) {\n        this.handleNewFrameCount_(frameCount);\n        return null;\n      }\n    }\n    this.handleNewFrameCount_(1);\n    return data;\n  }\n\n  /**\n   * Process a websocket frame that has arrived from the server.\n   * @param mess The frame data\n   */\n  handleIncomingFrame(mess: { [k: string]: any }) {\n    if (this.mySock === null) return; // Chrome apparently delivers incoming packets even after we .close() the connection sometimes.\n    const data = mess['data'] as string;\n    this.bytesReceived += data.length;\n    this.stats_.incrementCounter('bytes_received', data.length);\n\n    this.resetKeepAlive();\n\n    if (this.frames !== null) {\n      // we're buffering\n      this.appendFrame_(data);\n    } else {\n      // try to parse out a frame count, otherwise, assume 1 and process it\n      const remainingData = this.extractFrameCount_(data);\n      if (remainingData !== null) {\n        this.appendFrame_(remainingData);\n      }\n    }\n  }\n\n  /**\n   * Send a message to the server\n   * @param {Object} data The JSON object to transmit\n   */\n  send(data: Object) {\n    this.resetKeepAlive();\n\n    const dataStr = stringify(data);\n    this.bytesSent += dataStr.length;\n    this.stats_.incrementCounter('bytes_sent', dataStr.length);\n\n    //We can only fit a certain amount in each websocket frame, so we need to split this request\n    //up into multiple pieces if it doesn't fit in one request.\n\n    const dataSegs = splitStringBySize(dataStr, WEBSOCKET_MAX_FRAME_SIZE);\n\n    //Send the length header\n    if (dataSegs.length > 1) {\n      this.sendString_(String(dataSegs.length));\n    }\n\n    //Send the actual data in segments.\n    for (let i = 0; i < dataSegs.length; i++) {\n      this.sendString_(dataSegs[i]);\n    }\n  }\n\n  private shutdown_() {\n    this.isClosed_ = true;\n    if (this.keepaliveTimer) {\n      clearInterval(this.keepaliveTimer);\n      this.keepaliveTimer = null;\n    }\n\n    if (this.mySock) {\n      this.mySock.close();\n      this.mySock = null;\n    }\n  }\n\n  private onClosed_() {\n    if (!this.isClosed_) {\n      this.log_('WebSocket is closing itself');\n      this.shutdown_();\n\n      // since this is an internal close, trigger the close listener\n      if (this.onDisconnect) {\n        this.onDisconnect(this.everConnected_);\n        this.onDisconnect = null;\n      }\n    }\n  }\n\n  /**\n   * External-facing close handler.\n   * Close the websocket and kill the connection.\n   */\n  close() {\n    if (!this.isClosed_) {\n      this.log_('WebSocket is being closed');\n      this.shutdown_();\n    }\n  }\n\n  /**\n   * Kill the current keepalive timer and start a new one, to ensure that it always fires N seconds after\n   * the last activity.\n   */\n  resetKeepAlive() {\n    clearInterval(this.keepaliveTimer);\n    this.keepaliveTimer = setInterval(() => {\n      //If there has been no websocket activity for a while, send a no-op\n      if (this.mySock) {\n        this.sendString_('0');\n      }\n      this.resetKeepAlive();\n    }, Math.floor(WEBSOCKET_KEEPALIVE_INTERVAL)) as any;\n  }\n\n  /**\n   * Send a string over the websocket.\n   *\n   * @param {string} str String to send.\n   * @private\n   */\n  private sendString_(str: string) {\n    // Firefox seems to sometimes throw exceptions (NS_ERROR_UNEXPECTED) from websocket .send()\n    // calls for some unknown reason.  We treat these as an error and disconnect.\n    // See https://app.asana.com/0/58926111402292/68021340250410\n    try {\n      this.mySock.send(str);\n    } catch (e) {\n      this.log_(\n        'Exception thrown from WebSocket.send():',\n        e.message || e.data,\n        'Closing connection.'\n      );\n      setTimeout(this.onClosed_.bind(this), 0);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { BrowserPollConnection } from './BrowserPollConnection';\nimport { WebSocketConnection } from './WebSocketConnection';\nimport { warn, each } from '../core/util/util';\nimport { TransportConstructor } from './Transport';\nimport { RepoInfo } from '../core/RepoInfo';\n\n/**\n * Currently simplistic, this class manages what transport a Connection should use at various stages of its\n * lifecycle.\n *\n * It starts with longpolling in a browser, and httppolling on node. It then upgrades to websockets if\n * they are available.\n * @constructor\n */\nexport class TransportManager {\n  private transports_: TransportConstructor[];\n\n  /**\n   * @const\n   * @type {!Array.<function(new:Transport, string, RepoInfo, string=)>}\n   */\n  static get ALL_TRANSPORTS() {\n    return [BrowserPollConnection, WebSocketConnection];\n  }\n\n  /**\n   * @param {!RepoInfo} repoInfo Metadata around the namespace we're connecting to\n   */\n  constructor(repoInfo: RepoInfo) {\n    this.initTransports_(repoInfo);\n  }\n\n  /**\n   * @param {!RepoInfo} repoInfo\n   * @private\n   */\n  private initTransports_(repoInfo: RepoInfo) {\n    const isWebSocketsAvailable: boolean =\n      WebSocketConnection && WebSocketConnection['isAvailable']();\n    let isSkipPollConnection =\n      isWebSocketsAvailable && !WebSocketConnection.previouslyFailed();\n\n    if (repoInfo.webSocketOnly) {\n      if (!isWebSocketsAvailable)\n        warn(\n          \"wss:// URL used, but browser isn't known to support websockets.  Trying anyway.\"\n        );\n\n      isSkipPollConnection = true;\n    }\n\n    if (isSkipPollConnection) {\n      this.transports_ = [WebSocketConnection];\n    } else {\n      const transports = (this.transports_ = [] as TransportConstructor[]);\n      for (const transport of TransportManager.ALL_TRANSPORTS) {\n        if (transport && transport['isAvailable']()) {\n          transports.push(transport);\n        }\n      }\n    }\n  }\n\n  /**\n   * @return {function(new:Transport, !string, !RepoInfo, string=, string=)} The constructor for the\n   * initial transport to use\n   */\n  initialTransport(): TransportConstructor {\n    if (this.transports_.length > 0) {\n      return this.transports_[0];\n    } else {\n      throw new Error('No transports available');\n    }\n  }\n\n  /**\n   * @return {?function(new:Transport, function(),function(), string=)} The constructor for the next\n   * transport, or null\n   */\n  upgradeTransport(): TransportConstructor | null {\n    if (this.transports_.length > 1) {\n      return this.transports_[1];\n    } else {\n      return null;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  error,\n  logWrapper,\n  requireKey,\n  setTimeoutNonBlocking,\n  warn\n} from '../core/util/util';\nimport { PersistentStorage } from '../core/storage/storage';\nimport { PROTOCOL_VERSION } from './Constants';\nimport { TransportManager } from './TransportManager';\nimport { RepoInfo } from '../core/RepoInfo';\nimport { Transport, TransportConstructor } from './Transport';\n\n// Abort upgrade attempt if it takes longer than 60s.\nconst UPGRADE_TIMEOUT = 60000;\n\n// For some transports (WebSockets), we need to \"validate\" the transport by exchanging a few requests and responses.\n// If we haven't sent enough requests within 5s, we'll start sending noop ping requests.\nconst DELAY_BEFORE_SENDING_EXTRA_REQUESTS = 5000;\n\n// If the initial data sent triggers a lot of bandwidth (i.e. it's a large put or a listen for a large amount of data)\n// then we may not be able to exchange our ping/pong requests within the healthy timeout.  So if we reach the timeout\n// but we've sent/received enough bytes, we don't cancel the connection.\nconst BYTES_SENT_HEALTHY_OVERRIDE = 10 * 1024;\nconst BYTES_RECEIVED_HEALTHY_OVERRIDE = 100 * 1024;\n\nconst enum RealtimeState {\n  CONNECTING,\n  CONNECTED,\n  DISCONNECTED\n}\n\nconst MESSAGE_TYPE = 't';\nconst MESSAGE_DATA = 'd';\nconst CONTROL_SHUTDOWN = 's';\nconst CONTROL_RESET = 'r';\nconst CONTROL_ERROR = 'e';\nconst CONTROL_PONG = 'o';\nconst SWITCH_ACK = 'a';\nconst END_TRANSMISSION = 'n';\nconst PING = 'p';\n\nconst SERVER_HELLO = 'h';\n\n/**\n * Creates a new real-time connection to the server using whichever method works\n * best in the current browser.\n *\n * @constructor\n */\nexport class Connection {\n  connectionCount = 0;\n  pendingDataMessages: any[] = [];\n  sessionId: string;\n\n  private conn_: Transport;\n  private healthyTimeout_: number;\n  private isHealthy_: boolean;\n  private log_: (...args: any[]) => void;\n  private primaryResponsesRequired_: number;\n  private rx_: Transport;\n  private secondaryConn_: Transport;\n  private secondaryResponsesRequired_: number;\n  private state_ = RealtimeState.CONNECTING;\n  private transportManager_: TransportManager;\n  private tx_: Transport;\n\n  /**\n   * @param {!string} id - an id for this connection\n   * @param {!RepoInfo} repoInfo_ - the info for the endpoint to connect to\n   * @param {function(Object)} onMessage_ - the callback to be triggered when a server-push message arrives\n   * @param {function(number, string)} onReady_ - the callback to be triggered when this connection is ready to send messages.\n   * @param {function()} onDisconnect_ - the callback to be triggered when a connection was lost\n   * @param {function(string)} onKill_ - the callback to be triggered when this connection has permanently shut down.\n   * @param {string=} lastSessionId - last session id in persistent connection. is used to clean up old session in real-time server\n   */\n  constructor(\n    public id: string,\n    private repoInfo_: RepoInfo,\n    private onMessage_: (a: Object) => void,\n    private onReady_: (a: number, b: string) => void,\n    private onDisconnect_: () => void,\n    private onKill_: (a: string) => void,\n    public lastSessionId?: string\n  ) {\n    this.log_ = logWrapper('c:' + this.id + ':');\n    this.transportManager_ = new TransportManager(repoInfo_);\n    this.log_('Connection created');\n    this.start_();\n  }\n\n  /**\n   * Starts a connection attempt\n   * @private\n   */\n  private start_() {\n    const conn = this.transportManager_.initialTransport();\n    this.conn_ = new conn(\n      this.nextTransportId_(),\n      this.repoInfo_,\n      undefined,\n      this.lastSessionId\n    );\n\n    // For certain transports (WebSockets), we need to send and receive several messages back and forth before we\n    // can consider the transport healthy.\n    this.primaryResponsesRequired_ = conn['responsesRequiredToBeHealthy'] || 0;\n\n    const onMessageReceived = this.connReceiver_(this.conn_);\n    const onConnectionLost = this.disconnReceiver_(this.conn_);\n    this.tx_ = this.conn_;\n    this.rx_ = this.conn_;\n    this.secondaryConn_ = null;\n    this.isHealthy_ = false;\n\n    /*\n     * Firefox doesn't like when code from one iframe tries to create another iframe by way of the parent frame.\n     * This can occur in the case of a redirect, i.e. we guessed wrong on what server to connect to and received a reset.\n     * Somehow, setTimeout seems to make this ok. That doesn't make sense from a security perspective, since you should\n     * still have the context of your originating frame.\n     */\n    setTimeout(() => {\n      // this.conn_ gets set to null in some of the tests. Check to make sure it still exists before using it\n      this.conn_ && this.conn_.open(onMessageReceived, onConnectionLost);\n    }, Math.floor(0));\n\n    const healthyTimeout_ms = conn['healthyTimeout'] || 0;\n    if (healthyTimeout_ms > 0) {\n      this.healthyTimeout_ = setTimeoutNonBlocking(() => {\n        this.healthyTimeout_ = null;\n        if (!this.isHealthy_) {\n          if (\n            this.conn_ &&\n            this.conn_.bytesReceived > BYTES_RECEIVED_HEALTHY_OVERRIDE\n          ) {\n            this.log_(\n              'Connection exceeded healthy timeout but has received ' +\n                this.conn_.bytesReceived +\n                ' bytes.  Marking connection healthy.'\n            );\n            this.isHealthy_ = true;\n            this.conn_.markConnectionHealthy();\n          } else if (\n            this.conn_ &&\n            this.conn_.bytesSent > BYTES_SENT_HEALTHY_OVERRIDE\n          ) {\n            this.log_(\n              'Connection exceeded healthy timeout but has sent ' +\n                this.conn_.bytesSent +\n                ' bytes.  Leaving connection alive.'\n            );\n            // NOTE: We don't want to mark it healthy, since we have no guarantee that the bytes have made it to\n            // the server.\n          } else {\n            this.log_('Closing unhealthy connection after timeout.');\n            this.close();\n          }\n        }\n      }, Math.floor(healthyTimeout_ms)) as any;\n    }\n  }\n\n  /**\n   * @return {!string}\n   * @private\n   */\n  private nextTransportId_(): string {\n    return 'c:' + this.id + ':' + this.connectionCount++;\n  }\n\n  private disconnReceiver_(conn) {\n    return everConnected => {\n      if (conn === this.conn_) {\n        this.onConnectionLost_(everConnected);\n      } else if (conn === this.secondaryConn_) {\n        this.log_('Secondary connection lost.');\n        this.onSecondaryConnectionLost_();\n      } else {\n        this.log_('closing an old connection');\n      }\n    };\n  }\n\n  private connReceiver_(conn: Transport) {\n    return (message: object) => {\n      if (this.state_ != RealtimeState.DISCONNECTED) {\n        if (conn === this.rx_) {\n          this.onPrimaryMessageReceived_(message);\n        } else if (conn === this.secondaryConn_) {\n          this.onSecondaryMessageReceived_(message);\n        } else {\n          this.log_('message on old connection');\n        }\n      }\n    };\n  }\n\n  /**\n   *\n   * @param {Object} dataMsg An arbitrary data message to be sent to the server\n   */\n  sendRequest(dataMsg: object) {\n    // wrap in a data message envelope and send it on\n    const msg = { t: 'd', d: dataMsg };\n    this.sendData_(msg);\n  }\n\n  tryCleanupConnection() {\n    if (this.tx_ === this.secondaryConn_ && this.rx_ === this.secondaryConn_) {\n      this.log_(\n        'cleaning up and promoting a connection: ' + this.secondaryConn_.connId\n      );\n      this.conn_ = this.secondaryConn_;\n      this.secondaryConn_ = null;\n      // the server will shutdown the old connection\n    }\n  }\n\n  private onSecondaryControl_(controlData: { [k: string]: any }) {\n    if (MESSAGE_TYPE in controlData) {\n      const cmd = controlData[MESSAGE_TYPE] as string;\n      if (cmd === SWITCH_ACK) {\n        this.upgradeIfSecondaryHealthy_();\n      } else if (cmd === CONTROL_RESET) {\n        // Most likely the session wasn't valid. Abandon the switch attempt\n        this.log_('Got a reset on secondary, closing it');\n        this.secondaryConn_.close();\n        // If we were already using this connection for something, than we need to fully close\n        if (\n          this.tx_ === this.secondaryConn_ ||\n          this.rx_ === this.secondaryConn_\n        ) {\n          this.close();\n        }\n      } else if (cmd === CONTROL_PONG) {\n        this.log_('got pong on secondary.');\n        this.secondaryResponsesRequired_--;\n        this.upgradeIfSecondaryHealthy_();\n      }\n    }\n  }\n\n  private onSecondaryMessageReceived_(parsedData: object) {\n    const layer: string = requireKey('t', parsedData);\n    const data: any = requireKey('d', parsedData);\n    if (layer == 'c') {\n      this.onSecondaryControl_(data);\n    } else if (layer == 'd') {\n      // got a data message, but we're still second connection. Need to buffer it up\n      this.pendingDataMessages.push(data);\n    } else {\n      throw new Error('Unknown protocol layer: ' + layer);\n    }\n  }\n\n  private upgradeIfSecondaryHealthy_() {\n    if (this.secondaryResponsesRequired_ <= 0) {\n      this.log_('Secondary connection is healthy.');\n      this.isHealthy_ = true;\n      this.secondaryConn_.markConnectionHealthy();\n      this.proceedWithUpgrade_();\n    } else {\n      // Send a ping to make sure the connection is healthy.\n      this.log_('sending ping on secondary.');\n      this.secondaryConn_.send({ t: 'c', d: { t: PING, d: {} } });\n    }\n  }\n\n  private proceedWithUpgrade_() {\n    // tell this connection to consider itself open\n    this.secondaryConn_.start();\n    // send ack\n    this.log_('sending client ack on secondary');\n    this.secondaryConn_.send({ t: 'c', d: { t: SWITCH_ACK, d: {} } });\n\n    // send end packet on primary transport, switch to sending on this one\n    // can receive on this one, buffer responses until end received on primary transport\n    this.log_('Ending transmission on primary');\n    this.conn_.send({ t: 'c', d: { t: END_TRANSMISSION, d: {} } });\n    this.tx_ = this.secondaryConn_;\n\n    this.tryCleanupConnection();\n  }\n\n  private onPrimaryMessageReceived_(parsedData: { [k: string]: any }) {\n    // Must refer to parsedData properties in quotes, so closure doesn't touch them.\n    const layer: string = requireKey('t', parsedData);\n    const data: any = requireKey('d', parsedData);\n    if (layer == 'c') {\n      this.onControl_(data);\n    } else if (layer == 'd') {\n      this.onDataMessage_(data);\n    }\n  }\n\n  private onDataMessage_(message: any) {\n    this.onPrimaryResponse_();\n\n    // We don't do anything with data messages, just kick them up a level\n    this.onMessage_(message);\n  }\n\n  private onPrimaryResponse_() {\n    if (!this.isHealthy_) {\n      this.primaryResponsesRequired_--;\n      if (this.primaryResponsesRequired_ <= 0) {\n        this.log_('Primary connection is healthy.');\n        this.isHealthy_ = true;\n        this.conn_.markConnectionHealthy();\n      }\n    }\n  }\n\n  private onControl_(controlData: { [k: string]: any }) {\n    const cmd: string = requireKey(MESSAGE_TYPE, controlData);\n    if (MESSAGE_DATA in controlData) {\n      const payload = controlData[MESSAGE_DATA];\n      if (cmd === SERVER_HELLO) {\n        this.onHandshake_(payload);\n      } else if (cmd === END_TRANSMISSION) {\n        this.log_('recvd end transmission on primary');\n        this.rx_ = this.secondaryConn_;\n        for (let i = 0; i < this.pendingDataMessages.length; ++i) {\n          this.onDataMessage_(this.pendingDataMessages[i]);\n        }\n        this.pendingDataMessages = [];\n        this.tryCleanupConnection();\n      } else if (cmd === CONTROL_SHUTDOWN) {\n        // This was previously the 'onKill' callback passed to the lower-level connection\n        // payload in this case is the reason for the shutdown. Generally a human-readable error\n        this.onConnectionShutdown_(payload);\n      } else if (cmd === CONTROL_RESET) {\n        // payload in this case is the host we should contact\n        this.onReset_(payload);\n      } else if (cmd === CONTROL_ERROR) {\n        error('Server Error: ' + payload);\n      } else if (cmd === CONTROL_PONG) {\n        this.log_('got pong on primary.');\n        this.onPrimaryResponse_();\n        this.sendPingOnPrimaryIfNecessary_();\n      } else {\n        error('Unknown control packet command: ' + cmd);\n      }\n    }\n  }\n\n  /**\n   *\n   * @param {Object} handshake The handshake data returned from the server\n   * @private\n   */\n  private onHandshake_(handshake: {\n    ts: number;\n    v: string;\n    h: string;\n    s: string;\n  }) {\n    const timestamp = handshake.ts;\n    const version = handshake.v;\n    const host = handshake.h;\n    this.sessionId = handshake.s;\n    this.repoInfo_.updateHost(host);\n    // if we've already closed the connection, then don't bother trying to progress further\n    if (this.state_ == RealtimeState.CONNECTING) {\n      this.conn_.start();\n      this.onConnectionEstablished_(this.conn_, timestamp);\n      if (PROTOCOL_VERSION !== version) {\n        warn('Protocol version mismatch detected');\n      }\n      // TODO: do we want to upgrade? when? maybe a delay?\n      this.tryStartUpgrade_();\n    }\n  }\n\n  private tryStartUpgrade_() {\n    const conn = this.transportManager_.upgradeTransport();\n    if (conn) {\n      this.startUpgrade_(conn);\n    }\n  }\n\n  private startUpgrade_(conn: TransportConstructor) {\n    this.secondaryConn_ = new conn(\n      this.nextTransportId_(),\n      this.repoInfo_,\n      this.sessionId\n    );\n    // For certain transports (WebSockets), we need to send and receive several messages back and forth before we\n    // can consider the transport healthy.\n    this.secondaryResponsesRequired_ =\n      conn['responsesRequiredToBeHealthy'] || 0;\n\n    const onMessage = this.connReceiver_(this.secondaryConn_);\n    const onDisconnect = this.disconnReceiver_(this.secondaryConn_);\n    this.secondaryConn_.open(onMessage, onDisconnect);\n\n    // If we haven't successfully upgraded after UPGRADE_TIMEOUT, give up and kill the secondary.\n    setTimeoutNonBlocking(() => {\n      if (this.secondaryConn_) {\n        this.log_('Timed out trying to upgrade.');\n        this.secondaryConn_.close();\n      }\n    }, Math.floor(UPGRADE_TIMEOUT));\n  }\n\n  private onReset_(host: string) {\n    this.log_('Reset packet received.  New host: ' + host);\n    this.repoInfo_.updateHost(host);\n    // TODO: if we're already \"connected\", we need to trigger a disconnect at the next layer up.\n    // We don't currently support resets after the connection has already been established\n    if (this.state_ === RealtimeState.CONNECTED) {\n      this.close();\n    } else {\n      // Close whatever connections we have open and start again.\n      this.closeConnections_();\n      this.start_();\n    }\n  }\n\n  private onConnectionEstablished_(conn: Transport, timestamp: number) {\n    this.log_('Realtime connection established.');\n    this.conn_ = conn;\n    this.state_ = RealtimeState.CONNECTED;\n\n    if (this.onReady_) {\n      this.onReady_(timestamp, this.sessionId);\n      this.onReady_ = null;\n    }\n\n    // If after 5 seconds we haven't sent enough requests to the server to get the connection healthy,\n    // send some pings.\n    if (this.primaryResponsesRequired_ === 0) {\n      this.log_('Primary connection is healthy.');\n      this.isHealthy_ = true;\n    } else {\n      setTimeoutNonBlocking(() => {\n        this.sendPingOnPrimaryIfNecessary_();\n      }, Math.floor(DELAY_BEFORE_SENDING_EXTRA_REQUESTS));\n    }\n  }\n\n  private sendPingOnPrimaryIfNecessary_() {\n    // If the connection isn't considered healthy yet, we'll send a noop ping packet request.\n    if (!this.isHealthy_ && this.state_ === RealtimeState.CONNECTED) {\n      this.log_('sending ping on primary.');\n      this.sendData_({ t: 'c', d: { t: PING, d: {} } });\n    }\n  }\n\n  private onSecondaryConnectionLost_() {\n    const conn = this.secondaryConn_;\n    this.secondaryConn_ = null;\n    if (this.tx_ === conn || this.rx_ === conn) {\n      // we are relying on this connection already in some capacity. Therefore, a failure is real\n      this.close();\n    }\n  }\n\n  /**\n   *\n   * @param {boolean} everConnected Whether or not the connection ever reached a server. Used to determine if\n   * we should flush the host cache\n   * @private\n   */\n  private onConnectionLost_(everConnected: boolean) {\n    this.conn_ = null;\n\n    // NOTE: IF you're seeing a Firefox error for this line, I think it might be because it's getting\n    // called on window close and RealtimeState.CONNECTING is no longer defined.  Just a guess.\n    if (!everConnected && this.state_ === RealtimeState.CONNECTING) {\n      this.log_('Realtime connection failed.');\n      // Since we failed to connect at all, clear any cached entry for this namespace in case the machine went away\n      if (this.repoInfo_.isCacheableHost()) {\n        PersistentStorage.remove('host:' + this.repoInfo_.host);\n        // reset the internal host to what we would show the user, i.e. <ns>.firebaseio.com\n        this.repoInfo_.internalHost = this.repoInfo_.host;\n      }\n    } else if (this.state_ === RealtimeState.CONNECTED) {\n      this.log_('Realtime connection lost.');\n    }\n\n    this.close();\n  }\n\n  /**\n   *\n   * @param {string} reason\n   * @private\n   */\n  private onConnectionShutdown_(reason: string) {\n    this.log_('Connection shutdown command received. Shutting down...');\n\n    if (this.onKill_) {\n      this.onKill_(reason);\n      this.onKill_ = null;\n    }\n\n    // We intentionally don't want to fire onDisconnect (kill is a different case),\n    // so clear the callback.\n    this.onDisconnect_ = null;\n\n    this.close();\n  }\n\n  private sendData_(data: object) {\n    if (this.state_ !== RealtimeState.CONNECTED) {\n      throw 'Connection is not connected';\n    } else {\n      this.tx_.send(data);\n    }\n  }\n\n  /**\n   * Cleans up this connection, calling the appropriate callbacks\n   */\n  close() {\n    if (this.state_ !== RealtimeState.DISCONNECTED) {\n      this.log_('Closing realtime connection.');\n      this.state_ = RealtimeState.DISCONNECTED;\n\n      this.closeConnections_();\n\n      if (this.onDisconnect_) {\n        this.onDisconnect_();\n        this.onDisconnect_ = null;\n      }\n    }\n  }\n\n  /**\n   *\n   * @private\n   */\n  private closeConnections_() {\n    this.log_('Shutting down all connections');\n    if (this.conn_) {\n      this.conn_.close();\n      this.conn_ = null;\n    }\n\n    if (this.secondaryConn_) {\n      this.secondaryConn_.close();\n      this.secondaryConn_ = null;\n    }\n\n    if (this.healthyTimeout_) {\n      clearTimeout(this.healthyTimeout_);\n      this.healthyTimeout_ = null;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Query } from '../api/Query';\n\n/**\n * Interface defining the set of actions that can be performed against the Firebase server\n * (basically corresponds to our wire protocol).\n *\n * @interface\n */\nexport abstract class ServerActions {\n  /**\n   * @param {!Query} query\n   * @param {function():string} currentHashFn\n   * @param {?number} tag\n   * @param {function(string, *)} onComplete\n   */\n  abstract listen(\n    query: Query,\n    currentHashFn: () => string,\n    tag: number | null,\n    onComplete: (a: string, b: any) => void\n  ): void;\n\n  /**\n   * Remove a listen.\n   *\n   * @param {!Query} query\n   * @param {?number} tag\n   */\n  abstract unlisten(query: Query, tag: number | null): void;\n\n  /**\n   * @param {string} pathString\n   * @param {*} data\n   * @param {function(string, string)=} onComplete\n   * @param {string=} hash\n   */\n  put(\n    pathString: string,\n    data: any,\n    onComplete?: (a: string, b: string) => void,\n    hash?: string\n  ) {}\n\n  /**\n   * @param {string} pathString\n   * @param {*} data\n   * @param {function(string, ?string)} onComplete\n   * @param {string=} hash\n   */\n  merge(\n    pathString: string,\n    data: any,\n    onComplete: (a: string, b: string | null) => void,\n    hash?: string\n  ) {}\n\n  /**\n   * Refreshes the auth token for the current connection.\n   * @param {string} token The authentication token\n   */\n  refreshAuthToken(token: string) {}\n\n  /**\n   * @param {string} pathString\n   * @param {*} data\n   * @param {function(string, string)=} onComplete\n   */\n  onDisconnectPut(\n    pathString: string,\n    data: any,\n    onComplete?: (a: string, b: string) => void\n  ) {}\n\n  /**\n   * @param {string} pathString\n   * @param {*} data\n   * @param {function(string, string)=} onComplete\n   */\n  onDisconnectMerge(\n    pathString: string,\n    data: any,\n    onComplete?: (a: string, b: string) => void\n  ) {}\n\n  /**\n   * @param {string} pathString\n   * @param {function(string, string)=} onComplete\n   */\n  onDisconnectCancel(\n    pathString: string,\n    onComplete?: (a: string, b: string) => void\n  ) {}\n\n  /**\n   * @param {Object.<string, *>} stats\n   */\n  reportStats(stats: { [k: string]: any }) {}\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { contains, isEmpty, safeGet, CONSTANTS } from '@firebase/util';\nimport { stringify } from '@firebase/util';\nimport { assert } from '@firebase/util';\nimport { error, log, logWrapper, warn, ObjectToUniqueKey } from './util/util';\nimport { Path } from './util/Path';\nimport { VisibilityMonitor } from './util/VisibilityMonitor';\nimport { OnlineMonitor } from './util/OnlineMonitor';\nimport { isAdmin, isValidFormat } from '@firebase/util';\nimport { Connection } from '../realtime/Connection';\nimport { isMobileCordova, isReactNative, isNodeSdk } from '@firebase/util';\nimport { ServerActions } from './ServerActions';\nimport { AuthTokenProvider } from './AuthTokenProvider';\nimport { RepoInfo } from './RepoInfo';\nimport { Query } from '../api/Query';\nimport { SDK_VERSION } from './version';\n\nconst RECONNECT_MIN_DELAY = 1000;\nconst RECONNECT_MAX_DELAY_DEFAULT = 60 * 5 * 1000; // 5 minutes in milliseconds (Case: 1858)\nconst RECONNECT_MAX_DELAY_FOR_ADMINS = 30 * 1000; // 30 seconds for admin clients (likely to be a backend server)\nconst RECONNECT_DELAY_MULTIPLIER = 1.3;\nconst RECONNECT_DELAY_RESET_TIMEOUT = 30000; // Reset delay back to MIN_DELAY after being connected for 30sec.\nconst SERVER_KILL_INTERRUPT_REASON = 'server_kill';\n\n// If auth fails repeatedly, we'll assume something is wrong and log a warning / back off.\nconst INVALID_AUTH_TOKEN_THRESHOLD = 3;\n\ninterface ListenSpec {\n  onComplete(s: string, p?: any): void;\n\n  hashFn(): string;\n\n  query: Query;\n  tag: number | null;\n}\n\ninterface OnDisconnectRequest {\n  pathString: string;\n  action: string;\n  data: any;\n  onComplete?: (a: string, b: string) => void;\n}\n\ninterface OutstandingPut {\n  action: string;\n  request: Object;\n  queued?: boolean;\n  onComplete: (a: string, b?: string) => void;\n}\n\n/**\n * Firebase connection.  Abstracts wire protocol and handles reconnecting.\n *\n * NOTE: All JSON objects sent to the realtime connection must have property names enclosed\n * in quotes to make sure the closure compiler does not minify them.\n */\nexport class PersistentConnection extends ServerActions {\n  // Used for diagnostic logging.\n  id = PersistentConnection.nextPersistentConnectionId_++;\n  private log_ = logWrapper('p:' + this.id + ':');\n\n  private interruptReasons_: { [reason: string]: boolean } = {};\n  /** Map<path, Map<queryId, ListenSpec>> */\n  private readonly listens: Map<\n    /* path */ string,\n    Map</* queryId */ string, ListenSpec>\n  > = new Map();\n  private outstandingPuts_: OutstandingPut[] = [];\n  private outstandingPutCount_ = 0;\n  private onDisconnectRequestQueue_: OnDisconnectRequest[] = [];\n  private connected_ = false;\n  private reconnectDelay_ = RECONNECT_MIN_DELAY;\n  private maxReconnectDelay_ = RECONNECT_MAX_DELAY_DEFAULT;\n  private securityDebugCallback_: ((a: Object) => void) | null = null;\n  lastSessionId: string | null = null;\n\n  private establishConnectionTimer_: number | null = null;\n\n  private visible_: boolean = false;\n\n  // Before we get connected, we keep a queue of pending messages to send.\n  private requestCBHash_: { [k: number]: (a: any) => void } = {};\n  private requestNumber_ = 0;\n\n  private realtime_: {\n    sendRequest(a: Object): void;\n    close(): void;\n  } | null = null;\n\n  private authToken_: string | null = null;\n  private forceTokenRefresh_ = false;\n  private invalidAuthTokenCount_ = 0;\n\n  private firstConnection_ = true;\n  private lastConnectionAttemptTime_: number | null = null;\n  private lastConnectionEstablishedTime_: number | null = null;\n\n  private static nextPersistentConnectionId_ = 0;\n\n  /**\n   * Counter for number of connections created. Mainly used for tagging in the logs\n   */\n  private static nextConnectionId_ = 0;\n\n  /**\n   * @implements {ServerActions}\n   * @param repoInfo_ Data about the namespace we are connecting to\n   * @param onDataUpdate_ A callback for new data from the server\n   */\n  constructor(\n    private repoInfo_: RepoInfo,\n    private onDataUpdate_: (\n      a: string,\n      b: any,\n      c: boolean,\n      d: number | null\n    ) => void,\n    private onConnectStatus_: (a: boolean) => void,\n    private onServerInfoUpdate_: (a: any) => void,\n    private authTokenProvider_: AuthTokenProvider,\n    private authOverride_?: Object | null\n  ) {\n    super();\n\n    if (authOverride_ && !isNodeSdk()) {\n      throw new Error(\n        'Auth override specified in options, but not supported on non Node.js platforms'\n      );\n    }\n    this.scheduleConnect_(0);\n\n    VisibilityMonitor.getInstance().on('visible', this.onVisible_, this);\n\n    if (repoInfo_.host.indexOf('fblocal') === -1) {\n      OnlineMonitor.getInstance().on('online', this.onOnline_, this);\n    }\n  }\n\n  protected sendRequest(\n    action: string,\n    body: any,\n    onResponse?: (a: any) => void\n  ) {\n    const curReqNum = ++this.requestNumber_;\n\n    const msg = { r: curReqNum, a: action, b: body };\n    this.log_(stringify(msg));\n    assert(\n      this.connected_,\n      \"sendRequest call when we're not connected not allowed.\"\n    );\n    this.realtime_.sendRequest(msg);\n    if (onResponse) {\n      this.requestCBHash_[curReqNum] = onResponse;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  listen(\n    query: Query,\n    currentHashFn: () => string,\n    tag: number | null,\n    onComplete: (a: string, b: any) => void\n  ) {\n    const queryId = query.queryIdentifier();\n    const pathString = query.path.toString();\n    this.log_('Listen called for ' + pathString + ' ' + queryId);\n    if (!this.listens.has(pathString)) {\n      this.listens.set(pathString, new Map());\n    }\n    assert(\n      query.getQueryParams().isDefault() ||\n        !query.getQueryParams().loadsAllData(),\n      'listen() called for non-default but complete query'\n    );\n    assert(\n      !this.listens.get(pathString)!.has(queryId),\n      'listen() called twice for same path/queryId.'\n    );\n    const listenSpec: ListenSpec = {\n      onComplete: onComplete,\n      hashFn: currentHashFn,\n      query: query,\n      tag: tag\n    };\n    this.listens.get(pathString)!.set(queryId, listenSpec);\n\n    if (this.connected_) {\n      this.sendListen_(listenSpec);\n    }\n  }\n\n  private sendListen_(listenSpec: ListenSpec) {\n    const query = listenSpec.query;\n    const pathString = query.path.toString();\n    const queryId = query.queryIdentifier();\n    this.log_('Listen on ' + pathString + ' for ' + queryId);\n    const req: { [k: string]: any } = { /*path*/ p: pathString };\n\n    const action = 'q';\n\n    // Only bother to send query if it's non-default.\n    if (listenSpec.tag) {\n      req['q'] = query.queryObject();\n      req['t'] = listenSpec.tag;\n    }\n\n    req[/*hash*/ 'h'] = listenSpec.hashFn();\n\n    this.sendRequest(action, req, (message: { [k: string]: any }) => {\n      const payload: any = message[/*data*/ 'd'];\n      const status: string = message[/*status*/ 's'];\n\n      // print warnings in any case...\n      PersistentConnection.warnOnListenWarnings_(payload, query);\n\n      const currentListenSpec =\n        this.listens.get(pathString) &&\n        this.listens.get(pathString)!.get(queryId);\n      // only trigger actions if the listen hasn't been removed and readded\n      if (currentListenSpec === listenSpec) {\n        this.log_('listen response', message);\n\n        if (status !== 'ok') {\n          this.removeListen_(pathString, queryId);\n        }\n\n        if (listenSpec.onComplete) {\n          listenSpec.onComplete(status, payload);\n        }\n      }\n    });\n  }\n\n  private static warnOnListenWarnings_(payload: any, query: Query) {\n    if (payload && typeof payload === 'object' && contains(payload, 'w')) {\n      const warnings = safeGet(payload, 'w');\n      if (Array.isArray(warnings) && ~warnings.indexOf('no_index')) {\n        const indexSpec =\n          '\".indexOn\": \"' +\n          query\n            .getQueryParams()\n            .getIndex()\n            .toString() +\n          '\"';\n        const indexPath = query.path.toString();\n        warn(\n          `Using an unspecified index. Your data will be downloaded and ` +\n            `filtered on the client. Consider adding ${indexSpec} at ` +\n            `${indexPath} to your security rules for better performance.`\n        );\n      }\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  refreshAuthToken(token: string) {\n    this.authToken_ = token;\n    this.log_('Auth token refreshed');\n    if (this.authToken_) {\n      this.tryAuth();\n    } else {\n      //If we're connected we want to let the server know to unauthenticate us. If we're not connected, simply delete\n      //the credential so we dont become authenticated next time we connect.\n      if (this.connected_) {\n        this.sendRequest('unauth', {}, () => {});\n      }\n    }\n\n    this.reduceReconnectDelayIfAdminCredential_(token);\n  }\n\n  private reduceReconnectDelayIfAdminCredential_(credential: string) {\n    // NOTE: This isn't intended to be bulletproof (a malicious developer can always just modify the client).\n    // Additionally, we don't bother resetting the max delay back to the default if auth fails / expires.\n    const isFirebaseSecret = credential && credential.length === 40;\n    if (isFirebaseSecret || isAdmin(credential)) {\n      this.log_(\n        'Admin auth credential detected.  Reducing max reconnect time.'\n      );\n      this.maxReconnectDelay_ = RECONNECT_MAX_DELAY_FOR_ADMINS;\n    }\n  }\n\n  /**\n   * Attempts to authenticate with the given credentials. If the authentication attempt fails, it's triggered like\n   * a auth revoked (the connection is closed).\n   */\n  tryAuth() {\n    if (this.connected_ && this.authToken_) {\n      const token = this.authToken_;\n      const authMethod = isValidFormat(token) ? 'auth' : 'gauth';\n      const requestData: { [k: string]: any } = { cred: token };\n      if (this.authOverride_ === null) {\n        requestData['noauth'] = true;\n      } else if (typeof this.authOverride_ === 'object') {\n        requestData['authvar'] = this.authOverride_;\n      }\n      this.sendRequest(authMethod, requestData, (res: { [k: string]: any }) => {\n        const status: string = res[/*status*/ 's'];\n        const data: string = res[/*data*/ 'd'] || 'error';\n\n        if (this.authToken_ === token) {\n          if (status === 'ok') {\n            this.invalidAuthTokenCount_ = 0;\n          } else {\n            // Triggers reconnect and force refresh for auth token\n            this.onAuthRevoked_(status, data);\n          }\n        }\n      });\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  unlisten(query: Query, tag: number | null) {\n    const pathString = query.path.toString();\n    const queryId = query.queryIdentifier();\n\n    this.log_('Unlisten called for ' + pathString + ' ' + queryId);\n\n    assert(\n      query.getQueryParams().isDefault() ||\n        !query.getQueryParams().loadsAllData(),\n      'unlisten() called for non-default but complete query'\n    );\n    const listen = this.removeListen_(pathString, queryId);\n    if (listen && this.connected_) {\n      this.sendUnlisten_(pathString, queryId, query.queryObject(), tag);\n    }\n  }\n\n  private sendUnlisten_(\n    pathString: string,\n    queryId: string,\n    queryObj: Object,\n    tag: number | null\n  ) {\n    this.log_('Unlisten on ' + pathString + ' for ' + queryId);\n\n    const req: { [k: string]: any } = { /*path*/ p: pathString };\n    const action = 'n';\n    // Only bother sending queryId if it's non-default.\n    if (tag) {\n      req['q'] = queryObj;\n      req['t'] = tag;\n    }\n\n    this.sendRequest(action, req);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  onDisconnectPut(\n    pathString: string,\n    data: any,\n    onComplete?: (a: string, b: string) => void\n  ) {\n    if (this.connected_) {\n      this.sendOnDisconnect_('o', pathString, data, onComplete);\n    } else {\n      this.onDisconnectRequestQueue_.push({\n        pathString,\n        action: 'o',\n        data,\n        onComplete\n      });\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  onDisconnectMerge(\n    pathString: string,\n    data: any,\n    onComplete?: (a: string, b: string) => void\n  ) {\n    if (this.connected_) {\n      this.sendOnDisconnect_('om', pathString, data, onComplete);\n    } else {\n      this.onDisconnectRequestQueue_.push({\n        pathString,\n        action: 'om',\n        data,\n        onComplete\n      });\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  onDisconnectCancel(\n    pathString: string,\n    onComplete?: (a: string, b: string) => void\n  ) {\n    if (this.connected_) {\n      this.sendOnDisconnect_('oc', pathString, null, onComplete);\n    } else {\n      this.onDisconnectRequestQueue_.push({\n        pathString,\n        action: 'oc',\n        data: null,\n        onComplete\n      });\n    }\n  }\n\n  private sendOnDisconnect_(\n    action: string,\n    pathString: string,\n    data: any,\n    onComplete: (a: string, b: string) => void\n  ) {\n    const request = { /*path*/ p: pathString, /*data*/ d: data };\n    this.log_('onDisconnect ' + action, request);\n    this.sendRequest(action, request, (response: { [k: string]: any }) => {\n      if (onComplete) {\n        setTimeout(function() {\n          onComplete(response[/*status*/ 's'], response[/* data */ 'd']);\n        }, Math.floor(0));\n      }\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  put(\n    pathString: string,\n    data: any,\n    onComplete?: (a: string, b: string) => void,\n    hash?: string\n  ) {\n    this.putInternal('p', pathString, data, onComplete, hash);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  merge(\n    pathString: string,\n    data: any,\n    onComplete: (a: string, b: string | null) => void,\n    hash?: string\n  ) {\n    this.putInternal('m', pathString, data, onComplete, hash);\n  }\n\n  putInternal(\n    action: string,\n    pathString: string,\n    data: any,\n    onComplete: (a: string, b: string | null) => void,\n    hash?: string\n  ) {\n    const request: { [k: string]: any } = {\n      /*path*/ p: pathString,\n      /*data*/ d: data\n    };\n\n    if (hash !== undefined) request[/*hash*/ 'h'] = hash;\n\n    // TODO: Only keep track of the most recent put for a given path?\n    this.outstandingPuts_.push({\n      action,\n      request,\n      onComplete\n    });\n\n    this.outstandingPutCount_++;\n    const index = this.outstandingPuts_.length - 1;\n\n    if (this.connected_) {\n      this.sendPut_(index);\n    } else {\n      this.log_('Buffering put: ' + pathString);\n    }\n  }\n\n  private sendPut_(index: number) {\n    const action = this.outstandingPuts_[index].action;\n    const request = this.outstandingPuts_[index].request;\n    const onComplete = this.outstandingPuts_[index].onComplete;\n    this.outstandingPuts_[index].queued = this.connected_;\n\n    this.sendRequest(action, request, (message: { [k: string]: any }) => {\n      this.log_(action + ' response', message);\n\n      delete this.outstandingPuts_[index];\n      this.outstandingPutCount_--;\n\n      // Clean up array occasionally.\n      if (this.outstandingPutCount_ === 0) {\n        this.outstandingPuts_ = [];\n      }\n\n      if (onComplete)\n        onComplete(message[/*status*/ 's'], message[/* data */ 'd']);\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  reportStats(stats: { [k: string]: any }) {\n    // If we're not connected, we just drop the stats.\n    if (this.connected_) {\n      const request = { /*counters*/ c: stats };\n      this.log_('reportStats', request);\n\n      this.sendRequest(/*stats*/ 's', request, result => {\n        const status = result[/*status*/ 's'];\n        if (status !== 'ok') {\n          const errorReason = result[/* data */ 'd'];\n          this.log_('reportStats', 'Error sending stats: ' + errorReason);\n        }\n      });\n    }\n  }\n\n  private onDataMessage_(message: { [k: string]: any }) {\n    if ('r' in message) {\n      // this is a response\n      this.log_('from server: ' + stringify(message));\n      const reqNum = message['r'];\n      const onResponse = this.requestCBHash_[reqNum];\n      if (onResponse) {\n        delete this.requestCBHash_[reqNum];\n        onResponse(message[/*body*/ 'b']);\n      }\n    } else if ('error' in message) {\n      throw 'A server-side error has occurred: ' + message['error'];\n    } else if ('a' in message) {\n      // a and b are action and body, respectively\n      this.onDataPush_(message['a'], message['b']);\n    }\n  }\n\n  private onDataPush_(action: string, body: { [k: string]: any }) {\n    this.log_('handleServerMessage', action, body);\n    if (action === 'd')\n      this.onDataUpdate_(\n        body[/*path*/ 'p'],\n        body[/*data*/ 'd'],\n        /*isMerge*/ false,\n        body['t']\n      );\n    else if (action === 'm')\n      this.onDataUpdate_(\n        body[/*path*/ 'p'],\n        body[/*data*/ 'd'],\n        /*isMerge=*/ true,\n        body['t']\n      );\n    else if (action === 'c')\n      this.onListenRevoked_(body[/*path*/ 'p'], body[/*query*/ 'q']);\n    else if (action === 'ac')\n      this.onAuthRevoked_(\n        body[/*status code*/ 's'],\n        body[/* explanation */ 'd']\n      );\n    else if (action === 'sd') this.onSecurityDebugPacket_(body);\n    else\n      error(\n        'Unrecognized action received from server: ' +\n          stringify(action) +\n          '\\nAre you using the latest client?'\n      );\n  }\n\n  private onReady_(timestamp: number, sessionId: string) {\n    this.log_('connection ready');\n    this.connected_ = true;\n    this.lastConnectionEstablishedTime_ = new Date().getTime();\n    this.handleTimestamp_(timestamp);\n    this.lastSessionId = sessionId;\n    if (this.firstConnection_) {\n      this.sendConnectStats_();\n    }\n    this.restoreState_();\n    this.firstConnection_ = false;\n    this.onConnectStatus_(true);\n  }\n\n  private scheduleConnect_(timeout: number) {\n    assert(\n      !this.realtime_,\n      \"Scheduling a connect when we're already connected/ing?\"\n    );\n\n    if (this.establishConnectionTimer_) {\n      clearTimeout(this.establishConnectionTimer_);\n    }\n\n    // NOTE: Even when timeout is 0, it's important to do a setTimeout to work around an infuriating \"Security Error\" in\n    // Firefox when trying to write to our long-polling iframe in some scenarios (e.g. Forge or our unit tests).\n\n    this.establishConnectionTimer_ = setTimeout(() => {\n      this.establishConnectionTimer_ = null;\n      this.establishConnection_();\n    }, Math.floor(timeout)) as any;\n  }\n\n  private onVisible_(visible: boolean) {\n    // NOTE: Tabbing away and back to a window will defeat our reconnect backoff, but I think that's fine.\n    if (\n      visible &&\n      !this.visible_ &&\n      this.reconnectDelay_ === this.maxReconnectDelay_\n    ) {\n      this.log_('Window became visible.  Reducing delay.');\n      this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n\n      if (!this.realtime_) {\n        this.scheduleConnect_(0);\n      }\n    }\n    this.visible_ = visible;\n  }\n\n  private onOnline_(online: boolean) {\n    if (online) {\n      this.log_('Browser went online.');\n      this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n      if (!this.realtime_) {\n        this.scheduleConnect_(0);\n      }\n    } else {\n      this.log_('Browser went offline.  Killing connection.');\n      if (this.realtime_) {\n        this.realtime_.close();\n      }\n    }\n  }\n\n  private onRealtimeDisconnect_() {\n    this.log_('data client disconnected');\n    this.connected_ = false;\n    this.realtime_ = null;\n\n    // Since we don't know if our sent transactions succeeded or not, we need to cancel them.\n    this.cancelSentTransactions_();\n\n    // Clear out the pending requests.\n    this.requestCBHash_ = {};\n\n    if (this.shouldReconnect_()) {\n      if (!this.visible_) {\n        this.log_(\"Window isn't visible.  Delaying reconnect.\");\n        this.reconnectDelay_ = this.maxReconnectDelay_;\n        this.lastConnectionAttemptTime_ = new Date().getTime();\n      } else if (this.lastConnectionEstablishedTime_) {\n        // If we've been connected long enough, reset reconnect delay to minimum.\n        const timeSinceLastConnectSucceeded =\n          new Date().getTime() - this.lastConnectionEstablishedTime_;\n        if (timeSinceLastConnectSucceeded > RECONNECT_DELAY_RESET_TIMEOUT)\n          this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n        this.lastConnectionEstablishedTime_ = null;\n      }\n\n      const timeSinceLastConnectAttempt =\n        new Date().getTime() - this.lastConnectionAttemptTime_;\n      let reconnectDelay = Math.max(\n        0,\n        this.reconnectDelay_ - timeSinceLastConnectAttempt\n      );\n      reconnectDelay = Math.random() * reconnectDelay;\n\n      this.log_('Trying to reconnect in ' + reconnectDelay + 'ms');\n      this.scheduleConnect_(reconnectDelay);\n\n      // Adjust reconnect delay for next time.\n      this.reconnectDelay_ = Math.min(\n        this.maxReconnectDelay_,\n        this.reconnectDelay_ * RECONNECT_DELAY_MULTIPLIER\n      );\n    }\n    this.onConnectStatus_(false);\n  }\n\n  private establishConnection_() {\n    if (this.shouldReconnect_()) {\n      this.log_('Making a connection attempt');\n      this.lastConnectionAttemptTime_ = new Date().getTime();\n      this.lastConnectionEstablishedTime_ = null;\n      const onDataMessage = this.onDataMessage_.bind(this);\n      const onReady = this.onReady_.bind(this);\n      const onDisconnect = this.onRealtimeDisconnect_.bind(this);\n      const connId = this.id + ':' + PersistentConnection.nextConnectionId_++;\n      const self = this;\n      const lastSessionId = this.lastSessionId;\n      let canceled = false;\n      let connection: Connection | null = null;\n      const closeFn = function() {\n        if (connection) {\n          connection.close();\n        } else {\n          canceled = true;\n          onDisconnect();\n        }\n      };\n      const sendRequestFn = function(msg: Object) {\n        assert(\n          connection,\n          \"sendRequest call when we're not connected not allowed.\"\n        );\n        connection.sendRequest(msg);\n      };\n\n      this.realtime_ = {\n        close: closeFn,\n        sendRequest: sendRequestFn\n      };\n\n      const forceRefresh = this.forceTokenRefresh_;\n      this.forceTokenRefresh_ = false;\n\n      // First fetch auth token, and establish connection after fetching the token was successful\n      this.authTokenProvider_\n        .getToken(forceRefresh)\n        .then(function(result) {\n          if (!canceled) {\n            log('getToken() completed. Creating connection.');\n            self.authToken_ = result && result.accessToken;\n            connection = new Connection(\n              connId,\n              self.repoInfo_,\n              onDataMessage,\n              onReady,\n              onDisconnect,\n              /* onKill= */ function(reason) {\n                warn(reason + ' (' + self.repoInfo_.toString() + ')');\n                self.interrupt(SERVER_KILL_INTERRUPT_REASON);\n              },\n              lastSessionId\n            );\n          } else {\n            log('getToken() completed but was canceled');\n          }\n        })\n        .then(null, function(error) {\n          self.log_('Failed to get token: ' + error);\n          if (!canceled) {\n            if (CONSTANTS.NODE_ADMIN) {\n              // This may be a critical error for the Admin Node.js SDK, so log a warning.\n              // But getToken() may also just have temporarily failed, so we still want to\n              // continue retrying.\n              warn(error);\n            }\n            closeFn();\n          }\n        });\n    }\n  }\n\n  interrupt(reason: string) {\n    log('Interrupting connection for reason: ' + reason);\n    this.interruptReasons_[reason] = true;\n    if (this.realtime_) {\n      this.realtime_.close();\n    } else {\n      if (this.establishConnectionTimer_) {\n        clearTimeout(this.establishConnectionTimer_);\n        this.establishConnectionTimer_ = null;\n      }\n      if (this.connected_) {\n        this.onRealtimeDisconnect_();\n      }\n    }\n  }\n\n  resume(reason: string) {\n    log('Resuming connection for reason: ' + reason);\n    delete this.interruptReasons_[reason];\n    if (isEmpty(this.interruptReasons_)) {\n      this.reconnectDelay_ = RECONNECT_MIN_DELAY;\n      if (!this.realtime_) {\n        this.scheduleConnect_(0);\n      }\n    }\n  }\n\n  private handleTimestamp_(timestamp: number) {\n    const delta = timestamp - new Date().getTime();\n    this.onServerInfoUpdate_({ serverTimeOffset: delta });\n  }\n\n  private cancelSentTransactions_() {\n    for (let i = 0; i < this.outstandingPuts_.length; i++) {\n      const put = this.outstandingPuts_[i];\n      if (put && /*hash*/ 'h' in put.request && put.queued) {\n        if (put.onComplete) put.onComplete('disconnect');\n\n        delete this.outstandingPuts_[i];\n        this.outstandingPutCount_--;\n      }\n    }\n\n    // Clean up array occasionally.\n    if (this.outstandingPutCount_ === 0) this.outstandingPuts_ = [];\n  }\n\n  private onListenRevoked_(pathString: string, query?: any[]) {\n    // Remove the listen and manufacture a \"permission_denied\" error for the failed listen.\n    let queryId;\n    if (!query) {\n      queryId = 'default';\n    } else {\n      queryId = query.map(q => ObjectToUniqueKey(q)).join('$');\n    }\n    const listen = this.removeListen_(pathString, queryId);\n    if (listen && listen.onComplete) listen.onComplete('permission_denied');\n  }\n\n  private removeListen_(pathString: string, queryId: string): ListenSpec {\n    const normalizedPathString = new Path(pathString).toString(); // normalize path.\n    let listen;\n    if (this.listens.has(normalizedPathString)) {\n      const map = this.listens.get(normalizedPathString)!;\n      listen = map.get(queryId);\n      map.delete(queryId);\n      if (map.size === 0) {\n        this.listens.delete(normalizedPathString);\n      }\n    } else {\n      // all listens for this path has already been removed\n      listen = undefined;\n    }\n    return listen;\n  }\n\n  private onAuthRevoked_(statusCode: string, explanation: string) {\n    log('Auth token revoked: ' + statusCode + '/' + explanation);\n    this.authToken_ = null;\n    this.forceTokenRefresh_ = true;\n    this.realtime_.close();\n    if (statusCode === 'invalid_token' || statusCode === 'permission_denied') {\n      // We'll wait a couple times before logging the warning / increasing the\n      // retry period since oauth tokens will report as \"invalid\" if they're\n      // just expired. Plus there may be transient issues that resolve themselves.\n      this.invalidAuthTokenCount_++;\n      if (this.invalidAuthTokenCount_ >= INVALID_AUTH_TOKEN_THRESHOLD) {\n        // Set a long reconnect delay because recovery is unlikely\n        this.reconnectDelay_ = RECONNECT_MAX_DELAY_FOR_ADMINS;\n\n        // Notify the auth token provider that the token is invalid, which will log\n        // a warning\n        this.authTokenProvider_.notifyForInvalidToken();\n      }\n    }\n  }\n\n  private onSecurityDebugPacket_(body: { [k: string]: any }) {\n    if (this.securityDebugCallback_) {\n      this.securityDebugCallback_(body);\n    } else {\n      if ('msg' in body) {\n        console.log('FIREBASE: ' + body['msg'].replace('\\n', '\\nFIREBASE: '));\n      }\n    }\n  }\n\n  private restoreState_() {\n    //Re-authenticate ourselves if we have a credential stored.\n    this.tryAuth();\n\n    // Puts depend on having received the corresponding data update from the server before they complete, so we must\n    // make sure to send listens before puts.\n    for (const queries of this.listens.values()) {\n      for (const listenSpec of queries.values()) {\n        this.sendListen_(listenSpec);\n      }\n    }\n\n    for (let i = 0; i < this.outstandingPuts_.length; i++) {\n      if (this.outstandingPuts_[i]) this.sendPut_(i);\n    }\n\n    while (this.onDisconnectRequestQueue_.length) {\n      const request = this.onDisconnectRequestQueue_.shift();\n      this.sendOnDisconnect_(\n        request.action,\n        request.pathString,\n        request.data,\n        request.onComplete\n      );\n    }\n  }\n\n  /**\n   * Sends client stats for first connection\n   */\n  private sendConnectStats_() {\n    const stats: { [k: string]: number } = {};\n\n    let clientName = 'js';\n    if (CONSTANTS.NODE_ADMIN) {\n      clientName = 'admin_node';\n    } else if (CONSTANTS.NODE_CLIENT) {\n      clientName = 'node';\n    }\n\n    stats['sdk.' + clientName + '.' + SDK_VERSION.replace(/\\./g, '-')] = 1;\n\n    if (isMobileCordova()) {\n      stats['framework.cordova'] = 1;\n    } else if (isReactNative()) {\n      stats['framework.reactnative'] = 1;\n    }\n    this.reportStats(stats);\n  }\n\n  private shouldReconnect_(): boolean {\n    const online = OnlineMonitor.getInstance().currentlyOnline();\n    return isEmpty(this.interruptReasons_) && online;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { logWrapper, warn } from './util/util';\nimport { jsonEval } from '@firebase/util';\nimport { safeGet } from '@firebase/util';\nimport { querystring } from '@firebase/util';\nimport { ServerActions } from './ServerActions';\nimport { RepoInfo } from './RepoInfo';\nimport { AuthTokenProvider } from './AuthTokenProvider';\nimport { Query } from '../api/Query';\n\n/**\n * An implementation of ServerActions that communicates with the server via REST requests.\n * This is mostly useful for compatibility with crawlers, where we don't want to spin up a full\n * persistent connection (using WebSockets or long-polling)\n */\nexport class ReadonlyRestClient extends ServerActions {\n  reportStats(stats: { [k: string]: any }): void {\n    throw new Error('Method not implemented.');\n  }\n\n  /** @private {function(...[*])} */\n  private log_: (...args: any[]) => void = logWrapper('p:rest:');\n\n  /**\n   * We don't actually need to track listens, except to prevent us calling an onComplete for a listen\n   * that's been removed. :-/\n   *\n   * @private {!Object.<string, !Object>}\n   */\n  private listens_: { [k: string]: Object } = {};\n\n  /**\n   * @param {!Query} query\n   * @param {?number=} tag\n   * @return {string}\n   * @private\n   */\n  static getListenId_(query: Query, tag?: number | null): string {\n    if (tag !== undefined) {\n      return 'tag$' + tag;\n    } else {\n      assert(\n        query.getQueryParams().isDefault(),\n        \"should have a tag if it's not a default query.\"\n      );\n      return query.path.toString();\n    }\n  }\n\n  /**\n   * @param {!RepoInfo} repoInfo_ Data about the namespace we are connecting to\n   * @param {function(string, *, boolean, ?number)} onDataUpdate_ A callback for new data from the server\n   * @param {AuthTokenProvider} authTokenProvider_\n   * @implements {ServerActions}\n   */\n  constructor(\n    private repoInfo_: RepoInfo,\n    private onDataUpdate_: (\n      a: string,\n      b: any,\n      c: boolean,\n      d: number | null\n    ) => void,\n    private authTokenProvider_: AuthTokenProvider\n  ) {\n    super();\n  }\n\n  /** @inheritDoc */\n  listen(\n    query: Query,\n    currentHashFn: () => string,\n    tag: number | null,\n    onComplete: (a: string, b: any) => void\n  ) {\n    const pathString = query.path.toString();\n    this.log_(\n      'Listen called for ' + pathString + ' ' + query.queryIdentifier()\n    );\n\n    // Mark this listener so we can tell if it's removed.\n    const listenId = ReadonlyRestClient.getListenId_(query, tag);\n    const thisListen = {};\n    this.listens_[listenId] = thisListen;\n\n    const queryStringParameters = query\n      .getQueryParams()\n      .toRestQueryStringParameters();\n\n    this.restRequest_(\n      pathString + '.json',\n      queryStringParameters,\n      (error, result) => {\n        let data = result;\n\n        if (error === 404) {\n          data = null;\n          error = null;\n        }\n\n        if (error === null) {\n          this.onDataUpdate_(pathString, data, /*isMerge=*/ false, tag);\n        }\n\n        if (safeGet(this.listens_, listenId) === thisListen) {\n          let status;\n          if (!error) {\n            status = 'ok';\n          } else if (error == 401) {\n            status = 'permission_denied';\n          } else {\n            status = 'rest_error:' + error;\n          }\n\n          onComplete(status, null);\n        }\n      }\n    );\n  }\n\n  /** @inheritDoc */\n  unlisten(query: Query, tag: number | null) {\n    const listenId = ReadonlyRestClient.getListenId_(query, tag);\n    delete this.listens_[listenId];\n  }\n\n  /** @inheritDoc */\n  refreshAuthToken(token: string) {\n    // no-op since we just always call getToken.\n  }\n\n  /**\n   * Performs a REST request to the given path, with the provided query string parameters,\n   * and any auth credentials we have.\n   *\n   * @param {!string} pathString\n   * @param {!Object.<string, *>} queryStringParameters\n   * @param {?function(?number, *=)} callback\n   * @private\n   */\n  private restRequest_(\n    pathString: string,\n    queryStringParameters: { [k: string]: any } = {},\n    callback: ((a: number | null, b?: any) => void) | null\n  ) {\n    queryStringParameters['format'] = 'export';\n\n    this.authTokenProvider_\n      .getToken(/*forceRefresh=*/ false)\n      .then(authTokenData => {\n        const authToken = authTokenData && authTokenData.accessToken;\n        if (authToken) {\n          queryStringParameters['auth'] = authToken;\n        }\n\n        const url =\n          (this.repoInfo_.secure ? 'https://' : 'http://') +\n          this.repoInfo_.host +\n          pathString +\n          '?' +\n          'ns=' +\n          this.repoInfo_.namespace +\n          querystring(queryStringParameters);\n\n        this.log_('Sending REST request for ' + url);\n        const xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = () => {\n          if (callback && xhr.readyState === 4) {\n            this.log_(\n              'REST Response for ' + url + ' received. status:',\n              xhr.status,\n              'response:',\n              xhr.responseText\n            );\n            let res = null;\n            if (xhr.status >= 200 && xhr.status < 300) {\n              try {\n                res = jsonEval(xhr.responseText);\n              } catch (e) {\n                warn(\n                  'Failed to parse JSON response for ' +\n                    url +\n                    ': ' +\n                    xhr.responseText\n                );\n              }\n              callback(null, res);\n            } else {\n              // 401 and 404 are expected.\n              if (xhr.status !== 401 && xhr.status !== 404) {\n                warn(\n                  'Got unsuccessful REST response for ' +\n                    url +\n                    ' Status: ' +\n                    xhr.status\n                );\n              }\n              callback(xhr.status);\n            }\n            callback = null;\n          }\n        };\n\n        xhr.open('GET', url, /*asynchronous=*/ true);\n        xhr.send();\n      });\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  generateWithValues,\n  resolveDeferredValueSnapshot,\n  resolveDeferredValueTree\n} from './util/ServerValues';\nimport { nodeFromJSON } from './snap/nodeFromJSON';\nimport { Path } from './util/Path';\nimport { SparseSnapshotTree } from './SparseSnapshotTree';\nimport { SyncTree } from './SyncTree';\nimport { SnapshotHolder } from './SnapshotHolder';\nimport { stringify } from '@firebase/util';\nimport { beingCrawled, each, exceptionGuard, warn, log } from './util/util';\nimport { map, isEmpty } from '@firebase/util';\nimport { AuthTokenProvider } from './AuthTokenProvider';\nimport { StatsManager } from './stats/StatsManager';\nimport { StatsReporter } from './stats/StatsReporter';\nimport { StatsListener } from './stats/StatsListener';\nimport { EventQueue } from './view/EventQueue';\nimport { PersistentConnection } from './PersistentConnection';\nimport { ReadonlyRestClient } from './ReadonlyRestClient';\nimport { FirebaseApp } from '@firebase/app-types';\nimport { RepoInfo } from './RepoInfo';\nimport { Database } from '../api/Database';\nimport { ServerActions } from './ServerActions';\nimport { Query } from '../api/Query';\nimport { EventRegistration } from './view/EventRegistration';\nimport { StatsCollection } from './stats/StatsCollection';\nimport { Event } from './view/Event';\nimport { Node } from './snap/Node';\nimport { FirebaseAuthInternalName } from '@firebase/auth-interop-types';\nimport { Provider } from '@firebase/component';\n\nconst INTERRUPT_REASON = 'repo_interrupt';\n\n/**\n * A connection to a single data repository.\n */\nexport class Repo {\n  dataUpdateCount = 0;\n  private infoSyncTree_: SyncTree;\n  private serverSyncTree_: SyncTree;\n\n  private stats_: StatsCollection;\n  private statsListener_: StatsListener | null = null;\n  private eventQueue_ = new EventQueue();\n  private nextWriteId_ = 1;\n  private server_: ServerActions;\n  private statsReporter_: StatsReporter;\n  private transactions_init_: () => void;\n  private infoData_: SnapshotHolder;\n  private abortTransactions_: (path: Path) => Path;\n  private rerunTransactions_: (changedPath: Path) => Path;\n  private interceptServerDataCallback_:\n    | ((a: string, b: any) => void)\n    | null = null;\n  private __database: Database;\n\n  /** A list of data pieces and paths to be set when this client disconnects. */\n  private onDisconnect_ = new SparseSnapshotTree();\n\n  // TODO: This should be @private but it's used by test_access.js and internal.js\n  persistentConnection_: PersistentConnection | null = null;\n\n  constructor(\n    public repoInfo_: RepoInfo,\n    forceRestClient: boolean,\n    public app: FirebaseApp,\n    authProvider: Provider<FirebaseAuthInternalName>\n  ) {\n    const authTokenProvider = new AuthTokenProvider(app, authProvider);\n\n    this.stats_ = StatsManager.getCollection(repoInfo_);\n\n    if (forceRestClient || beingCrawled()) {\n      this.server_ = new ReadonlyRestClient(\n        this.repoInfo_,\n        this.onDataUpdate_.bind(this),\n        authTokenProvider\n      );\n\n      // Minor hack: Fire onConnect immediately, since there's no actual connection.\n      setTimeout(this.onConnectStatus_.bind(this, true), 0);\n    } else {\n      const authOverride = app.options['databaseAuthVariableOverride'];\n      // Validate authOverride\n      if (typeof authOverride !== 'undefined' && authOverride !== null) {\n        if (typeof authOverride !== 'object') {\n          throw new Error(\n            'Only objects are supported for option databaseAuthVariableOverride'\n          );\n        }\n        try {\n          stringify(authOverride);\n        } catch (e) {\n          throw new Error('Invalid authOverride provided: ' + e);\n        }\n      }\n\n      this.persistentConnection_ = new PersistentConnection(\n        this.repoInfo_,\n        this.onDataUpdate_.bind(this),\n        this.onConnectStatus_.bind(this),\n        this.onServerInfoUpdate_.bind(this),\n        authTokenProvider,\n        authOverride\n      );\n\n      this.server_ = this.persistentConnection_;\n    }\n\n    authTokenProvider.addTokenChangeListener(token => {\n      this.server_.refreshAuthToken(token);\n    });\n\n    // In the case of multiple Repos for the same repoInfo (i.e. there are multiple Firebase.Contexts being used),\n    // we only want to create one StatsReporter.  As such, we'll report stats over the first Repo created.\n    this.statsReporter_ = StatsManager.getOrCreateReporter(\n      repoInfo_,\n      () => new StatsReporter(this.stats_, this.server_)\n    );\n\n    this.transactions_init_();\n\n    // Used for .info.\n    this.infoData_ = new SnapshotHolder();\n    this.infoSyncTree_ = new SyncTree({\n      startListening: (query, tag, currentHashFn, onComplete) => {\n        let infoEvents: Event[] = [];\n        const node = this.infoData_.getNode(query.path);\n        // This is possibly a hack, but we have different semantics for .info endpoints. We don't raise null events\n        // on initial data...\n        if (!node.isEmpty()) {\n          infoEvents = this.infoSyncTree_.applyServerOverwrite(\n            query.path,\n            node\n          );\n          setTimeout(() => {\n            onComplete('ok');\n          }, 0);\n        }\n        return infoEvents;\n      },\n      stopListening: () => {}\n    });\n    this.updateInfo_('connected', false);\n\n    this.serverSyncTree_ = new SyncTree({\n      startListening: (query, tag, currentHashFn, onComplete) => {\n        this.server_.listen(query, currentHashFn, tag, (status, data) => {\n          const events = onComplete(status, data);\n          this.eventQueue_.raiseEventsForChangedPath(query.path, events);\n        });\n        // No synchronous events for network-backed sync trees\n        return [];\n      },\n      stopListening: (query, tag) => {\n        this.server_.unlisten(query, tag);\n      }\n    });\n  }\n\n  /**\n   * @return The URL corresponding to the root of this Firebase.\n   */\n  toString(): string {\n    return (\n      (this.repoInfo_.secure ? 'https://' : 'http://') + this.repoInfo_.host\n    );\n  }\n\n  /**\n   * @return The namespace represented by the repo.\n   */\n  name(): string {\n    return this.repoInfo_.namespace;\n  }\n\n  /**\n   * @return The time in milliseconds, taking the server offset into account if we have one.\n   */\n  serverTime(): number {\n    const offsetNode = this.infoData_.getNode(\n      new Path('.info/serverTimeOffset')\n    );\n    const offset = (offsetNode.val() as number) || 0;\n    return new Date().getTime() + offset;\n  }\n\n  /**\n   * Generate ServerValues using some variables from the repo object.\n   */\n  generateServerValues(): Object {\n    return generateWithValues({\n      timestamp: this.serverTime()\n    });\n  }\n\n  /**\n   * Called by realtime when we get new messages from the server.\n   */\n  private onDataUpdate_(\n    pathString: string,\n    data: any,\n    isMerge: boolean,\n    tag: number | null\n  ) {\n    // For testing.\n    this.dataUpdateCount++;\n    const path = new Path(pathString);\n    data = this.interceptServerDataCallback_\n      ? this.interceptServerDataCallback_(pathString, data)\n      : data;\n    let events = [];\n    if (tag) {\n      if (isMerge) {\n        const taggedChildren = map(data as { [k: string]: any }, (raw: any) =>\n          nodeFromJSON(raw)\n        );\n        events = this.serverSyncTree_.applyTaggedQueryMerge(\n          path,\n          taggedChildren,\n          tag\n        );\n      } else {\n        const taggedSnap = nodeFromJSON(data);\n        events = this.serverSyncTree_.applyTaggedQueryOverwrite(\n          path,\n          taggedSnap,\n          tag\n        );\n      }\n    } else if (isMerge) {\n      const changedChildren = map(data as { [k: string]: any }, (raw: any) =>\n        nodeFromJSON(raw)\n      );\n      events = this.serverSyncTree_.applyServerMerge(path, changedChildren);\n    } else {\n      const snap = nodeFromJSON(data);\n      events = this.serverSyncTree_.applyServerOverwrite(path, snap);\n    }\n    let affectedPath = path;\n    if (events.length > 0) {\n      // Since we have a listener outstanding for each transaction, receiving any events\n      // is a proxy for some change having occurred.\n      affectedPath = this.rerunTransactions_(path);\n    }\n    this.eventQueue_.raiseEventsForChangedPath(affectedPath, events);\n  }\n\n  // TODO: This should be @private but it's used by test_access.js and internal.js\n  interceptServerData_(callback: ((a: string, b: any) => any) | null) {\n    this.interceptServerDataCallback_ = callback;\n  }\n\n  private onConnectStatus_(connectStatus: boolean) {\n    this.updateInfo_('connected', connectStatus);\n    if (connectStatus === false) {\n      this.runOnDisconnectEvents_();\n    }\n  }\n\n  private onServerInfoUpdate_(updates: Object) {\n    each(updates, (key: string, value: any) => {\n      this.updateInfo_(key, value);\n    });\n  }\n\n  private updateInfo_(pathString: string, value: any) {\n    const path = new Path('/.info/' + pathString);\n    const newNode = nodeFromJSON(value);\n    this.infoData_.updateSnapshot(path, newNode);\n    const events = this.infoSyncTree_.applyServerOverwrite(path, newNode);\n    this.eventQueue_.raiseEventsForChangedPath(path, events);\n  }\n\n  private getNextWriteId_(): number {\n    return this.nextWriteId_++;\n  }\n\n  setWithPriority(\n    path: Path,\n    newVal: any,\n    newPriority: number | string | null,\n    onComplete: ((status: Error | null, errorReason?: string) => void) | null\n  ) {\n    this.log_('set', {\n      path: path.toString(),\n      value: newVal,\n      priority: newPriority\n    });\n\n    // TODO: Optimize this behavior to either (a) store flag to skip resolving where possible and / or\n    // (b) store unresolved paths on JSON parse\n    const serverValues = this.generateServerValues();\n    const newNodeUnresolved = nodeFromJSON(newVal, newPriority);\n    const existing = this.serverSyncTree_.calcCompleteEventCache(path);\n    const newNode = resolveDeferredValueSnapshot(\n      newNodeUnresolved,\n      existing,\n      serverValues\n    );\n\n    const writeId = this.getNextWriteId_();\n    const events = this.serverSyncTree_.applyUserOverwrite(\n      path,\n      newNode,\n      writeId,\n      true\n    );\n    this.eventQueue_.queueEvents(events);\n    this.server_.put(\n      path.toString(),\n      newNodeUnresolved.val(/*export=*/ true),\n      (status, errorReason) => {\n        const success = status === 'ok';\n        if (!success) {\n          warn('set at ' + path + ' failed: ' + status);\n        }\n\n        const clearEvents = this.serverSyncTree_.ackUserWrite(\n          writeId,\n          !success\n        );\n        this.eventQueue_.raiseEventsForChangedPath(path, clearEvents);\n        this.callOnCompleteCallback(onComplete, status, errorReason);\n      }\n    );\n    const affectedPath = this.abortTransactions_(path);\n    this.rerunTransactions_(affectedPath);\n    // We queued the events above, so just flush the queue here\n    this.eventQueue_.raiseEventsForChangedPath(affectedPath, []);\n  }\n\n  update(\n    path: Path,\n    childrenToMerge: { [k: string]: any },\n    onComplete: ((status: Error | null, errorReason?: string) => void) | null\n  ) {\n    this.log_('update', { path: path.toString(), value: childrenToMerge });\n\n    // Start with our existing data and merge each child into it.\n    let empty = true;\n    const serverValues = this.generateServerValues();\n    const changedChildren: { [k: string]: Node } = {};\n    each(childrenToMerge, (changedKey: string, changedValue: any) => {\n      empty = false;\n      const newNodeUnresolved = nodeFromJSON(changedValue);\n      changedChildren[changedKey] = resolveDeferredValueSnapshot(\n        newNodeUnresolved,\n        this.serverSyncTree_.calcCompleteEventCache(path),\n        serverValues\n      );\n    });\n\n    if (!empty) {\n      const writeId = this.getNextWriteId_();\n      const events = this.serverSyncTree_.applyUserMerge(\n        path,\n        changedChildren,\n        writeId\n      );\n      this.eventQueue_.queueEvents(events);\n      this.server_.merge(\n        path.toString(),\n        childrenToMerge,\n        (status, errorReason) => {\n          const success = status === 'ok';\n          if (!success) {\n            warn('update at ' + path + ' failed: ' + status);\n          }\n\n          const clearEvents = this.serverSyncTree_.ackUserWrite(\n            writeId,\n            !success\n          );\n          const affectedPath =\n            clearEvents.length > 0 ? this.rerunTransactions_(path) : path;\n          this.eventQueue_.raiseEventsForChangedPath(affectedPath, clearEvents);\n          this.callOnCompleteCallback(onComplete, status, errorReason);\n        }\n      );\n\n      each(childrenToMerge, (changedPath: string) => {\n        const affectedPath = this.abortTransactions_(path.child(changedPath));\n        this.rerunTransactions_(affectedPath);\n      });\n\n      // We queued the events above, so just flush the queue here\n      this.eventQueue_.raiseEventsForChangedPath(path, []);\n    } else {\n      log(\"update() called with empty data.  Don't do anything.\");\n      this.callOnCompleteCallback(onComplete, 'ok');\n    }\n  }\n\n  /**\n   * Applies all of the changes stored up in the onDisconnect_ tree.\n   */\n  private runOnDisconnectEvents_() {\n    this.log_('onDisconnectEvents');\n\n    const serverValues = this.generateServerValues();\n    const resolvedOnDisconnectTree = resolveDeferredValueTree(\n      this.onDisconnect_,\n      this.serverSyncTree_,\n      serverValues\n    );\n    let events: Event[] = [];\n\n    resolvedOnDisconnectTree.forEachTree(Path.Empty, (path, snap) => {\n      events = events.concat(\n        this.serverSyncTree_.applyServerOverwrite(path, snap)\n      );\n      const affectedPath = this.abortTransactions_(path);\n      this.rerunTransactions_(affectedPath);\n    });\n\n    this.onDisconnect_ = new SparseSnapshotTree();\n    this.eventQueue_.raiseEventsForChangedPath(Path.Empty, events);\n  }\n\n  onDisconnectCancel(\n    path: Path,\n    onComplete: ((status: Error | null, errorReason?: string) => void) | null\n  ) {\n    this.server_.onDisconnectCancel(path.toString(), (status, errorReason) => {\n      if (status === 'ok') {\n        this.onDisconnect_.forget(path);\n      }\n      this.callOnCompleteCallback(onComplete, status, errorReason);\n    });\n  }\n\n  onDisconnectSet(\n    path: Path,\n    value: any,\n    onComplete: ((status: Error | null, errorReason?: string) => void) | null\n  ) {\n    const newNode = nodeFromJSON(value);\n    this.server_.onDisconnectPut(\n      path.toString(),\n      newNode.val(/*export=*/ true),\n      (status, errorReason) => {\n        if (status === 'ok') {\n          this.onDisconnect_.remember(path, newNode);\n        }\n        this.callOnCompleteCallback(onComplete, status, errorReason);\n      }\n    );\n  }\n\n  onDisconnectSetWithPriority(\n    path: Path,\n    value: any,\n    priority: any,\n    onComplete: ((status: Error | null, errorReason?: string) => void) | null\n  ) {\n    const newNode = nodeFromJSON(value, priority);\n    this.server_.onDisconnectPut(\n      path.toString(),\n      newNode.val(/*export=*/ true),\n      (status, errorReason) => {\n        if (status === 'ok') {\n          this.onDisconnect_.remember(path, newNode);\n        }\n        this.callOnCompleteCallback(onComplete, status, errorReason);\n      }\n    );\n  }\n\n  onDisconnectUpdate(\n    path: Path,\n    childrenToMerge: { [k: string]: any },\n    onComplete: ((status: Error | null, errorReason?: string) => void) | null\n  ) {\n    if (isEmpty(childrenToMerge)) {\n      log(\n        \"onDisconnect().update() called with empty data.  Don't do anything.\"\n      );\n      this.callOnCompleteCallback(onComplete, 'ok');\n      return;\n    }\n\n    this.server_.onDisconnectMerge(\n      path.toString(),\n      childrenToMerge,\n      (status, errorReason) => {\n        if (status === 'ok') {\n          each(childrenToMerge, (childName: string, childNode: any) => {\n            const newChildNode = nodeFromJSON(childNode);\n            this.onDisconnect_.remember(path.child(childName), newChildNode);\n          });\n        }\n        this.callOnCompleteCallback(onComplete, status, errorReason);\n      }\n    );\n  }\n\n  addEventCallbackForQuery(query: Query, eventRegistration: EventRegistration) {\n    let events;\n    if (query.path.getFront() === '.info') {\n      events = this.infoSyncTree_.addEventRegistration(\n        query,\n        eventRegistration\n      );\n    } else {\n      events = this.serverSyncTree_.addEventRegistration(\n        query,\n        eventRegistration\n      );\n    }\n    this.eventQueue_.raiseEventsAtPath(query.path, events);\n  }\n\n  removeEventCallbackForQuery(\n    query: Query,\n    eventRegistration: EventRegistration\n  ) {\n    // These are guaranteed not to raise events, since we're not passing in a cancelError. However, we can future-proof\n    // a little bit by handling the return values anyways.\n    let events;\n    if (query.path.getFront() === '.info') {\n      events = this.infoSyncTree_.removeEventRegistration(\n        query,\n        eventRegistration\n      );\n    } else {\n      events = this.serverSyncTree_.removeEventRegistration(\n        query,\n        eventRegistration\n      );\n    }\n    this.eventQueue_.raiseEventsAtPath(query.path, events);\n  }\n\n  interrupt() {\n    if (this.persistentConnection_) {\n      this.persistentConnection_.interrupt(INTERRUPT_REASON);\n    }\n  }\n\n  resume() {\n    if (this.persistentConnection_) {\n      this.persistentConnection_.resume(INTERRUPT_REASON);\n    }\n  }\n\n  stats(showDelta: boolean = false) {\n    if (typeof console === 'undefined') return;\n\n    let stats: { [k: string]: any };\n    if (showDelta) {\n      if (!this.statsListener_)\n        this.statsListener_ = new StatsListener(this.stats_);\n      stats = this.statsListener_.get();\n    } else {\n      stats = this.stats_.get();\n    }\n\n    const longestName = Object.keys(stats).reduce(\n      (previousValue, currentValue) =>\n        Math.max(currentValue.length, previousValue),\n      0\n    );\n\n    each(stats, (stat: string, value: any) => {\n      let paddedStat = stat;\n      // pad stat names to be the same length (plus 2 extra spaces).\n      for (let i = stat.length; i < longestName + 2; i++) {\n        paddedStat += ' ';\n      }\n      console.log(paddedStat + value);\n    });\n  }\n\n  statsIncrementCounter(metric: string) {\n    this.stats_.incrementCounter(metric);\n    this.statsReporter_.includeStat(metric);\n  }\n\n  private log_(...var_args: any[]) {\n    let prefix = '';\n    if (this.persistentConnection_) {\n      prefix = this.persistentConnection_.id + ':';\n    }\n    log(prefix, ...var_args);\n  }\n\n  callOnCompleteCallback(\n    callback: ((status: Error | null, errorReason?: string) => void) | null,\n    status: string,\n    errorReason?: string | null\n  ) {\n    if (callback) {\n      exceptionGuard(function() {\n        if (status == 'ok') {\n          callback(null);\n        } else {\n          const code = (status || 'error').toUpperCase();\n          let message = code;\n          if (errorReason) message += ': ' + errorReason;\n\n          const error = new Error(message);\n          (error as any).code = code;\n          callback(error);\n        }\n      });\n    }\n  }\n\n  get database(): Database {\n    return this.__database || (this.__database = new Database(this));\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IndexedFilter } from './IndexedFilter';\nimport { PRIORITY_INDEX } from '../../snap/indexes/PriorityIndex';\nimport { NamedNode, Node } from '../../../core/snap/Node';\nimport { ChildrenNode } from '../../snap/ChildrenNode';\nimport { NodeFilter } from './NodeFilter';\nimport { QueryParams } from '../QueryParams';\nimport { Index } from '../../snap/indexes/Index';\nimport { Path } from '../../util/Path';\nimport { CompleteChildSource } from '../CompleteChildSource';\nimport { ChildChangeAccumulator } from '../ChildChangeAccumulator';\n\n/**\n * Filters nodes by range and uses an IndexFilter to track any changes after filtering the node\n *\n * @constructor\n * @implements {NodeFilter}\n */\nexport class RangedFilter implements NodeFilter {\n  /**\n   * @type {!IndexedFilter}\n   * @const\n   * @private\n   */\n  private indexedFilter_: IndexedFilter;\n\n  /**\n   * @const\n   * @type {!Index}\n   * @private\n   */\n  private index_: Index;\n\n  /**\n   * @const\n   * @type {!NamedNode}\n   * @private\n   */\n  private startPost_: NamedNode;\n\n  /**\n   * @const\n   * @type {!NamedNode}\n   * @private\n   */\n  private endPost_: NamedNode;\n\n  /**\n   * @param {!QueryParams} params\n   */\n  constructor(params: QueryParams) {\n    this.indexedFilter_ = new IndexedFilter(params.getIndex());\n    this.index_ = params.getIndex();\n    this.startPost_ = RangedFilter.getStartPost_(params);\n    this.endPost_ = RangedFilter.getEndPost_(params);\n  }\n\n  /**\n   * @return {!NamedNode}\n   */\n  getStartPost(): NamedNode {\n    return this.startPost_;\n  }\n\n  /**\n   * @return {!NamedNode}\n   */\n  getEndPost(): NamedNode {\n    return this.endPost_;\n  }\n\n  /**\n   * @param {!NamedNode} node\n   * @return {boolean}\n   */\n  matches(node: NamedNode): boolean {\n    return (\n      this.index_.compare(this.getStartPost(), node) <= 0 &&\n      this.index_.compare(node, this.getEndPost()) <= 0\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updateChild(\n    snap: Node,\n    key: string,\n    newChild: Node,\n    affectedPath: Path,\n    source: CompleteChildSource,\n    optChangeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    if (!this.matches(new NamedNode(key, newChild))) {\n      newChild = ChildrenNode.EMPTY_NODE;\n    }\n    return this.indexedFilter_.updateChild(\n      snap,\n      key,\n      newChild,\n      affectedPath,\n      source,\n      optChangeAccumulator\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updateFullNode(\n    oldSnap: Node,\n    newSnap: Node,\n    optChangeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    if (newSnap.isLeafNode()) {\n      // Make sure we have a children node with the correct index, not a leaf node;\n      newSnap = ChildrenNode.EMPTY_NODE;\n    }\n    let filtered = newSnap.withIndex(this.index_);\n    // Don't support priorities on queries\n    filtered = filtered.updatePriority(ChildrenNode.EMPTY_NODE);\n    const self = this;\n    newSnap.forEachChild(PRIORITY_INDEX, function(key, childNode) {\n      if (!self.matches(new NamedNode(key, childNode))) {\n        filtered = filtered.updateImmediateChild(key, ChildrenNode.EMPTY_NODE);\n      }\n    });\n    return this.indexedFilter_.updateFullNode(\n      oldSnap,\n      filtered,\n      optChangeAccumulator\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updatePriority(oldSnap: Node, newPriority: Node): Node {\n    // Don't support priorities on queries\n    return oldSnap;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  filtersNodes(): boolean {\n    return true;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getIndexedFilter(): IndexedFilter {\n    return this.indexedFilter_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getIndex(): Index {\n    return this.index_;\n  }\n\n  /**\n   * @param {!QueryParams} params\n   * @return {!NamedNode}\n   * @private\n   */\n  private static getStartPost_(params: QueryParams): NamedNode {\n    if (params.hasStart()) {\n      const startName = params.getIndexStartName();\n      return params.getIndex().makePost(params.getIndexStartValue(), startName);\n    } else {\n      return params.getIndex().minPost();\n    }\n  }\n\n  /**\n   * @param {!QueryParams} params\n   * @return {!NamedNode}\n   * @private\n   */\n  private static getEndPost_(params: QueryParams): NamedNode {\n    if (params.hasEnd()) {\n      const endName = params.getIndexEndName();\n      return params.getIndex().makePost(params.getIndexEndValue(), endName);\n    } else {\n      return params.getIndex().maxPost();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { RangedFilter } from './RangedFilter';\nimport { ChildrenNode } from '../../snap/ChildrenNode';\nimport { Node, NamedNode } from '../../snap/Node';\nimport { assert } from '@firebase/util';\nimport { Change } from '../Change';\nimport { NodeFilter } from './NodeFilter';\nimport { Index } from '../../snap/indexes/Index';\nimport { IndexedFilter } from './IndexedFilter';\nimport { QueryParams } from '../QueryParams';\nimport { Path } from '../../util/Path';\nimport { CompleteChildSource } from '../CompleteChildSource';\nimport { ChildChangeAccumulator } from '../ChildChangeAccumulator';\n\n/**\n * Applies a limit and a range to a node and uses RangedFilter to do the heavy lifting where possible\n *\n * @constructor\n * @implements {NodeFilter}\n */\nexport class LimitedFilter implements NodeFilter {\n  /**\n   * @const\n   * @type {RangedFilter}\n   * @private\n   */\n  private readonly rangedFilter_: RangedFilter;\n\n  /**\n   * @const\n   * @type {!Index}\n   * @private\n   */\n  private readonly index_: Index;\n\n  /**\n   * @const\n   * @type {number}\n   * @private\n   */\n  private readonly limit_: number;\n\n  /**\n   * @const\n   * @type {boolean}\n   * @private\n   */\n  private readonly reverse_: boolean;\n\n  /**\n   * @param {!QueryParams} params\n   */\n  constructor(params: QueryParams) {\n    this.rangedFilter_ = new RangedFilter(params);\n    this.index_ = params.getIndex();\n    this.limit_ = params.getLimit();\n    this.reverse_ = !params.isViewFromLeft();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updateChild(\n    snap: Node,\n    key: string,\n    newChild: Node,\n    affectedPath: Path,\n    source: CompleteChildSource,\n    optChangeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    if (!this.rangedFilter_.matches(new NamedNode(key, newChild))) {\n      newChild = ChildrenNode.EMPTY_NODE;\n    }\n    if (snap.getImmediateChild(key).equals(newChild)) {\n      // No change\n      return snap;\n    } else if (snap.numChildren() < this.limit_) {\n      return this.rangedFilter_\n        .getIndexedFilter()\n        .updateChild(\n          snap,\n          key,\n          newChild,\n          affectedPath,\n          source,\n          optChangeAccumulator\n        );\n    } else {\n      return this.fullLimitUpdateChild_(\n        snap,\n        key,\n        newChild,\n        source,\n        optChangeAccumulator\n      );\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updateFullNode(\n    oldSnap: Node,\n    newSnap: Node,\n    optChangeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    let filtered;\n    if (newSnap.isLeafNode() || newSnap.isEmpty()) {\n      // Make sure we have a children node with the correct index, not a leaf node;\n      filtered = ChildrenNode.EMPTY_NODE.withIndex(this.index_);\n    } else {\n      if (\n        this.limit_ * 2 < newSnap.numChildren() &&\n        newSnap.isIndexed(this.index_)\n      ) {\n        // Easier to build up a snapshot, since what we're given has more than twice the elements we want\n        filtered = ChildrenNode.EMPTY_NODE.withIndex(this.index_);\n        // anchor to the startPost, endPost, or last element as appropriate\n        let iterator;\n        if (this.reverse_) {\n          iterator = (newSnap as ChildrenNode).getReverseIteratorFrom(\n            this.rangedFilter_.getEndPost(),\n            this.index_\n          );\n        } else {\n          iterator = (newSnap as ChildrenNode).getIteratorFrom(\n            this.rangedFilter_.getStartPost(),\n            this.index_\n          );\n        }\n        let count = 0;\n        while (iterator.hasNext() && count < this.limit_) {\n          const next = iterator.getNext();\n          let inRange;\n          if (this.reverse_) {\n            inRange =\n              this.index_.compare(this.rangedFilter_.getStartPost(), next) <= 0;\n          } else {\n            inRange =\n              this.index_.compare(next, this.rangedFilter_.getEndPost()) <= 0;\n          }\n          if (inRange) {\n            filtered = filtered.updateImmediateChild(next.name, next.node);\n            count++;\n          } else {\n            // if we have reached the end post, we cannot keep adding elemments\n            break;\n          }\n        }\n      } else {\n        // The snap contains less than twice the limit. Faster to delete from the snap than build up a new one\n        filtered = newSnap.withIndex(this.index_);\n        // Don't support priorities on queries\n        filtered = filtered.updatePriority(\n          ChildrenNode.EMPTY_NODE\n        ) as ChildrenNode;\n        let startPost;\n        let endPost;\n        let cmp;\n        let iterator;\n        if (this.reverse_) {\n          iterator = filtered.getReverseIterator(this.index_);\n          startPost = this.rangedFilter_.getEndPost();\n          endPost = this.rangedFilter_.getStartPost();\n          const indexCompare = this.index_.getCompare();\n          cmp = (a: NamedNode, b: NamedNode) => indexCompare(b, a);\n        } else {\n          iterator = filtered.getIterator(this.index_);\n          startPost = this.rangedFilter_.getStartPost();\n          endPost = this.rangedFilter_.getEndPost();\n          cmp = this.index_.getCompare();\n        }\n\n        let count = 0;\n        let foundStartPost = false;\n        while (iterator.hasNext()) {\n          let next = iterator.getNext();\n          if (!foundStartPost && cmp(startPost, next) <= 0) {\n            // start adding\n            foundStartPost = true;\n          }\n          let inRange =\n            foundStartPost && count < this.limit_ && cmp(next, endPost) <= 0;\n          if (inRange) {\n            count++;\n          } else {\n            filtered = filtered.updateImmediateChild(\n              next.name,\n              ChildrenNode.EMPTY_NODE\n            );\n          }\n        }\n      }\n    }\n    return this.rangedFilter_\n      .getIndexedFilter()\n      .updateFullNode(oldSnap, filtered, optChangeAccumulator);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  updatePriority(oldSnap: Node, newPriority: Node): Node {\n    // Don't support priorities on queries\n    return oldSnap;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  filtersNodes(): boolean {\n    return true;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getIndexedFilter(): IndexedFilter {\n    return this.rangedFilter_.getIndexedFilter();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getIndex(): Index {\n    return this.index_;\n  }\n\n  /**\n   * @param {!Node} snap\n   * @param {string} childKey\n   * @param {!Node} childSnap\n   * @param {!CompleteChildSource} source\n   * @param {?ChildChangeAccumulator} changeAccumulator\n   * @return {!Node}\n   * @private\n   */\n  private fullLimitUpdateChild_(\n    snap: Node,\n    childKey: string,\n    childSnap: Node,\n    source: CompleteChildSource,\n    changeAccumulator: ChildChangeAccumulator | null\n  ): Node {\n    // TODO: rename all cache stuff etc to general snap terminology\n    let cmp;\n    if (this.reverse_) {\n      const indexCmp = this.index_.getCompare();\n      cmp = (a: NamedNode, b: NamedNode) => indexCmp(b, a);\n    } else {\n      cmp = this.index_.getCompare();\n    }\n    const oldEventCache = snap as ChildrenNode;\n    assert(oldEventCache.numChildren() == this.limit_, '');\n    const newChildNamedNode = new NamedNode(childKey, childSnap);\n    const windowBoundary = this.reverse_\n      ? oldEventCache.getFirstChild(this.index_)\n      : (oldEventCache.getLastChild(this.index_) as NamedNode);\n    const inRange = this.rangedFilter_.matches(newChildNamedNode);\n    if (oldEventCache.hasChild(childKey)) {\n      const oldChildSnap = oldEventCache.getImmediateChild(childKey);\n      let nextChild = source.getChildAfterChild(\n        this.index_,\n        windowBoundary,\n        this.reverse_\n      );\n      while (\n        nextChild != null &&\n        (nextChild.name == childKey || oldEventCache.hasChild(nextChild.name))\n      ) {\n        // There is a weird edge case where a node is updated as part of a merge in the write tree, but hasn't\n        // been applied to the limited filter yet. Ignore this next child which will be updated later in\n        // the limited filter...\n        nextChild = source.getChildAfterChild(\n          this.index_,\n          nextChild,\n          this.reverse_\n        );\n      }\n      const compareNext =\n        nextChild == null ? 1 : cmp(nextChild, newChildNamedNode);\n      const remainsInWindow =\n        inRange && !childSnap.isEmpty() && compareNext >= 0;\n      if (remainsInWindow) {\n        if (changeAccumulator != null) {\n          changeAccumulator.trackChildChange(\n            Change.childChangedChange(childKey, childSnap, oldChildSnap)\n          );\n        }\n        return oldEventCache.updateImmediateChild(childKey, childSnap);\n      } else {\n        if (changeAccumulator != null) {\n          changeAccumulator.trackChildChange(\n            Change.childRemovedChange(childKey, oldChildSnap)\n          );\n        }\n        const newEventCache = oldEventCache.updateImmediateChild(\n          childKey,\n          ChildrenNode.EMPTY_NODE\n        );\n        const nextChildInRange =\n          nextChild != null && this.rangedFilter_.matches(nextChild);\n        if (nextChildInRange) {\n          if (changeAccumulator != null) {\n            changeAccumulator.trackChildChange(\n              Change.childAddedChange(nextChild.name, nextChild.node)\n            );\n          }\n          return newEventCache.updateImmediateChild(\n            nextChild.name,\n            nextChild.node\n          );\n        } else {\n          return newEventCache;\n        }\n      }\n    } else if (childSnap.isEmpty()) {\n      // we're deleting a node, but it was not in the window, so ignore it\n      return snap;\n    } else if (inRange) {\n      if (cmp(windowBoundary, newChildNamedNode) >= 0) {\n        if (changeAccumulator != null) {\n          changeAccumulator.trackChildChange(\n            Change.childRemovedChange(windowBoundary.name, windowBoundary.node)\n          );\n          changeAccumulator.trackChildChange(\n            Change.childAddedChange(childKey, childSnap)\n          );\n        }\n        return oldEventCache\n          .updateImmediateChild(childKey, childSnap)\n          .updateImmediateChild(windowBoundary.name, ChildrenNode.EMPTY_NODE);\n      } else {\n        return snap;\n      }\n    } else {\n      return snap;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { MIN_NAME, MAX_NAME } from '../util/util';\nimport { KEY_INDEX } from '../snap/indexes/KeyIndex';\nimport { PRIORITY_INDEX } from '../snap/indexes/PriorityIndex';\nimport { VALUE_INDEX } from '../snap/indexes/ValueIndex';\nimport { PathIndex } from '../snap/indexes/PathIndex';\nimport { IndexedFilter } from './filter/IndexedFilter';\nimport { LimitedFilter } from './filter/LimitedFilter';\nimport { RangedFilter } from './filter/RangedFilter';\nimport { stringify } from '@firebase/util';\nimport { NodeFilter } from './filter/NodeFilter';\nimport { Index } from '../snap/indexes/Index';\n\n/**\n * This class is an immutable-from-the-public-api struct containing a set of query parameters defining a\n * range to be returned for a particular location. It is assumed that validation of parameters is done at the\n * user-facing API level, so it is not done here.\n * @constructor\n */\nexport class QueryParams {\n  private limitSet_ = false;\n  private startSet_ = false;\n  private startNameSet_ = false;\n  private endSet_ = false;\n  private endNameSet_ = false;\n\n  private limit_ = 0;\n  private viewFrom_ = '';\n  private indexStartValue_: any | null = null;\n  private indexStartName_ = '';\n  private indexEndValue_: any | null = null;\n  private indexEndName_ = '';\n\n  private index_ = PRIORITY_INDEX;\n\n  /**\n   * Wire Protocol Constants\n   * @const\n   * @enum {string}\n   * @private\n   */\n  private static readonly WIRE_PROTOCOL_CONSTANTS_ = {\n    INDEX_START_VALUE: 'sp',\n    INDEX_START_NAME: 'sn',\n    INDEX_END_VALUE: 'ep',\n    INDEX_END_NAME: 'en',\n    LIMIT: 'l',\n    VIEW_FROM: 'vf',\n    VIEW_FROM_LEFT: 'l',\n    VIEW_FROM_RIGHT: 'r',\n    INDEX: 'i'\n  };\n\n  /**\n   * REST Query Constants\n   * @const\n   * @enum {string}\n   * @private\n   */\n  private static readonly REST_QUERY_CONSTANTS_ = {\n    ORDER_BY: 'orderBy',\n    PRIORITY_INDEX: '$priority',\n    VALUE_INDEX: '$value',\n    KEY_INDEX: '$key',\n    START_AT: 'startAt',\n    END_AT: 'endAt',\n    LIMIT_TO_FIRST: 'limitToFirst',\n    LIMIT_TO_LAST: 'limitToLast'\n  };\n\n  /**\n   * Default, empty query parameters\n   * @type {!QueryParams}\n   * @const\n   */\n  static readonly DEFAULT = new QueryParams();\n\n  /**\n   * @return {boolean}\n   */\n  hasStart(): boolean {\n    return this.startSet_;\n  }\n\n  /**\n   * @return {boolean} True if it would return from left.\n   */\n  isViewFromLeft(): boolean {\n    if (this.viewFrom_ === '') {\n      // limit(), rather than limitToFirst or limitToLast was called.\n      // This means that only one of startSet_ and endSet_ is true. Use them\n      // to calculate which side of the view to anchor to. If neither is set,\n      // anchor to the end.\n      return this.startSet_;\n    } else {\n      return (\n        this.viewFrom_ === QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT\n      );\n    }\n  }\n\n  /**\n   * Only valid to call if hasStart() returns true\n   * @return {*}\n   */\n  getIndexStartValue(): any {\n    assert(this.startSet_, 'Only valid if start has been set');\n    return this.indexStartValue_;\n  }\n\n  /**\n   * Only valid to call if hasStart() returns true.\n   * Returns the starting key name for the range defined by these query parameters\n   * @return {!string}\n   */\n  getIndexStartName(): string {\n    assert(this.startSet_, 'Only valid if start has been set');\n    if (this.startNameSet_) {\n      return this.indexStartName_;\n    } else {\n      return MIN_NAME;\n    }\n  }\n\n  /**\n   * @return {boolean}\n   */\n  hasEnd(): boolean {\n    return this.endSet_;\n  }\n\n  /**\n   * Only valid to call if hasEnd() returns true.\n   * @return {*}\n   */\n  getIndexEndValue(): any {\n    assert(this.endSet_, 'Only valid if end has been set');\n    return this.indexEndValue_;\n  }\n\n  /**\n   * Only valid to call if hasEnd() returns true.\n   * Returns the end key name for the range defined by these query parameters\n   * @return {!string}\n   */\n  getIndexEndName(): string {\n    assert(this.endSet_, 'Only valid if end has been set');\n    if (this.endNameSet_) {\n      return this.indexEndName_;\n    } else {\n      return MAX_NAME;\n    }\n  }\n\n  /**\n   * @return {boolean}\n   */\n  hasLimit(): boolean {\n    return this.limitSet_;\n  }\n\n  /**\n   * @return {boolean} True if a limit has been set and it has been explicitly anchored\n   */\n  hasAnchoredLimit(): boolean {\n    return this.limitSet_ && this.viewFrom_ !== '';\n  }\n\n  /**\n   * Only valid to call if hasLimit() returns true\n   * @return {!number}\n   */\n  getLimit(): number {\n    assert(this.limitSet_, 'Only valid if limit has been set');\n    return this.limit_;\n  }\n\n  /**\n   * @return {!Index}\n   */\n  getIndex(): Index {\n    return this.index_;\n  }\n\n  /**\n   * @return {!QueryParams}\n   * @private\n   */\n  private copy_(): QueryParams {\n    const copy = new QueryParams();\n    copy.limitSet_ = this.limitSet_;\n    copy.limit_ = this.limit_;\n    copy.startSet_ = this.startSet_;\n    copy.indexStartValue_ = this.indexStartValue_;\n    copy.startNameSet_ = this.startNameSet_;\n    copy.indexStartName_ = this.indexStartName_;\n    copy.endSet_ = this.endSet_;\n    copy.indexEndValue_ = this.indexEndValue_;\n    copy.endNameSet_ = this.endNameSet_;\n    copy.indexEndName_ = this.indexEndName_;\n    copy.index_ = this.index_;\n    copy.viewFrom_ = this.viewFrom_;\n    return copy;\n  }\n\n  /**\n   * @param {!number} newLimit\n   * @return {!QueryParams}\n   */\n  limit(newLimit: number): QueryParams {\n    const newParams = this.copy_();\n    newParams.limitSet_ = true;\n    newParams.limit_ = newLimit;\n    newParams.viewFrom_ = '';\n    return newParams;\n  }\n\n  /**\n   * @param {!number} newLimit\n   * @return {!QueryParams}\n   */\n  limitToFirst(newLimit: number): QueryParams {\n    const newParams = this.copy_();\n    newParams.limitSet_ = true;\n    newParams.limit_ = newLimit;\n    newParams.viewFrom_ = QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT;\n    return newParams;\n  }\n\n  /**\n   * @param {!number} newLimit\n   * @return {!QueryParams}\n   */\n  limitToLast(newLimit: number): QueryParams {\n    const newParams = this.copy_();\n    newParams.limitSet_ = true;\n    newParams.limit_ = newLimit;\n    newParams.viewFrom_ = QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT;\n    return newParams;\n  }\n\n  /**\n   * @param {*} indexValue\n   * @param {?string=} key\n   * @return {!QueryParams}\n   */\n  startAt(indexValue: any, key?: string | null): QueryParams {\n    const newParams = this.copy_();\n    newParams.startSet_ = true;\n    if (indexValue === undefined) {\n      indexValue = null;\n    }\n    newParams.indexStartValue_ = indexValue;\n    if (key != null) {\n      newParams.startNameSet_ = true;\n      newParams.indexStartName_ = key;\n    } else {\n      newParams.startNameSet_ = false;\n      newParams.indexStartName_ = '';\n    }\n    return newParams;\n  }\n\n  /**\n   * @param {*} indexValue\n   * @param {?string=} key\n   * @return {!QueryParams}\n   */\n  endAt(indexValue: any, key?: string | null): QueryParams {\n    const newParams = this.copy_();\n    newParams.endSet_ = true;\n    if (indexValue === undefined) {\n      indexValue = null;\n    }\n    newParams.indexEndValue_ = indexValue;\n    if (key !== undefined) {\n      newParams.endNameSet_ = true;\n      newParams.indexEndName_ = key;\n    } else {\n      newParams.endNameSet_ = false;\n      newParams.indexEndName_ = '';\n    }\n    return newParams;\n  }\n\n  /**\n   * @param {!Index} index\n   * @return {!QueryParams}\n   */\n  orderBy(index: Index): QueryParams {\n    const newParams = this.copy_();\n    newParams.index_ = index;\n    return newParams;\n  }\n\n  /**\n   * @return {!Object}\n   */\n  getQueryObject(): Object {\n    const WIRE_PROTOCOL_CONSTANTS = QueryParams.WIRE_PROTOCOL_CONSTANTS_;\n    const obj: { [k: string]: any } = {};\n    if (this.startSet_) {\n      obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_VALUE] = this.indexStartValue_;\n      if (this.startNameSet_) {\n        obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_NAME] = this.indexStartName_;\n      }\n    }\n    if (this.endSet_) {\n      obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_VALUE] = this.indexEndValue_;\n      if (this.endNameSet_) {\n        obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_NAME] = this.indexEndName_;\n      }\n    }\n    if (this.limitSet_) {\n      obj[WIRE_PROTOCOL_CONSTANTS.LIMIT] = this.limit_;\n      let viewFrom = this.viewFrom_;\n      if (viewFrom === '') {\n        if (this.isViewFromLeft()) {\n          viewFrom = WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_LEFT;\n        } else {\n          viewFrom = WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_RIGHT;\n        }\n      }\n      obj[WIRE_PROTOCOL_CONSTANTS.VIEW_FROM] = viewFrom;\n    }\n    // For now, priority index is the default, so we only specify if it's some other index\n    if (this.index_ !== PRIORITY_INDEX) {\n      obj[WIRE_PROTOCOL_CONSTANTS.INDEX] = this.index_.toString();\n    }\n    return obj;\n  }\n\n  /**\n   * @return {boolean}\n   */\n  loadsAllData(): boolean {\n    return !(this.startSet_ || this.endSet_ || this.limitSet_);\n  }\n\n  /**\n   * @return {boolean}\n   */\n  isDefault(): boolean {\n    return this.loadsAllData() && this.index_ == PRIORITY_INDEX;\n  }\n\n  /**\n   * @return {!NodeFilter}\n   */\n  getNodeFilter(): NodeFilter {\n    if (this.loadsAllData()) {\n      return new IndexedFilter(this.getIndex());\n    } else if (this.hasLimit()) {\n      return new LimitedFilter(this);\n    } else {\n      return new RangedFilter(this);\n    }\n  }\n\n  /**\n   * Returns a set of REST query string parameters representing this query.\n   *\n   * @return {!Object.<string,*>} query string parameters\n   */\n  toRestQueryStringParameters(): { [k: string]: any } {\n    const REST_CONSTANTS = QueryParams.REST_QUERY_CONSTANTS_;\n    const qs: { [k: string]: string | number } = {};\n\n    if (this.isDefault()) {\n      return qs;\n    }\n\n    let orderBy;\n    if (this.index_ === PRIORITY_INDEX) {\n      orderBy = REST_CONSTANTS.PRIORITY_INDEX;\n    } else if (this.index_ === VALUE_INDEX) {\n      orderBy = REST_CONSTANTS.VALUE_INDEX;\n    } else if (this.index_ === KEY_INDEX) {\n      orderBy = REST_CONSTANTS.KEY_INDEX;\n    } else {\n      assert(this.index_ instanceof PathIndex, 'Unrecognized index type!');\n      orderBy = this.index_.toString();\n    }\n    qs[REST_CONSTANTS.ORDER_BY] = stringify(orderBy);\n\n    if (this.startSet_) {\n      qs[REST_CONSTANTS.START_AT] = stringify(this.indexStartValue_);\n      if (this.startNameSet_) {\n        qs[REST_CONSTANTS.START_AT] += ',' + stringify(this.indexStartName_);\n      }\n    }\n\n    if (this.endSet_) {\n      qs[REST_CONSTANTS.END_AT] = stringify(this.indexEndValue_);\n      if (this.endNameSet_) {\n        qs[REST_CONSTANTS.END_AT] += ',' + stringify(this.indexEndName_);\n      }\n    }\n\n    if (this.limitSet_) {\n      if (this.isViewFromLeft()) {\n        qs[REST_CONSTANTS.LIMIT_TO_FIRST] = this.limit_;\n      } else {\n        qs[REST_CONSTANTS.LIMIT_TO_LAST] = this.limit_;\n      }\n    }\n\n    return qs;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { OnDisconnect } from './onDisconnect';\nimport { TransactionResult } from './TransactionResult';\nimport { warn } from '../core/util/util';\nimport { nextPushId } from '../core/util/NextPushId';\nimport { Query } from './Query';\nimport { Repo } from '../core/Repo';\nimport { Path } from '../core/util/Path';\nimport { QueryParams } from '../core/view/QueryParams';\nimport {\n  validateRootPathString,\n  validatePathString,\n  validateFirebaseMergeDataArg,\n  validateBoolean,\n  validatePriority,\n  validateFirebaseDataArg,\n  validateWritablePath\n} from '../core/util/validation';\nimport { validateArgCount, validateCallback } from '@firebase/util';\nimport { Deferred } from '@firebase/util';\nimport { SyncPoint } from '../core/SyncPoint';\nimport { Database } from './Database';\nimport { DataSnapshot } from './DataSnapshot';\nimport * as types from '@firebase/database-types';\n\nexport interface ReferenceConstructor {\n  new (repo: Repo, path: Path): Reference;\n}\n\nexport class Reference extends Query implements types.Reference {\n  public then: (a?: any) => Promise<any>;\n  public catch: (a?: Error) => Promise<any>;\n\n  /**\n   * Call options:\n   *   new Reference(Repo, Path) or\n   *   new Reference(url: string, string|RepoManager)\n   *\n   * Externally - this is the firebase.database.Reference type.\n   *\n   * @param {!Repo} repo\n   * @param {(!Path)} path\n   * @extends {Query}\n   */\n  constructor(repo: Repo, path: Path) {\n    if (!(repo instanceof Repo)) {\n      throw new Error(\n        'new Reference() no longer supported - use app.database().'\n      );\n    }\n\n    // call Query's constructor, passing in the repo and path.\n    super(repo, path, QueryParams.DEFAULT, false);\n  }\n\n  /** @return {?string} */\n  getKey(): string | null {\n    validateArgCount('Reference.key', 0, 0, arguments.length);\n\n    if (this.path.isEmpty()) return null;\n    else return this.path.getBack();\n  }\n\n  /**\n   * @param {!(string|Path)} pathString\n   * @return {!Reference}\n   */\n  child(pathString: string | Path): Reference {\n    validateArgCount('Reference.child', 1, 1, arguments.length);\n    if (typeof pathString === 'number') {\n      pathString = String(pathString);\n    } else if (!(pathString instanceof Path)) {\n      if (this.path.getFront() === null)\n        validateRootPathString('Reference.child', 1, pathString, false);\n      else validatePathString('Reference.child', 1, pathString, false);\n    }\n\n    return new Reference(this.repo, this.path.child(pathString));\n  }\n\n  /** @return {?Reference} */\n  getParent(): Reference | null {\n    validateArgCount('Reference.parent', 0, 0, arguments.length);\n\n    const parentPath = this.path.parent();\n    return parentPath === null ? null : new Reference(this.repo, parentPath);\n  }\n\n  /** @return {!Reference} */\n  getRoot(): Reference {\n    validateArgCount('Reference.root', 0, 0, arguments.length);\n\n    let ref = this as any;\n    while (ref.getParent() !== null) {\n      ref = ref.getParent();\n    }\n    return ref;\n  }\n\n  /** @return {!Database} */\n  databaseProp(): Database {\n    return this.repo.database;\n  }\n\n  /**\n   * @param {*} newVal\n   * @param {function(?Error)=} onComplete\n   * @return {!Promise}\n   */\n  set(newVal: any, onComplete?: (a: Error | null) => void): Promise<any> {\n    validateArgCount('Reference.set', 1, 2, arguments.length);\n    validateWritablePath('Reference.set', this.path);\n    validateFirebaseDataArg('Reference.set', 1, newVal, this.path, false);\n    validateCallback('Reference.set', 2, onComplete, true);\n\n    const deferred = new Deferred();\n    this.repo.setWithPriority(\n      this.path,\n      newVal,\n      /*priority=*/ null,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {!Object} objectToMerge\n   * @param {function(?Error)=} onComplete\n   * @return {!Promise}\n   */\n  update(\n    objectToMerge: Object,\n    onComplete?: (a: Error | null) => void\n  ): Promise<any> {\n    validateArgCount('Reference.update', 1, 2, arguments.length);\n    validateWritablePath('Reference.update', this.path);\n\n    if (Array.isArray(objectToMerge)) {\n      const newObjectToMerge: { [k: string]: any } = {};\n      for (let i = 0; i < objectToMerge.length; ++i) {\n        newObjectToMerge['' + i] = objectToMerge[i];\n      }\n      objectToMerge = newObjectToMerge;\n      warn(\n        'Passing an Array to Firebase.update() is deprecated. ' +\n          'Use set() if you want to overwrite the existing data, or ' +\n          'an Object with integer keys if you really do want to ' +\n          'only update some of the children.'\n      );\n    }\n    validateFirebaseMergeDataArg(\n      'Reference.update',\n      1,\n      objectToMerge,\n      this.path,\n      false\n    );\n    validateCallback('Reference.update', 2, onComplete, true);\n    const deferred = new Deferred();\n    this.repo.update(\n      this.path,\n      objectToMerge,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {*} newVal\n   * @param {string|number|null} newPriority\n   * @param {function(?Error)=} onComplete\n   * @return {!Promise}\n   */\n  setWithPriority(\n    newVal: any,\n    newPriority: string | number | null,\n    onComplete?: (a: Error | null) => void\n  ): Promise<any> {\n    validateArgCount('Reference.setWithPriority', 2, 3, arguments.length);\n    validateWritablePath('Reference.setWithPriority', this.path);\n    validateFirebaseDataArg(\n      'Reference.setWithPriority',\n      1,\n      newVal,\n      this.path,\n      false\n    );\n    validatePriority('Reference.setWithPriority', 2, newPriority, false);\n    validateCallback('Reference.setWithPriority', 3, onComplete, true);\n\n    if (this.getKey() === '.length' || this.getKey() === '.keys')\n      throw 'Reference.setWithPriority failed: ' +\n        this.getKey() +\n        ' is a read-only object.';\n\n    const deferred = new Deferred();\n    this.repo.setWithPriority(\n      this.path,\n      newVal,\n      newPriority,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {function(?Error)=} onComplete\n   * @return {!Promise}\n   */\n  remove(onComplete?: (a: Error | null) => void): Promise<any> {\n    validateArgCount('Reference.remove', 0, 1, arguments.length);\n    validateWritablePath('Reference.remove', this.path);\n    validateCallback('Reference.remove', 1, onComplete, true);\n\n    return this.set(null, onComplete);\n  }\n\n  /**\n   * @param {function(*):*} transactionUpdate\n   * @param {(function(?Error, boolean, ?DataSnapshot))=} onComplete\n   * @param {boolean=} applyLocally\n   * @return {!Promise}\n   */\n  transaction(\n    transactionUpdate: (a: any) => any,\n    onComplete?: (a: Error | null, b: boolean, c: DataSnapshot | null) => void,\n    applyLocally?: boolean\n  ): Promise<TransactionResult> {\n    validateArgCount('Reference.transaction', 1, 3, arguments.length);\n    validateWritablePath('Reference.transaction', this.path);\n    validateCallback('Reference.transaction', 1, transactionUpdate, false);\n    validateCallback('Reference.transaction', 2, onComplete, true);\n    // NOTE: applyLocally is an internal-only option for now.  We need to decide if we want to keep it and how\n    // to expose it.\n    validateBoolean('Reference.transaction', 3, applyLocally, true);\n\n    if (this.getKey() === '.length' || this.getKey() === '.keys')\n      throw 'Reference.transaction failed: ' +\n        this.getKey() +\n        ' is a read-only object.';\n\n    if (applyLocally === undefined) applyLocally = true;\n\n    const deferred = new Deferred<TransactionResult>();\n    if (typeof onComplete === 'function') {\n      deferred.promise.catch(() => {});\n    }\n\n    const promiseComplete = function(\n      error: Error,\n      committed: boolean,\n      snapshot: DataSnapshot\n    ) {\n      if (error) {\n        deferred.reject(error);\n      } else {\n        deferred.resolve(new TransactionResult(committed, snapshot));\n      }\n      if (typeof onComplete === 'function') {\n        onComplete(error, committed, snapshot);\n      }\n    };\n    this.repo.startTransaction(\n      this.path,\n      transactionUpdate,\n      promiseComplete,\n      applyLocally\n    );\n\n    return deferred.promise;\n  }\n\n  /**\n   * @param {string|number|null} priority\n   * @param {function(?Error)=} onComplete\n   * @return {!Promise}\n   */\n  setPriority(\n    priority: string | number | null,\n    onComplete?: (a: Error | null) => void\n  ): Promise<any> {\n    validateArgCount('Reference.setPriority', 1, 2, arguments.length);\n    validateWritablePath('Reference.setPriority', this.path);\n    validatePriority('Reference.setPriority', 1, priority, false);\n    validateCallback('Reference.setPriority', 2, onComplete, true);\n\n    const deferred = new Deferred();\n    this.repo.setWithPriority(\n      this.path.child('.priority'),\n      priority,\n      null,\n      deferred.wrapCallback(onComplete)\n    );\n    return deferred.promise;\n  }\n\n  /**\n   * @param {*=} value\n   * @param {function(?Error)=} onComplete\n   * @return {!Reference}\n   */\n  push(value?: any, onComplete?: (a: Error | null) => void): Reference {\n    validateArgCount('Reference.push', 0, 2, arguments.length);\n    validateWritablePath('Reference.push', this.path);\n    validateFirebaseDataArg('Reference.push', 1, value, this.path, true);\n    validateCallback('Reference.push', 2, onComplete, true);\n\n    const now = this.repo.serverTime();\n    const name = nextPushId(now);\n\n    // push() returns a ThennableReference whose promise is fulfilled with a regular Reference.\n    // We use child() to create handles to two different references. The first is turned into a\n    // ThennableReference below by adding then() and catch() methods and is used as the\n    // return value of push(). The second remains a regular Reference and is used as the fulfilled\n    // value of the first ThennableReference.\n    const thennablePushRef = this.child(name);\n    const pushRef = this.child(name);\n\n    let promise;\n    if (value != null) {\n      promise = thennablePushRef.set(value, onComplete).then(() => pushRef);\n    } else {\n      promise = Promise.resolve(pushRef);\n    }\n\n    thennablePushRef.then = promise.then.bind(promise);\n    thennablePushRef.catch = promise.then.bind(promise, undefined);\n\n    if (typeof onComplete === 'function') {\n      promise.catch(() => {});\n    }\n\n    return thennablePushRef;\n  }\n\n  /**\n   * @return {!OnDisconnect}\n   */\n  onDisconnect(): OnDisconnect {\n    validateWritablePath('Reference.onDisconnect', this.path);\n    return new OnDisconnect(this.repo, this.path);\n  }\n\n  get database(): Database {\n    return this.databaseProp();\n  }\n\n  get key(): string | null {\n    return this.getKey();\n  }\n\n  get parent(): Reference | null {\n    return this.getParent();\n  }\n\n  get root(): Reference {\n    return this.getRoot();\n  }\n}\n\n/**\n * Define reference constructor in various modules\n *\n * We are doing this here to avoid several circular\n * dependency issues\n */\nQuery.__referenceConstructor = Reference;\nSyncPoint.__referenceConstructor = Reference;\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { Path } from './Path';\nimport { contains, safeGet } from '@firebase/util';\nimport { each } from './util';\n\n/**\n * Node in a Tree.\n */\nexport class TreeNode<T> {\n  // TODO: Consider making accessors that create children and value lazily or\n  // separate Internal / Leaf 'types'.\n  children: { [name: string]: TreeNode<T> } = {};\n  childCount = 0;\n  value: T | null = null;\n}\n\n/**\n * A light-weight tree, traversable by path.  Nodes can have both values and children.\n * Nodes are not enumerated (by forEachChild) unless they have a value or non-empty\n * children.\n */\nexport class Tree<T> {\n  /**\n   * @template T\n   * @param {string=} name_ Optional name of the node.\n   * @param {Tree=} parent_ Optional parent node.\n   * @param {TreeNode=} node_ Optional node to wrap.\n   */\n  constructor(\n    private name_: string = '',\n    private parent_: Tree<T> | null = null,\n    private node_: TreeNode<T> = new TreeNode<T>()\n  ) {}\n\n  /**\n   * Returns a sub-Tree for the given path.\n   *\n   * @param {!(string|Path)} pathObj Path to look up.\n   * @return {!Tree.<T>} Tree for path.\n   */\n  subTree(pathObj: string | Path): Tree<T> {\n    // TODO: Require pathObj to be Path?\n    let path = pathObj instanceof Path ? pathObj : new Path(pathObj);\n    let child = this as Tree<T>,\n      next;\n    while ((next = path.getFront()) !== null) {\n      const childNode = safeGet(child.node_.children, next) || new TreeNode();\n      child = new Tree(next, child, childNode);\n      path = path.popFront();\n    }\n\n    return child;\n  }\n\n  /**\n   * Returns the data associated with this tree node.\n   *\n   * @return {?T} The data or null if no data exists.\n   */\n  getValue(): T | null {\n    return this.node_.value;\n  }\n\n  /**\n   * Sets data to this tree node.\n   *\n   * @param {!T} value Value to set.\n   */\n  setValue(value: T) {\n    assert(typeof value !== 'undefined', 'Cannot set value to undefined');\n    this.node_.value = value;\n    this.updateParents_();\n  }\n\n  /**\n   * Clears the contents of the tree node (its value and all children).\n   */\n  clear() {\n    this.node_.value = null;\n    this.node_.children = {};\n    this.node_.childCount = 0;\n    this.updateParents_();\n  }\n\n  /**\n   * @return {boolean} Whether the tree has any children.\n   */\n  hasChildren(): boolean {\n    return this.node_.childCount > 0;\n  }\n\n  /**\n   * @return {boolean} Whether the tree is empty (no value or children).\n   */\n  isEmpty(): boolean {\n    return this.getValue() === null && !this.hasChildren();\n  }\n\n  /**\n   * Calls action for each child of this tree node.\n   *\n   * @param {function(!Tree.<T>)} action Action to be called for each child.\n   */\n  forEachChild(action: (tree: Tree<T>) => void) {\n    each(this.node_.children, (child: string, childTree: TreeNode<T>) => {\n      action(new Tree<T>(child, this, childTree));\n    });\n  }\n\n  /**\n   * Does a depth-first traversal of this node's descendants, calling action for each one.\n   *\n   * @param {function(!Tree.<T>)} action Action to be called for each child.\n   * @param {boolean=} includeSelf Whether to call action on this node as well. Defaults to\n   *   false.\n   * @param {boolean=} childrenFirst Whether to call action on children before calling it on\n   *   parent.\n   */\n  forEachDescendant(\n    action: (tree: Tree<T>) => void,\n    includeSelf?: boolean,\n    childrenFirst?: boolean\n  ) {\n    if (includeSelf && !childrenFirst) action(this);\n\n    this.forEachChild(function(child) {\n      child.forEachDescendant(action, /*includeSelf=*/ true, childrenFirst);\n    });\n\n    if (includeSelf && childrenFirst) action(this);\n  }\n\n  /**\n   * Calls action on each ancestor node.\n   *\n   * @param {function(!Tree.<T>)} action Action to be called on each parent; return\n   *   true to abort.\n   * @param {boolean=} includeSelf Whether to call action on this node as well.\n   * @return {boolean} true if the action callback returned true.\n   */\n  forEachAncestor(\n    action: (tree: Tree<T>) => unknown,\n    includeSelf?: boolean\n  ): boolean {\n    let node = includeSelf ? this : this.parent();\n    while (node !== null) {\n      if (action(node)) {\n        return true;\n      }\n      node = node.parent();\n    }\n    return false;\n  }\n\n  /**\n   * Does a depth-first traversal of this node's descendants.  When a descendant with a value\n   * is found, action is called on it and traversal does not continue inside the node.\n   * Action is *not* called on this node.\n   *\n   * @param {function(!Tree.<T>)} action Action to be called for each child.\n   */\n  forEachImmediateDescendantWithValue(action: (tree: Tree<T>) => void) {\n    this.forEachChild(function(child) {\n      if (child.getValue() !== null) action(child);\n      else child.forEachImmediateDescendantWithValue(action);\n    });\n  }\n\n  /**\n   * @return {!Path} The path of this tree node, as a Path.\n   */\n  path(): Path {\n    return new Path(\n      this.parent_ === null\n        ? this.name_\n        : this.parent_.path() + '/' + this.name_\n    );\n  }\n\n  /**\n   * @return {string} The name of the tree node.\n   */\n  name(): string {\n    return this.name_;\n  }\n\n  /**\n   * @return {?Tree} The parent tree node, or null if this is the root of the tree.\n   */\n  parent(): Tree<T> | null {\n    return this.parent_;\n  }\n\n  /**\n   * Adds or removes this child from its parent based on whether it's empty or not.\n   *\n   * @private\n   */\n  private updateParents_() {\n    if (this.parent_ !== null) this.parent_.updateChild_(this.name_, this);\n  }\n\n  /**\n   * Adds or removes the passed child to this tree node, depending on whether it's empty.\n   *\n   * @param {string} childName The name of the child to update.\n   * @param {!Tree.<T>} child The child to update.\n   * @private\n   */\n  private updateChild_(childName: string, child: Tree<T>) {\n    const childEmpty = child.isEmpty();\n    const childExists = contains(this.node_.children, childName);\n    if (childEmpty && childExists) {\n      delete this.node_.children[childName];\n      this.node_.childCount--;\n      this.updateParents_();\n    } else if (!childEmpty && !childExists) {\n      this.node_.children[childName] = child.node_;\n      this.node_.childCount++;\n      this.updateParents_();\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assert } from '@firebase/util';\nimport { Reference } from '../api/Reference';\nimport { DataSnapshot } from '../api/DataSnapshot';\nimport { Path } from './util/Path';\nimport { Tree } from './util/Tree';\nimport { PRIORITY_INDEX } from './snap/indexes/PriorityIndex';\nimport { Node } from './snap/Node';\nimport { LUIDGenerator, warn, exceptionGuard } from './util/util';\nimport { resolveDeferredValueSnapshot } from './util/ServerValues';\nimport { isValidPriority, validateFirebaseData } from './util/validation';\nimport { contains, safeGet } from '@firebase/util';\nimport { nodeFromJSON } from './snap/nodeFromJSON';\nimport { ChildrenNode } from './snap/ChildrenNode';\nimport { Repo } from './Repo';\nimport { Event } from './view/Event';\n\n// TODO: This is pretty messy.  Ideally, a lot of this would move into FirebaseData, or a transaction-specific\n// component used by FirebaseData, but it has ties to user callbacks (transaction update and onComplete) as well\n// as the realtime connection (to send transactions to the server).  So that all needs to be decoupled first.\n// For now it's part of Repo, but in its own file.\n\n/**\n * @enum {number}\n */\nexport enum TransactionStatus {\n  // We've run the transaction and updated transactionResultData_ with the result, but it isn't currently sent to the\n  // server. A transaction will go from RUN -> SENT -> RUN if it comes back from the server as rejected due to\n  // mismatched hash.\n  RUN,\n\n  // We've run the transaction and sent it to the server and it's currently outstanding (hasn't come back as accepted\n  // or rejected yet).\n  SENT,\n\n  // Temporary state used to mark completed transactions (whether successful or aborted).  The transaction will be\n  // removed when we get a chance to prune completed ones.\n  COMPLETED,\n\n  // Used when an already-sent transaction needs to be aborted (e.g. due to a conflicting set() call that was made).\n  // If it comes back as unsuccessful, we'll abort it.\n  SENT_NEEDS_ABORT,\n\n  // Temporary state used to mark transactions that need to be aborted.\n  NEEDS_ABORT\n}\n\n/**\n * If a transaction does not succeed after 25 retries, we abort it.  Among other things this ensure that if there's\n * ever a bug causing a mismatch between client / server hashes for some data, we won't retry indefinitely.\n * @type {number}\n * @const\n * @private\n */\n(Repo as any).MAX_TRANSACTION_RETRIES_ = 25;\n\n/**\n * @typedef {{\n *   path: !Path,\n *   update: function(*):*,\n *   onComplete: ?function(?Error, boolean, ?DataSnapshot),\n *   status: ?TransactionStatus,\n *   order: !number,\n *   applyLocally: boolean,\n *   retryCount: !number,\n *   unwatcher: function(),\n *   abortReason: ?string,\n *   currentWriteId: !number,\n *   currentInputSnapshot: ?Node,\n *   currentOutputSnapshotRaw: ?Node,\n *   currentOutputSnapshotResolved: ?Node\n * }}\n */\ntype Transaction = {\n  path: Path;\n  update: (a: any) => any;\n  onComplete: (a: Error | null, b: boolean, c: DataSnapshot | null) => void;\n  status: TransactionStatus;\n  order: number;\n  applyLocally: boolean;\n  retryCount: number;\n  unwatcher: () => void;\n  abortReason: string | null;\n  currentWriteId: number;\n  currentInputSnapshot: Node | null;\n  currentOutputSnapshotRaw: Node | null;\n  currentOutputSnapshotResolved: Node | null;\n};\n\n/**\n * Setup the transaction data structures\n * @private\n */\n(Repo.prototype as any).transactions_init_ = function() {\n  /**\n   * Stores queues of outstanding transactions for Firebase locations.\n   *\n   * @type {!Tree.<Array.<!Transaction>>}\n   * @private\n   */\n  this.transactionQueueTree_ = new Tree<Transaction[]>();\n};\n\ndeclare module './Repo' {\n  interface Repo {\n    startTransaction(\n      path: Path,\n      transactionUpdate: (a: any) => void,\n      onComplete: ((a: Error, b: boolean, c: DataSnapshot) => void) | null,\n      applyLocally: boolean\n    ): void;\n  }\n}\n\n/**\n * Creates a new transaction, adds it to the transactions we're tracking, and sends it to the server if possible.\n *\n * @param {!Path} path Path at which to do transaction.\n * @param {function(*):*} transactionUpdate Update callback.\n * @param {?function(?Error, boolean, ?DataSnapshot)} onComplete Completion callback.\n * @param {boolean} applyLocally Whether or not to make intermediate results visible\n */\nRepo.prototype.startTransaction = function(\n  path: Path,\n  transactionUpdate: (a: any) => any,\n  onComplete: ((a: Error, b: boolean, c: DataSnapshot) => void) | null,\n  applyLocally: boolean\n) {\n  this.log_('transaction on ' + path);\n\n  // Add a watch to make sure we get server updates.\n  const valueCallback = function() {};\n  const watchRef = new Reference(this, path);\n  watchRef.on('value', valueCallback);\n  const unwatcher = function() {\n    watchRef.off('value', valueCallback);\n  };\n\n  // Initialize transaction.\n  const transaction: Transaction = {\n    path,\n    update: transactionUpdate,\n    onComplete,\n\n    // One of TransactionStatus enums.\n    status: null,\n\n    // Used when combining transactions at different locations to figure out which one goes first.\n    order: LUIDGenerator(),\n\n    // Whether to raise local events for this transaction.\n    applyLocally: applyLocally,\n\n    // Count of how many times we've retried the transaction.\n    retryCount: 0,\n\n    // Function to call to clean up our .on() listener.\n    unwatcher,\n\n    // Stores why a transaction was aborted.\n    abortReason: null,\n\n    currentWriteId: null,\n\n    currentInputSnapshot: null,\n\n    currentOutputSnapshotRaw: null,\n\n    currentOutputSnapshotResolved: null\n  };\n\n  // Run transaction initially.\n  const currentState = this.getLatestState_(path);\n  transaction.currentInputSnapshot = currentState;\n  const newVal = transaction.update(currentState.val());\n  if (newVal === undefined) {\n    // Abort transaction.\n    transaction.unwatcher();\n    transaction.currentOutputSnapshotRaw = null;\n    transaction.currentOutputSnapshotResolved = null;\n    if (transaction.onComplete) {\n      // We just set the input snapshot, so this cast should be safe\n      const snapshot = new DataSnapshot(\n        transaction.currentInputSnapshot,\n        new Reference(this, transaction.path),\n        PRIORITY_INDEX\n      );\n      transaction.onComplete(null, false, snapshot);\n    }\n  } else {\n    validateFirebaseData(\n      'transaction failed: Data returned ',\n      newVal,\n      transaction.path\n    );\n\n    // Mark as run and add to our queue.\n    transaction.status = TransactionStatus.RUN;\n    const queueNode = this.transactionQueueTree_.subTree(path);\n    const nodeQueue = queueNode.getValue() || [];\n    nodeQueue.push(transaction);\n\n    queueNode.setValue(nodeQueue);\n\n    // Update visibleData and raise events\n    // Note: We intentionally raise events after updating all of our transaction state, since the user could\n    // start new transactions from the event callbacks.\n    let priorityForNode;\n    if (\n      typeof newVal === 'object' &&\n      newVal !== null &&\n      contains(newVal, '.priority')\n    ) {\n      priorityForNode = safeGet(newVal, '.priority');\n      assert(\n        isValidPriority(priorityForNode),\n        'Invalid priority returned by transaction. ' +\n          'Priority must be a valid string, finite number, server value, or null.'\n      );\n    } else {\n      const currentNode =\n        this.serverSyncTree_.calcCompleteEventCache(path) ||\n        ChildrenNode.EMPTY_NODE;\n      priorityForNode = currentNode.getPriority().val();\n    }\n    priorityForNode /** @type {null|number|string} */ = priorityForNode;\n\n    const serverValues = this.generateServerValues();\n    const newNodeUnresolved = nodeFromJSON(newVal, priorityForNode);\n    const newNode = resolveDeferredValueSnapshot(\n      newNodeUnresolved,\n      currentState,\n      serverValues\n    );\n    transaction.currentOutputSnapshotRaw = newNodeUnresolved;\n    transaction.currentOutputSnapshotResolved = newNode;\n    transaction.currentWriteId = this.getNextWriteId_();\n\n    const events = this.serverSyncTree_.applyUserOverwrite(\n      path,\n      newNode,\n      transaction.currentWriteId,\n      transaction.applyLocally\n    );\n    this.eventQueue_.raiseEventsForChangedPath(path, events);\n\n    this.sendReadyTransactions_();\n  }\n};\n\n/**\n * @param {!Path} path\n * @param {Array.<number>=} excludeSets A specific set to exclude\n * @return {Node}\n * @private\n */\n(Repo.prototype as any).getLatestState_ = function(\n  path: Path,\n  excludeSets?: number[]\n): Node {\n  return (\n    this.serverSyncTree_.calcCompleteEventCache(path, excludeSets) ||\n    ChildrenNode.EMPTY_NODE\n  );\n};\n\n/**\n * Sends any already-run transactions that aren't waiting for outstanding transactions to\n * complete.\n *\n * Externally it's called with no arguments, but it calls itself recursively with a particular\n * transactionQueueTree node to recurse through the tree.\n *\n * @param {Tree.<Array.<Transaction>>=} node  transactionQueueTree node to start at.\n * @private\n */\n(Repo.prototype as any).sendReadyTransactions_ = function(\n  node: Tree<Transaction[]> = this.transactionQueueTree_\n) {\n  // Before recursing, make sure any completed transactions are removed.\n  if (!node) {\n    this.pruneCompletedTransactionsBelowNode_(node);\n  }\n\n  if (node.getValue() !== null) {\n    const queue = this.buildTransactionQueue_(node);\n    assert(queue.length > 0, 'Sending zero length transaction queue');\n\n    const allRun = queue.every(\n      (transaction: Transaction) => transaction.status === TransactionStatus.RUN\n    );\n\n    // If they're all run (and not sent), we can send them.  Else, we must wait.\n    if (allRun) {\n      this.sendTransactionQueue_(node.path(), queue);\n    }\n  } else if (node.hasChildren()) {\n    node.forEachChild(childNode => {\n      this.sendReadyTransactions_(childNode);\n    });\n  }\n};\n\n/**\n * Given a list of run transactions, send them to the server and then handle the result (success or failure).\n *\n * @param {!Path} path The location of the queue.\n * @param {!Array.<Transaction>} queue Queue of transactions under the specified location.\n * @private\n */\n(Repo.prototype as any).sendTransactionQueue_ = function(\n  path: Path,\n  queue: Array<Transaction>\n) {\n  // Mark transactions as sent and increment retry count!\n  const setsToIgnore = queue.map(function(txn) {\n    return txn.currentWriteId;\n  });\n  const latestState = this.getLatestState_(path, setsToIgnore);\n  let snapToSend = latestState;\n  const latestHash = latestState.hash();\n  for (let i = 0; i < queue.length; i++) {\n    const txn = queue[i];\n    assert(\n      txn.status === TransactionStatus.RUN,\n      'tryToSendTransactionQueue_: items in queue should all be run.'\n    );\n    txn.status = TransactionStatus.SENT;\n    txn.retryCount++;\n    const relativePath = Path.relativePath(path, txn.path);\n    // If we've gotten to this point, the output snapshot must be defined.\n    snapToSend = snapToSend.updateChild(\n      relativePath /**@type {!Node} */,\n      txn.currentOutputSnapshotRaw\n    );\n  }\n\n  const dataToSend = snapToSend.val(true);\n  const pathToSend = path;\n\n  // Send the put.\n  this.server_.put(\n    pathToSend.toString(),\n    dataToSend,\n    (status: string) => {\n      this.log_('transaction put response', {\n        path: pathToSend.toString(),\n        status\n      });\n\n      let events: Event[] = [];\n      if (status === 'ok') {\n        // Queue up the callbacks and fire them after cleaning up all of our transaction state, since\n        // the callback could trigger more transactions or sets.\n        const callbacks = [];\n        for (let i = 0; i < queue.length; i++) {\n          queue[i].status = TransactionStatus.COMPLETED;\n          events = events.concat(\n            this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId)\n          );\n          if (queue[i].onComplete) {\n            // We never unset the output snapshot, and given that this transaction is complete, it should be set\n            const node = queue[i].currentOutputSnapshotResolved as Node;\n            const ref = new Reference(this, queue[i].path);\n            const snapshot = new DataSnapshot(node, ref, PRIORITY_INDEX);\n            callbacks.push(\n              queue[i].onComplete.bind(null, null, true, snapshot)\n            );\n          }\n          queue[i].unwatcher();\n        }\n\n        // Now remove the completed transactions.\n        this.pruneCompletedTransactionsBelowNode_(\n          this.transactionQueueTree_.subTree(path)\n        );\n        // There may be pending transactions that we can now send.\n        this.sendReadyTransactions_();\n\n        this.eventQueue_.raiseEventsForChangedPath(path, events);\n\n        // Finally, trigger onComplete callbacks.\n        for (let i = 0; i < callbacks.length; i++) {\n          exceptionGuard(callbacks[i]);\n        }\n      } else {\n        // transactions are no longer sent.  Update their status appropriately.\n        if (status === 'datastale') {\n          for (let i = 0; i < queue.length; i++) {\n            if (queue[i].status === TransactionStatus.SENT_NEEDS_ABORT)\n              queue[i].status = TransactionStatus.NEEDS_ABORT;\n            else queue[i].status = TransactionStatus.RUN;\n          }\n        } else {\n          warn(\n            'transaction at ' + pathToSend.toString() + ' failed: ' + status\n          );\n          for (let i = 0; i < queue.length; i++) {\n            queue[i].status = TransactionStatus.NEEDS_ABORT;\n            queue[i].abortReason = status;\n          }\n        }\n\n        this.rerunTransactions_(path);\n      }\n    },\n    latestHash\n  );\n};\n\n/**\n * Finds all transactions dependent on the data at changedPath and reruns them.\n *\n * Should be called any time cached data changes.\n *\n * Return the highest path that was affected by rerunning transactions.  This is the path at which events need to\n * be raised for.\n *\n * @param {!Path} changedPath The path in mergedData that changed.\n * @return {!Path} The rootmost path that was affected by rerunning transactions.\n * @private\n */\n(Repo.prototype as any).rerunTransactions_ = function(changedPath: Path): Path {\n  const rootMostTransactionNode = this.getAncestorTransactionNode_(changedPath);\n  const path = rootMostTransactionNode.path();\n\n  const queue = this.buildTransactionQueue_(rootMostTransactionNode);\n  this.rerunTransactionQueue_(queue, path);\n\n  return path;\n};\n\n/**\n * Does all the work of rerunning transactions (as well as cleans up aborted transactions and whatnot).\n *\n * @param {Array.<Transaction>} queue The queue of transactions to run.\n * @param {!Path} path The path the queue is for.\n * @private\n */\n(Repo.prototype as any).rerunTransactionQueue_ = function(\n  queue: Array<Transaction>,\n  path: Path\n) {\n  if (queue.length === 0) {\n    return; // Nothing to do!\n  }\n\n  // Queue up the callbacks and fire them after cleaning up all of our transaction state, since\n  // the callback could trigger more transactions or sets.\n  const callbacks = [];\n  let events: Event[] = [];\n  // Ignore all of the sets we're going to re-run.\n  const txnsToRerun = queue.filter(function(q) {\n    return q.status === TransactionStatus.RUN;\n  });\n  const setsToIgnore = txnsToRerun.map(function(q) {\n    return q.currentWriteId;\n  });\n  for (let i = 0; i < queue.length; i++) {\n    const transaction = queue[i];\n    const relativePath = Path.relativePath(path, transaction.path);\n    let abortTransaction = false,\n      abortReason;\n    assert(\n      relativePath !== null,\n      'rerunTransactionsUnderNode_: relativePath should not be null.'\n    );\n\n    if (transaction.status === TransactionStatus.NEEDS_ABORT) {\n      abortTransaction = true;\n      abortReason = transaction.abortReason;\n      events = events.concat(\n        this.serverSyncTree_.ackUserWrite(transaction.currentWriteId, true)\n      );\n    } else if (transaction.status === TransactionStatus.RUN) {\n      if (transaction.retryCount >= (Repo as any).MAX_TRANSACTION_RETRIES_) {\n        abortTransaction = true;\n        abortReason = 'maxretry';\n        events = events.concat(\n          this.serverSyncTree_.ackUserWrite(transaction.currentWriteId, true)\n        );\n      } else {\n        // This code reruns a transaction\n        const currentNode = this.getLatestState_(\n          transaction.path,\n          setsToIgnore\n        );\n        transaction.currentInputSnapshot = currentNode;\n        const newData = queue[i].update(currentNode.val());\n        if (newData !== undefined) {\n          validateFirebaseData(\n            'transaction failed: Data returned ',\n            newData,\n            transaction.path\n          );\n          let newDataNode = nodeFromJSON(newData);\n          const hasExplicitPriority =\n            typeof newData === 'object' &&\n            newData != null &&\n            contains(newData, '.priority');\n          if (!hasExplicitPriority) {\n            // Keep the old priority if there wasn't a priority explicitly specified.\n            newDataNode = newDataNode.updatePriority(currentNode.getPriority());\n          }\n\n          const oldWriteId = transaction.currentWriteId;\n          const serverValues = this.generateServerValues();\n          const newNodeResolved = resolveDeferredValueSnapshot(\n            newDataNode,\n            currentNode,\n            serverValues\n          );\n\n          transaction.currentOutputSnapshotRaw = newDataNode;\n          transaction.currentOutputSnapshotResolved = newNodeResolved;\n          transaction.currentWriteId = this.getNextWriteId_();\n          // Mutates setsToIgnore in place\n          setsToIgnore.splice(setsToIgnore.indexOf(oldWriteId), 1);\n          events = events.concat(\n            this.serverSyncTree_.applyUserOverwrite(\n              transaction.path,\n              newNodeResolved,\n              transaction.currentWriteId,\n              transaction.applyLocally\n            )\n          );\n          events = events.concat(\n            this.serverSyncTree_.ackUserWrite(oldWriteId, true)\n          );\n        } else {\n          abortTransaction = true;\n          abortReason = 'nodata';\n          events = events.concat(\n            this.serverSyncTree_.ackUserWrite(transaction.currentWriteId, true)\n          );\n        }\n      }\n    }\n    this.eventQueue_.raiseEventsForChangedPath(path, events);\n    events = [];\n    if (abortTransaction) {\n      // Abort.\n      queue[i].status = TransactionStatus.COMPLETED;\n\n      // Removing a listener can trigger pruning which can muck with mergedData/visibleData (as it prunes data).\n      // So defer the unwatcher until we're done.\n      (function(unwatcher) {\n        setTimeout(unwatcher, Math.floor(0));\n      })(queue[i].unwatcher);\n\n      if (queue[i].onComplete) {\n        if (abortReason === 'nodata') {\n          const ref = new Reference(this, queue[i].path);\n          // We set this field immediately, so it's safe to cast to an actual snapshot\n          const lastInput /** @type {!Node} */ = queue[i].currentInputSnapshot;\n          const snapshot = new DataSnapshot(lastInput, ref, PRIORITY_INDEX);\n          callbacks.push(queue[i].onComplete.bind(null, null, false, snapshot));\n        } else {\n          callbacks.push(\n            queue[i].onComplete.bind(null, new Error(abortReason), false, null)\n          );\n        }\n      }\n    }\n  }\n\n  // Clean up completed transactions.\n  this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);\n\n  // Now fire callbacks, now that we're in a good, known state.\n  for (let i = 0; i < callbacks.length; i++) {\n    exceptionGuard(callbacks[i]);\n  }\n\n  // Try to send the transaction result to the server.\n  this.sendReadyTransactions_();\n};\n\n/**\n * Returns the rootmost ancestor node of the specified path that has a pending transaction on it, or just returns\n * the node for the given path if there are no pending transactions on any ancestor.\n *\n * @param {!Path} path The location to start at.\n * @return {!Tree.<Array.<!Transaction>>} The rootmost node with a transaction.\n * @private\n */\n(Repo.prototype as any).getAncestorTransactionNode_ = function(\n  path: Path\n): Tree<Transaction[]> {\n  let front;\n\n  // Start at the root and walk deeper into the tree towards path until we find a node with pending transactions.\n  let transactionNode = this.transactionQueueTree_;\n  while (\n    (front = path.getFront()) !== null &&\n    transactionNode.getValue() === null\n  ) {\n    transactionNode = transactionNode.subTree(front);\n    path = path.popFront();\n  }\n\n  return transactionNode;\n};\n\n/**\n * Builds the queue of all transactions at or below the specified transactionNode.\n *\n * @param {!Tree.<Array.<Transaction>>} transactionNode\n * @return {Array.<Transaction>} The generated queue.\n * @private\n */\n(Repo.prototype as any).buildTransactionQueue_ = function(\n  transactionNode: Tree<Transaction[]>\n): Array<Transaction> {\n  // Walk any child transaction queues and aggregate them into a single queue.\n  const transactionQueue: Transaction[] = [];\n  this.aggregateTransactionQueuesForNode_(transactionNode, transactionQueue);\n\n  // Sort them by the order the transactions were created.\n  transactionQueue.sort(function(a, b) {\n    return a.order - b.order;\n  });\n\n  return transactionQueue;\n};\n\n/**\n * @param {!Tree.<Array.<Transaction>>} node\n * @param {Array.<Transaction>} queue\n * @private\n */\n(Repo.prototype as any).aggregateTransactionQueuesForNode_ = function(\n  node: Tree<Transaction[]>,\n  queue: Array<Transaction>\n) {\n  const nodeQueue = node.getValue();\n  if (nodeQueue !== null) {\n    for (let i = 0; i < nodeQueue.length; i++) {\n      queue.push(nodeQueue[i]);\n    }\n  }\n\n  node.forEachChild(child => {\n    this.aggregateTransactionQueuesForNode_(child, queue);\n  });\n};\n\n/**\n * Remove COMPLETED transactions at or below this node in the transactionQueueTree_.\n *\n * @param {!Tree.<Array.<!Transaction>>} node\n * @private\n */\n(Repo.prototype as any).pruneCompletedTransactionsBelowNode_ = function(\n  node: Tree<Transaction[]>\n) {\n  const queue = node.getValue();\n  if (queue) {\n    let to = 0;\n    for (let from = 0; from < queue.length; from++) {\n      if (queue[from].status !== TransactionStatus.COMPLETED) {\n        queue[to] = queue[from];\n        to++;\n      }\n    }\n    queue.length = to;\n    node.setValue(queue.length > 0 ? queue : null);\n  }\n\n  node.forEachChild(childNode => {\n    this.pruneCompletedTransactionsBelowNode_(childNode);\n  });\n};\n\n/**\n * Aborts all transactions on ancestors or descendants of the specified path.  Called when doing a set() or update()\n * since we consider them incompatible with transactions.\n *\n * @param {!Path} path Path for which we want to abort related transactions.\n * @return {!Path}\n * @private\n */\n(Repo.prototype as any).abortTransactions_ = function(path: Path): Path {\n  const affectedPath = this.getAncestorTransactionNode_(path).path();\n\n  const transactionNode = this.transactionQueueTree_.subTree(path);\n\n  transactionNode.forEachAncestor((node: Tree<Transaction[]>) => {\n    this.abortTransactionsOnNode_(node);\n  });\n\n  this.abortTransactionsOnNode_(transactionNode);\n\n  transactionNode.forEachDescendant((node: Tree<Transaction[]>) => {\n    this.abortTransactionsOnNode_(node);\n  });\n\n  return affectedPath;\n};\n\n/**\n * Abort transactions stored in this transaction queue node.\n *\n * @param {!Tree.<Array.<Transaction>>} node Node to abort transactions for.\n * @private\n */\n(Repo.prototype as any).abortTransactionsOnNode_ = function(\n  node: Tree<Transaction[]>\n) {\n  const queue = node.getValue();\n  if (queue !== null) {\n    // Queue up the callbacks and fire them after cleaning up all of our transaction state, since\n    // the callback could trigger more transactions or sets.\n    const callbacks = [];\n\n    // Go through queue.  Any already-sent transactions must be marked for abort, while the unsent ones\n    // can be immediately aborted and removed.\n    let events: Event[] = [];\n    let lastSent = -1;\n    for (let i = 0; i < queue.length; i++) {\n      if (queue[i].status === TransactionStatus.SENT_NEEDS_ABORT) {\n        // Already marked.  No action needed.\n      } else if (queue[i].status === TransactionStatus.SENT) {\n        assert(\n          lastSent === i - 1,\n          'All SENT items should be at beginning of queue.'\n        );\n        lastSent = i;\n        // Mark transaction for abort when it comes back.\n        queue[i].status = TransactionStatus.SENT_NEEDS_ABORT;\n        queue[i].abortReason = 'set';\n      } else {\n        assert(\n          queue[i].status === TransactionStatus.RUN,\n          'Unexpected transaction status in abort'\n        );\n        // We can abort it immediately.\n        queue[i].unwatcher();\n        events = events.concat(\n          this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId, true)\n        );\n        if (queue[i].onComplete) {\n          const snapshot: DataSnapshot | null = null;\n          callbacks.push(\n            queue[i].onComplete.bind(null, new Error('set'), false, snapshot)\n          );\n        }\n      }\n    }\n    if (lastSent === -1) {\n      // We're not waiting for any sent transactions.  We can clear the queue.\n      node.setValue(null);\n    } else {\n      // Remove the transactions we aborted.\n      queue.length = lastSent + 1;\n    }\n\n    // Now fire the callbacks.\n    this.eventQueue_.raiseEventsForChangedPath(node.path(), events);\n    for (let i = 0; i < callbacks.length; i++) {\n      exceptionGuard(callbacks[i]);\n    }\n  }\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FirebaseApp } from '@firebase/app-types';\nimport { safeGet } from '@firebase/util';\nimport { Repo } from './Repo';\nimport { fatal } from './util/util';\nimport { parseRepoInfo } from './util/libs/parser';\nimport { validateUrl } from './util/validation';\nimport './Repo_transaction';\nimport { Database } from '../api/Database';\nimport { RepoInfo } from './RepoInfo';\nimport { FirebaseAuthInternalName } from '@firebase/auth-interop-types';\nimport { Provider } from '@firebase/component';\n\n/** @const {string} */\nconst DATABASE_URL_OPTION = 'databaseURL';\n\n/**\n * This variable is also defined in the firebase node.js admin SDK. Before\n * modifying this definition, consult the definition in:\n *\n * https://github.com/firebase/firebase-admin-node\n *\n * and make sure the two are consistent.\n */\nconst FIREBASE_DATABASE_EMULATOR_HOST_VAR = 'FIREBASE_DATABASE_EMULATOR_HOST';\n\nlet _staticInstance: RepoManager;\n\n/**\n * Creates and caches Repo instances.\n */\nexport class RepoManager {\n  /**\n   * @private {!Object.<string, Object<string, !fb.core.Repo>>}\n   */\n  private repos_: {\n    [appName: string]: {\n      [dbUrl: string]: Repo;\n    };\n  } = {};\n\n  /**\n   * If true, new Repos will be created to use ReadonlyRestClient (for testing purposes).\n   * @private {boolean}\n   */\n  private useRestClient_: boolean = false;\n\n  static getInstance(): RepoManager {\n    if (!_staticInstance) {\n      _staticInstance = new RepoManager();\n    }\n    return _staticInstance;\n  }\n\n  // TODO(koss): Remove these functions unless used in tests?\n  interrupt() {\n    for (const appName in this.repos_) {\n      for (const dbUrl in this.repos_[appName]) {\n        this.repos_[appName][dbUrl].interrupt();\n      }\n    }\n  }\n\n  resume() {\n    for (const appName in this.repos_) {\n      for (const dbUrl in this.repos_[appName]) {\n        this.repos_[appName][dbUrl].resume();\n      }\n    }\n  }\n\n  /**\n   * This function should only ever be called to CREATE a new database instance.\n   *\n   * @param {!FirebaseApp} app\n   * @return {!Database}\n   */\n  databaseFromApp(\n    app: FirebaseApp,\n    authProvider: Provider<FirebaseAuthInternalName>,\n    url?: string\n  ): Database {\n    let dbUrl: string | undefined = url || app.options[DATABASE_URL_OPTION];\n    if (dbUrl === undefined) {\n      fatal(\n        \"Can't determine Firebase Database URL.  Be sure to include \" +\n          DATABASE_URL_OPTION +\n          ' option when calling firebase.initializeApp().'\n      );\n    }\n\n    let parsedUrl = parseRepoInfo(dbUrl);\n    let repoInfo = parsedUrl.repoInfo;\n\n    let dbEmulatorHost: string | undefined = undefined;\n    if (typeof process !== 'undefined') {\n      dbEmulatorHost = process.env[FIREBASE_DATABASE_EMULATOR_HOST_VAR];\n    }\n    if (dbEmulatorHost) {\n      dbUrl = `http://${dbEmulatorHost}?ns=${repoInfo.namespace}`;\n      parsedUrl = parseRepoInfo(dbUrl);\n      repoInfo = parsedUrl.repoInfo;\n    }\n\n    validateUrl('Invalid Firebase Database URL', 1, parsedUrl);\n    if (!parsedUrl.path.isEmpty()) {\n      fatal(\n        'Database URL must point to the root of a Firebase Database ' +\n          '(not including a child path).'\n      );\n    }\n\n    const repo = this.createRepo(repoInfo, app, authProvider);\n\n    return repo.database;\n  }\n\n  /**\n   * Remove the repo and make sure it is disconnected.\n   *\n   * @param {!Repo} repo\n   */\n  deleteRepo(repo: Repo) {\n    const appRepos = safeGet(this.repos_, repo.app.name);\n    // This should never happen...\n    if (!appRepos || safeGet(appRepos, repo.repoInfo_.toURLString()) !== repo) {\n      fatal(\n        `Database ${repo.app.name}(${repo.repoInfo_}) has already been deleted.`\n      );\n    }\n    repo.interrupt();\n    delete appRepos[repo.repoInfo_.toURLString()];\n  }\n\n  /**\n   * Ensures a repo doesn't already exist and then creates one using the\n   * provided app.\n   *\n   * @param {!RepoInfo} repoInfo The metadata about the Repo\n   * @param {!FirebaseApp} app\n   * @return {!Repo} The Repo object for the specified server / repoName.\n   */\n  createRepo(\n    repoInfo: RepoInfo,\n    app: FirebaseApp,\n    authProvider: Provider<FirebaseAuthInternalName>\n  ): Repo {\n    let appRepos = safeGet(this.repos_, app.name);\n\n    if (!appRepos) {\n      appRepos = {};\n      this.repos_[app.name] = appRepos;\n    }\n\n    let repo = safeGet(appRepos, repoInfo.toURLString());\n    if (repo) {\n      fatal(\n        'Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.'\n      );\n    }\n    repo = new Repo(repoInfo, this.useRestClient_, app, authProvider);\n    appRepos[repoInfo.toURLString()] = repo;\n\n    return repo;\n  }\n\n  /**\n   * Forces us to use ReadonlyRestClient instead of PersistentConnection for new Repos.\n   * @param {boolean} forceRestClient\n   */\n  forceRestClient(forceRestClient: boolean) {\n    this.useRestClient_ = forceRestClient;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { fatal } from '../core/util/util';\nimport { parseRepoInfo } from '../core/util/libs/parser';\nimport { Path } from '../core/util/Path';\nimport { Reference } from './Reference';\nimport { Repo } from '../core/Repo';\nimport { RepoManager } from '../core/RepoManager';\nimport { validateArgCount } from '@firebase/util';\nimport { validateUrl } from '../core/util/validation';\nimport { FirebaseApp } from '@firebase/app-types';\nimport { FirebaseService } from '@firebase/app-types/private';\nimport { RepoInfo } from '../core/RepoInfo';\nimport { FirebaseDatabase } from '@firebase/database-types';\n\n/**\n * Class representing a firebase database.\n * @implements {FirebaseService}\n */\nexport class Database implements FirebaseService, FirebaseDatabase {\n  INTERNAL: DatabaseInternals;\n  private root_: Reference;\n\n  static readonly ServerValue = {\n    TIMESTAMP: {\n      '.sv': 'timestamp'\n    },\n    _increment: (x: number) => {\n      return {\n        '.sv': {\n          'increment': x\n        }\n      };\n    }\n  };\n\n  /**\n   * The constructor should not be called by users of our public API.\n   * @param {!Repo} repo_\n   */\n  constructor(private repo_: Repo) {\n    if (!(repo_ instanceof Repo)) {\n      fatal(\n        \"Don't call new Database() directly - please use firebase.database().\"\n      );\n    }\n\n    /** @type {Reference} */\n    this.root_ = new Reference(repo_, Path.Empty);\n\n    this.INTERNAL = new DatabaseInternals(this);\n  }\n\n  get app(): FirebaseApp {\n    return this.repo_.app;\n  }\n\n  /**\n   * Returns a reference to the root or to the path specified in the provided\n   * argument.\n\n   * @param {string|Reference=} path The relative string path or an existing\n   * Reference to a database location.\n   * @throws If a Reference is provided, throws if it does not belong to the\n   * same project.\n   * @return {!Reference} Firebase reference.\n   **/\n  ref(path?: string): Reference;\n  ref(path?: Reference): Reference;\n  ref(path?: string | Reference): Reference {\n    this.checkDeleted_('ref');\n    validateArgCount('database.ref', 0, 1, arguments.length);\n\n    if (path instanceof Reference) {\n      return this.refFromURL(path.toString());\n    }\n\n    return path !== undefined ? this.root_.child(path) : this.root_;\n  }\n\n  /**\n   * Returns a reference to the root or the path specified in url.\n   * We throw a exception if the url is not in the same domain as the\n   * current repo.\n   * @param {string} url\n   * @return {!Reference} Firebase reference.\n   */\n  refFromURL(url: string): Reference {\n    /** @const {string} */\n    const apiName = 'database.refFromURL';\n    this.checkDeleted_(apiName);\n    validateArgCount(apiName, 1, 1, arguments.length);\n    const parsedURL = parseRepoInfo(url);\n    validateUrl(apiName, 1, parsedURL);\n\n    const repoInfo = parsedURL.repoInfo;\n    if (repoInfo.host !== ((this.repo_ as any).repoInfo_ as RepoInfo).host) {\n      fatal(\n        apiName +\n          ': Host name does not match the current database: ' +\n          '(found ' +\n          repoInfo.host +\n          ' but expected ' +\n          ((this.repo_ as any).repoInfo_ as RepoInfo).host +\n          ')'\n      );\n    }\n\n    return this.ref(parsedURL.path.toString());\n  }\n\n  /**\n   * @param {string} apiName\n   */\n  private checkDeleted_(apiName: string) {\n    if (this.repo_ === null) {\n      fatal('Cannot call ' + apiName + ' on a deleted database.');\n    }\n  }\n\n  // Make individual repo go offline.\n  goOffline() {\n    validateArgCount('database.goOffline', 0, 0, arguments.length);\n    this.checkDeleted_('goOffline');\n    this.repo_.interrupt();\n  }\n\n  goOnline() {\n    validateArgCount('database.goOnline', 0, 0, arguments.length);\n    this.checkDeleted_('goOnline');\n    this.repo_.resume();\n  }\n}\n\nexport class DatabaseInternals {\n  /** @param {!Database} database */\n  constructor(public database: Database) {}\n\n  /** @return {Promise<void>} */\n  async delete(): Promise<void> {\n    (this.database as any).checkDeleted_('delete');\n    RepoManager.getInstance().deleteRepo((this.database as any).repo_ as Repo);\n\n    (this.database as any).repo_ = null;\n    (this.database as any).root_ = null;\n    this.database.INTERNAL = null;\n    this.database = null;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { WebSocketConnection } from '../realtime/WebSocketConnection';\nimport { BrowserPollConnection } from '../realtime/BrowserPollConnection';\nimport { Reference } from './Reference';\n\n/**\n * INTERNAL methods for internal-use only (tests, etc.).\n *\n * Customers shouldn't use these or else should be aware that they could break at any time.\n *\n * @const\n */\n\nexport const forceLongPolling = function() {\n  WebSocketConnection.forceDisallow();\n  BrowserPollConnection.forceAllow();\n};\n\nexport const forceWebSockets = function() {\n  BrowserPollConnection.forceDisallow();\n};\n\n/* Used by App Manager */\nexport const isWebSocketsAvailable = function(): boolean {\n  return WebSocketConnection['isAvailable']();\n};\n\nexport const setSecurityDebugCallback = function(\n  ref: Reference,\n  callback: (a: Object) => void\n) {\n  (ref.repo.persistentConnection_ as any).securityDebugCallback_ = callback;\n};\n\nexport const stats = function(ref: Reference, showDelta?: boolean) {\n  ref.repo.stats(showDelta);\n};\n\nexport const statsIncrementCounter = function(ref: Reference, metric: string) {\n  ref.repo.statsIncrementCounter(metric);\n};\n\nexport const dataUpdateCount = function(ref: Reference): number {\n  return ref.repo.dataUpdateCount;\n};\n\nexport const interceptServerData = function(\n  ref: Reference,\n  callback: ((a: string, b: any) => void) | null\n) {\n  return ref.repo.interceptServerData_(callback);\n};\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { RepoInfo } from '../core/RepoInfo';\nimport { PersistentConnection } from '../core/PersistentConnection';\nimport { RepoManager } from '../core/RepoManager';\nimport { Connection } from '../realtime/Connection';\nimport { Query } from './Query';\n\nexport const DataConnection = PersistentConnection;\n\n/**\n * @param {!string} pathString\n * @param {function(*)} onComplete\n */\n(PersistentConnection.prototype as any).simpleListen = function(\n  pathString: string,\n  onComplete: (a: any) => void\n) {\n  this.sendRequest('q', { p: pathString }, onComplete);\n};\n\n/**\n * @param {*} data\n * @param {function(*)} onEcho\n */\n(PersistentConnection.prototype as any).echo = function(\n  data: any,\n  onEcho: (a: any) => void\n) {\n  this.sendRequest('echo', { d: data }, onEcho);\n};\n\n// RealTimeConnection properties that we use in tests.\nexport const RealTimeConnection = Connection;\n\n/**\n * @param {function(): string} newHash\n * @return {function()}\n */\nexport const hijackHash = function(newHash: () => string) {\n  const oldPut = PersistentConnection.prototype.put;\n  PersistentConnection.prototype.put = function(\n    pathString,\n    data,\n    opt_onComplete,\n    opt_hash\n  ) {\n    if (opt_hash !== undefined) {\n      opt_hash = newHash();\n    }\n    oldPut.call(this, pathString, data, opt_onComplete, opt_hash);\n  };\n  return function() {\n    PersistentConnection.prototype.put = oldPut;\n  };\n};\n\n/**\n * @type {function(new:RepoInfo, !string, boolean, !string, boolean): undefined}\n */\nexport const ConnectionTarget = RepoInfo;\n\n/**\n * @param {!Query} query\n * @return {!string}\n */\nexport const queryIdentifier = function(query: Query) {\n  return query.queryIdentifier();\n};\n\n/**\n * Forces the RepoManager to create Repos that use ReadonlyRestClient instead of PersistentConnection.\n *\n * @param {boolean} forceRestClient\n */\nexport const forceRestClient = function(forceRestClient: boolean) {\n  RepoManager.getInstance().forceRestClient(forceRestClient);\n};\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","module.exports = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]';\n};\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { CONFIG_STORAGE_BUCKET_KEY } from './constants';\n\nexport class FirebaseStorageError implements Error {\n  private code_: string;\n  private message_: string;\n  private serverResponse_: string | null;\n  private name_: string;\n\n  constructor(code: Code, message: string) {\n    this.code_ = prependCode(code);\n    this.message_ = 'Firebase Storage: ' + message;\n    this.serverResponse_ = null;\n    this.name_ = 'FirebaseError';\n  }\n\n  codeProp(): string {\n    return this.code;\n  }\n\n  codeEquals(code: Code): boolean {\n    return prependCode(code) === this.codeProp();\n  }\n\n  serverResponseProp(): string | null {\n    return this.serverResponse_;\n  }\n\n  setServerResponseProp(serverResponse: string | null): void {\n    this.serverResponse_ = serverResponse;\n  }\n\n  get name(): string {\n    return this.name_;\n  }\n\n  get code(): string {\n    return this.code_;\n  }\n\n  get message(): string {\n    return this.message_;\n  }\n\n  get serverResponse(): null | string {\n    return this.serverResponse_;\n  }\n}\n\nexport const errors = {};\n\n/**\n * @enum {string}\n */\nexport type Code = string;\nexport const Code = {\n  // Shared between all platforms\n  UNKNOWN: 'unknown',\n  OBJECT_NOT_FOUND: 'object-not-found',\n  BUCKET_NOT_FOUND: 'bucket-not-found',\n  PROJECT_NOT_FOUND: 'project-not-found',\n  QUOTA_EXCEEDED: 'quota-exceeded',\n  UNAUTHENTICATED: 'unauthenticated',\n  UNAUTHORIZED: 'unauthorized',\n  RETRY_LIMIT_EXCEEDED: 'retry-limit-exceeded',\n  INVALID_CHECKSUM: 'invalid-checksum',\n  CANCELED: 'canceled',\n  // JS specific\n  INVALID_EVENT_NAME: 'invalid-event-name',\n  INVALID_URL: 'invalid-url',\n  INVALID_DEFAULT_BUCKET: 'invalid-default-bucket',\n  NO_DEFAULT_BUCKET: 'no-default-bucket',\n  CANNOT_SLICE_BLOB: 'cannot-slice-blob',\n  SERVER_FILE_WRONG_SIZE: 'server-file-wrong-size',\n  NO_DOWNLOAD_URL: 'no-download-url',\n  INVALID_ARGUMENT: 'invalid-argument',\n  INVALID_ARGUMENT_COUNT: 'invalid-argument-count',\n  APP_DELETED: 'app-deleted',\n  INVALID_ROOT_OPERATION: 'invalid-root-operation',\n  INVALID_FORMAT: 'invalid-format',\n  INTERNAL_ERROR: 'internal-error'\n};\n\nexport function prependCode(code: Code): string {\n  return 'storage/' + code;\n}\n\nexport function unknown(): FirebaseStorageError {\n  const message =\n    'An unknown error occurred, please check the error payload for ' +\n    'server response.';\n  return new FirebaseStorageError(Code.UNKNOWN, message);\n}\n\nexport function objectNotFound(path: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.OBJECT_NOT_FOUND,\n    \"Object '\" + path + \"' does not exist.\"\n  );\n}\n\nexport function bucketNotFound(bucket: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.BUCKET_NOT_FOUND,\n    \"Bucket '\" + bucket + \"' does not exist.\"\n  );\n}\n\nexport function projectNotFound(project: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.PROJECT_NOT_FOUND,\n    \"Project '\" + project + \"' does not exist.\"\n  );\n}\n\nexport function quotaExceeded(bucket: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.QUOTA_EXCEEDED,\n    \"Quota for bucket '\" +\n      bucket +\n      \"' exceeded, please view quota on \" +\n      'https://firebase.google.com/pricing/.'\n  );\n}\n\nexport function unauthenticated(): FirebaseStorageError {\n  const message =\n    'User is not authenticated, please authenticate using Firebase ' +\n    'Authentication and try again.';\n  return new FirebaseStorageError(Code.UNAUTHENTICATED, message);\n}\n\nexport function unauthorized(path: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.UNAUTHORIZED,\n    \"User does not have permission to access '\" + path + \"'.\"\n  );\n}\n\nexport function retryLimitExceeded(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.RETRY_LIMIT_EXCEEDED,\n    'Max retry time for operation exceeded, please try again.'\n  );\n}\n\nexport function invalidChecksum(\n  path: string,\n  checksum: string,\n  calculated: string\n): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_CHECKSUM,\n    \"Uploaded/downloaded object '\" +\n      path +\n      \"' has checksum '\" +\n      checksum +\n      \"' which does not match '\" +\n      calculated +\n      \"'. Please retry the upload/download.\"\n  );\n}\n\nexport function canceled(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.CANCELED,\n    'User canceled the upload/download.'\n  );\n}\n\nexport function invalidEventName(name: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_EVENT_NAME,\n    \"Invalid event name '\" + name + \"'.\"\n  );\n}\n\nexport function invalidUrl(url: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_URL,\n    \"Invalid URL '\" + url + \"'.\"\n  );\n}\n\nexport function invalidDefaultBucket(bucket: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_DEFAULT_BUCKET,\n    \"Invalid default bucket '\" + bucket + \"'.\"\n  );\n}\n\nexport function noDefaultBucket(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.NO_DEFAULT_BUCKET,\n    'No default bucket ' +\n      \"found. Did you set the '\" +\n      CONFIG_STORAGE_BUCKET_KEY +\n      \"' property when initializing the app?\"\n  );\n}\n\nexport function cannotSliceBlob(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.CANNOT_SLICE_BLOB,\n    'Cannot slice blob for upload. Please retry the upload.'\n  );\n}\n\nexport function serverFileWrongSize(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.SERVER_FILE_WRONG_SIZE,\n    'Server recorded incorrect upload file size, please retry the upload.'\n  );\n}\n\nexport function noDownloadURL(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.NO_DOWNLOAD_URL,\n    'The given file does not have any download URLs.'\n  );\n}\n\nexport function invalidArgument(\n  index: number,\n  fnName: string,\n  message: string\n): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_ARGUMENT,\n    'Invalid argument in `' + fnName + '` at index ' + index + ': ' + message\n  );\n}\n\nexport function invalidArgumentCount(\n  argMin: number,\n  argMax: number,\n  fnName: string,\n  real: number\n): FirebaseStorageError {\n  let countPart;\n  let plural;\n  if (argMin === argMax) {\n    countPart = argMin;\n    plural = argMin === 1 ? 'argument' : 'arguments';\n  } else {\n    countPart = 'between ' + argMin + ' and ' + argMax;\n    plural = 'arguments';\n  }\n  return new FirebaseStorageError(\n    Code.INVALID_ARGUMENT_COUNT,\n    'Invalid argument count in `' +\n      fnName +\n      '`: Expected ' +\n      countPart +\n      ' ' +\n      plural +\n      ', received ' +\n      real +\n      '.'\n  );\n}\n\nexport function appDeleted(): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.APP_DELETED,\n    'The Firebase app was deleted.'\n  );\n}\n\n/**\n * @param name The name of the operation that was invalid.\n */\nexport function invalidRootOperation(name: string): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_ROOT_OPERATION,\n    \"The operation '\" +\n      name +\n      \"' cannot be performed on a root reference, create a non-root \" +\n      \"reference using child, such as .child('file.png').\"\n  );\n}\n\n/**\n * @param format The format that was not valid.\n * @param message A message describing the format violation.\n */\nexport function invalidFormat(\n  format: string,\n  message: string\n): FirebaseStorageError {\n  return new FirebaseStorageError(\n    Code.INVALID_FORMAT,\n    \"String does not match format '\" + format + \"': \" + message\n  );\n}\n\n/**\n * @param message A message describing the internal error.\n */\nexport function internalError(message: string): FirebaseStorageError {\n  throw new FirebaseStorageError(\n    Code.INTERNAL_ERROR,\n    'Internal error: ' + message\n  );\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport * as errorsExports from './error';\n\n/**\n * @enum {string}\n */\nexport type StringFormat = string;\nexport const StringFormat = {\n  RAW: 'raw',\n  BASE64: 'base64',\n  BASE64URL: 'base64url',\n  DATA_URL: 'data_url'\n};\n\nexport function formatValidator(stringFormat: unknown): void {\n  switch (stringFormat) {\n    case StringFormat.RAW:\n    case StringFormat.BASE64:\n    case StringFormat.BASE64URL:\n    case StringFormat.DATA_URL:\n      return;\n    default:\n      throw 'Expected one of the event types: [' +\n        StringFormat.RAW +\n        ', ' +\n        StringFormat.BASE64 +\n        ', ' +\n        StringFormat.BASE64URL +\n        ', ' +\n        StringFormat.DATA_URL +\n        '].';\n  }\n}\n\n/**\n * @struct\n */\nexport class StringData {\n  contentType: string | null;\n\n  constructor(public data: Uint8Array, contentType?: string | null) {\n    this.contentType = contentType || null;\n  }\n}\n\nexport function dataFromString(\n  format: StringFormat,\n  stringData: string\n): StringData {\n  switch (format) {\n    case StringFormat.RAW:\n      return new StringData(utf8Bytes_(stringData));\n    case StringFormat.BASE64:\n    case StringFormat.BASE64URL:\n      return new StringData(base64Bytes_(format, stringData));\n    case StringFormat.DATA_URL:\n      return new StringData(\n        dataURLBytes_(stringData),\n        dataURLContentType_(stringData)\n      );\n    default:\n    // do nothing\n  }\n\n  // assert(false);\n  throw errorsExports.unknown();\n}\n\nexport function utf8Bytes_(value: string): Uint8Array {\n  const b: number[] = [];\n  for (let i = 0; i < value.length; i++) {\n    let c = value.charCodeAt(i);\n    if (c <= 127) {\n      b.push(c);\n    } else {\n      if (c <= 2047) {\n        b.push(192 | (c >> 6), 128 | (c & 63));\n      } else {\n        if ((c & 64512) === 55296) {\n          // The start of a surrogate pair.\n          const valid =\n            i < value.length - 1 && (value.charCodeAt(i + 1) & 64512) === 56320;\n          if (!valid) {\n            // The second surrogate wasn't there.\n            b.push(239, 191, 189);\n          } else {\n            const hi = c;\n            const lo = value.charCodeAt(++i);\n            c = 65536 | ((hi & 1023) << 10) | (lo & 1023);\n            b.push(\n              240 | (c >> 18),\n              128 | ((c >> 12) & 63),\n              128 | ((c >> 6) & 63),\n              128 | (c & 63)\n            );\n          }\n        } else {\n          if ((c & 64512) === 56320) {\n            // Invalid low surrogate.\n            b.push(239, 191, 189);\n          } else {\n            b.push(224 | (c >> 12), 128 | ((c >> 6) & 63), 128 | (c & 63));\n          }\n        }\n      }\n    }\n  }\n  return new Uint8Array(b);\n}\n\nexport function percentEncodedBytes_(value: string): Uint8Array {\n  let decoded;\n  try {\n    decoded = decodeURIComponent(value);\n  } catch (e) {\n    throw errorsExports.invalidFormat(\n      StringFormat.DATA_URL,\n      'Malformed data URL.'\n    );\n  }\n  return utf8Bytes_(decoded);\n}\n\nexport function base64Bytes_(format: StringFormat, value: string): Uint8Array {\n  switch (format) {\n    case StringFormat.BASE64: {\n      const hasMinus = value.indexOf('-') !== -1;\n      const hasUnder = value.indexOf('_') !== -1;\n      if (hasMinus || hasUnder) {\n        const invalidChar = hasMinus ? '-' : '_';\n        throw errorsExports.invalidFormat(\n          format,\n          \"Invalid character '\" +\n            invalidChar +\n            \"' found: is it base64url encoded?\"\n        );\n      }\n      break;\n    }\n    case StringFormat.BASE64URL: {\n      const hasPlus = value.indexOf('+') !== -1;\n      const hasSlash = value.indexOf('/') !== -1;\n      if (hasPlus || hasSlash) {\n        const invalidChar = hasPlus ? '+' : '/';\n        throw errorsExports.invalidFormat(\n          format,\n          \"Invalid character '\" + invalidChar + \"' found: is it base64 encoded?\"\n        );\n      }\n      value = value.replace(/-/g, '+').replace(/_/g, '/');\n      break;\n    }\n    default:\n    // do nothing\n  }\n  let bytes;\n  try {\n    bytes = atob(value);\n  } catch (e) {\n    throw errorsExports.invalidFormat(format, 'Invalid character found');\n  }\n  const array = new Uint8Array(bytes.length);\n  for (let i = 0; i < bytes.length; i++) {\n    array[i] = bytes.charCodeAt(i);\n  }\n  return array;\n}\n\n/**\n * @struct\n */\nclass DataURLParts {\n  base64: boolean = false;\n  contentType: string | null = null;\n  rest: string;\n\n  constructor(dataURL: string) {\n    const matches = dataURL.match(/^data:([^,]+)?,/);\n    if (matches === null) {\n      throw errorsExports.invalidFormat(\n        StringFormat.DATA_URL,\n        \"Must be formatted 'data:[<mediatype>][;base64],<data>\"\n      );\n    }\n    const middle = matches[1] || null;\n    if (middle != null) {\n      this.base64 = endsWith(middle, ';base64');\n      this.contentType = this.base64\n        ? middle.substring(0, middle.length - ';base64'.length)\n        : middle;\n    }\n    this.rest = dataURL.substring(dataURL.indexOf(',') + 1);\n  }\n}\n\nexport function dataURLBytes_(dataUrl: string): Uint8Array {\n  const parts = new DataURLParts(dataUrl);\n  if (parts.base64) {\n    return base64Bytes_(StringFormat.BASE64, parts.rest);\n  } else {\n    return percentEncodedBytes_(parts.rest);\n  }\n}\n\nexport function dataURLContentType_(dataUrl: string): string | null {\n  const parts = new DataURLParts(dataUrl);\n  return parts.contentType;\n}\n\nfunction endsWith(s: string, end: string): boolean {\n  const longEnough = s.length >= end.length;\n  if (!longEnough) {\n    return false;\n  }\n\n  return s.substring(s.length - end.length) === end;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Enumerations used for upload tasks.\n */\n\n/**\n * Enum for task events.\n * @enum {string}\n */\nexport type TaskEvent = string;\nexport const TaskEvent = {\n  /** Triggered whenever the task changes or progress is updated. */\n  STATE_CHANGED: 'state_changed'\n};\n\n/**\n * Internal enum for task state.\n * @enum {string}\n */\nexport type InternalTaskState = string;\nexport const InternalTaskState = {\n  RUNNING: 'running',\n  PAUSING: 'pausing',\n  PAUSED: 'paused',\n  SUCCESS: 'success',\n  CANCELING: 'canceling',\n  CANCELED: 'canceled',\n  ERROR: 'error'\n};\n\n/**\n * External (API-surfaced) enum for task state.\n * @enum {string}\n */\nexport type TaskState = string;\nexport const TaskState = {\n  /** The task is currently transferring data. */\n  RUNNING: 'running',\n  /** The task was paused by the user. */\n  PAUSED: 'paused',\n  /** The task completed successfully. */\n  SUCCESS: 'success',\n  /** The task was canceled. */\n  CANCELED: 'canceled',\n  /** The task failed with an error. */\n  ERROR: 'error'\n};\n\nexport function taskStateFromInternalTaskState(\n  state: InternalTaskState\n): TaskState {\n  switch (state) {\n    case InternalTaskState.RUNNING:\n    case InternalTaskState.PAUSING:\n    case InternalTaskState.CANCELING:\n      return TaskState.RUNNING;\n    case InternalTaskState.PAUSED:\n      return TaskState.PAUSED;\n    case InternalTaskState.SUCCESS:\n      return TaskState.SUCCESS;\n    case InternalTaskState.CANCELED:\n      return TaskState.CANCELED;\n    case InternalTaskState.ERROR:\n      return TaskState.ERROR;\n    default:\n      // TODO(andysoto): assert(false);\n      return TaskState.ERROR;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview A lightweight wrapper around XMLHttpRequest with a\n * goog.net.XhrIo-like interface.\n */\n\nexport interface Headers {\n  [name: string]: string | number;\n}\n\nexport interface XhrIo {\n  send(\n    url: string,\n    method: string,\n    body?: ArrayBufferView | Blob | string | null,\n    headers?: Headers\n  ): Promise<XhrIo>;\n\n  getErrorCode(): ErrorCode;\n\n  getStatus(): number;\n\n  getResponseText(): string;\n\n  /**\n   * Abort the request.\n   */\n  abort(): void;\n\n  getResponseHeader(header: string): string | null;\n\n  addUploadProgressListener(listener: (p1: ProgressEvent) => void): void;\n\n  removeUploadProgressListener(listener: (p1: ProgressEvent) => void): void;\n}\n\n/**\n * @enum{number}\n */\nexport enum ErrorCode {\n  NO_ERROR = 0,\n  NETWORK_ERROR = 1,\n  ABORT = 2\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @return False if the object is undefined or null, true otherwise.\n */\nexport function isDef<T>(p: T | null | undefined): p is T {\n  return p != null;\n}\n\nexport function isJustDef<T>(p: T | null | undefined): p is T | null {\n  return p !== void 0;\n}\n\nexport function isFunction(p: unknown): p is Function {\n  return typeof p === 'function';\n}\n\nexport function isObject(p: unknown): p is { [key: string]: unknown } | null {\n  return typeof p === 'object';\n}\n\nexport function isNonNullObject(p: unknown): p is object {\n  return isObject(p) && p !== null;\n}\n\nexport function isNonArrayObject(p: unknown): boolean {\n  return isObject(p) && !Array.isArray(p);\n}\n\nexport function isString(p: unknown): p is string {\n  return typeof p === 'string' || p instanceof String;\n}\n\nexport function isInteger(p: unknown): p is number {\n  return isNumber(p) && Number.isInteger(p);\n}\n\nexport function isNumber(p: unknown): p is number {\n  return typeof p === 'number' || p instanceof Number;\n}\n\nexport function isNativeBlob(p: unknown): p is Blob {\n  return isNativeBlobDefined() && p instanceof Blob;\n}\n\nexport function isNativeBlobDefined(): boolean {\n  return typeof Blob !== 'undefined';\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport * as errorsExports from './error';\nimport * as type from './type';\nimport { Headers, XhrIo, ErrorCode } from './xhrio';\n\n/**\n * We use this instead of goog.net.XhrIo because goog.net.XhrIo is hyuuuuge and\n * doesn't work in React Native on Android.\n */\nexport class NetworkXhrIo implements XhrIo {\n  private xhr_: XMLHttpRequest;\n  private errorCode_: ErrorCode;\n  private sendPromise_: Promise<XhrIo>;\n  private sent_: boolean = false;\n\n  constructor() {\n    this.xhr_ = new XMLHttpRequest();\n    this.errorCode_ = ErrorCode.NO_ERROR;\n    this.sendPromise_ = new Promise(resolve => {\n      this.xhr_.addEventListener('abort', () => {\n        this.errorCode_ = ErrorCode.ABORT;\n        resolve(this);\n      });\n      this.xhr_.addEventListener('error', () => {\n        this.errorCode_ = ErrorCode.NETWORK_ERROR;\n        resolve(this);\n      });\n      this.xhr_.addEventListener('load', () => {\n        resolve(this);\n      });\n    });\n  }\n\n  /**\n   * @override\n   */\n  send(\n    url: string,\n    method: string,\n    body?: ArrayBufferView | Blob | string | null,\n    headers?: Headers\n  ): Promise<XhrIo> {\n    if (this.sent_) {\n      throw errorsExports.internalError('cannot .send() more than once');\n    }\n    this.sent_ = true;\n    this.xhr_.open(method, url, true);\n    if (type.isDef(headers)) {\n      for (const key in headers) {\n        if (headers.hasOwnProperty(key)) {\n          this.xhr_.setRequestHeader(key, headers[key].toString());\n        }\n      }\n    }\n    if (type.isDef(body)) {\n      this.xhr_.send(body);\n    } else {\n      this.xhr_.send();\n    }\n    return this.sendPromise_;\n  }\n\n  /**\n   * @override\n   */\n  getErrorCode(): ErrorCode {\n    if (!this.sent_) {\n      throw errorsExports.internalError(\n        'cannot .getErrorCode() before sending'\n      );\n    }\n    return this.errorCode_;\n  }\n\n  /**\n   * @override\n   */\n  getStatus(): number {\n    if (!this.sent_) {\n      throw errorsExports.internalError('cannot .getStatus() before sending');\n    }\n    try {\n      return this.xhr_.status;\n    } catch (e) {\n      return -1;\n    }\n  }\n\n  /**\n   * @override\n   */\n  getResponseText(): string {\n    if (!this.sent_) {\n      throw errorsExports.internalError(\n        'cannot .getResponseText() before sending'\n      );\n    }\n    return this.xhr_.responseText;\n  }\n\n  /**\n   * Aborts the request.\n   * @override\n   */\n  abort(): void {\n    this.xhr_.abort();\n  }\n\n  /**\n   * @override\n   */\n  getResponseHeader(header: string): string | null {\n    return this.xhr_.getResponseHeader(header);\n  }\n\n  /**\n   * @override\n   */\n  addUploadProgressListener(listener: (p1: ProgressEvent) => void): void {\n    if (type.isDef(this.xhr_.upload)) {\n      this.xhr_.upload.addEventListener('progress', listener);\n    }\n  }\n\n  /**\n   * @override\n   */\n  removeUploadProgressListener(listener: (p1: ProgressEvent) => void): void {\n    if (type.isDef(this.xhr_.upload)) {\n      this.xhr_.upload.removeEventListener('progress', listener);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Replacement for goog.net.XhrIoPool that works with fbs.XhrIo.\n */\nimport { XhrIo } from './xhrio';\nimport { NetworkXhrIo } from './xhrio_network';\n\n/**\n * Factory-like class for creating XhrIo instances.\n */\nexport class XhrIoPool {\n  createXhrIo(): XhrIo {\n    return new NetworkXhrIo();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @fileoverview Some methods copied from goog.fs.\n * We don't include goog.fs because it pulls in a bunch of Deferred code that\n * bloats the size of the released binary.\n */\nimport * as type from './type';\n\nfunction getBlobBuilder(): typeof IBlobBuilder | undefined {\n  if (typeof BlobBuilder !== 'undefined') {\n    return BlobBuilder;\n  } else if (typeof WebKitBlobBuilder !== 'undefined') {\n    return WebKitBlobBuilder;\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Concatenates one or more values together and converts them to a Blob.\n *\n * @param args The values that will make up the resulting blob.\n * @return The blob.\n */\nexport function getBlob(...args: Array<string | Blob | ArrayBuffer>): Blob {\n  const BlobBuilder = getBlobBuilder();\n  if (BlobBuilder !== undefined) {\n    const bb = new BlobBuilder();\n    for (let i = 0; i < args.length; i++) {\n      bb.append(args[i]);\n    }\n    return bb.getBlob();\n  } else {\n    if (type.isNativeBlobDefined()) {\n      return new Blob(args);\n    } else {\n      throw Error(\"This browser doesn't seem to support creating Blobs\");\n    }\n  }\n}\n\n/**\n * Slices the blob. The returned blob contains data from the start byte\n * (inclusive) till the end byte (exclusive). Negative indices cannot be used.\n *\n * @param blob The blob to be sliced.\n * @param start Index of the starting byte.\n * @param end Index of the ending byte.\n * @return The blob slice or null if not supported.\n */\nexport function sliceBlob(blob: Blob, start: number, end: number): Blob | null {\n  if (blob.webkitSlice) {\n    return blob.webkitSlice(start, end);\n  } else if (blob.mozSlice) {\n    return blob.mozSlice(start, end);\n  } else if (blob.slice) {\n    return blob.slice(start, end);\n  }\n  return null;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @file Provides a Blob-like wrapper for various binary types (including the\n * native Blob type). This makes it possible to upload types like ArrayBuffers,\n * making uploads possible in environments without the native Blob type.\n */\nimport * as fs from './fs';\nimport { StringFormat, dataFromString } from './string';\nimport * as type from './type';\n\n/**\n * @param opt_elideCopy If true, doesn't copy mutable input data\n *     (e.g. Uint8Arrays). Pass true only if you know the objects will not be\n *     modified after this blob's construction.\n */\nexport class FbsBlob {\n  private data_!: Blob | Uint8Array;\n  private size_: number;\n  private type_: string;\n\n  constructor(data: Blob | Uint8Array | ArrayBuffer, elideCopy?: boolean) {\n    let size: number = 0;\n    let blobType: string = '';\n    if (type.isNativeBlob(data)) {\n      this.data_ = data as Blob;\n      size = (data as Blob).size;\n      blobType = (data as Blob).type;\n    } else if (data instanceof ArrayBuffer) {\n      if (elideCopy) {\n        this.data_ = new Uint8Array(data);\n      } else {\n        this.data_ = new Uint8Array(data.byteLength);\n        this.data_.set(new Uint8Array(data));\n      }\n      size = this.data_.length;\n    } else if (data instanceof Uint8Array) {\n      if (elideCopy) {\n        this.data_ = data as Uint8Array;\n      } else {\n        this.data_ = new Uint8Array(data.length);\n        this.data_.set(data as Uint8Array);\n      }\n      size = data.length;\n    }\n    this.size_ = size;\n    this.type_ = blobType;\n  }\n\n  size(): number {\n    return this.size_;\n  }\n\n  type(): string {\n    return this.type_;\n  }\n\n  slice(startByte: number, endByte: number): FbsBlob | null {\n    if (type.isNativeBlob(this.data_)) {\n      const realBlob = this.data_ as Blob;\n      const sliced = fs.sliceBlob(realBlob, startByte, endByte);\n      if (sliced === null) {\n        return null;\n      }\n      return new FbsBlob(sliced);\n    } else {\n      const slice = new Uint8Array(\n        (this.data_ as Uint8Array).buffer,\n        startByte,\n        endByte - startByte\n      );\n      return new FbsBlob(slice, true);\n    }\n  }\n\n  static getBlob(...args: Array<string | FbsBlob>): FbsBlob | null {\n    if (type.isNativeBlobDefined()) {\n      const blobby: Array<Blob | Uint8Array | string> = args.map(\n        (val: string | FbsBlob): Blob | Uint8Array | string => {\n          if (val instanceof FbsBlob) {\n            return val.data_;\n          } else {\n            return val;\n          }\n        }\n      );\n      return new FbsBlob(fs.getBlob.apply(null, blobby));\n    } else {\n      const uint8Arrays: Uint8Array[] = args.map(\n        (val: string | FbsBlob): Uint8Array => {\n          if (type.isString(val)) {\n            return dataFromString(StringFormat.RAW, val as string).data;\n          } else {\n            // Blobs don't exist, so this has to be a Uint8Array.\n            return (val as FbsBlob).data_ as Uint8Array;\n          }\n        }\n      );\n      let finalLength = 0;\n      uint8Arrays.forEach((array: Uint8Array): void => {\n        finalLength += array.byteLength;\n      });\n      const merged = new Uint8Array(finalLength);\n      let index = 0;\n      uint8Arrays.forEach((array: Uint8Array) => {\n        for (let i = 0; i < array.length; i++) {\n          merged[index++] = array[i];\n        }\n      });\n      return new FbsBlob(merged, true);\n    }\n  }\n\n  uploadData(): Blob | Uint8Array {\n    return this.data_;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Functionality related to the parsing/composition of bucket/\n * object location.\n */\nimport * as errorsExports from './error';\nimport { DEFAULT_HOST } from './constants';\n\n/**\n * @struct\n */\nexport class Location {\n  private path_: string;\n\n  constructor(public readonly bucket: string, path: string) {\n    this.path_ = path;\n  }\n\n  get path(): string {\n    return this.path_;\n  }\n\n  get isRoot(): boolean {\n    return this.path.length === 0;\n  }\n\n  fullServerUrl(): string {\n    const encode = encodeURIComponent;\n    return '/b/' + encode(this.bucket) + '/o/' + encode(this.path);\n  }\n\n  bucketOnlyServerUrl(): string {\n    const encode = encodeURIComponent;\n    return '/b/' + encode(this.bucket) + '/o';\n  }\n\n  static makeFromBucketSpec(bucketString: string): Location {\n    let bucketLocation;\n    try {\n      bucketLocation = Location.makeFromUrl(bucketString);\n    } catch (e) {\n      // Not valid URL, use as-is. This lets you put bare bucket names in\n      // config.\n      return new Location(bucketString, '');\n    }\n    if (bucketLocation.path === '') {\n      return bucketLocation;\n    } else {\n      throw errorsExports.invalidDefaultBucket(bucketString);\n    }\n  }\n\n  static makeFromUrl(url: string): Location {\n    let location: Location | null = null;\n    const bucketDomain = '([A-Za-z0-9.\\\\-_]+)';\n\n    function gsModify(loc: Location): void {\n      if (loc.path.charAt(loc.path.length - 1) === '/') {\n        loc.path_ = loc.path_.slice(0, -1);\n      }\n    }\n    const gsPath = '(/(.*))?$';\n    const path = '(/([^?#]*).*)?$';\n    const gsRegex = new RegExp('^gs://' + bucketDomain + gsPath, 'i');\n    const gsIndices = { bucket: 1, path: 3 };\n\n    function httpModify(loc: Location): void {\n      loc.path_ = decodeURIComponent(loc.path);\n    }\n    const version = 'v[A-Za-z0-9_]+';\n    const hostRegex = DEFAULT_HOST.replace(/[.]/g, '\\\\.');\n    const httpRegex = new RegExp(\n      `^https?://${hostRegex}/${version}/b/${bucketDomain}/o${path}`,\n      'i'\n    );\n    const httpIndices = { bucket: 1, path: 3 };\n    const groups = [\n      { regex: gsRegex, indices: gsIndices, postModify: gsModify },\n      { regex: httpRegex, indices: httpIndices, postModify: httpModify }\n    ];\n    for (let i = 0; i < groups.length; i++) {\n      const group = groups[i];\n      const captures = group.regex.exec(url);\n      if (captures) {\n        const bucketValue = captures[group.indices.bucket];\n        let pathValue = captures[group.indices.path];\n        if (!pathValue) {\n          pathValue = '';\n        }\n        location = new Location(bucketValue, pathValue);\n        group.postModify(location);\n        break;\n      }\n    }\n    if (location == null) {\n      throw errorsExports.invalidUrl(url);\n    }\n    return location;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @fileoverview Constants used in the Firebase Storage library.\n */\n\n/**\n * Domain name for firebase storage.\n */\nexport const DEFAULT_HOST = 'firebasestorage.googleapis.com';\n\n/**\n * The key in Firebase config json for the storage bucket.\n */\nexport const CONFIG_STORAGE_BUCKET_KEY = 'storageBucket';\n\n/**\n * 2 minutes\n *\n * The timeout for all operations except upload.\n */\nexport const DEFAULT_MAX_OPERATION_RETRY_TIME = 2 * 60 * 1000;\n\n/**\n * 10 minutes\n *\n * The timeout for upload.\n */\nexport const DEFAULT_MAX_UPLOAD_RETRY_TIME = 10 * 60 * 1000;\n\n/**\n * This is the value of Number.MIN_SAFE_INTEGER, which is not well supported\n * enough for us to use it directly.\n */\nexport const MIN_SAFE_INTEGER = -9007199254740991;\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport * as type from './type';\n\n/**\n * Returns the Object resulting from parsing the given JSON, or null if the\n * given string does not represent a JSON object.\n */\nexport function jsonObjectOrNull(\n  s: string\n): { [name: string]: unknown } | null {\n  let obj;\n  try {\n    obj = JSON.parse(s);\n  } catch (e) {\n    return null;\n  }\n  if (type.isNonArrayObject(obj)) {\n    return obj;\n  } else {\n    return null;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Contains helper methods for manipulating paths.\n */\n\n/**\n * @return Null if the path is already at the root.\n */\nexport function parent(path: string): string | null {\n  if (path.length === 0) {\n    return null;\n  }\n  const index = path.lastIndexOf('/');\n  if (index === -1) {\n    return '';\n  }\n  const newPath = path.slice(0, index);\n  return newPath;\n}\n\nexport function child(path: string, childPath: string): string {\n  const canonicalChildPath = childPath\n    .split('/')\n    .filter(component => component.length > 0)\n    .join('/');\n  if (path.length === 0) {\n    return canonicalChildPath;\n  } else {\n    return path + '/' + canonicalChildPath;\n  }\n}\n\n/**\n * Returns the last component of a path.\n * '/foo/bar' -> 'bar'\n * '/foo/bar/baz/' -> 'baz/'\n * '/a' -> 'a'\n */\nexport function lastComponent(path: string): string {\n  const index = path.lastIndexOf('/', path.length - 2);\n  if (index === -1) {\n    return path;\n  } else {\n    return path.slice(index + 1);\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Functions to create and manipulate URLs for the server API.\n */\nimport { DEFAULT_HOST } from './constants';\nimport { UrlParams } from './requestinfo';\n\nexport function makeUrl(urlPart: string): string {\n  return `https://${DEFAULT_HOST}/v0${urlPart}`;\n}\n\nexport function makeQueryString(params: UrlParams): string {\n  const encode = encodeURIComponent;\n  let queryPart = '?';\n  for (const key in params) {\n    if (params.hasOwnProperty(key)) {\n      // @ts-ignore TODO: remove once typescript is upgraded to 3.5.x\n      const nextPart = encode(key) + '=' + encode(params[key]);\n      queryPart = queryPart + nextPart + '&';\n    }\n  }\n\n  // Chop off the extra '&' or '?' on the end\n  queryPart = queryPart.slice(0, -1);\n  return queryPart;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Documentation for the metadata format\n */\nimport { Metadata } from '../metadata';\n\nimport { AuthWrapper } from './authwrapper';\nimport * as json from './json';\nimport { Location } from './location';\nimport * as path from './path';\nimport * as type from './type';\nimport * as UrlUtils from './url';\nimport { Reference } from '../reference';\n\nexport function noXform_<T>(metadata: Metadata, value: T): T {\n  return value;\n}\n\n/**\n * @struct\n */\nclass Mapping<T> {\n  local: string;\n  writable: boolean;\n  xform: (p1: Metadata, p2?: T) => T | undefined;\n\n  constructor(\n    public server: string,\n    local?: string | null,\n    writable?: boolean,\n    xform?: ((p1: Metadata, p2?: T) => T | undefined) | null\n  ) {\n    this.local = local || server;\n    this.writable = !!writable;\n    this.xform = xform || noXform_;\n  }\n}\ntype Mappings = Array<Mapping<string> | Mapping<number>>;\n\nexport { Mappings };\n\nlet mappings_: Mappings | null = null;\n\nexport function xformPath(fullPath: string | undefined): string | undefined {\n  if (!type.isString(fullPath) || fullPath.length < 2) {\n    return fullPath;\n  } else {\n    return path.lastComponent(fullPath);\n  }\n}\n\nexport function getMappings(): Mappings {\n  if (mappings_) {\n    return mappings_;\n  }\n  const mappings: Mappings = [];\n  mappings.push(new Mapping<string>('bucket'));\n  mappings.push(new Mapping<string>('generation'));\n  mappings.push(new Mapping<string>('metageneration'));\n  mappings.push(new Mapping<string>('name', 'fullPath', true));\n\n  function mappingsXformPath(\n    _metadata: Metadata,\n    fullPath: string | undefined\n  ): string | undefined {\n    return xformPath(fullPath);\n  }\n  const nameMapping = new Mapping<string>('name');\n  nameMapping.xform = mappingsXformPath;\n  mappings.push(nameMapping);\n\n  /**\n   * Coerces the second param to a number, if it is defined.\n   */\n  function xformSize(\n    _metadata: Metadata,\n    size: number | string | undefined\n  ): number | undefined {\n    if (type.isDef(size)) {\n      return Number(size);\n    } else {\n      return size;\n    }\n  }\n  const sizeMapping = new Mapping<number>('size');\n  sizeMapping.xform = xformSize;\n  mappings.push(sizeMapping);\n  mappings.push(new Mapping<number>('timeCreated'));\n  mappings.push(new Mapping<string>('updated'));\n  mappings.push(new Mapping<string>('md5Hash', null, true));\n  mappings.push(new Mapping<string>('cacheControl', null, true));\n  mappings.push(new Mapping<string>('contentDisposition', null, true));\n  mappings.push(new Mapping<string>('contentEncoding', null, true));\n  mappings.push(new Mapping<string>('contentLanguage', null, true));\n  mappings.push(new Mapping<string>('contentType', null, true));\n  mappings.push(new Mapping<string>('metadata', 'customMetadata', true));\n  mappings_ = mappings;\n  return mappings_;\n}\n\nexport function addRef(metadata: Metadata, authWrapper: AuthWrapper): void {\n  function generateRef(): Reference {\n    const bucket: string = metadata['bucket'] as string;\n    const path: string = metadata['fullPath'] as string;\n    const loc = new Location(bucket, path);\n    return authWrapper.makeStorageReference(loc);\n  }\n  Object.defineProperty(metadata, 'ref', { get: generateRef });\n}\n\nexport function fromResource(\n  authWrapper: AuthWrapper,\n  resource: { [name: string]: unknown },\n  mappings: Mappings\n): Metadata {\n  const metadata: Metadata = {} as Metadata;\n  metadata['type'] = 'file';\n  const len = mappings.length;\n  for (let i = 0; i < len; i++) {\n    const mapping = mappings[i];\n    metadata[mapping.local] = (mapping as Mapping<unknown>).xform(\n      metadata,\n      resource[mapping.server]\n    );\n  }\n  addRef(metadata, authWrapper);\n  return metadata;\n}\n\nexport function fromResourceString(\n  authWrapper: AuthWrapper,\n  resourceString: string,\n  mappings: Mappings\n): Metadata | null {\n  const obj = json.jsonObjectOrNull(resourceString);\n  if (obj === null) {\n    return null;\n  }\n  const resource = obj as Metadata;\n  return fromResource(authWrapper, resource, mappings);\n}\n\nexport function downloadUrlFromResourceString(\n  metadata: Metadata,\n  resourceString: string\n): string | null {\n  const obj = json.jsonObjectOrNull(resourceString);\n  if (obj === null) {\n    return null;\n  }\n  if (!type.isString(obj['downloadTokens'])) {\n    // This can happen if objects are uploaded through GCS and retrieved\n    // through list, so we don't want to throw an Error.\n    return null;\n  }\n  const tokens: string = obj['downloadTokens'] as string;\n  if (tokens.length === 0) {\n    return null;\n  }\n  const encode = encodeURIComponent;\n  const tokensList = tokens.split(',');\n  const urls = tokensList.map((token: string): string => {\n    const bucket: string = metadata['bucket'] as string;\n    const path: string = metadata['fullPath'] as string;\n    const urlPart = '/b/' + encode(bucket) + '/o/' + encode(path);\n    const base = UrlUtils.makeUrl(urlPart);\n    const queryString = UrlUtils.makeQueryString({\n      alt: 'media',\n      token\n    });\n    return base + queryString;\n  });\n  return urls[0];\n}\n\nexport function toResourceString(\n  metadata: Metadata,\n  mappings: Mappings\n): string {\n  const resource: {\n    [prop: string]: unknown;\n  } = {};\n  const len = mappings.length;\n  for (let i = 0; i < len; i++) {\n    const mapping = mappings[i];\n    if (mapping.writable) {\n      resource[mapping.server] = metadata[mapping.local];\n    }\n  }\n  return JSON.stringify(resource);\n}\n\nexport function metadataValidator(p: unknown): void {\n  if (!type.isObject(p) || !p) {\n    throw 'Expected Metadata object.';\n  }\n  for (const key in p) {\n    if (p.hasOwnProperty(key)) {\n      const val = p[key];\n      if (key === 'customMetadata') {\n        if (!type.isObject(val)) {\n          throw 'Expected object for \\'customMetadata\\' mapping.';\n        }\n      } else {\n        if (type.isNonNullObject(val)) {\n          throw \"Mapping for '\" + key + \"' cannot be an object.\";\n        }\n      }\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Documentation for the listOptions and listResult format\n */\nimport { AuthWrapper } from './authwrapper';\nimport { Location } from './location';\nimport * as json from './json';\nimport * as type from './type';\nimport { ListResult } from '../list';\nimport * as errors from './error';\n\n/**\n * Represents the simplified object metadata returned by List API.\n * Other fields are filtered because list in Firebase Rules does not grant\n * the permission to read the metadata.\n */\ninterface ListMetadataResponse {\n  name: string;\n  bucket: string;\n}\n\n/**\n * Represents the JSON response of List API.\n */\ninterface ListResultResponse {\n  prefixes: string[];\n  items: ListMetadataResponse[];\n  nextPageToken?: string;\n}\n\nconst MAX_RESULTS_KEY = 'maxResults';\nconst MAX_MAX_RESULTS = 1000;\nconst PAGE_TOKEN_KEY = 'pageToken';\nconst PREFIXES_KEY = 'prefixes';\nconst ITEMS_KEY = 'items';\n\nfunction fromBackendResponse(\n  authWrapper: AuthWrapper,\n  resource: ListResultResponse\n): ListResult {\n  const listResult: ListResult = {\n    prefixes: [],\n    items: [],\n    nextPageToken: resource['nextPageToken']\n  };\n  const bucket = authWrapper.bucket();\n  if (bucket === null) {\n    throw errors.noDefaultBucket();\n  }\n  if (resource[PREFIXES_KEY]) {\n    for (const path of resource[PREFIXES_KEY]) {\n      const pathWithoutTrailingSlash = path.replace(/\\/$/, '');\n      const reference = authWrapper.makeStorageReference(\n        new Location(bucket, pathWithoutTrailingSlash)\n      );\n      listResult.prefixes.push(reference);\n    }\n  }\n\n  if (resource[ITEMS_KEY]) {\n    for (const item of resource[ITEMS_KEY]) {\n      const reference = authWrapper.makeStorageReference(\n        new Location(bucket, item['name'])\n      );\n      listResult.items.push(reference);\n    }\n  }\n  return listResult;\n}\n\nexport function fromResponseString(\n  authWrapper: AuthWrapper,\n  resourceString: string\n): ListResult | null {\n  const obj = json.jsonObjectOrNull(resourceString);\n  if (obj === null) {\n    return null;\n  }\n  const resource = (obj as unknown) as ListResultResponse;\n  return fromBackendResponse(authWrapper, resource);\n}\n\nexport function listOptionsValidator(p: unknown): void {\n  if (!type.isObject(p) || !p) {\n    throw 'Expected ListOptions object.';\n  }\n  for (const key in p) {\n    if (key === MAX_RESULTS_KEY) {\n      if (\n        !type.isInteger(p[MAX_RESULTS_KEY]) ||\n        (p[MAX_RESULTS_KEY] as number) <= 0\n      ) {\n        throw 'Expected maxResults to be a positive number.';\n      }\n      if ((p[MAX_RESULTS_KEY] as number) > 1000) {\n        throw `Expected maxResults to be less than or equal to ${MAX_MAX_RESULTS}.`;\n      }\n    } else if (key === PAGE_TOKEN_KEY) {\n      if (p[PAGE_TOKEN_KEY] && !type.isString(p[PAGE_TOKEN_KEY])) {\n        throw 'Expected pageToken to be string.';\n      }\n    } else {\n      throw 'Unknown option: ' + key;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { FirebaseStorageError } from './error';\nimport { Headers, XhrIo } from './xhrio';\n\nexport interface UrlParams {\n  [name: string]: string | number;\n}\n\nexport class RequestInfo<T> {\n  urlParams: UrlParams = {};\n  headers: Headers = {};\n  body: Blob | string | Uint8Array | null = null;\n\n  errorHandler:\n    | ((p1: XhrIo, p2: FirebaseStorageError) => FirebaseStorageError)\n    | null = null;\n\n  /**\n   * Called with the current number of bytes uploaded and total size (-1 if not\n   * computable) of the request body (i.e. used to report upload progress).\n   */\n  progressCallback: ((p1: number, p2: number) => void) | null = null;\n  successCodes: number[] = [200];\n  additionalRetryCodes: number[] = [];\n\n  constructor(\n    public url: string,\n    public method: string,\n    /**\n     * Returns the value with which to resolve the request's promise. Only called\n     * if the request is successful. Throw from this function to reject the\n     * returned Request's promise with the thrown error.\n     * Note: The XhrIo passed to this function may be reused after this callback\n     * returns. Do not keep a reference to it in any way.\n     */\n    public handler: (p1: XhrIo, p2: string) => T,\n    public timeout: number\n  ) {}\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Defines methods for interacting with the network.\n */\n\nimport { Metadata } from '../metadata';\nimport { ListResult } from '../list';\nimport { AuthWrapper } from './authwrapper';\nimport { FbsBlob } from './blob';\nimport {\n  FirebaseStorageError,\n  cannotSliceBlob,\n  unauthenticated,\n  quotaExceeded,\n  unauthorized,\n  objectNotFound,\n  serverFileWrongSize,\n  unknown\n} from './error';\nimport { Location } from './location';\nimport * as MetadataUtils from './metadata';\nimport * as ListResultUtils from './list';\nimport { RequestInfo, UrlParams } from './requestinfo';\nimport * as type from './type';\nimport * as UrlUtils from './url';\nimport { XhrIo } from './xhrio';\n\n/**\n * Throws the UNKNOWN FirebaseStorageError if cndn is false.\n */\nexport function handlerCheck(cndn: boolean): void {\n  if (!cndn) {\n    throw unknown();\n  }\n}\n\nexport function metadataHandler(\n  authWrapper: AuthWrapper,\n  mappings: MetadataUtils.Mappings\n): (p1: XhrIo, p2: string) => Metadata {\n  function handler(xhr: XhrIo, text: string): Metadata {\n    const metadata = MetadataUtils.fromResourceString(\n      authWrapper,\n      text,\n      mappings\n    );\n    handlerCheck(metadata !== null);\n    return metadata as Metadata;\n  }\n  return handler;\n}\n\nexport function listHandler(\n  authWrapper: AuthWrapper\n): (p1: XhrIo, p2: string) => ListResult {\n  function handler(xhr: XhrIo, text: string): ListResult {\n    const listResult = ListResultUtils.fromResponseString(authWrapper, text);\n    handlerCheck(listResult !== null);\n    return listResult as ListResult;\n  }\n  return handler;\n}\n\nexport function downloadUrlHandler(\n  authWrapper: AuthWrapper,\n  mappings: MetadataUtils.Mappings\n): (p1: XhrIo, p2: string) => string | null {\n  function handler(xhr: XhrIo, text: string): string | null {\n    const metadata = MetadataUtils.fromResourceString(\n      authWrapper,\n      text,\n      mappings\n    );\n    handlerCheck(metadata !== null);\n    return MetadataUtils.downloadUrlFromResourceString(\n      metadata as Metadata,\n      text\n    );\n  }\n  return handler;\n}\n\nexport function sharedErrorHandler(\n  location: Location\n): (p1: XhrIo, p2: FirebaseStorageError) => FirebaseStorageError {\n  function errorHandler(\n    xhr: XhrIo,\n    err: FirebaseStorageError\n  ): FirebaseStorageError {\n    let newErr;\n    if (xhr.getStatus() === 401) {\n      newErr = unauthenticated();\n    } else {\n      if (xhr.getStatus() === 402) {\n        newErr = quotaExceeded(location.bucket);\n      } else {\n        if (xhr.getStatus() === 403) {\n          newErr = unauthorized(location.path);\n        } else {\n          newErr = err;\n        }\n      }\n    }\n    newErr.setServerResponseProp(err.serverResponseProp());\n    return newErr;\n  }\n  return errorHandler;\n}\n\nexport function objectErrorHandler(\n  location: Location\n): (p1: XhrIo, p2: FirebaseStorageError) => FirebaseStorageError {\n  const shared = sharedErrorHandler(location);\n\n  function errorHandler(\n    xhr: XhrIo,\n    err: FirebaseStorageError\n  ): FirebaseStorageError {\n    let newErr = shared(xhr, err);\n    if (xhr.getStatus() === 404) {\n      newErr = objectNotFound(location.path);\n    }\n    newErr.setServerResponseProp(err.serverResponseProp());\n    return newErr;\n  }\n  return errorHandler;\n}\n\nexport function getMetadata(\n  authWrapper: AuthWrapper,\n  location: Location,\n  mappings: MetadataUtils.Mappings\n): RequestInfo<Metadata> {\n  const urlPart = location.fullServerUrl();\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'GET';\n  const timeout = authWrapper.maxOperationRetryTime();\n  const requestInfo = new RequestInfo(\n    url,\n    method,\n    metadataHandler(authWrapper, mappings),\n    timeout\n  );\n  requestInfo.errorHandler = objectErrorHandler(location);\n  return requestInfo;\n}\n\nexport function list(\n  authWrapper: AuthWrapper,\n  location: Location,\n  delimiter?: string,\n  pageToken?: string | null,\n  maxResults?: number | null\n): RequestInfo<ListResult> {\n  const urlParams: UrlParams = {};\n  if (location.isRoot) {\n    urlParams['prefix'] = '';\n  } else {\n    urlParams['prefix'] = location.path + '/';\n  }\n  if (delimiter && delimiter.length > 0) {\n    urlParams['delimiter'] = delimiter;\n  }\n  if (pageToken) {\n    urlParams['pageToken'] = pageToken;\n  }\n  if (maxResults) {\n    urlParams['maxResults'] = maxResults;\n  }\n  const urlPart = location.bucketOnlyServerUrl();\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'GET';\n  const timeout = authWrapper.maxOperationRetryTime();\n  const requestInfo = new RequestInfo(\n    url,\n    method,\n    listHandler(authWrapper),\n    timeout\n  );\n  requestInfo.urlParams = urlParams;\n  requestInfo.errorHandler = sharedErrorHandler(location);\n  return requestInfo;\n}\n\nexport function getDownloadUrl(\n  authWrapper: AuthWrapper,\n  location: Location,\n  mappings: MetadataUtils.Mappings\n): RequestInfo<string | null> {\n  const urlPart = location.fullServerUrl();\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'GET';\n  const timeout = authWrapper.maxOperationRetryTime();\n  const requestInfo = new RequestInfo(\n    url,\n    method,\n    downloadUrlHandler(authWrapper, mappings),\n    timeout\n  );\n  requestInfo.errorHandler = objectErrorHandler(location);\n  return requestInfo;\n}\n\nexport function updateMetadata(\n  authWrapper: AuthWrapper,\n  location: Location,\n  metadata: Metadata,\n  mappings: MetadataUtils.Mappings\n): RequestInfo<Metadata> {\n  const urlPart = location.fullServerUrl();\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'PATCH';\n  const body = MetadataUtils.toResourceString(metadata, mappings);\n  const headers = { 'Content-Type': 'application/json; charset=utf-8' };\n  const timeout = authWrapper.maxOperationRetryTime();\n  const requestInfo = new RequestInfo(\n    url,\n    method,\n    metadataHandler(authWrapper, mappings),\n    timeout\n  );\n  requestInfo.headers = headers;\n  requestInfo.body = body;\n  requestInfo.errorHandler = objectErrorHandler(location);\n  return requestInfo;\n}\n\nexport function deleteObject(\n  authWrapper: AuthWrapper,\n  location: Location\n): RequestInfo<void> {\n  const urlPart = location.fullServerUrl();\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'DELETE';\n  const timeout = authWrapper.maxOperationRetryTime();\n\n  function handler(_xhr: XhrIo, _text: string): void {}\n  const requestInfo = new RequestInfo(url, method, handler, timeout);\n  requestInfo.successCodes = [200, 204];\n  requestInfo.errorHandler = objectErrorHandler(location);\n  return requestInfo;\n}\n\nexport function determineContentType_(\n  metadata: Metadata | null,\n  blob: FbsBlob | null\n): string {\n  return (\n    (metadata && metadata['contentType']) ||\n    (blob && blob.type()) ||\n    'application/octet-stream'\n  );\n}\n\nexport function metadataForUpload_(\n  location: Location,\n  blob: FbsBlob,\n  metadata?: Metadata | null\n): Metadata {\n  const metadataClone = Object.assign({}, metadata);\n  metadataClone['fullPath'] = location.path;\n  metadataClone['size'] = blob.size();\n  if (!metadataClone['contentType']) {\n    metadataClone['contentType'] = determineContentType_(null, blob);\n  }\n  return metadataClone;\n}\n\nexport function multipartUpload(\n  authWrapper: AuthWrapper,\n  location: Location,\n  mappings: MetadataUtils.Mappings,\n  blob: FbsBlob,\n  metadata?: Metadata | null\n): RequestInfo<Metadata> {\n  const urlPart = location.bucketOnlyServerUrl();\n  const headers: { [prop: string]: string } = {\n    'X-Goog-Upload-Protocol': 'multipart'\n  };\n\n  function genBoundary(): string {\n    let str = '';\n    for (let i = 0; i < 2; i++) {\n      str =\n        str +\n        Math.random()\n          .toString()\n          .slice(2);\n    }\n    return str;\n  }\n  const boundary = genBoundary();\n  headers['Content-Type'] = 'multipart/related; boundary=' + boundary;\n  const metadata_ = metadataForUpload_(location, blob, metadata);\n  const metadataString = MetadataUtils.toResourceString(metadata_, mappings);\n  const preBlobPart =\n    '--' +\n    boundary +\n    '\\r\\n' +\n    'Content-Type: application/json; charset=utf-8\\r\\n\\r\\n' +\n    metadataString +\n    '\\r\\n--' +\n    boundary +\n    '\\r\\n' +\n    'Content-Type: ' +\n    metadata_['contentType'] +\n    '\\r\\n\\r\\n';\n  const postBlobPart = '\\r\\n--' + boundary + '--';\n  const body = FbsBlob.getBlob(preBlobPart, blob, postBlobPart);\n  if (body === null) {\n    throw cannotSliceBlob();\n  }\n  const urlParams: UrlParams = { name: metadata_['fullPath']! };\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'POST';\n  const timeout = authWrapper.maxUploadRetryTime();\n  const requestInfo = new RequestInfo(\n    url,\n    method,\n    metadataHandler(authWrapper, mappings),\n    timeout\n  );\n  requestInfo.urlParams = urlParams;\n  requestInfo.headers = headers;\n  requestInfo.body = body.uploadData();\n  requestInfo.errorHandler = sharedErrorHandler(location);\n  return requestInfo;\n}\n\n/**\n * @param current The number of bytes that have been uploaded so far.\n * @param total The total number of bytes in the upload.\n * @param opt_finalized True if the server has finished the upload.\n * @param opt_metadata The upload metadata, should\n *     only be passed if opt_finalized is true.\n * @struct\n */\nexport class ResumableUploadStatus {\n  finalized: boolean;\n  metadata: Metadata | null;\n\n  constructor(\n    public current: number,\n    public total: number,\n    finalized?: boolean,\n    metadata?: Metadata | null\n  ) {\n    this.finalized = !!finalized;\n    this.metadata = metadata || null;\n  }\n}\n\nexport function checkResumeHeader_(xhr: XhrIo, allowed?: string[]): string {\n  let status: string | null = null;\n  try {\n    status = xhr.getResponseHeader('X-Goog-Upload-Status');\n  } catch (e) {\n    handlerCheck(false);\n  }\n  const allowedStatus = allowed || ['active'];\n  handlerCheck(!!status && allowedStatus.indexOf(status) !== -1);\n  return status as string;\n}\n\nexport function createResumableUpload(\n  authWrapper: AuthWrapper,\n  location: Location,\n  mappings: MetadataUtils.Mappings,\n  blob: FbsBlob,\n  metadata?: Metadata | null\n): RequestInfo<string> {\n  const urlPart = location.bucketOnlyServerUrl();\n  const metadataForUpload = metadataForUpload_(location, blob, metadata);\n  const urlParams: UrlParams = { name: metadataForUpload['fullPath']! };\n  const url = UrlUtils.makeUrl(urlPart);\n  const method = 'POST';\n  const headers = {\n    'X-Goog-Upload-Protocol': 'resumable',\n    'X-Goog-Upload-Command': 'start',\n    'X-Goog-Upload-Header-Content-Length': blob.size(),\n    'X-Goog-Upload-Header-Content-Type': metadataForUpload['contentType']!,\n    'Content-Type': 'application/json; charset=utf-8'\n  };\n  const body = MetadataUtils.toResourceString(metadataForUpload, mappings);\n  const timeout = authWrapper.maxUploadRetryTime();\n\n  function handler(xhr: XhrIo): string {\n    checkResumeHeader_(xhr);\n    let url;\n    try {\n      url = xhr.getResponseHeader('X-Goog-Upload-URL');\n    } catch (e) {\n      handlerCheck(false);\n    }\n    handlerCheck(type.isString(url));\n    return url as string;\n  }\n  const requestInfo = new RequestInfo(url, method, handler, timeout);\n  requestInfo.urlParams = urlParams;\n  requestInfo.headers = headers;\n  requestInfo.body = body;\n  requestInfo.errorHandler = sharedErrorHandler(location);\n  return requestInfo;\n}\n\n/**\n * @param url From a call to fbs.requests.createResumableUpload.\n */\nexport function getResumableUploadStatus(\n  authWrapper: AuthWrapper,\n  location: Location,\n  url: string,\n  blob: FbsBlob\n): RequestInfo<ResumableUploadStatus> {\n  const headers = { 'X-Goog-Upload-Command': 'query' };\n\n  function handler(xhr: XhrIo): ResumableUploadStatus {\n    const status = checkResumeHeader_(xhr, ['active', 'final']);\n    let sizeString: string | null = null;\n    try {\n      sizeString = xhr.getResponseHeader('X-Goog-Upload-Size-Received');\n    } catch (e) {\n      handlerCheck(false);\n    }\n\n    if (!sizeString) {\n      // null or empty string\n      handlerCheck(false);\n    }\n\n    const size = Number(sizeString);\n    handlerCheck(!isNaN(size));\n    return new ResumableUploadStatus(size, blob.size(), status === 'final');\n  }\n  const method = 'POST';\n  const timeout = authWrapper.maxUploadRetryTime();\n  const requestInfo = new RequestInfo(url, method, handler, timeout);\n  requestInfo.headers = headers;\n  requestInfo.errorHandler = sharedErrorHandler(location);\n  return requestInfo;\n}\n\n/**\n * Any uploads via the resumable upload API must transfer a number of bytes\n * that is a multiple of this number.\n */\nexport const resumableUploadChunkSize: number = 256 * 1024;\n\n/**\n * @param url From a call to fbs.requests.createResumableUpload.\n * @param chunkSize Number of bytes to upload.\n * @param status The previous status.\n *     If not passed or null, we start from the beginning.\n * @throws fbs.Error If the upload is already complete, the passed in status\n *     has a final size inconsistent with the blob, or the blob cannot be sliced\n *     for upload.\n */\nexport function continueResumableUpload(\n  location: Location,\n  authWrapper: AuthWrapper,\n  url: string,\n  blob: FbsBlob,\n  chunkSize: number,\n  mappings: MetadataUtils.Mappings,\n  status?: ResumableUploadStatus | null,\n  progressCallback?: ((p1: number, p2: number) => void) | null\n): RequestInfo<ResumableUploadStatus> {\n  // TODO(andysoto): standardize on internal asserts\n  // assert(!(opt_status && opt_status.finalized));\n  const status_ = new ResumableUploadStatus(0, 0);\n  if (status) {\n    status_.current = status.current;\n    status_.total = status.total;\n  } else {\n    status_.current = 0;\n    status_.total = blob.size();\n  }\n  if (blob.size() !== status_.total) {\n    throw serverFileWrongSize();\n  }\n  const bytesLeft = status_.total - status_.current;\n  let bytesToUpload = bytesLeft;\n  if (chunkSize > 0) {\n    bytesToUpload = Math.min(bytesToUpload, chunkSize);\n  }\n  const startByte = status_.current;\n  const endByte = startByte + bytesToUpload;\n  const uploadCommand =\n    bytesToUpload === bytesLeft ? 'upload, finalize' : 'upload';\n  const headers = {\n    'X-Goog-Upload-Command': uploadCommand,\n    'X-Goog-Upload-Offset': status_.current\n  };\n  const body = blob.slice(startByte, endByte);\n  if (body === null) {\n    throw cannotSliceBlob();\n  }\n\n  function handler(xhr: XhrIo, text: string): ResumableUploadStatus {\n    // TODO(andysoto): Verify the MD5 of each uploaded range:\n    // the 'x-range-md5' header comes back with status code 308 responses.\n    // We'll only be able to bail out though, because you can't re-upload a\n    // range that you previously uploaded.\n    const uploadStatus = checkResumeHeader_(xhr, ['active', 'final']);\n    const newCurrent = status_.current + bytesToUpload;\n    const size = blob.size();\n    let metadata;\n    if (uploadStatus === 'final') {\n      metadata = metadataHandler(authWrapper, mappings)(xhr, text);\n    } else {\n      metadata = null;\n    }\n    return new ResumableUploadStatus(\n      newCurrent,\n      size,\n      uploadStatus === 'final',\n      metadata\n    );\n  }\n  const method = 'POST';\n  const timeout = authWrapper.maxUploadRetryTime();\n  const requestInfo = new RequestInfo(url, method, handler, timeout);\n  requestInfo.headers = headers;\n  requestInfo.body = body.uploadData();\n  requestInfo.progressCallback = progressCallback || null;\n  requestInfo.errorHandler = sharedErrorHandler(location);\n  return requestInfo;\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport * as type from './type';\nimport { FirebaseStorageError } from './error';\n\nexport type NextFn<T> = (value: T) => void;\nexport type ErrorFn = (error: Error | FirebaseStorageError) => void;\nexport type CompleteFn = () => void;\nexport type Unsubscribe = () => void;\n\nexport interface StorageObserver<T> {\n  next?: NextFn<T> | null;\n  error?: ErrorFn | null;\n  complete?: CompleteFn | null;\n}\n\nexport type Subscribe<T> = (\n  next?: NextFn<T> | StorageObserver<T> | null,\n  error?: ErrorFn | null,\n  complete?: CompleteFn | null\n) => Unsubscribe;\n\n/**\n * @struct\n */\nexport class Observer<T> implements StorageObserver<T> {\n  next?: NextFn<T> | null;\n  error?: ErrorFn | null;\n  complete?: CompleteFn | null;\n\n  constructor(\n    nextOrObserver?: NextFn<T> | StorageObserver<T> | null,\n    error?: ErrorFn | null,\n    complete?: CompleteFn | null\n  ) {\n    const asFunctions =\n      type.isFunction(nextOrObserver) ||\n      type.isDef(error) ||\n      type.isDef(complete);\n    if (asFunctions) {\n      this.next = nextOrObserver as NextFn<T> | null;\n      this.error = error || null;\n      this.complete = complete || null;\n    } else {\n      const observer = nextOrObserver as {\n        next?: NextFn<T> | null;\n        error?: ErrorFn | null;\n        complete?: CompleteFn | null;\n      };\n      this.next = observer.next || null;\n      this.error = observer.error || null;\n      this.complete = observer.complete || null;\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { TaskState } from './implementation/taskenums';\nimport { Metadata } from './metadata';\nimport { Reference } from './reference';\nimport { UploadTask } from './task';\n\nexport class UploadTaskSnapshot {\n  constructor(\n    readonly bytesTransferred: number,\n    readonly totalBytes: number,\n    readonly state: TaskState,\n    readonly metadata: Metadata | null,\n    readonly task: UploadTask,\n    readonly ref: Reference\n  ) {}\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport * as errorsExports from './error';\nimport * as MetadataUtils from './metadata';\nimport * as ListOptionsUtils from './list';\nimport * as type from './type';\n\n/**\n * @param name Name of the function.\n * @param specs Argument specs.\n * @param passed The actual arguments passed to the function.\n * @throws {fbs.Error} If the arguments are invalid.\n */\nexport function validate(\n  name: string,\n  specs: ArgSpec[],\n  passed: IArguments\n): void {\n  let minArgs = specs.length;\n  const maxArgs = specs.length;\n  for (let i = 0; i < specs.length; i++) {\n    if (specs[i].optional) {\n      minArgs = i;\n      break;\n    }\n  }\n  const validLength = minArgs <= passed.length && passed.length <= maxArgs;\n  if (!validLength) {\n    throw errorsExports.invalidArgumentCount(\n      minArgs,\n      maxArgs,\n      name,\n      passed.length\n    );\n  }\n  for (let i = 0; i < passed.length; i++) {\n    try {\n      specs[i].validator(passed[i]);\n    } catch (e) {\n      if (e instanceof Error) {\n        throw errorsExports.invalidArgument(i, name, e.message);\n      } else {\n        throw errorsExports.invalidArgument(i, name, e);\n      }\n    }\n  }\n}\n\n/**\n * @struct\n */\nexport class ArgSpec {\n  validator: (p1: unknown) => void;\n  optional: boolean;\n\n  constructor(validator: (p1: unknown) => void, optional?: boolean) {\n    const self = this;\n    this.validator = function(p: unknown) {\n      if (self.optional && !type.isJustDef(p)) {\n        return;\n      }\n      validator(p);\n    };\n    this.optional = !!optional;\n  }\n}\n\nexport function and_(\n  v1: (p1: unknown) => void,\n  v2: (p1: unknown) => void\n): (p1: unknown) => void {\n  return function(p) {\n    v1(p);\n    v2(p);\n  };\n}\n\nexport function stringSpec(\n  validator?: (p1: unknown) => void | null,\n  optional?: boolean\n): ArgSpec {\n  function stringValidator(p: unknown): void {\n    if (!type.isString(p)) {\n      throw 'Expected string.';\n    }\n  }\n  let chainedValidator;\n  if (validator) {\n    chainedValidator = and_(stringValidator, validator);\n  } else {\n    chainedValidator = stringValidator;\n  }\n  return new ArgSpec(chainedValidator, optional);\n}\n\nexport function uploadDataSpec(): ArgSpec {\n  function validator(p: unknown): void {\n    const valid =\n      p instanceof Uint8Array ||\n      p instanceof ArrayBuffer ||\n      (type.isNativeBlobDefined() && p instanceof Blob);\n    if (!valid) {\n      throw 'Expected Blob or File.';\n    }\n  }\n  return new ArgSpec(validator);\n}\n\nexport function metadataSpec(optional?: boolean): ArgSpec {\n  return new ArgSpec(MetadataUtils.metadataValidator, optional);\n}\n\nexport function listOptionSpec(optional?: boolean): ArgSpec {\n  return new ArgSpec(ListOptionsUtils.listOptionsValidator, optional);\n}\n\nexport function nonNegativeNumberSpec(): ArgSpec {\n  function validator(p: unknown): void {\n    const valid = type.isNumber(p) && p >= 0;\n    if (!valid) {\n      throw 'Expected a number 0 or greater.';\n    }\n  }\n  return new ArgSpec(validator);\n}\n\nexport function looseObjectSpec(\n  validator?: ((p1: unknown) => void) | null,\n  optional?: boolean\n): ArgSpec {\n  function isLooseObjectValidator(p: unknown): void {\n    const isLooseObject = p === null || (type.isDef(p) && p instanceof Object);\n    if (!isLooseObject) {\n      throw 'Expected an Object.';\n    }\n    if (validator !== undefined && validator !== null) {\n      validator(p);\n    }\n  }\n  return new ArgSpec(isLooseObjectValidator, optional);\n}\n\nexport function nullFunctionSpec(optional?: boolean): ArgSpec {\n  function validator(p: unknown): void {\n    const valid = p === null || type.isFunction(p);\n    if (!valid) {\n      throw 'Expected a Function.';\n    }\n  }\n  return new ArgSpec(validator, optional);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns a function that invokes f with its arguments asynchronously as a\n * microtask, i.e. as soon as possible after the current script returns back\n * into browser code.\n */\nexport function async(f: Function): Function {\n  return (...argsToForward: unknown[]) => {\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    Promise.resolve().then(() => f(...argsToForward));\n  };\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @fileoverview Defines types for interacting with blob transfer tasks.\n */\n\nimport { AuthWrapper } from './implementation/authwrapper';\nimport { FbsBlob } from './implementation/blob';\nimport { FirebaseStorageError, Code, canceled } from './implementation/error';\nimport {\n  InternalTaskState,\n  TaskEvent,\n  TaskState,\n  taskStateFromInternalTaskState\n} from './implementation/taskenums';\nimport { Metadata } from './metadata';\nimport {\n  CompleteFn,\n  ErrorFn,\n  NextFn,\n  Observer,\n  StorageObserver,\n  Subscribe,\n  Unsubscribe\n} from './implementation/observer';\nimport { Request } from './implementation/request';\nimport { UploadTaskSnapshot } from './tasksnapshot';\nimport {\n  ArgSpec,\n  nullFunctionSpec,\n  looseObjectSpec,\n  stringSpec,\n  validate\n} from './implementation/args';\nimport { async as fbsAsync } from './implementation/async';\nimport { Location } from './implementation/location';\nimport * as fbsMetadata from './implementation/metadata';\nimport * as fbsRequests from './implementation/requests';\nimport * as typeUtils from './implementation/type';\nimport { Reference } from './reference';\n\n/**\n * Represents a blob being uploaded. Can be used to pause/resume/cancel the\n * upload and manage callbacks for various events.\n */\nexport class UploadTask {\n  private ref_: Reference;\n  private authWrapper_: AuthWrapper;\n  private location_: Location;\n  private blob_: FbsBlob;\n  private metadata_: Metadata | null;\n  private mappings_: fbsMetadata.Mappings;\n  private transferred_: number = 0;\n  private needToFetchStatus_: boolean = false;\n  private needToFetchMetadata_: boolean = false;\n  private observers_: Array<Observer<UploadTaskSnapshot>> = [];\n  private resumable_: boolean;\n  private state_: InternalTaskState;\n  private error_: Error | null = null;\n  private uploadUrl_: string | null = null;\n  private request_: Request<unknown> | null = null;\n  private chunkMultiplier_: number = 1;\n  private errorHandler_: (p1: FirebaseStorageError) => void;\n  private metadataErrorHandler_: (p1: FirebaseStorageError) => void;\n  private resolve_: ((p1: UploadTaskSnapshot) => void) | null = null;\n  private reject_: ((p1: Error) => void) | null = null;\n  private promise_: Promise<UploadTaskSnapshot>;\n\n  /**\n   * @param ref The firebaseStorage.Reference object this task came\n   *     from, untyped to avoid cyclic dependencies.\n   * @param blob The blob to upload.\n   */\n  constructor(\n    ref: Reference,\n    authWrapper: AuthWrapper,\n    location: Location,\n    mappings: fbsMetadata.Mappings,\n    blob: FbsBlob,\n    metadata: Metadata | null = null\n  ) {\n    this.ref_ = ref;\n    this.authWrapper_ = authWrapper;\n    this.location_ = location;\n    this.blob_ = blob;\n    this.metadata_ = metadata;\n    this.mappings_ = mappings;\n    this.resumable_ = this.shouldDoResumable_(this.blob_);\n    this.state_ = InternalTaskState.RUNNING;\n    this.errorHandler_ = error => {\n      this.request_ = null;\n      this.chunkMultiplier_ = 1;\n      if (error.codeEquals(Code.CANCELED)) {\n        this.needToFetchStatus_ = true;\n        this.completeTransitions_();\n      } else {\n        this.error_ = error;\n        this.transition_(InternalTaskState.ERROR);\n      }\n    };\n    this.metadataErrorHandler_ = error => {\n      this.request_ = null;\n      if (error.codeEquals(Code.CANCELED)) {\n        this.completeTransitions_();\n      } else {\n        this.error_ = error;\n        this.transition_(InternalTaskState.ERROR);\n      }\n    };\n    this.promise_ = new Promise((resolve, reject) => {\n      this.resolve_ = resolve;\n      this.reject_ = reject;\n      this.start_();\n    });\n\n    // Prevent uncaught rejections on the internal promise from bubbling out\n    // to the top level with a dummy handler.\n    this.promise_.then(null, () => {});\n  }\n\n  private makeProgressCallback_(): (p1: number, p2: number) => void {\n    const sizeBefore = this.transferred_;\n    return loaded => this.updateProgress_(sizeBefore + loaded);\n  }\n\n  private shouldDoResumable_(blob: FbsBlob): boolean {\n    return blob.size() > 256 * 1024;\n  }\n\n  private start_(): void {\n    if (this.state_ !== InternalTaskState.RUNNING) {\n      // This can happen if someone pauses us in a resume callback, for example.\n      return;\n    }\n    if (this.request_ !== null) {\n      return;\n    }\n    if (this.resumable_) {\n      if (this.uploadUrl_ === null) {\n        this.createResumable_();\n      } else {\n        if (this.needToFetchStatus_) {\n          this.fetchStatus_();\n        } else {\n          if (this.needToFetchMetadata_) {\n            // Happens if we miss the metadata on upload completion.\n            this.fetchMetadata_();\n          } else {\n            this.continueUpload_();\n          }\n        }\n      }\n    } else {\n      this.oneShotUpload_();\n    }\n  }\n\n  private resolveToken_(callback: (p1: string | null) => void): void {\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    this.authWrapper_.getAuthToken().then(authToken => {\n      switch (this.state_) {\n        case InternalTaskState.RUNNING:\n          callback(authToken);\n          break;\n        case InternalTaskState.CANCELING:\n          this.transition_(InternalTaskState.CANCELED);\n          break;\n        case InternalTaskState.PAUSING:\n          this.transition_(InternalTaskState.PAUSED);\n          break;\n        default:\n      }\n    });\n  }\n\n  // TODO(andysoto): assert false\n\n  private createResumable_(): void {\n    this.resolveToken_(authToken => {\n      const requestInfo = fbsRequests.createResumableUpload(\n        this.authWrapper_,\n        this.location_,\n        this.mappings_,\n        this.blob_,\n        this.metadata_\n      );\n      const createRequest = this.authWrapper_.makeRequest(\n        requestInfo,\n        authToken\n      );\n      this.request_ = createRequest;\n      createRequest.getPromise().then((url: string) => {\n        this.request_ = null;\n        this.uploadUrl_ = url;\n        this.needToFetchStatus_ = false;\n        this.completeTransitions_();\n      }, this.errorHandler_);\n    });\n  }\n\n  private fetchStatus_(): void {\n    // TODO(andysoto): assert(this.uploadUrl_ !== null);\n    const url = this.uploadUrl_ as string;\n    this.resolveToken_(authToken => {\n      const requestInfo = fbsRequests.getResumableUploadStatus(\n        this.authWrapper_,\n        this.location_,\n        url,\n        this.blob_\n      );\n      const statusRequest = this.authWrapper_.makeRequest(\n        requestInfo,\n        authToken\n      );\n      this.request_ = statusRequest;\n      statusRequest.getPromise().then(status => {\n        status = status as fbsRequests.ResumableUploadStatus;\n        this.request_ = null;\n        this.updateProgress_(status.current);\n        this.needToFetchStatus_ = false;\n        if (status.finalized) {\n          this.needToFetchMetadata_ = true;\n        }\n        this.completeTransitions_();\n      }, this.errorHandler_);\n    });\n  }\n\n  private continueUpload_(): void {\n    const chunkSize =\n      fbsRequests.resumableUploadChunkSize * this.chunkMultiplier_;\n    const status = new fbsRequests.ResumableUploadStatus(\n      this.transferred_,\n      this.blob_.size()\n    );\n\n    // TODO(andysoto): assert(this.uploadUrl_ !== null);\n    const url = this.uploadUrl_ as string;\n    this.resolveToken_(authToken => {\n      let requestInfo;\n      try {\n        requestInfo = fbsRequests.continueResumableUpload(\n          this.location_,\n          this.authWrapper_,\n          url,\n          this.blob_,\n          chunkSize,\n          this.mappings_,\n          status,\n          this.makeProgressCallback_()\n        );\n      } catch (e) {\n        this.error_ = e;\n        this.transition_(InternalTaskState.ERROR);\n        return;\n      }\n      const uploadRequest = this.authWrapper_.makeRequest(\n        requestInfo,\n        authToken\n      );\n      this.request_ = uploadRequest;\n      uploadRequest\n        .getPromise()\n        .then((newStatus: fbsRequests.ResumableUploadStatus) => {\n          this.increaseMultiplier_();\n          this.request_ = null;\n          this.updateProgress_(newStatus.current);\n          if (newStatus.finalized) {\n            this.metadata_ = newStatus.metadata;\n            this.transition_(InternalTaskState.SUCCESS);\n          } else {\n            this.completeTransitions_();\n          }\n        }, this.errorHandler_);\n    });\n  }\n\n  private increaseMultiplier_(): void {\n    const currentSize =\n      fbsRequests.resumableUploadChunkSize * this.chunkMultiplier_;\n\n    // Max chunk size is 32M.\n    if (currentSize < 32 * 1024 * 1024) {\n      this.chunkMultiplier_ *= 2;\n    }\n  }\n\n  private fetchMetadata_(): void {\n    this.resolveToken_(authToken => {\n      const requestInfo = fbsRequests.getMetadata(\n        this.authWrapper_,\n        this.location_,\n        this.mappings_\n      );\n      const metadataRequest = this.authWrapper_.makeRequest(\n        requestInfo,\n        authToken\n      );\n      this.request_ = metadataRequest;\n      metadataRequest.getPromise().then(metadata => {\n        this.request_ = null;\n        this.metadata_ = metadata;\n        this.transition_(InternalTaskState.SUCCESS);\n      }, this.metadataErrorHandler_);\n    });\n  }\n\n  private oneShotUpload_(): void {\n    this.resolveToken_(authToken => {\n      const requestInfo = fbsRequests.multipartUpload(\n        this.authWrapper_,\n        this.location_,\n        this.mappings_,\n        this.blob_,\n        this.metadata_\n      );\n      const multipartRequest = this.authWrapper_.makeRequest(\n        requestInfo,\n        authToken\n      );\n      this.request_ = multipartRequest;\n      multipartRequest.getPromise().then(metadata => {\n        this.request_ = null;\n        this.metadata_ = metadata;\n        this.updateProgress_(this.blob_.size());\n        this.transition_(InternalTaskState.SUCCESS);\n      }, this.errorHandler_);\n    });\n  }\n\n  private updateProgress_(transferred: number): void {\n    const old = this.transferred_;\n    this.transferred_ = transferred;\n\n    // A progress update can make the \"transferred\" value smaller (e.g. a\n    // partial upload not completed by server, after which the \"transferred\"\n    // value may reset to the value at the beginning of the request).\n    if (this.transferred_ !== old) {\n      this.notifyObservers_();\n    }\n  }\n\n  private transition_(state: InternalTaskState): void {\n    if (this.state_ === state) {\n      return;\n    }\n    switch (state) {\n      case InternalTaskState.CANCELING:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.RUNNING ||\n        //        this.state_ === InternalTaskState.PAUSING);\n        this.state_ = state;\n        if (this.request_ !== null) {\n          this.request_.cancel();\n        }\n        break;\n      case InternalTaskState.PAUSING:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.RUNNING);\n        this.state_ = state;\n        if (this.request_ !== null) {\n          this.request_.cancel();\n        }\n        break;\n      case InternalTaskState.RUNNING:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.PAUSED ||\n        //        this.state_ === InternalTaskState.PAUSING);\n        const wasPaused = this.state_ === InternalTaskState.PAUSED;\n        this.state_ = state;\n        if (wasPaused) {\n          this.notifyObservers_();\n          this.start_();\n        }\n        break;\n      case InternalTaskState.PAUSED:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.PAUSING);\n        this.state_ = state;\n        this.notifyObservers_();\n        break;\n      case InternalTaskState.CANCELED:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.PAUSED ||\n        //        this.state_ === InternalTaskState.CANCELING);\n        this.error_ = canceled();\n        this.state_ = state;\n        this.notifyObservers_();\n        break;\n      case InternalTaskState.ERROR:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.RUNNING ||\n        //        this.state_ === InternalTaskState.PAUSING ||\n        //        this.state_ === InternalTaskState.CANCELING);\n        this.state_ = state;\n        this.notifyObservers_();\n        break;\n      case InternalTaskState.SUCCESS:\n        // TODO(andysoto):\n        // assert(this.state_ === InternalTaskState.RUNNING ||\n        //        this.state_ === InternalTaskState.PAUSING ||\n        //        this.state_ === InternalTaskState.CANCELING);\n        this.state_ = state;\n        this.notifyObservers_();\n        break;\n      default: // Ignore\n    }\n  }\n\n  private completeTransitions_(): void {\n    switch (this.state_) {\n      case InternalTaskState.PAUSING:\n        this.transition_(InternalTaskState.PAUSED);\n        break;\n      case InternalTaskState.CANCELING:\n        this.transition_(InternalTaskState.CANCELED);\n        break;\n      case InternalTaskState.RUNNING:\n        this.start_();\n        break;\n      default:\n        // TODO(andysoto): assert(false);\n        break;\n    }\n  }\n\n  get snapshot(): UploadTaskSnapshot {\n    const externalState = taskStateFromInternalTaskState(this.state_);\n    return new UploadTaskSnapshot(\n      this.transferred_,\n      this.blob_.size(),\n      externalState,\n      this.metadata_,\n      this,\n      this.ref_\n    );\n  }\n\n  /**\n   * Adds a callback for an event.\n   * @param type The type of event to listen for.\n   */\n  on(\n    type: TaskEvent,\n    nextOrObserver?:\n      | NextFn<UploadTaskSnapshot>\n      | StorageObserver<UploadTaskSnapshot>\n      | null,\n    error?: ErrorFn | null,\n    completed?: CompleteFn | null\n  ): Unsubscribe | Subscribe<UploadTaskSnapshot> {\n    function typeValidator(): void {\n      if (type !== TaskEvent.STATE_CHANGED) {\n        throw `Expected one of the event types: [${TaskEvent.STATE_CHANGED}].`;\n      }\n    }\n    const nextOrObserverMessage =\n      'Expected a function or an Object with one of ' +\n      '`next`, `error`, `complete` properties.';\n    const nextValidator = nullFunctionSpec(true).validator;\n    const observerValidator = looseObjectSpec(null, true).validator;\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    function nextOrObserverValidator(p: any): void {\n      try {\n        nextValidator(p);\n        return;\n      } catch (e) {}\n      try {\n        observerValidator(p);\n        const anyDefined =\n          typeUtils.isJustDef(p['next']) ||\n          typeUtils.isJustDef(p['error']) ||\n          typeUtils.isJustDef(p['complete']);\n        if (!anyDefined) {\n          throw '';\n        }\n        return;\n      } catch (e) {\n        throw nextOrObserverMessage;\n      }\n    }\n    const specs = [\n      stringSpec(typeValidator),\n      looseObjectSpec(nextOrObserverValidator, true),\n      nullFunctionSpec(true),\n      nullFunctionSpec(true)\n    ];\n    validate('on', specs, arguments);\n    const self = this;\n\n    function makeBinder(\n      specs: ArgSpec[] | null\n    ): Subscribe<UploadTaskSnapshot> {\n      function binder(\n        nextOrObserver?:\n          | NextFn<UploadTaskSnapshot>\n          | StorageObserver<UploadTaskSnapshot>\n          | null,\n        error?: ErrorFn | null,\n        complete?: CompleteFn | null\n      ): () => void {\n        if (specs !== null) {\n          validate('on', specs, arguments);\n        }\n        const observer = new Observer(nextOrObserver, error, completed);\n        self.addObserver_(observer);\n        return () => {\n          self.removeObserver_(observer);\n        };\n      }\n      return binder;\n    }\n\n    function binderNextOrObserverValidator(p: unknown): void {\n      if (p === null) {\n        throw nextOrObserverMessage;\n      }\n      nextOrObserverValidator(p);\n    }\n    const binderSpecs = [\n      looseObjectSpec(binderNextOrObserverValidator),\n      nullFunctionSpec(true),\n      nullFunctionSpec(true)\n    ];\n    const typeOnly = !(\n      typeUtils.isJustDef(nextOrObserver) ||\n      typeUtils.isJustDef(error) ||\n      typeUtils.isJustDef(completed)\n    );\n    if (typeOnly) {\n      return makeBinder(binderSpecs);\n    } else {\n      return makeBinder(null)(nextOrObserver, error, completed);\n    }\n  }\n\n  /**\n   * This object behaves like a Promise, and resolves with its snapshot data\n   * when the upload completes.\n   * @param onFulfilled The fulfillment callback. Promise chaining works as normal.\n   * @param onRejected The rejection callback.\n   */\n  then<U>(\n    onFulfilled?: ((value: UploadTaskSnapshot) => U | Promise<U>) | null,\n    onRejected?: ((error: Error) => U | Promise<U>) | null\n  ): Promise<U> {\n    // These casts are needed so that TypeScript can infer the types of the\n    // resulting Promise.\n    return this.promise_.then<U>(\n      onFulfilled as (value: UploadTaskSnapshot) => U | Promise<U>,\n      onRejected as ((error: unknown) => Promise<never>) | null\n    );\n  }\n\n  /**\n   * Equivalent to calling `then(null, onRejected)`.\n   */\n  catch<T>(onRejected: (p1: Error) => T | Promise<T>): Promise<T> {\n    return this.then(null, onRejected);\n  }\n\n  /**\n   * Adds the given observer.\n   */\n  private addObserver_(observer: Observer<UploadTaskSnapshot>): void {\n    this.observers_.push(observer);\n    this.notifyObserver_(observer);\n  }\n\n  /**\n   * Removes the given observer.\n   */\n  private removeObserver_(observer: Observer<UploadTaskSnapshot>): void {\n    const i = this.observers_.indexOf(observer);\n    if (i !== -1) {\n      this.observers_.splice(i, 1);\n    }\n  }\n\n  private notifyObservers_(): void {\n    this.finishPromise_();\n    const observers = this.observers_.slice();\n    observers.forEach(observer => {\n      this.notifyObserver_(observer);\n    });\n  }\n\n  private finishPromise_(): void {\n    if (this.resolve_ !== null) {\n      let triggered = true;\n      switch (taskStateFromInternalTaskState(this.state_)) {\n        case TaskState.SUCCESS:\n          fbsAsync(this.resolve_.bind(null, this.snapshot))();\n          break;\n        case TaskState.CANCELED:\n        case TaskState.ERROR:\n          const toCall = this.reject_ as (p1: Error) => void;\n          fbsAsync(toCall.bind(null, this.error_ as Error))();\n          break;\n        default:\n          triggered = false;\n          break;\n      }\n      if (triggered) {\n        this.resolve_ = null;\n        this.reject_ = null;\n      }\n    }\n  }\n\n  private notifyObserver_(observer: Observer<UploadTaskSnapshot>): void {\n    const externalState = taskStateFromInternalTaskState(this.state_);\n    switch (externalState) {\n      case TaskState.RUNNING:\n      case TaskState.PAUSED:\n        if (observer.next) {\n          fbsAsync(observer.next.bind(observer, this.snapshot))();\n        }\n        break;\n      case TaskState.SUCCESS:\n        if (observer.complete) {\n          fbsAsync(observer.complete.bind(observer))();\n        }\n        break;\n      case TaskState.CANCELED:\n      case TaskState.ERROR:\n        if (observer.error) {\n          fbsAsync(observer.error.bind(observer, this.error_ as Error))();\n        }\n        break;\n      default:\n        // TODO(andysoto): assert(false);\n        if (observer.error) {\n          fbsAsync(observer.error.bind(observer, this.error_ as Error))();\n        }\n    }\n  }\n\n  /**\n   * Resumes a paused task. Has no effect on a currently running or failed task.\n   * @return True if the operation took effect, false if ignored.\n   */\n  resume(): boolean {\n    validate('resume', [], arguments);\n    const valid =\n      this.state_ === InternalTaskState.PAUSED ||\n      this.state_ === InternalTaskState.PAUSING;\n    if (valid) {\n      this.transition_(InternalTaskState.RUNNING);\n    }\n    return valid;\n  }\n\n  /**\n   * Pauses a currently running task. Has no effect on a paused or failed task.\n   * @return True if the operation took effect, false if ignored.\n   */\n  pause(): boolean {\n    validate('pause', [], arguments);\n    const valid = this.state_ === InternalTaskState.RUNNING;\n    if (valid) {\n      this.transition_(InternalTaskState.PAUSING);\n    }\n    return valid;\n  }\n\n  /**\n   * Cancels a currently running or paused task. Has no effect on a complete or\n   * failed task.\n   * @return True if the operation took effect, false if ignored.\n   */\n  cancel(): boolean {\n    validate('cancel', [], arguments);\n    const valid =\n      this.state_ === InternalTaskState.RUNNING ||\n      this.state_ === InternalTaskState.PAUSING;\n    if (valid) {\n      this.transition_(InternalTaskState.CANCELING);\n    }\n    return valid;\n  }\n}\n","/**\n * @license\n * Copyright 2019 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Defines the Firebase Storage Reference class.\n */\nimport { AuthWrapper } from './implementation/authwrapper';\nimport { FbsBlob } from './implementation/blob';\nimport * as errorsExports from './implementation/error';\nimport { Location } from './implementation/location';\nimport * as metadata from './implementation/metadata';\nimport * as path from './implementation/path';\nimport * as requests from './implementation/requests';\nimport {\n  StringFormat,\n  formatValidator,\n  dataFromString\n} from './implementation/string';\nimport * as type from './implementation/type';\nimport { Metadata } from './metadata';\nimport { Service } from './service';\nimport { UploadTask } from './task';\nimport { ListOptions, ListResult } from './list';\nimport {\n  listOptionSpec,\n  stringSpec,\n  validate,\n  metadataSpec,\n  uploadDataSpec\n} from './implementation/args';\n\n/**\n * Provides methods to interact with a bucket in the Firebase Storage service.\n * @param location An fbs.location, or the URL at\n *     which to base this object, in one of the following forms:\n *         gs://<bucket>/<object-path>\n *         http[s]://firebasestorage.googleapis.com/\n *                     <api-version>/b/<bucket>/o/<object-path>\n *     Any query or fragment strings will be ignored in the http[s]\n *     format. If no value is passed, the storage object will use a URL based on\n *     the project ID of the base firebase.App instance.\n */\nexport class Reference {\n  protected location: Location;\n\n  constructor(protected authWrapper: AuthWrapper, location: string | Location) {\n    if (location instanceof Location) {\n      this.location = location;\n    } else {\n      this.location = Location.makeFromUrl(location);\n    }\n  }\n\n  /**\n   * @return The URL for the bucket and path this object references,\n   *     in the form gs://<bucket>/<object-path>\n   * @override\n   */\n  toString(): string {\n    validate('toString', [], arguments);\n    return 'gs://' + this.location.bucket + '/' + this.location.path;\n  }\n\n  protected newRef(authWrapper: AuthWrapper, location: Location): Reference {\n    return new Reference(authWrapper, location);\n  }\n\n  protected mappings(): metadata.Mappings {\n    return metadata.getMappings();\n  }\n\n  /**\n   * @return A reference to the object obtained by\n   *     appending childPath, removing any duplicate, beginning, or trailing\n   *     slashes.\n   */\n  child(childPath: string): Reference {\n    validate('child', [stringSpec()], arguments);\n    const newPath = path.child(this.location.path, childPath);\n    const location = new Location(this.location.bucket, newPath);\n    return this.newRef(this.authWrapper, location);\n  }\n\n  /**\n   * @return A reference to the parent of the\n   *     current object, or null if the current object is the root.\n   */\n  get parent(): Reference | null {\n    const newPath = path.parent(this.location.path);\n    if (newPath === null) {\n      return null;\n    }\n    const location = new Location(this.location.bucket, newPath);\n    return this.newRef(this.authWrapper, location);\n  }\n\n  /**\n   * @return An reference to the root of this\n   *     object's bucket.\n   */\n  get root(): Reference {\n    const location = new Location(this.location.bucket, '');\n    return this.newRef(this.authWrapper, location);\n  }\n\n  get bucket(): string {\n    return this.location.bucket;\n  }\n\n  get fullPath(): string {\n    return this.location.path;\n  }\n\n  get name(): string {\n    return path.lastComponent(this.location.path);\n  }\n\n  get storage(): Service {\n    return this.authWrapper.service();\n  }\n\n  /**\n   * Uploads a blob to this object's location.\n   * @param data The blob to upload.\n   * @return An UploadTask that lets you control and\n   *     observe the upload.\n   */\n  put(\n    data: Blob | Uint8Array | ArrayBuffer,\n    metadata: Metadata | null = null\n  ): UploadTask {\n    validate('put', [uploadDataSpec(), metadataSpec(true)], arguments);\n    this.throwIfRoot_('put');\n    return new UploadTask(\n      this,\n      this.authWrapper,\n      this.location,\n      this.mappings(),\n      new FbsBlob(data),\n      metadata\n    );\n  }\n\n  /**\n   * Uploads a string to this object's location.\n   * @param value The string to upload.\n   * @param format The format of the string to upload.\n   * @return An UploadTask that lets you control and\n   *     observe the upload.\n   */\n  putString(\n    value: string,\n    format: StringFormat = StringFormat.RAW,\n    metadata?: Metadata\n  ): UploadTask {\n    validate(\n      'putString',\n      [stringSpec(), stringSpec(formatValidator, true), metadataSpec(true)],\n      arguments\n    );\n    this.throwIfRoot_('putString');\n    const data = dataFromString(format, value);\n    const metadataClone = Object.assign({}, metadata);\n    if (\n      !type.isDef(metadataClone['contentType']) &&\n      type.isDef(data.contentType)\n    ) {\n      metadataClone['contentType'] = data.contentType!;\n    }\n    return new UploadTask(\n      this,\n      this.authWrapper,\n      this.location,\n      this.mappings(),\n      new FbsBlob(data.data, true),\n      metadataClone\n    );\n  }\n\n  /**\n   * Deletes the object at this location.\n   * @return A promise that resolves if the deletion succeeds.\n   */\n  delete(): Promise<void> {\n    validate('delete', [], arguments);\n    this.throwIfRoot_('delete');\n    return this.authWrapper.getAuthToken().then(authToken => {\n      const requestInfo = requests.deleteObject(\n        this.authWrapper,\n        this.location\n      );\n      return this.authWrapper.makeRequest(requestInfo, authToken).getPromise();\n    });\n  }\n\n  /**\n   * List all items (files) and prefixes (folders) under this storage reference.\n   *\n   * This is a helper method for calling list() repeatedly until there are\n   * no more results. The default pagination size is 1000.\n   *\n   * Note: The results may not be consistent if objects are changed while this\n   * operation is running.\n   *\n   * Warning: listAll may potentially consume too many resources if there are\n   * too many results.\n   *\n   * @return A Promise that resolves with all the items and prefixes under\n   *      the current storage reference. `prefixes` contains references to\n   *      sub-directories and `items` contains references to objects in this\n   *      folder. `nextPageToken` is never returned.\n   */\n  listAll(): Promise<ListResult> {\n    validate('listAll', [], arguments);\n    const accumulator = {\n      prefixes: [],\n      items: []\n    };\n    return this.listAllHelper(accumulator).then(() => accumulator);\n  }\n\n  private async listAllHelper(\n    accumulator: ListResult,\n    pageToken?: string\n  ): Promise<void> {\n    const opt: ListOptions = {\n      // maxResults is 1000 by default.\n      pageToken\n    };\n    const nextPage = await this.list(opt);\n    accumulator.prefixes.push(...nextPage.prefixes);\n    accumulator.items.push(...nextPage.items);\n    if (nextPage.nextPageToken != null) {\n      await this.listAllHelper(accumulator, nextPage.nextPageToken);\n    }\n  }\n\n  /**\n   * List items (files) and prefixes (folders) under this storage reference.\n   *\n   * List API is only available for Firebase Rules Version 2.\n   *\n   * GCS is a key-blob store. Firebase Storage imposes the semantic of '/'\n   * delimited folder structure.\n   * Refer to GCS's List API if you want to learn more.\n   *\n   * To adhere to Firebase Rules's Semantics, Firebase Storage does not\n   * support objects whose paths end with \"/\" or contain two consecutive\n   * \"/\"s. Firebase Storage List API will filter these unsupported objects.\n   * list() may fail if there are too many unsupported objects in the bucket.\n   *\n   * @param options See ListOptions for details.\n   * @return A Promise that resolves with the items and prefixes.\n   *      `prefixes` contains references to sub-folders and `items`\n   *      contains references to objects in this folder. `nextPageToken`\n   *      can be used to get the rest of the results.\n   */\n  list(options?: ListOptions | null): Promise<ListResult> {\n    validate('list', [listOptionSpec(true)], arguments);\n    const self = this;\n    return this.authWrapper.getAuthToken().then(authToken => {\n      const op = options || {};\n      const requestInfo = requests.list(\n        self.authWrapper,\n        self.location,\n        /*delimiter= */ '/',\n        op.pageToken,\n        op.maxResults\n      );\n      return self.authWrapper.makeRequest(requestInfo, authToken).getPromise();\n    });\n  }\n\n  /**\n   *     A promise that resolves with the metadata for this object. If this\n   *     object doesn't exist or metadata cannot be retreived, the promise is\n   *     rejected.\n   */\n  getMetadata(): Promise<Metadata> {\n    validate('getMetadata', [], arguments);\n    this.throwIfRoot_('getMetadata');\n    return this.authWrapper.getAuthToken().then(authToken => {\n      const requestInfo = requests.getMetadata(\n        this.authWrapper,\n        this.location,\n        this.mappings()\n      );\n      return this.authWrapper.makeRequest(requestInfo, authToken).getPromise();\n    });\n  }\n\n  /**\n   * Updates the metadata for this object.\n   * @param metadata The new metadata for the object.\n   *     Only values that have been explicitly set will be changed. Explicitly\n   *     setting a value to null will remove the metadata.\n   * @return A promise that resolves\n   *     with the new metadata for this object.\n   *     @see firebaseStorage.Reference.prototype.getMetadata\n   */\n  updateMetadata(metadata: Metadata): Promise<Metadata> {\n    validate('updateMetadata', [metadataSpec()], arguments);\n    this.throwIfRoot_('updateMetadata');\n    return this.authWrapper.getAuthToken().then(authToken => {\n      const requestInfo = requests.updateMetadata(\n        this.authWrapper,\n        this.location,\n        metadata,\n        this.mappings()\n      );\n      return this.authWrapper.makeRequest(requestInfo, authToken).getPromise();\n    });\n  }\n\n  /**\n   * @return A promise that resolves with the download\n   *     URL for this object.\n   */\n  getDownloadURL(): Promise<string> {\n    validate('getDownloadURL', [], arguments);\n    this.throwIfRoot_('getDownloadURL');\n    return this.authWrapper.getAuthToken().then(authToken => {\n      const requestInfo = requests.getDownloadUrl(\n        this.authWrapper,\n        this.location,\n        this.mappings()\n      );\n      return this.authWrapper\n        .makeRequest(requestInfo, authToken)\n        .getPromise()\n        .then(url => {\n          if (url === null) {\n            throw errorsExports.noDownloadURL();\n          }\n          return url;\n        });\n    });\n  }\n\n  private throwIfRoot_(name: string): void {\n    if (this.location.path === '') {\n      throw errorsExports.invalidRootOperation(name);\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { FirebaseStorageError } from './error';\nimport { Request } from './request';\n\n/**\n * A request whose promise always fails.\n * @struct\n * @template T\n */\nexport class FailRequest<T> implements Request<T> {\n  promise_: Promise<T>;\n\n  constructor(error: FirebaseStorageError) {\n    this.promise_ = Promise.reject<T>(error);\n  }\n\n  /** @inheritDoc */\n  getPromise(): Promise<T> {\n    return this.promise_;\n  }\n\n  /** @inheritDoc */\n  cancel(_appDelete = false): void {}\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Request } from './request';\nimport * as constants from './constants';\n\nexport class RequestMap {\n  private readonly map: Map<number, Request<unknown>> = new Map();\n  private id: number;\n\n  constructor() {\n    this.id = constants.MIN_SAFE_INTEGER;\n  }\n\n  /**\n   * Registers the given request with this map.\n   * The request is unregistered when it completes.\n   *\n   * @param request The request to register.\n   */\n  addRequest(request: Request<unknown>): void {\n    const id = this.id;\n    this.id++;\n    this.map.set(id, request);\n\n    request.getPromise().then(\n      () => this.map.delete(id),\n      () => this.map.delete(id)\n    );\n  }\n\n  /**\n   * Cancels all registered requests.\n   */\n  clear(): void {\n    this.map.forEach(v => {\n      v && v.cancel(true);\n    });\n    this.map.clear();\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Reference } from '../reference';\nimport { Service } from '../service';\nimport * as constants from './constants';\nimport * as errorsExports from './error';\nimport { FailRequest } from './failrequest';\nimport { Location } from './location';\nimport { Request } from './request';\nimport { RequestInfo } from './requestinfo';\nimport { requestMaker } from './requestmaker';\nimport { RequestMap } from './requestmap';\nimport * as type from './type';\nimport { XhrIoPool } from './xhriopool';\nimport { FirebaseApp, FirebaseOptions } from '@firebase/app-types';\nimport {\n  _FirebaseApp,\n  FirebaseAuthTokenData\n} from '@firebase/app-types/private';\nimport { Provider } from '@firebase/component';\nimport { FirebaseAuthInternalName } from '@firebase/auth-interop-types';\n\n/**\n * @param app If null, getAuthToken always resolves with null.\n * @param service The storage service associated with this auth wrapper.\n *     Untyped to avoid circular type dependencies.\n * @struct\n */\nexport class AuthWrapper {\n  private app_: FirebaseApp | null;\n  private authProvider_: Provider<FirebaseAuthInternalName>;\n  private bucket_: string | null = null;\n\n  private storageRefMaker_: (p1: AuthWrapper, p2: Location) => Reference;\n  private requestMaker_: requestMaker;\n  private pool_: XhrIoPool;\n  private service_: Service;\n  private maxOperationRetryTime_: number;\n  private maxUploadRetryTime_: number;\n  private requestMap_: RequestMap;\n  private deleted_: boolean = false;\n\n  constructor(\n    app: FirebaseApp | null,\n    authProvider: Provider<FirebaseAuthInternalName>,\n    maker: (p1: AuthWrapper, p2: Location) => Reference,\n    requestMaker: requestMaker,\n    service: Service,\n    pool: XhrIoPool\n  ) {\n    this.app_ = app;\n    if (this.app_ !== null) {\n      const options = this.app_.options;\n      if (type.isDef(options)) {\n        this.bucket_ = AuthWrapper.extractBucket_(options);\n      }\n    }\n    this.authProvider_ = authProvider;\n    this.storageRefMaker_ = maker;\n    this.requestMaker_ = requestMaker;\n    this.pool_ = pool;\n    this.service_ = service;\n    this.maxOperationRetryTime_ = constants.DEFAULT_MAX_OPERATION_RETRY_TIME;\n    this.maxUploadRetryTime_ = constants.DEFAULT_MAX_UPLOAD_RETRY_TIME;\n    this.requestMap_ = new RequestMap();\n  }\n\n  private static extractBucket_(config: FirebaseOptions): string | null {\n    const bucketString = config[constants.CONFIG_STORAGE_BUCKET_KEY] || null;\n    if (bucketString == null) {\n      return null;\n    }\n    const loc: Location = Location.makeFromBucketSpec(bucketString);\n    return loc.bucket;\n  }\n\n  getAuthToken(): Promise<string | null> {\n    const auth = this.authProvider_.getImmediate({ optional: true });\n    if (auth) {\n      return auth.getToken().then(\n        (response: FirebaseAuthTokenData | null): string | null => {\n          if (response !== null) {\n            return response.accessToken;\n          } else {\n            return null;\n          }\n        },\n        () => null\n      );\n    } else {\n      return Promise.resolve(null);\n    }\n  }\n\n  bucket(): string | null {\n    if (this.deleted_) {\n      throw errorsExports.appDeleted();\n    } else {\n      return this.bucket_;\n    }\n  }\n\n  /**\n   * The service associated with this auth wrapper. Untyped to avoid circular\n   * type dependencies.\n   */\n  service(): Service {\n    return this.service_;\n  }\n\n  /**\n   * Returns a new firebaseStorage.Reference object referencing this AuthWrapper\n   * at the given Location.\n   * @param loc The Location.\n   * @return Actually a firebaseStorage.Reference, typing not allowed\n   *     because of circular dependency problems.\n   */\n  makeStorageReference(loc: Location): Reference {\n    return this.storageRefMaker_(this, loc);\n  }\n\n  makeRequest<T>(\n    requestInfo: RequestInfo<T>,\n    authToken: string | null\n  ): Request<T> {\n    if (!this.deleted_) {\n      const request = this.requestMaker_(requestInfo, authToken, this.pool_);\n      this.requestMap_.addRequest(request);\n      return request;\n    } else {\n      return new FailRequest(errorsExports.appDeleted());\n    }\n  }\n\n  /**\n   * Stop running requests and prevent more from being created.\n   */\n  deleteApp(): void {\n    this.deleted_ = true;\n    this.app_ = null;\n    this.requestMap_.clear();\n  }\n\n  maxUploadRetryTime(): number {\n    return this.maxUploadRetryTime_;\n  }\n\n  setMaxUploadRetryTime(time: number): void {\n    this.maxUploadRetryTime_ = time;\n  }\n\n  maxOperationRetryTime(): number {\n    return this.maxOperationRetryTime_;\n  }\n\n  setMaxOperationRetryTime(time: number): void {\n    this.maxOperationRetryTime_ = time;\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Defines methods used to actually send HTTP requests from\n * abstract representations.\n */\n\nimport firebase from '@firebase/app';\nimport * as backoff from './backoff';\nimport {\n  FirebaseStorageError,\n  unknown,\n  appDeleted,\n  canceled,\n  retryLimitExceeded\n} from './error';\nimport { RequestInfo } from './requestinfo';\nimport * as type from './type';\nimport * as UrlUtils from './url';\nimport { Headers, XhrIo, ErrorCode } from './xhrio';\nimport { XhrIoPool } from './xhriopool';\n\n/**\n * @template T\n */\nexport interface Request<T> {\n  getPromise(): Promise<T>;\n\n  /**\n   * Cancels the request. IMPORTANT: the promise may still be resolved with an\n   * appropriate value (if the request is finished before you call this method,\n   * but the promise has not yet been resolved), so don't just assume it will be\n   * rejected if you call this function.\n   * @param appDelete True if the cancelation came from the app being deleted.\n   */\n  cancel(appDelete?: boolean): void;\n}\n\n/**\n * @struct\n * @template T\n */\nclass NetworkRequest<T> implements Request<T> {\n  private url_: string;\n  private method_: string;\n  private headers_: Headers;\n  private body_: string | Blob | Uint8Array | null;\n  private successCodes_: number[];\n  private additionalRetryCodes_: number[];\n  private pendingXhr_: XhrIo | null = null;\n  private backoffId_: backoff.id | null = null;\n  private resolve_: Function | null = null;\n  private reject_: Function | null = null;\n  private canceled_: boolean = false;\n  private appDelete_: boolean = false;\n  private callback_: (p1: XhrIo, p2: string) => T;\n  private errorCallback_:\n    | ((p1: XhrIo, p2: FirebaseStorageError) => FirebaseStorageError)\n    | null;\n  private progressCallback_: ((p1: number, p2: number) => void) | null;\n  private timeout_: number;\n  private pool_: XhrIoPool;\n  promise_: Promise<T>;\n\n  constructor(\n    url: string,\n    method: string,\n    headers: Headers,\n    body: string | Blob | Uint8Array | null,\n    successCodes: number[],\n    additionalRetryCodes: number[],\n    callback: (p1: XhrIo, p2: string) => T,\n    errorCallback:\n      | ((p1: XhrIo, p2: FirebaseStorageError) => FirebaseStorageError)\n      | null,\n    timeout: number,\n    progressCallback: ((p1: number, p2: number) => void) | null,\n    pool: XhrIoPool\n  ) {\n    this.url_ = url;\n    this.method_ = method;\n    this.headers_ = headers;\n    this.body_ = body;\n    this.successCodes_ = successCodes.slice();\n    this.additionalRetryCodes_ = additionalRetryCodes.slice();\n    this.callback_ = callback;\n    this.errorCallback_ = errorCallback;\n    this.progressCallback_ = progressCallback;\n    this.timeout_ = timeout;\n    this.pool_ = pool;\n    this.promise_ = new Promise((resolve, reject) => {\n      this.resolve_ = resolve;\n      this.reject_ = reject;\n      this.start_();\n    });\n  }\n\n  /**\n   * Actually starts the retry loop.\n   */\n  private start_(): void {\n    const self = this;\n\n    function doTheRequest(\n      backoffCallback: (p1: boolean, ...p2: unknown[]) => void,\n      canceled: boolean\n    ): void {\n      if (canceled) {\n        backoffCallback(false, new RequestEndStatus(false, null, true));\n        return;\n      }\n      const xhr = self.pool_.createXhrIo();\n      self.pendingXhr_ = xhr;\n\n      function progressListener(progressEvent: ProgressEvent): void {\n        const loaded = progressEvent.loaded;\n        const total = progressEvent.lengthComputable ? progressEvent.total : -1;\n        if (self.progressCallback_ !== null) {\n          self.progressCallback_(loaded, total);\n        }\n      }\n      if (self.progressCallback_ !== null) {\n        xhr.addUploadProgressListener(progressListener);\n      }\n\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      xhr\n        .send(self.url_, self.method_, self.body_, self.headers_)\n        .then((xhr: XhrIo) => {\n          if (self.progressCallback_ !== null) {\n            xhr.removeUploadProgressListener(progressListener);\n          }\n          self.pendingXhr_ = null;\n          xhr = xhr as XhrIo;\n          const hitServer = xhr.getErrorCode() === ErrorCode.NO_ERROR;\n          const status = xhr.getStatus();\n          if (!hitServer || self.isRetryStatusCode_(status)) {\n            const wasCanceled = xhr.getErrorCode() === ErrorCode.ABORT;\n            backoffCallback(\n              false,\n              new RequestEndStatus(false, null, wasCanceled)\n            );\n            return;\n          }\n          const successCode = self.successCodes_.indexOf(status) !== -1;\n          backoffCallback(true, new RequestEndStatus(successCode, xhr));\n        });\n    }\n\n    /**\n     * @param requestWentThrough True if the request eventually went\n     *     through, false if it hit the retry limit or was canceled.\n     */\n    function backoffDone(\n      requestWentThrough: boolean,\n      status: RequestEndStatus\n    ): void {\n      const resolve = self.resolve_ as Function;\n      const reject = self.reject_ as Function;\n      const xhr = status.xhr as XhrIo;\n      if (status.wasSuccessCode) {\n        try {\n          const result = self.callback_(xhr, xhr.getResponseText());\n          if (type.isJustDef(result)) {\n            resolve(result);\n          } else {\n            resolve();\n          }\n        } catch (e) {\n          reject(e);\n        }\n      } else {\n        if (xhr !== null) {\n          const err = unknown();\n          err.setServerResponseProp(xhr.getResponseText());\n          if (self.errorCallback_) {\n            reject(self.errorCallback_(xhr, err));\n          } else {\n            reject(err);\n          }\n        } else {\n          if (status.canceled) {\n            const err = self.appDelete_ ? appDeleted() : canceled();\n            reject(err);\n          } else {\n            const err = retryLimitExceeded();\n            reject(err);\n          }\n        }\n      }\n    }\n    if (this.canceled_) {\n      backoffDone(false, new RequestEndStatus(false, null, true));\n    } else {\n      this.backoffId_ = backoff.start(doTheRequest, backoffDone, this.timeout_);\n    }\n  }\n\n  /** @inheritDoc */\n  getPromise(): Promise<T> {\n    return this.promise_;\n  }\n\n  /** @inheritDoc */\n  cancel(appDelete?: boolean): void {\n    this.canceled_ = true;\n    this.appDelete_ = appDelete || false;\n    if (this.backoffId_ !== null) {\n      backoff.stop(this.backoffId_);\n    }\n    if (this.pendingXhr_ !== null) {\n      this.pendingXhr_.abort();\n    }\n  }\n\n  private isRetryStatusCode_(status: number): boolean {\n    // The codes for which to retry came from this page:\n    // https://cloud.google.com/storage/docs/exponential-backoff\n    const isFiveHundredCode = status >= 500 && status < 600;\n    const extraRetryCodes = [\n      // Request Timeout: web server didn't receive full request in time.\n      408,\n      // Too Many Requests: you're getting rate-limited, basically.\n      429\n    ];\n    const isExtraRetryCode = extraRetryCodes.indexOf(status) !== -1;\n    const isRequestSpecificRetryCode =\n      this.additionalRetryCodes_.indexOf(status) !== -1;\n    return isFiveHundredCode || isExtraRetryCode || isRequestSpecificRetryCode;\n  }\n}\n\n/**\n * A collection of information about the result of a network request.\n * @param opt_canceled Defaults to false.\n * @struct\n */\nexport class RequestEndStatus {\n  /**\n   * True if the request was canceled.\n   */\n  canceled: boolean;\n\n  constructor(\n    public wasSuccessCode: boolean,\n    public xhr: XhrIo | null,\n    canceled?: boolean\n  ) {\n    this.canceled = !!canceled;\n  }\n}\n\nexport function addAuthHeader_(\n  headers: Headers,\n  authToken: string | null\n): void {\n  if (authToken !== null && authToken.length > 0) {\n    headers['Authorization'] = 'Firebase ' + authToken;\n  }\n}\n\nexport function addVersionHeader_(headers: Headers): void {\n  const version =\n    typeof firebase !== 'undefined' ? firebase.SDK_VERSION : 'AppManager';\n  headers['X-Firebase-Storage-Version'] = 'webjs/' + version;\n}\n\n/**\n * @template T\n */\nexport function makeRequest<T>(\n  requestInfo: RequestInfo<T>,\n  authToken: string | null,\n  pool: XhrIoPool\n): Request<T> {\n  const queryPart = UrlUtils.makeQueryString(requestInfo.urlParams);\n  const url = requestInfo.url + queryPart;\n  const headers = Object.assign({}, requestInfo.headers);\n  addAuthHeader_(headers, authToken);\n  addVersionHeader_(headers);\n  return new NetworkRequest<T>(\n    url,\n    requestInfo.method,\n    headers,\n    requestInfo.body,\n    requestInfo.successCodes,\n    requestInfo.additionalRetryCodes,\n    requestInfo.handler,\n    requestInfo.errorHandler,\n    requestInfo.timeout,\n    requestInfo.progressCallback,\n    pool\n  );\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Provides a method for running a function with exponential\n * backoff.\n */\ntype id = (p1: boolean) => void;\n\nexport { id };\n\n/**\n * @param f May be invoked\n *     before the function returns.\n * @param callback Get all the arguments passed to the function\n *     passed to f, including the initial boolean.\n */\nexport function start(\n  f: (p1: (success: boolean) => void, canceled: boolean) => void,\n  callback: Function,\n  timeout: number\n): id {\n  // TODO(andysoto): make this code cleaner (probably refactor into an actual\n  // type instead of a bunch of functions with state shared in the closure)\n  let waitSeconds = 1;\n  // Would type this as \"number\" but that doesn't work for Node so ¯\\_(ツ)_/¯\n  // TODO: find a way to exclude Node type definition for storage because storage only works in browser\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  let timeoutId: any = null;\n  let hitTimeout = false;\n  let cancelState = 0;\n\n  function canceled(): boolean {\n    return cancelState === 2;\n  }\n  let triggeredCallback = false;\n\n  // TODO: This disable can be removed and the 'ignoreRestArgs' option added to\n  // the no-explicit-any rule when ESlint releases it.\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  function triggerCallback(...args: any[]): void {\n    if (!triggeredCallback) {\n      triggeredCallback = true;\n      callback.apply(null, args);\n    }\n  }\n\n  function callWithDelay(millis: number): void {\n    timeoutId = setTimeout(() => {\n      timeoutId = null;\n      f(handler, canceled());\n    }, millis);\n  }\n\n  // TODO: This disable can be removed and the 'ignoreRestArgs' option added to\n  // the no-explicit-any rule when ESlint releases it.\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  function handler(success: boolean, ...args: any[]): void {\n    if (triggeredCallback) {\n      return;\n    }\n    if (success) {\n      triggerCallback.call(null, success, ...args);\n      return;\n    }\n    const mustStop = canceled() || hitTimeout;\n    if (mustStop) {\n      triggerCallback.call(null, success, ...args);\n      return;\n    }\n    if (waitSeconds < 64) {\n      /* TODO(andysoto): don't back off so quickly if we know we're offline. */\n      waitSeconds *= 2;\n    }\n    let waitMillis;\n    if (cancelState === 1) {\n      cancelState = 2;\n      waitMillis = 0;\n    } else {\n      waitMillis = (waitSeconds + Math.random()) * 1000;\n    }\n    callWithDelay(waitMillis);\n  }\n  let stopped = false;\n\n  function stop(wasTimeout: boolean): void {\n    if (stopped) {\n      return;\n    }\n    stopped = true;\n    if (triggeredCallback) {\n      return;\n    }\n    if (timeoutId !== null) {\n      if (!wasTimeout) {\n        cancelState = 2;\n      }\n      clearTimeout(timeoutId);\n      callWithDelay(0);\n    } else {\n      if (!wasTimeout) {\n        cancelState = 1;\n      }\n    }\n  }\n  callWithDelay(0);\n  setTimeout(() => {\n    hitTimeout = true;\n    stop(true);\n  }, timeout);\n  return stop;\n}\n\n/**\n * Stops the retry loop from repeating.\n * If the function is currently \"in between\" retries, it is invoked immediately\n * with the second parameter as \"true\". Otherwise, it will be invoked once more\n * after the current invocation finishes iff the current invocation would have\n * triggered another retry.\n */\nexport function stop(id: id): void {\n  id(false);\n}\n","/**\n * @license\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { FirebaseApp } from '@firebase/app-types';\nimport * as args from './implementation/args';\nimport { AuthWrapper } from './implementation/authwrapper';\nimport { Location } from './implementation/location';\nimport * as RequestExports from './implementation/request';\nimport { XhrIoPool } from './implementation/xhriopool';\nimport { Reference } from './reference';\nimport { Provider } from '@firebase/component';\nimport { FirebaseAuthInternalName } from '@firebase/auth-interop-types';\n\n/**\n * A service that provides firebaseStorage.Reference instances.\n * @param opt_url gs:// url to a custom Storage Bucket\n *\n * @struct\n */\nexport class Service {\n  authWrapper_: AuthWrapper;\n  private app_: FirebaseApp;\n  private bucket_: Location | null = null;\n  private internals_: ServiceInternals;\n\n  constructor(\n    app: FirebaseApp,\n    authProvider: Provider<FirebaseAuthInternalName>,\n    pool: XhrIoPool,\n    url?: string\n  ) {\n    function maker(authWrapper: AuthWrapper, loc: Location): Reference {\n      return new Reference(authWrapper, loc);\n    }\n    this.authWrapper_ = new AuthWrapper(\n      app,\n      authProvider,\n      maker,\n      RequestExports.makeRequest,\n      this,\n      pool\n    );\n    this.app_ = app;\n    if (url != null) {\n      this.bucket_ = Location.makeFromBucketSpec(url);\n    } else {\n      const authWrapperBucket = this.authWrapper_.bucket();\n      if (authWrapperBucket != null) {\n        this.bucket_ = new Location(authWrapperBucket, '');\n      }\n    }\n    this.internals_ = new ServiceInternals(this);\n  }\n\n  /**\n   * Returns a firebaseStorage.Reference for the given path in the default\n   * bucket.\n   */\n  ref(path?: string): Reference {\n    function validator(path: unknown): void {\n      if (typeof path !== 'string') {\n        throw 'Path is not a string.';\n      }\n      if (/^[A-Za-z]+:\\/\\//.test(path as string)) {\n        throw 'Expected child path but got a URL, use refFromURL instead.';\n      }\n    }\n    args.validate('ref', [args.stringSpec(validator, true)], arguments);\n    if (this.bucket_ == null) {\n      throw new Error('No Storage Bucket defined in Firebase Options.');\n    }\n\n    const ref = new Reference(this.authWrapper_, this.bucket_);\n    if (path != null) {\n      return ref.child(path);\n    } else {\n      return ref;\n    }\n  }\n\n  /**\n   * Returns a firebaseStorage.Reference object for the given absolute URL,\n   * which must be a gs:// or http[s]:// URL.\n   */\n  refFromURL(url: string): Reference {\n    function validator(p: unknown): void {\n      if (typeof p !== 'string') {\n        throw 'Path is not a string.';\n      }\n      if (!/^[A-Za-z]+:\\/\\//.test(p as string)) {\n        throw 'Expected full URL but got a child path, use ref instead.';\n      }\n      try {\n        Location.makeFromUrl(p as string);\n      } catch (e) {\n        throw 'Expected valid full URL but got an invalid one.';\n      }\n    }\n    args.validate('refFromURL', [args.stringSpec(validator, false)], arguments);\n    return new Reference(this.authWrapper_, url);\n  }\n\n  get maxUploadRetryTime(): number {\n    return this.authWrapper_.maxUploadRetryTime();\n  }\n\n  setMaxUploadRetryTime(time: number): void {\n    args.validate(\n      'setMaxUploadRetryTime',\n      [args.nonNegativeNumberSpec()],\n      arguments\n    );\n    this.authWrapper_.setMaxUploadRetryTime(time);\n  }\n\n  setMaxOperationRetryTime(time: number): void {\n    args.validate(\n      'setMaxOperationRetryTime',\n      [args.nonNegativeNumberSpec()],\n      arguments\n    );\n    this.authWrapper_.setMaxOperationRetryTime(time);\n  }\n\n  get app(): FirebaseApp {\n    return this.app_;\n  }\n\n  get INTERNAL(): ServiceInternals {\n    return this.internals_;\n  }\n}\n\n/**\n * @struct\n */\nexport class ServiceInternals {\n  service_: Service;\n\n  constructor(service: Service) {\n    this.service_ = service;\n  }\n\n  /**\n   * Called when the associated app is deleted.\n   * @see {!fbs.AuthWrapper.prototype.deleteApp}\n   */\n  delete(): Promise<void> {\n    this.service_.authWrapper_.deleteApp();\n    return Promise.resolve();\n  }\n}\n","function isAbsolute(pathname) {\n  return pathname.charAt(0) === '/';\n}\n\n// About 1.5x faster than the two-arg version of Array#splice()\nfunction spliceOne(list, index) {\n  for (var i = index, k = i + 1, n = list.length; k < n; i += 1, k += 1) {\n    list[i] = list[k];\n  }\n\n  list.pop();\n}\n\n// This implementation is based heavily on node's url.parse\nfunction resolvePathname(to) {\n  var from = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n\n  var toParts = to && to.split('/') || [];\n  var fromParts = from && from.split('/') || [];\n\n  var isToAbs = to && isAbsolute(to);\n  var isFromAbs = from && isAbsolute(from);\n  var mustEndAbs = isToAbs || isFromAbs;\n\n  if (to && isAbsolute(to)) {\n    // to is absolute\n    fromParts = toParts;\n  } else if (toParts.length) {\n    // to is relative, drop the filename\n    fromParts.pop();\n    fromParts = fromParts.concat(toParts);\n  }\n\n  if (!fromParts.length) return '/';\n\n  var hasTrailingSlash = void 0;\n  if (fromParts.length) {\n    var last = fromParts[fromParts.length - 1];\n    hasTrailingSlash = last === '.' || last === '..' || last === '';\n  } else {\n    hasTrailingSlash = false;\n  }\n\n  var up = 0;\n  for (var i = fromParts.length; i >= 0; i--) {\n    var part = fromParts[i];\n\n    if (part === '.') {\n      spliceOne(fromParts, i);\n    } else if (part === '..') {\n      spliceOne(fromParts, i);\n      up++;\n    } else if (up) {\n      spliceOne(fromParts, i);\n      up--;\n    }\n  }\n\n  if (!mustEndAbs) for (; up--; up) {\n    fromParts.unshift('..');\n  }if (mustEndAbs && fromParts[0] !== '' && (!fromParts[0] || !isAbsolute(fromParts[0]))) fromParts.unshift('');\n\n  var result = fromParts.join('/');\n\n  if (hasTrailingSlash && result.substr(-1) !== '/') result += '/';\n\n  return result;\n}\n\nexport default resolvePathname;","var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction valueEqual(a, b) {\n  if (a === b) return true;\n\n  if (a == null || b == null) return false;\n\n  if (Array.isArray(a)) {\n    return Array.isArray(b) && a.length === b.length && a.every(function (item, index) {\n      return valueEqual(item, b[index]);\n    });\n  }\n\n  var aType = typeof a === 'undefined' ? 'undefined' : _typeof(a);\n  var bType = typeof b === 'undefined' ? 'undefined' : _typeof(b);\n\n  if (aType !== bType) return false;\n\n  if (aType === 'object') {\n    var aValue = a.valueOf();\n    var bValue = b.valueOf();\n\n    if (aValue !== a || bValue !== b) return valueEqual(aValue, bValue);\n\n    var aKeys = Object.keys(a);\n    var bKeys = Object.keys(b);\n\n    if (aKeys.length !== bKeys.length) return false;\n\n    return aKeys.every(function (key) {\n      return valueEqual(a[key], b[key]);\n    });\n  }\n\n  return false;\n}\n\nexport default valueEqual;","export var addLeadingSlash = function addLeadingSlash(path) {\n  return path.charAt(0) === '/' ? path : '/' + path;\n};\n\nexport var stripLeadingSlash = function stripLeadingSlash(path) {\n  return path.charAt(0) === '/' ? path.substr(1) : path;\n};\n\nexport var hasBasename = function hasBasename(path, prefix) {\n  return new RegExp('^' + prefix + '(\\\\/|\\\\?|#|$)', 'i').test(path);\n};\n\nexport var stripBasename = function stripBasename(path, prefix) {\n  return hasBasename(path, prefix) ? path.substr(prefix.length) : path;\n};\n\nexport var stripTrailingSlash = function stripTrailingSlash(path) {\n  return path.charAt(path.length - 1) === '/' ? path.slice(0, -1) : path;\n};\n\nexport var parsePath = function parsePath(path) {\n  var pathname = path || '/';\n  var search = '';\n  var hash = '';\n\n  var hashIndex = pathname.indexOf('#');\n  if (hashIndex !== -1) {\n    hash = pathname.substr(hashIndex);\n    pathname = pathname.substr(0, hashIndex);\n  }\n\n  var searchIndex = pathname.indexOf('?');\n  if (searchIndex !== -1) {\n    search = pathname.substr(searchIndex);\n    pathname = pathname.substr(0, searchIndex);\n  }\n\n  return {\n    pathname: pathname,\n    search: search === '?' ? '' : search,\n    hash: hash === '#' ? '' : hash\n  };\n};\n\nexport var createPath = function createPath(location) {\n  var pathname = location.pathname,\n      search = location.search,\n      hash = location.hash;\n\n\n  var path = pathname || '/';\n\n  if (search && search !== '?') path += search.charAt(0) === '?' ? search : '?' + search;\n\n  if (hash && hash !== '#') path += hash.charAt(0) === '#' ? hash : '#' + hash;\n\n  return path;\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport resolvePathname from 'resolve-pathname';\nimport valueEqual from 'value-equal';\nimport { parsePath } from './PathUtils';\n\nexport var createLocation = function createLocation(path, state, key, currentLocation) {\n  var location = void 0;\n  if (typeof path === 'string') {\n    // Two-arg form: push(path, state)\n    location = parsePath(path);\n    location.state = state;\n  } else {\n    // One-arg form: push(location)\n    location = _extends({}, path);\n\n    if (location.pathname === undefined) location.pathname = '';\n\n    if (location.search) {\n      if (location.search.charAt(0) !== '?') location.search = '?' + location.search;\n    } else {\n      location.search = '';\n    }\n\n    if (location.hash) {\n      if (location.hash.charAt(0) !== '#') location.hash = '#' + location.hash;\n    } else {\n      location.hash = '';\n    }\n\n    if (state !== undefined && location.state === undefined) location.state = state;\n  }\n\n  try {\n    location.pathname = decodeURI(location.pathname);\n  } catch (e) {\n    if (e instanceof URIError) {\n      throw new URIError('Pathname \"' + location.pathname + '\" could not be decoded. ' + 'This is likely caused by an invalid percent-encoding.');\n    } else {\n      throw e;\n    }\n  }\n\n  if (key) location.key = key;\n\n  if (currentLocation) {\n    // Resolve incomplete/relative pathname relative to current location.\n    if (!location.pathname) {\n      location.pathname = currentLocation.pathname;\n    } else if (location.pathname.charAt(0) !== '/') {\n      location.pathname = resolvePathname(location.pathname, currentLocation.pathname);\n    }\n  } else {\n    // When there is no prior location and pathname is empty, set it to /\n    if (!location.pathname) {\n      location.pathname = '/';\n    }\n  }\n\n  return location;\n};\n\nexport var locationsAreEqual = function locationsAreEqual(a, b) {\n  return a.pathname === b.pathname && a.search === b.search && a.hash === b.hash && a.key === b.key && valueEqual(a.state, b.state);\n};","import warning from 'warning';\n\nvar createTransitionManager = function createTransitionManager() {\n  var prompt = null;\n\n  var setPrompt = function setPrompt(nextPrompt) {\n    warning(prompt == null, 'A history supports only one prompt at a time');\n\n    prompt = nextPrompt;\n\n    return function () {\n      if (prompt === nextPrompt) prompt = null;\n    };\n  };\n\n  var confirmTransitionTo = function confirmTransitionTo(location, action, getUserConfirmation, callback) {\n    // TODO: If another transition starts while we're still confirming\n    // the previous one, we may end up in a weird state. Figure out the\n    // best way to handle this.\n    if (prompt != null) {\n      var result = typeof prompt === 'function' ? prompt(location, action) : prompt;\n\n      if (typeof result === 'string') {\n        if (typeof getUserConfirmation === 'function') {\n          getUserConfirmation(result, callback);\n        } else {\n          warning(false, 'A history needs a getUserConfirmation function in order to use a prompt message');\n\n          callback(true);\n        }\n      } else {\n        // Return false from a transition hook to cancel the transition.\n        callback(result !== false);\n      }\n    } else {\n      callback(true);\n    }\n  };\n\n  var listeners = [];\n\n  var appendListener = function appendListener(fn) {\n    var isActive = true;\n\n    var listener = function listener() {\n      if (isActive) fn.apply(undefined, arguments);\n    };\n\n    listeners.push(listener);\n\n    return function () {\n      isActive = false;\n      listeners = listeners.filter(function (item) {\n        return item !== listener;\n      });\n    };\n  };\n\n  var notifyListeners = function notifyListeners() {\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    listeners.forEach(function (listener) {\n      return listener.apply(undefined, args);\n    });\n  };\n\n  return {\n    setPrompt: setPrompt,\n    confirmTransitionTo: confirmTransitionTo,\n    appendListener: appendListener,\n    notifyListeners: notifyListeners\n  };\n};\n\nexport default createTransitionManager;","export var canUseDOM = !!(typeof window !== 'undefined' && window.document && window.document.createElement);\n\nexport var addEventListener = function addEventListener(node, event, listener) {\n  return node.addEventListener ? node.addEventListener(event, listener, false) : node.attachEvent('on' + event, listener);\n};\n\nexport var removeEventListener = function removeEventListener(node, event, listener) {\n  return node.removeEventListener ? node.removeEventListener(event, listener, false) : node.detachEvent('on' + event, listener);\n};\n\nexport var getConfirmation = function getConfirmation(message, callback) {\n  return callback(window.confirm(message));\n}; // eslint-disable-line no-alert\n\n/**\n * Returns true if the HTML5 history API is supported. Taken from Modernizr.\n *\n * https://github.com/Modernizr/Modernizr/blob/master/LICENSE\n * https://github.com/Modernizr/Modernizr/blob/master/feature-detects/history.js\n * changed to avoid false negatives for Windows Phones: https://github.com/reactjs/react-router/issues/586\n */\nexport var supportsHistory = function supportsHistory() {\n  var ua = window.navigator.userAgent;\n\n  if ((ua.indexOf('Android 2.') !== -1 || ua.indexOf('Android 4.0') !== -1) && ua.indexOf('Mobile Safari') !== -1 && ua.indexOf('Chrome') === -1 && ua.indexOf('Windows Phone') === -1) return false;\n\n  return window.history && 'pushState' in window.history;\n};\n\n/**\n * Returns true if browser fires popstate on hash change.\n * IE10 and IE11 do not.\n */\nexport var supportsPopStateOnHashChange = function supportsPopStateOnHashChange() {\n  return window.navigator.userAgent.indexOf('Trident') === -1;\n};\n\n/**\n * Returns false if using go(n) with hash history causes a full page reload.\n */\nexport var supportsGoWithoutReloadUsingHash = function supportsGoWithoutReloadUsingHash() {\n  return window.navigator.userAgent.indexOf('Firefox') === -1;\n};\n\n/**\n * Returns true if a given popstate event is an extraneous WebKit event.\n * Accounts for the fact that Chrome on iOS fires real popstate events\n * containing undefined state when pressing the back button.\n */\nexport var isExtraneousPopstateEvent = function isExtraneousPopstateEvent(event) {\n  return event.state === undefined && navigator.userAgent.indexOf('CriOS') === -1;\n};","var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport warning from 'warning';\nimport invariant from 'invariant';\nimport { createLocation } from './LocationUtils';\nimport { addLeadingSlash, stripTrailingSlash, hasBasename, stripBasename, createPath } from './PathUtils';\nimport createTransitionManager from './createTransitionManager';\nimport { canUseDOM, addEventListener, removeEventListener, getConfirmation, supportsHistory, supportsPopStateOnHashChange, isExtraneousPopstateEvent } from './DOMUtils';\n\nvar PopStateEvent = 'popstate';\nvar HashChangeEvent = 'hashchange';\n\nvar getHistoryState = function getHistoryState() {\n  try {\n    return window.history.state || {};\n  } catch (e) {\n    // IE 11 sometimes throws when accessing window.history.state\n    // See https://github.com/ReactTraining/history/pull/289\n    return {};\n  }\n};\n\n/**\n * Creates a history object that uses the HTML5 history API including\n * pushState, replaceState, and the popstate event.\n */\nvar createBrowserHistory = function createBrowserHistory() {\n  var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  invariant(canUseDOM, 'Browser history needs a DOM');\n\n  var globalHistory = window.history;\n  var canUseHistory = supportsHistory();\n  var needsHashChangeListener = !supportsPopStateOnHashChange();\n\n  var _props$forceRefresh = props.forceRefresh,\n      forceRefresh = _props$forceRefresh === undefined ? false : _props$forceRefresh,\n      _props$getUserConfirm = props.getUserConfirmation,\n      getUserConfirmation = _props$getUserConfirm === undefined ? getConfirmation : _props$getUserConfirm,\n      _props$keyLength = props.keyLength,\n      keyLength = _props$keyLength === undefined ? 6 : _props$keyLength;\n\n  var basename = props.basename ? stripTrailingSlash(addLeadingSlash(props.basename)) : '';\n\n  var getDOMLocation = function getDOMLocation(historyState) {\n    var _ref = historyState || {},\n        key = _ref.key,\n        state = _ref.state;\n\n    var _window$location = window.location,\n        pathname = _window$location.pathname,\n        search = _window$location.search,\n        hash = _window$location.hash;\n\n\n    var path = pathname + search + hash;\n\n    warning(!basename || hasBasename(path, basename), 'You are attempting to use a basename on a page whose URL path does not begin ' + 'with the basename. Expected path \"' + path + '\" to begin with \"' + basename + '\".');\n\n    if (basename) path = stripBasename(path, basename);\n\n    return createLocation(path, state, key);\n  };\n\n  var createKey = function createKey() {\n    return Math.random().toString(36).substr(2, keyLength);\n  };\n\n  var transitionManager = createTransitionManager();\n\n  var setState = function setState(nextState) {\n    _extends(history, nextState);\n\n    history.length = globalHistory.length;\n\n    transitionManager.notifyListeners(history.location, history.action);\n  };\n\n  var handlePopState = function handlePopState(event) {\n    // Ignore extraneous popstate events in WebKit.\n    if (isExtraneousPopstateEvent(event)) return;\n\n    handlePop(getDOMLocation(event.state));\n  };\n\n  var handleHashChange = function handleHashChange() {\n    handlePop(getDOMLocation(getHistoryState()));\n  };\n\n  var forceNextPop = false;\n\n  var handlePop = function handlePop(location) {\n    if (forceNextPop) {\n      forceNextPop = false;\n      setState();\n    } else {\n      var action = 'POP';\n\n      transitionManager.confirmTransitionTo(location, action, getUserConfirmation, function (ok) {\n        if (ok) {\n          setState({ action: action, location: location });\n        } else {\n          revertPop(location);\n        }\n      });\n    }\n  };\n\n  var revertPop = function revertPop(fromLocation) {\n    var toLocation = history.location;\n\n    // TODO: We could probably make this more reliable by\n    // keeping a list of keys we've seen in sessionStorage.\n    // Instead, we just default to 0 for keys we don't know.\n\n    var toIndex = allKeys.indexOf(toLocation.key);\n\n    if (toIndex === -1) toIndex = 0;\n\n    var fromIndex = allKeys.indexOf(fromLocation.key);\n\n    if (fromIndex === -1) fromIndex = 0;\n\n    var delta = toIndex - fromIndex;\n\n    if (delta) {\n      forceNextPop = true;\n      go(delta);\n    }\n  };\n\n  var initialLocation = getDOMLocation(getHistoryState());\n  var allKeys = [initialLocation.key];\n\n  // Public interface\n\n  var createHref = function createHref(location) {\n    return basename + createPath(location);\n  };\n\n  var push = function push(path, state) {\n    warning(!((typeof path === 'undefined' ? 'undefined' : _typeof(path)) === 'object' && path.state !== undefined && state !== undefined), 'You should avoid providing a 2nd state argument to push when the 1st ' + 'argument is a location-like object that already has state; it is ignored');\n\n    var action = 'PUSH';\n    var location = createLocation(path, state, createKey(), history.location);\n\n    transitionManager.confirmTransitionTo(location, action, getUserConfirmation, function (ok) {\n      if (!ok) return;\n\n      var href = createHref(location);\n      var key = location.key,\n          state = location.state;\n\n\n      if (canUseHistory) {\n        globalHistory.pushState({ key: key, state: state }, null, href);\n\n        if (forceRefresh) {\n          window.location.href = href;\n        } else {\n          var prevIndex = allKeys.indexOf(history.location.key);\n          var nextKeys = allKeys.slice(0, prevIndex === -1 ? 0 : prevIndex + 1);\n\n          nextKeys.push(location.key);\n          allKeys = nextKeys;\n\n          setState({ action: action, location: location });\n        }\n      } else {\n        warning(state === undefined, 'Browser history cannot push state in browsers that do not support HTML5 history');\n\n        window.location.href = href;\n      }\n    });\n  };\n\n  var replace = function replace(path, state) {\n    warning(!((typeof path === 'undefined' ? 'undefined' : _typeof(path)) === 'object' && path.state !== undefined && state !== undefined), 'You should avoid providing a 2nd state argument to replace when the 1st ' + 'argument is a location-like object that already has state; it is ignored');\n\n    var action = 'REPLACE';\n    var location = createLocation(path, state, createKey(), history.location);\n\n    transitionManager.confirmTransitionTo(location, action, getUserConfirmation, function (ok) {\n      if (!ok) return;\n\n      var href = createHref(location);\n      var key = location.key,\n          state = location.state;\n\n\n      if (canUseHistory) {\n        globalHistory.replaceState({ key: key, state: state }, null, href);\n\n        if (forceRefresh) {\n          window.location.replace(href);\n        } else {\n          var prevIndex = allKeys.indexOf(history.location.key);\n\n          if (prevIndex !== -1) allKeys[prevIndex] = location.key;\n\n          setState({ action: action, location: location });\n        }\n      } else {\n        warning(state === undefined, 'Browser history cannot replace state in browsers that do not support HTML5 history');\n\n        window.location.replace(href);\n      }\n    });\n  };\n\n  var go = function go(n) {\n    globalHistory.go(n);\n  };\n\n  var goBack = function goBack() {\n    return go(-1);\n  };\n\n  var goForward = function goForward() {\n    return go(1);\n  };\n\n  var listenerCount = 0;\n\n  var checkDOMListeners = function checkDOMListeners(delta) {\n    listenerCount += delta;\n\n    if (listenerCount === 1) {\n      addEventListener(window, PopStateEvent, handlePopState);\n\n      if (needsHashChangeListener) addEventListener(window, HashChangeEvent, handleHashChange);\n    } else if (listenerCount === 0) {\n      removeEventListener(window, PopStateEvent, handlePopState);\n\n      if (needsHashChangeListener) removeEventListener(window, HashChangeEvent, handleHashChange);\n    }\n  };\n\n  var isBlocked = false;\n\n  var block = function block() {\n    var prompt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    var unblock = transitionManager.setPrompt(prompt);\n\n    if (!isBlocked) {\n      checkDOMListeners(1);\n      isBlocked = true;\n    }\n\n    return function () {\n      if (isBlocked) {\n        isBlocked = false;\n        checkDOMListeners(-1);\n      }\n\n      return unblock();\n    };\n  };\n\n  var listen = function listen(listener) {\n    var unlisten = transitionManager.appendListener(listener);\n    checkDOMListeners(1);\n\n    return function () {\n      checkDOMListeners(-1);\n      unlisten();\n    };\n  };\n\n  var history = {\n    length: globalHistory.length,\n    action: 'POP',\n    location: initialLocation,\n    createHref: createHref,\n    push: push,\n    replace: replace,\n    go: go,\n    goBack: goBack,\n    goForward: goForward,\n    block: block,\n    listen: listen\n  };\n\n  return history;\n};\n\nexport default createBrowserHistory;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport warning from \"warning\";\nimport invariant from \"invariant\";\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\n\n/**\n * The public API for putting history on context.\n */\n\nvar Router = function (_React$Component) {\n  _inherits(Router, _React$Component);\n\n  function Router() {\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Router);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _React$Component.call.apply(_React$Component, [this].concat(args))), _this), _this.state = {\n      match: _this.computeMatch(_this.props.history.location.pathname)\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  Router.prototype.getChildContext = function getChildContext() {\n    return {\n      router: _extends({}, this.context.router, {\n        history: this.props.history,\n        route: {\n          location: this.props.history.location,\n          match: this.state.match\n        }\n      })\n    };\n  };\n\n  Router.prototype.computeMatch = function computeMatch(pathname) {\n    return {\n      path: \"/\",\n      url: \"/\",\n      params: {},\n      isExact: pathname === \"/\"\n    };\n  };\n\n  Router.prototype.componentWillMount = function componentWillMount() {\n    var _this2 = this;\n\n    var _props = this.props,\n        children = _props.children,\n        history = _props.history;\n\n\n    invariant(children == null || React.Children.count(children) === 1, \"A <Router> may have only one child element\");\n\n    // Do this here so we can setState when a <Redirect> changes the\n    // location in componentWillMount. This happens e.g. when doing\n    // server rendering using a <StaticRouter>.\n    this.unlisten = history.listen(function () {\n      _this2.setState({\n        match: _this2.computeMatch(history.location.pathname)\n      });\n    });\n  };\n\n  Router.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    warning(this.props.history === nextProps.history, \"You cannot change <Router history>\");\n  };\n\n  Router.prototype.componentWillUnmount = function componentWillUnmount() {\n    this.unlisten();\n  };\n\n  Router.prototype.render = function render() {\n    var children = this.props.children;\n\n    return children ? React.Children.only(children) : null;\n  };\n\n  return Router;\n}(React.Component);\n\nRouter.propTypes = {\n  history: PropTypes.object.isRequired,\n  children: PropTypes.node\n};\nRouter.contextTypes = {\n  router: PropTypes.object\n};\nRouter.childContextTypes = {\n  router: PropTypes.object.isRequired\n};\n\n\nexport default Router;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport warning from 'warning';\nimport invariant from 'invariant';\nimport { createLocation, locationsAreEqual } from './LocationUtils';\nimport { addLeadingSlash, stripLeadingSlash, stripTrailingSlash, hasBasename, stripBasename, createPath } from './PathUtils';\nimport createTransitionManager from './createTransitionManager';\nimport { canUseDOM, addEventListener, removeEventListener, getConfirmation, supportsGoWithoutReloadUsingHash } from './DOMUtils';\n\nvar HashChangeEvent = 'hashchange';\n\nvar HashPathCoders = {\n  hashbang: {\n    encodePath: function encodePath(path) {\n      return path.charAt(0) === '!' ? path : '!/' + stripLeadingSlash(path);\n    },\n    decodePath: function decodePath(path) {\n      return path.charAt(0) === '!' ? path.substr(1) : path;\n    }\n  },\n  noslash: {\n    encodePath: stripLeadingSlash,\n    decodePath: addLeadingSlash\n  },\n  slash: {\n    encodePath: addLeadingSlash,\n    decodePath: addLeadingSlash\n  }\n};\n\nvar getHashPath = function getHashPath() {\n  // We can't use window.location.hash here because it's not\n  // consistent across browsers - Firefox will pre-decode it!\n  var href = window.location.href;\n  var hashIndex = href.indexOf('#');\n  return hashIndex === -1 ? '' : href.substring(hashIndex + 1);\n};\n\nvar pushHashPath = function pushHashPath(path) {\n  return window.location.hash = path;\n};\n\nvar replaceHashPath = function replaceHashPath(path) {\n  var hashIndex = window.location.href.indexOf('#');\n\n  window.location.replace(window.location.href.slice(0, hashIndex >= 0 ? hashIndex : 0) + '#' + path);\n};\n\nvar createHashHistory = function createHashHistory() {\n  var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  invariant(canUseDOM, 'Hash history needs a DOM');\n\n  var globalHistory = window.history;\n  var canGoWithoutReload = supportsGoWithoutReloadUsingHash();\n\n  var _props$getUserConfirm = props.getUserConfirmation,\n      getUserConfirmation = _props$getUserConfirm === undefined ? getConfirmation : _props$getUserConfirm,\n      _props$hashType = props.hashType,\n      hashType = _props$hashType === undefined ? 'slash' : _props$hashType;\n\n  var basename = props.basename ? stripTrailingSlash(addLeadingSlash(props.basename)) : '';\n\n  var _HashPathCoders$hashT = HashPathCoders[hashType],\n      encodePath = _HashPathCoders$hashT.encodePath,\n      decodePath = _HashPathCoders$hashT.decodePath;\n\n\n  var getDOMLocation = function getDOMLocation() {\n    var path = decodePath(getHashPath());\n\n    warning(!basename || hasBasename(path, basename), 'You are attempting to use a basename on a page whose URL path does not begin ' + 'with the basename. Expected path \"' + path + '\" to begin with \"' + basename + '\".');\n\n    if (basename) path = stripBasename(path, basename);\n\n    return createLocation(path);\n  };\n\n  var transitionManager = createTransitionManager();\n\n  var setState = function setState(nextState) {\n    _extends(history, nextState);\n\n    history.length = globalHistory.length;\n\n    transitionManager.notifyListeners(history.location, history.action);\n  };\n\n  var forceNextPop = false;\n  var ignorePath = null;\n\n  var handleHashChange = function handleHashChange() {\n    var path = getHashPath();\n    var encodedPath = encodePath(path);\n\n    if (path !== encodedPath) {\n      // Ensure we always have a properly-encoded hash.\n      replaceHashPath(encodedPath);\n    } else {\n      var location = getDOMLocation();\n      var prevLocation = history.location;\n\n      if (!forceNextPop && locationsAreEqual(prevLocation, location)) return; // A hashchange doesn't always == location change.\n\n      if (ignorePath === createPath(location)) return; // Ignore this change; we already setState in push/replace.\n\n      ignorePath = null;\n\n      handlePop(location);\n    }\n  };\n\n  var handlePop = function handlePop(location) {\n    if (forceNextPop) {\n      forceNextPop = false;\n      setState();\n    } else {\n      var action = 'POP';\n\n      transitionManager.confirmTransitionTo(location, action, getUserConfirmation, function (ok) {\n        if (ok) {\n          setState({ action: action, location: location });\n        } else {\n          revertPop(location);\n        }\n      });\n    }\n  };\n\n  var revertPop = function revertPop(fromLocation) {\n    var toLocation = history.location;\n\n    // TODO: We could probably make this more reliable by\n    // keeping a list of paths we've seen in sessionStorage.\n    // Instead, we just default to 0 for paths we don't know.\n\n    var toIndex = allPaths.lastIndexOf(createPath(toLocation));\n\n    if (toIndex === -1) toIndex = 0;\n\n    var fromIndex = allPaths.lastIndexOf(createPath(fromLocation));\n\n    if (fromIndex === -1) fromIndex = 0;\n\n    var delta = toIndex - fromIndex;\n\n    if (delta) {\n      forceNextPop = true;\n      go(delta);\n    }\n  };\n\n  // Ensure the hash is encoded properly before doing anything else.\n  var path = getHashPath();\n  var encodedPath = encodePath(path);\n\n  if (path !== encodedPath) replaceHashPath(encodedPath);\n\n  var initialLocation = getDOMLocation();\n  var allPaths = [createPath(initialLocation)];\n\n  // Public interface\n\n  var createHref = function createHref(location) {\n    return '#' + encodePath(basename + createPath(location));\n  };\n\n  var push = function push(path, state) {\n    warning(state === undefined, 'Hash history cannot push state; it is ignored');\n\n    var action = 'PUSH';\n    var location = createLocation(path, undefined, undefined, history.location);\n\n    transitionManager.confirmTransitionTo(location, action, getUserConfirmation, function (ok) {\n      if (!ok) return;\n\n      var path = createPath(location);\n      var encodedPath = encodePath(basename + path);\n      var hashChanged = getHashPath() !== encodedPath;\n\n      if (hashChanged) {\n        // We cannot tell if a hashchange was caused by a PUSH, so we'd\n        // rather setState here and ignore the hashchange. The caveat here\n        // is that other hash histories in the page will consider it a POP.\n        ignorePath = path;\n        pushHashPath(encodedPath);\n\n        var prevIndex = allPaths.lastIndexOf(createPath(history.location));\n        var nextPaths = allPaths.slice(0, prevIndex === -1 ? 0 : prevIndex + 1);\n\n        nextPaths.push(path);\n        allPaths = nextPaths;\n\n        setState({ action: action, location: location });\n      } else {\n        warning(false, 'Hash history cannot PUSH the same path; a new entry will not be added to the history stack');\n\n        setState();\n      }\n    });\n  };\n\n  var replace = function replace(path, state) {\n    warning(state === undefined, 'Hash history cannot replace state; it is ignored');\n\n    var action = 'REPLACE';\n    var location = createLocation(path, undefined, undefined, history.location);\n\n    transitionManager.confirmTransitionTo(location, action, getUserConfirmation, function (ok) {\n      if (!ok) return;\n\n      var path = createPath(location);\n      var encodedPath = encodePath(basename + path);\n      var hashChanged = getHashPath() !== encodedPath;\n\n      if (hashChanged) {\n        // We cannot tell if a hashchange was caused by a REPLACE, so we'd\n        // rather setState here and ignore the hashchange. The caveat here\n        // is that other hash histories in the page will consider it a POP.\n        ignorePath = path;\n        replaceHashPath(encodedPath);\n      }\n\n      var prevIndex = allPaths.indexOf(createPath(history.location));\n\n      if (prevIndex !== -1) allPaths[prevIndex] = path;\n\n      setState({ action: action, location: location });\n    });\n  };\n\n  var go = function go(n) {\n    warning(canGoWithoutReload, 'Hash history go(n) causes a full page reload in this browser');\n\n    globalHistory.go(n);\n  };\n\n  var goBack = function goBack() {\n    return go(-1);\n  };\n\n  var goForward = function goForward() {\n    return go(1);\n  };\n\n  var listenerCount = 0;\n\n  var checkDOMListeners = function checkDOMListeners(delta) {\n    listenerCount += delta;\n\n    if (listenerCount === 1) {\n      addEventListener(window, HashChangeEvent, handleHashChange);\n    } else if (listenerCount === 0) {\n      removeEventListener(window, HashChangeEvent, handleHashChange);\n    }\n  };\n\n  var isBlocked = false;\n\n  var block = function block() {\n    var prompt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    var unblock = transitionManager.setPrompt(prompt);\n\n    if (!isBlocked) {\n      checkDOMListeners(1);\n      isBlocked = true;\n    }\n\n    return function () {\n      if (isBlocked) {\n        isBlocked = false;\n        checkDOMListeners(-1);\n      }\n\n      return unblock();\n    };\n  };\n\n  var listen = function listen(listener) {\n    var unlisten = transitionManager.appendListener(listener);\n    checkDOMListeners(1);\n\n    return function () {\n      checkDOMListeners(-1);\n      unlisten();\n    };\n  };\n\n  var history = {\n    length: globalHistory.length,\n    action: 'POP',\n    location: initialLocation,\n    createHref: createHref,\n    push: push,\n    replace: replace,\n    go: go,\n    goBack: goBack,\n    goForward: goForward,\n    block: block,\n    listen: listen\n  };\n\n  return history;\n};\n\nexport default createHashHistory;","var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport warning from 'warning';\nimport { createPath } from './PathUtils';\nimport { createLocation } from './LocationUtils';\nimport createTransitionManager from './createTransitionManager';\n\nvar clamp = function clamp(n, lowerBound, upperBound) {\n  return Math.min(Math.max(n, lowerBound), upperBound);\n};\n\n/**\n * Creates a history object that stores locations in memory.\n */\nvar createMemoryHistory = function createMemoryHistory() {\n  var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var getUserConfirmation = props.getUserConfirmation,\n      _props$initialEntries = props.initialEntries,\n      initialEntries = _props$initialEntries === undefined ? ['/'] : _props$initialEntries,\n      _props$initialIndex = props.initialIndex,\n      initialIndex = _props$initialIndex === undefined ? 0 : _props$initialIndex,\n      _props$keyLength = props.keyLength,\n      keyLength = _props$keyLength === undefined ? 6 : _props$keyLength;\n\n\n  var transitionManager = createTransitionManager();\n\n  var setState = function setState(nextState) {\n    _extends(history, nextState);\n\n    history.length = history.entries.length;\n\n    transitionManager.notifyListeners(history.location, history.action);\n  };\n\n  var createKey = function createKey() {\n    return Math.random().toString(36).substr(2, keyLength);\n  };\n\n  var index = clamp(initialIndex, 0, initialEntries.length - 1);\n  var entries = initialEntries.map(function (entry) {\n    return typeof entry === 'string' ? createLocation(entry, undefined, createKey()) : createLocation(entry, undefined, entry.key || createKey());\n  });\n\n  // Public interface\n\n  var createHref = createPath;\n\n  var push = function push(path, state) {\n    warning(!((typeof path === 'undefined' ? 'undefined' : _typeof(path)) === 'object' && path.state !== undefined && state !== undefined), 'You should avoid providing a 2nd state argument to push when the 1st ' + 'argument is a location-like object that already has state; it is ignored');\n\n    var action = 'PUSH';\n    var location = createLocation(path, state, createKey(), history.location);\n\n    transitionManager.confirmTransitionTo(location, action, getUserConfirmation, function (ok) {\n      if (!ok) return;\n\n      var prevIndex = history.index;\n      var nextIndex = prevIndex + 1;\n\n      var nextEntries = history.entries.slice(0);\n      if (nextEntries.length > nextIndex) {\n        nextEntries.splice(nextIndex, nextEntries.length - nextIndex, location);\n      } else {\n        nextEntries.push(location);\n      }\n\n      setState({\n        action: action,\n        location: location,\n        index: nextIndex,\n        entries: nextEntries\n      });\n    });\n  };\n\n  var replace = function replace(path, state) {\n    warning(!((typeof path === 'undefined' ? 'undefined' : _typeof(path)) === 'object' && path.state !== undefined && state !== undefined), 'You should avoid providing a 2nd state argument to replace when the 1st ' + 'argument is a location-like object that already has state; it is ignored');\n\n    var action = 'REPLACE';\n    var location = createLocation(path, state, createKey(), history.location);\n\n    transitionManager.confirmTransitionTo(location, action, getUserConfirmation, function (ok) {\n      if (!ok) return;\n\n      history.entries[history.index] = location;\n\n      setState({ action: action, location: location });\n    });\n  };\n\n  var go = function go(n) {\n    var nextIndex = clamp(history.index + n, 0, history.entries.length - 1);\n\n    var action = 'POP';\n    var location = history.entries[nextIndex];\n\n    transitionManager.confirmTransitionTo(location, action, getUserConfirmation, function (ok) {\n      if (ok) {\n        setState({\n          action: action,\n          location: location,\n          index: nextIndex\n        });\n      } else {\n        // Mimic the behavior of DOM histories by\n        // causing a render after a cancelled POP.\n        setState();\n      }\n    });\n  };\n\n  var goBack = function goBack() {\n    return go(-1);\n  };\n\n  var goForward = function goForward() {\n    return go(1);\n  };\n\n  var canGo = function canGo(n) {\n    var nextIndex = history.index + n;\n    return nextIndex >= 0 && nextIndex < history.entries.length;\n  };\n\n  var block = function block() {\n    var prompt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    return transitionManager.setPrompt(prompt);\n  };\n\n  var listen = function listen(listener) {\n    return transitionManager.appendListener(listener);\n  };\n\n  var history = {\n    length: entries.length,\n    action: 'POP',\n    location: entries[index],\n    index: index,\n    entries: entries,\n    createHref: createHref,\n    push: push,\n    replace: replace,\n    go: go,\n    goBack: goBack,\n    goForward: goForward,\n    canGo: canGo,\n    block: block,\n    listen: listen\n  };\n\n  return history;\n};\n\nexport default createMemoryHistory;","// Written in this round about way for babel-transform-imports\nimport Router from \"react-router/es/Router\";\n\nexport default Router;","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport warning from \"warning\";\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { createBrowserHistory as createHistory } from \"history\";\nimport Router from \"./Router\";\n\n/**\n * The public API for a <Router> that uses HTML5 history.\n */\n\nvar BrowserRouter = function (_React$Component) {\n  _inherits(BrowserRouter, _React$Component);\n\n  function BrowserRouter() {\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, BrowserRouter);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _React$Component.call.apply(_React$Component, [this].concat(args))), _this), _this.history = createHistory(_this.props), _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  BrowserRouter.prototype.componentWillMount = function componentWillMount() {\n    warning(!this.props.history, \"<BrowserRouter> ignores the history prop. To use a custom history, \" + \"use `import { Router }` instead of `import { BrowserRouter as Router }`.\");\n  };\n\n  BrowserRouter.prototype.render = function render() {\n    return React.createElement(Router, { history: this.history, children: this.props.children });\n  };\n\n  return BrowserRouter;\n}(React.Component);\n\nBrowserRouter.propTypes = {\n  basename: PropTypes.string,\n  forceRefresh: PropTypes.bool,\n  getUserConfirmation: PropTypes.func,\n  keyLength: PropTypes.number,\n  children: PropTypes.node\n};\n\n\nexport default BrowserRouter;","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport warning from \"warning\";\nimport invariant from \"invariant\";\nimport matchPath from \"./matchPath\";\n\n/**\n * The public API for rendering the first <Route> that matches.\n */\n\nvar Switch = function (_React$Component) {\n  _inherits(Switch, _React$Component);\n\n  function Switch() {\n    _classCallCheck(this, Switch);\n\n    return _possibleConstructorReturn(this, _React$Component.apply(this, arguments));\n  }\n\n  Switch.prototype.componentWillMount = function componentWillMount() {\n    invariant(this.context.router, \"You should not use <Switch> outside a <Router>\");\n  };\n\n  Switch.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    warning(!(nextProps.location && !this.props.location), '<Switch> elements should not change from uncontrolled to controlled (or vice versa). You initially used no \"location\" prop and then provided one on a subsequent render.');\n\n    warning(!(!nextProps.location && this.props.location), '<Switch> elements should not change from controlled to uncontrolled (or vice versa). You provided a \"location\" prop initially but omitted it on a subsequent render.');\n  };\n\n  Switch.prototype.render = function render() {\n    var route = this.context.router.route;\n    var children = this.props.children;\n\n    var location = this.props.location || route.location;\n\n    var match = void 0,\n        child = void 0;\n    React.Children.forEach(children, function (element) {\n      if (match == null && React.isValidElement(element)) {\n        var _element$props = element.props,\n            pathProp = _element$props.path,\n            exact = _element$props.exact,\n            strict = _element$props.strict,\n            sensitive = _element$props.sensitive,\n            from = _element$props.from;\n\n        var path = pathProp || from;\n\n        child = element;\n        match = matchPath(location.pathname, { path: path, exact: exact, strict: strict, sensitive: sensitive }, route.match);\n      }\n    });\n\n    return match ? React.cloneElement(child, { location: location, computedMatch: match }) : null;\n  };\n\n  return Switch;\n}(React.Component);\n\nSwitch.contextTypes = {\n  router: PropTypes.shape({\n    route: PropTypes.object.isRequired\n  }).isRequired\n};\nSwitch.propTypes = {\n  children: PropTypes.node,\n  location: PropTypes.object\n};\n\n\nexport default Switch;","// Written in this round about way for babel-transform-imports\nimport Switch from \"react-router/es/Switch\";\n\nexport default Switch;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport warning from \"warning\";\nimport invariant from \"invariant\";\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport matchPath from \"./matchPath\";\n\nvar isEmptyChildren = function isEmptyChildren(children) {\n  return React.Children.count(children) === 0;\n};\n\n/**\n * The public API for matching a single path and rendering.\n */\n\nvar Route = function (_React$Component) {\n  _inherits(Route, _React$Component);\n\n  function Route() {\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Route);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, _React$Component.call.apply(_React$Component, [this].concat(args))), _this), _this.state = {\n      match: _this.computeMatch(_this.props, _this.context.router)\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  Route.prototype.getChildContext = function getChildContext() {\n    return {\n      router: _extends({}, this.context.router, {\n        route: {\n          location: this.props.location || this.context.router.route.location,\n          match: this.state.match\n        }\n      })\n    };\n  };\n\n  Route.prototype.computeMatch = function computeMatch(_ref, router) {\n    var computedMatch = _ref.computedMatch,\n        location = _ref.location,\n        path = _ref.path,\n        strict = _ref.strict,\n        exact = _ref.exact,\n        sensitive = _ref.sensitive;\n\n    if (computedMatch) return computedMatch; // <Switch> already computed the match for us\n\n    invariant(router, \"You should not use <Route> or withRouter() outside a <Router>\");\n\n    var route = router.route;\n\n    var pathname = (location || route.location).pathname;\n\n    return matchPath(pathname, { path: path, strict: strict, exact: exact, sensitive: sensitive }, route.match);\n  };\n\n  Route.prototype.componentWillMount = function componentWillMount() {\n    warning(!(this.props.component && this.props.render), \"You should not use <Route component> and <Route render> in the same route; <Route render> will be ignored\");\n\n    warning(!(this.props.component && this.props.children && !isEmptyChildren(this.props.children)), \"You should not use <Route component> and <Route children> in the same route; <Route children> will be ignored\");\n\n    warning(!(this.props.render && this.props.children && !isEmptyChildren(this.props.children)), \"You should not use <Route render> and <Route children> in the same route; <Route children> will be ignored\");\n  };\n\n  Route.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps, nextContext) {\n    warning(!(nextProps.location && !this.props.location), '<Route> elements should not change from uncontrolled to controlled (or vice versa). You initially used no \"location\" prop and then provided one on a subsequent render.');\n\n    warning(!(!nextProps.location && this.props.location), '<Route> elements should not change from controlled to uncontrolled (or vice versa). You provided a \"location\" prop initially but omitted it on a subsequent render.');\n\n    this.setState({\n      match: this.computeMatch(nextProps, nextContext.router)\n    });\n  };\n\n  Route.prototype.render = function render() {\n    var match = this.state.match;\n    var _props = this.props,\n        children = _props.children,\n        component = _props.component,\n        render = _props.render;\n    var _context$router = this.context.router,\n        history = _context$router.history,\n        route = _context$router.route,\n        staticContext = _context$router.staticContext;\n\n    var location = this.props.location || route.location;\n    var props = { match: match, location: location, history: history, staticContext: staticContext };\n\n    if (component) return match ? React.createElement(component, props) : null;\n\n    if (render) return match ? render(props) : null;\n\n    if (typeof children === \"function\") return children(props);\n\n    if (children && !isEmptyChildren(children)) return React.Children.only(children);\n\n    return null;\n  };\n\n  return Route;\n}(React.Component);\n\nRoute.propTypes = {\n  computedMatch: PropTypes.object, // private, from <Switch>\n  path: PropTypes.string,\n  exact: PropTypes.bool,\n  strict: PropTypes.bool,\n  sensitive: PropTypes.bool,\n  component: PropTypes.func,\n  render: PropTypes.func,\n  children: PropTypes.oneOfType([PropTypes.func, PropTypes.node]),\n  location: PropTypes.object\n};\nRoute.contextTypes = {\n  router: PropTypes.shape({\n    history: PropTypes.object.isRequired,\n    route: PropTypes.object.isRequired,\n    staticContext: PropTypes.object\n  })\n};\nRoute.childContextTypes = {\n  router: PropTypes.object.isRequired\n};\n\n\nexport default Route;","// Written in this round about way for babel-transform-imports\nimport Route from \"react-router/es/Route\";\n\nexport default Route;"],"sourceRoot":""}